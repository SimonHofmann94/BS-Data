{
  "experiment_name": "experiment_grid_lr0.001_wd0.1_s20_20251207_141623",
  "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s20_20251207_141623",
  "timestamp": "2025-12-07T14:18:16.827093",
  "model": "ConvNextTiny",
  "loss": "CrossEntropyLossWrapper",
  "loss_params": {
    "weight": null,
    "reduction": "mean"
  },
  "best_epoch": 13,
  "split_info": {
    "train": {
      "total_samples": 15284,
      "class_counts": {
        "no_defect": 7734,
        "defect": 7550
      }
    },
    "val": {
      "total_samples": 3275,
      "class_counts": {
        "no_defect": 1691,
        "defect": 1584
      }
    },
    "test": {
      "total_samples": 3276,
      "class_counts": {
        "no_defect": 1650,
        "defect": 1626
      }
    },
    "total": {
      "total_samples": 21835,
      "class_counts": {
        "no_defect": 11075,
        "defect": 10760
      }
    }
  },
  "config": {
    "model": {
      "name": "convnext_tiny",
      "num_classes": 2,
      "pretrained": true,
      "cbam_stages": [
        3,
        4
      ]
    },
    "loss": {
      "type": "cross_entropy",
      "weight": null,
      "reduction": "mean"
    },
    "data": {
      "img_dir": "data/images",
      "ann_dir": "data/annotations",
      "splits_dir": "data/splits",
      "batch_size": 64,
      "num_workers": 8,
      "pin_memory": false,
      "image_size": [
        150,
        150
      ],
      "num_classes": 2,
      "class_names": [
        "no_defect",
        "defect"
      ],
      "split_strategy": "stratified_70_15_15",
      "use_saved_splits": true
    },
    "augmentation": {
      "horizontal_flip": 0.5,
      "vertical_flip": 0.3,
      "rotation": 10,
      "brightness_contrast": {
        "brightness": 0.2,
        "contrast": 0.2
      },
      "defect_blackout": {
        "enabled": false
      }
    },
    "training": {
      "num_epochs": 15,
      "learning_rate": 0.001,
      "weight_decay": 0.1,
      "warmup_epochs": 2,
      "log_interval": 5,
      "threshold": 0.5,
      "save_checkpoints": false,
      "freeze_backbone": true,
      "freeze_early_stages": null
    },
    "optimizer": {
      "type": "adamw",
      "lr": 0.001,
      "weight_decay": 0.1,
      "betas": [
        0.9,
        0.999
      ]
    },
    "scheduler": {
      "type": "cosine",
      "warmup_epochs": 3
    },
    "experiment": {
      "name": "grid_lr0.001_wd0.1_s20",
      "seed": 20,
      "save_dir": "code/experiments/results",
      "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s20_20251207_141623"
    }
  },
  "device": "cuda",
  "num_model_parameters": 28590666,
  "num_trainable_parameters": 772074,
  "best_val_metrics": {
    "precision_macro": 0.955909353490934,
    "recall_macro": 0.9561033904987187,
    "f1_macro": 0.955993505402833,
    "precision_micro": 0.956030534351145,
    "recall_micro": 0.956030534351145,
    "f1_micro": 0.956030534351145,
    "accuracy": 0.956030534351145,
    "hamming_loss": 0.04396946564885496,
    "no_defect_precision": 0.9606908874329958,
    "no_defect_recall": 0.9538734476641041,
    "no_defect_f1": 0.9572700296735905,
    "no_defect_tp": 1613,
    "no_defect_fp": 66,
    "no_defect_tn": 1518,
    "no_defect_fn": 78,
    "no_defect_support": 1691,
    "defect_precision": 0.9511278195488722,
    "defect_recall": 0.9583333333333334,
    "defect_f1": 0.9547169811320755,
    "defect_tp": 1518,
    "defect_fp": 78,
    "defect_tn": 1613,
    "defect_fn": 66,
    "defect_support": 1584
  },
  "test_metrics": {
    "precision_macro": 0.9591201814329445,
    "recall_macro": 0.9590763725819076,
    "f1_macro": 0.9590925559529863,
    "precision_micro": 0.9590964590964591,
    "recall_micro": 0.9590964590964591,
    "f1_micro": 0.9590964590964591,
    "accuracy": 0.9590964590964591,
    "hamming_loss": 0.040903540903540904,
    "no_defect_precision": 0.9571773220747889,
    "no_defect_recall": 0.9618181818181818,
    "no_defect_f1": 0.9594921402660218,
    "no_defect_tp": 1587,
    "no_defect_fp": 71,
    "no_defect_tn": 1555,
    "no_defect_fn": 63,
    "no_defect_support": 1650,
    "defect_precision": 0.9610630407911002,
    "defect_recall": 0.9563345633456335,
    "defect_f1": 0.9586929716399507,
    "defect_tp": 1555,
    "defect_fp": 63,
    "defect_tn": 1587,
    "defect_fn": 71,
    "defect_support": 1626
  },
  "training_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15
    ],
    "train_loss": [
      0.6242238652257242,
      0.4153349873411107,
      0.29124508760713635,
      0.24422635225321956,
      0.2196897032620019,
      0.20738409568699834,
      0.20074088101481793,
      0.1999250901044662,
      0.18837926733194535,
      0.18957710163239155,
      0.18472971760952323,
      0.18533138887154008,
      0.18362400450092978,
      0.18545647227365103,
      0.18568970453165565
    ],
    "val_loss": [
      0.5757260162096757,
      0.3501260418158311,
      0.25265169688142264,
      0.2144702569796489,
      0.19696015148208693,
      0.17805780126498297,
      0.16845107408097157,
      0.16534089712569347,
      0.15900266628998977,
      0.1552880953710813,
      0.15183656419125888,
      0.15012183814094618,
      0.15017963071855214,
      0.14984577965851015,
      0.14993701001199392
    ]
  },
  "metrics_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15
    ],
    "train_metrics": [
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null
    ],
    "val_metrics": [
      {
        "precision_macro": 0.8444569901762053,
        "recall_macro": 0.8170786068849345,
        "f1_macro": 0.8167906805015941,
        "precision_micro": 0.8213740458015267,
        "recall_micro": 0.8213740458015267,
        "f1_micro": 0.8213740458015267,
        "accuracy": 0.8213740458015267,
        "hamming_loss": 0.17862595419847327,
        "no_defect_precision": 0.7630827783063748,
        "no_defect_recall": 0.9485511531638084,
        "no_defect_f1": 0.8457685209596625,
        "no_defect_tp": 1604,
        "no_defect_fp": 498,
        "no_defect_tn": 1086,
        "no_defect_fn": 87,
        "no_defect_support": 1691,
        "defect_precision": 0.9258312020460358,
        "defect_recall": 0.6856060606060606,
        "defect_f1": 0.7878128400435256,
        "defect_tp": 1086,
        "defect_fp": 87,
        "defect_tn": 1604,
        "defect_fn": 498,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9048839717341844,
        "recall_macro": 0.9014227505689658,
        "f1_macro": 0.9021777408608321,
        "precision_micro": 0.9025954198473283,
        "recall_micro": 0.9025954198473283,
        "f1_micro": 0.9025954198473283,
        "accuracy": 0.9025954198473283,
        "hamming_loss": 0.09740458015267175,
        "no_defect_precision": 0.8815350389321468,
        "no_defect_recall": 0.9373151981076286,
        "no_defect_f1": 0.9085697907709945,
        "no_defect_tp": 1585,
        "no_defect_fp": 213,
        "no_defect_tn": 1371,
        "no_defect_fn": 106,
        "no_defect_support": 1691,
        "defect_precision": 0.9282329045362221,
        "defect_recall": 0.865530303030303,
        "defect_f1": 0.8957856909506697,
        "defect_tp": 1371,
        "defect_fp": 106,
        "defect_tn": 1585,
        "defect_fn": 213,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9306685078038942,
        "recall_macro": 0.9300076832786768,
        "f1_macro": 0.9302596392442375,
        "precision_micro": 0.9303816793893129,
        "recall_micro": 0.9303816793893129,
        "f1_micro": 0.9303816793893129,
        "accuracy": 0.9303816793893129,
        "hamming_loss": 0.06961832061068703,
        "no_defect_precision": 0.9250435793143521,
        "no_defect_recall": 0.9414547604967475,
        "no_defect_f1": 0.9331770222743259,
        "no_defect_tp": 1592,
        "no_defect_fp": 129,
        "no_defect_tn": 1455,
        "no_defect_fn": 99,
        "no_defect_support": 1691,
        "defect_precision": 0.9362934362934363,
        "defect_recall": 0.9185606060606061,
        "defect_f1": 0.9273422562141491,
        "defect_tp": 1455,
        "defect_fp": 99,
        "defect_tn": 1592,
        "defect_fn": 129,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9394273431924924,
        "recall_macro": 0.9395572743998232,
        "f1_macro": 0.9394866880979008,
        "precision_micro": 0.9395419847328245,
        "recall_micro": 0.9395419847328245,
        "f1_micro": 0.9395419847328245,
        "accuracy": 0.9395419847328245,
        "hamming_loss": 0.06045801526717557,
        "no_defect_precision": 0.9435531788472965,
        "no_defect_recall": 0.9390892962743939,
        "no_defect_f1": 0.941315945465323,
        "no_defect_tp": 1588,
        "no_defect_fp": 95,
        "no_defect_tn": 1489,
        "no_defect_fn": 103,
        "no_defect_support": 1691,
        "defect_precision": 0.9353015075376885,
        "defect_recall": 0.9400252525252525,
        "defect_f1": 0.9376574307304786,
        "defect_tp": 1489,
        "defect_fp": 103,
        "defect_tn": 1588,
        "defect_fn": 95,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9430104471088078,
        "recall_macro": 0.9434689144550173,
        "f1_macro": 0.9428904549544471,
        "precision_micro": 0.9429007633587786,
        "recall_micro": 0.9429007633587786,
        "f1_micro": 0.9429007633587786,
        "accuracy": 0.9429007633587786,
        "hamming_loss": 0.05709923664122137,
        "no_defect_precision": 0.961916461916462,
        "no_defect_recall": 0.9260792430514488,
        "no_defect_f1": 0.943657728231395,
        "no_defect_tp": 1566,
        "no_defect_fp": 62,
        "no_defect_tn": 1522,
        "no_defect_fn": 125,
        "no_defect_support": 1691,
        "defect_precision": 0.9241044323011536,
        "defect_recall": 0.9608585858585859,
        "defect_f1": 0.9421231816774992,
        "defect_tp": 1522,
        "defect_fp": 125,
        "defect_tn": 1566,
        "defect_fn": 62,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9517041721173891,
        "recall_macro": 0.9517041721173891,
        "f1_macro": 0.9517041721173891,
        "precision_micro": 0.9517557251908397,
        "recall_micro": 0.9517557251908397,
        "f1_micro": 0.9517557251908397,
        "accuracy": 0.9517557251908397,
        "hamming_loss": 0.048244274809160305,
        "no_defect_precision": 0.9532820816085157,
        "no_defect_recall": 0.9532820816085157,
        "no_defect_f1": 0.9532820816085157,
        "no_defect_tp": 1612,
        "no_defect_fp": 79,
        "no_defect_tn": 1505,
        "no_defect_fn": 79,
        "no_defect_support": 1691,
        "defect_precision": 0.9501262626262627,
        "defect_recall": 0.9501262626262627,
        "defect_f1": 0.9501262626262627,
        "defect_tp": 1505,
        "defect_fp": 79,
        "defect_tn": 1612,
        "defect_fn": 79,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9517390387621938,
        "recall_macro": 0.9511288595595219,
        "f1_macro": 0.9513689674195196,
        "precision_micro": 0.9514503816793893,
        "recall_micro": 0.9514503816793893,
        "f1_micro": 0.9514503816793893,
        "accuracy": 0.9514503816793893,
        "hamming_loss": 0.04854961832061069,
        "no_defect_precision": 0.9458672875436555,
        "no_defect_recall": 0.960969840331165,
        "no_defect_f1": 0.9533587562334995,
        "no_defect_tp": 1625,
        "no_defect_fp": 93,
        "no_defect_tn": 1491,
        "no_defect_fn": 66,
        "no_defect_support": 1691,
        "defect_precision": 0.9576107899807321,
        "defect_recall": 0.9412878787878788,
        "defect_f1": 0.9493791786055397,
        "defect_tp": 1491,
        "defect_fp": 66,
        "defect_tn": 1625,
        "defect_fn": 93,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9525530988007314,
        "recall_macro": 0.952990691958019,
        "f1_macro": 0.9526501239421774,
        "precision_micro": 0.9526717557251908,
        "recall_micro": 0.9526717557251908,
        "f1_micro": 0.9526717557251908,
        "accuracy": 0.9526717557251908,
        "hamming_loss": 0.04732824427480916,
        "no_defect_precision": 0.964328899637243,
        "no_defect_recall": 0.9432288586635127,
        "no_defect_f1": 0.953662182361734,
        "no_defect_tp": 1595,
        "no_defect_fp": 59,
        "no_defect_tn": 1525,
        "no_defect_fn": 96,
        "no_defect_support": 1691,
        "defect_precision": 0.9407772979642196,
        "defect_recall": 0.9627525252525253,
        "defect_f1": 0.9516380655226209,
        "defect_tp": 1525,
        "defect_fp": 96,
        "defect_tn": 1595,
        "defect_fn": 59,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9549722858157701,
        "recall_macro": 0.9552562884910608,
        "f1_macro": 0.9550820726596982,
        "precision_micro": 0.9551145038167939,
        "recall_micro": 0.9551145038167939,
        "f1_micro": 0.9551145038167939,
        "accuracy": 0.9551145038167939,
        "hamming_loss": 0.04488549618320611,
        "no_defect_precision": 0.9617224880382775,
        "no_defect_recall": 0.9509166173861621,
        "no_defect_f1": 0.9562890276538805,
        "no_defect_tp": 1608,
        "no_defect_fp": 64,
        "no_defect_tn": 1520,
        "no_defect_fn": 83,
        "no_defect_support": 1691,
        "defect_precision": 0.9482220835932627,
        "defect_recall": 0.9595959595959596,
        "defect_f1": 0.9538751176655161,
        "defect_tp": 1520,
        "defect_fp": 83,
        "defect_tn": 1608,
        "defect_fn": 64,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9555998546141715,
        "recall_macro": 0.9558077074709246,
        "f1_macro": 0.9556886862286829,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.9606674612634089,
        "no_defect_recall": 0.9532820816085157,
        "no_defect_f1": 0.9569605224102108,
        "no_defect_tp": 1612,
        "no_defect_fp": 66,
        "no_defect_tn": 1518,
        "no_defect_fn": 79,
        "no_defect_support": 1691,
        "defect_precision": 0.9505322479649343,
        "defect_recall": 0.9583333333333334,
        "defect_f1": 0.9544168500471549,
        "defect_tp": 1518,
        "defect_fp": 79,
        "defect_tn": 1612,
        "defect_fn": 66,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9556177330517805,
        "recall_macro": 0.9557677603951997,
        "f1_macro": 0.9556855105080515,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.9595719381688466,
        "no_defect_recall": 0.9544648137196925,
        "no_defect_f1": 0.9570115624073525,
        "no_defect_tp": 1614,
        "no_defect_fp": 68,
        "no_defect_tn": 1516,
        "no_defect_fn": 77,
        "no_defect_support": 1691,
        "defect_precision": 0.9516635279347144,
        "defect_recall": 0.9570707070707071,
        "defect_f1": 0.9543594586087504,
        "defect_tp": 1516,
        "defect_fp": 77,
        "defect_tn": 1614,
        "defect_fn": 68,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9559677745698187,
        "recall_macro": 0.9560035228094068,
        "f1_macro": 0.9559852910981278,
        "precision_micro": 0.956030534351145,
        "recall_micro": 0.956030534351145,
        "f1_micro": 0.956030534351145,
        "accuracy": 0.956030534351145,
        "hamming_loss": 0.04396946564885496,
        "no_defect_precision": 0.9579632918886916,
        "no_defect_recall": 0.9568302779420461,
        "no_defect_f1": 0.9573964497041421,
        "no_defect_tp": 1618,
        "no_defect_fp": 71,
        "no_defect_tn": 1513,
        "no_defect_fn": 73,
        "no_defect_support": 1691,
        "defect_precision": 0.9539722572509458,
        "defect_recall": 0.9551767676767676,
        "defect_f1": 0.9545741324921135,
        "defect_tp": 1513,
        "defect_fp": 73,
        "defect_tn": 1618,
        "defect_fn": 71,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.955909353490934,
        "recall_macro": 0.9561033904987187,
        "f1_macro": 0.955993505402833,
        "precision_micro": 0.956030534351145,
        "recall_micro": 0.956030534351145,
        "f1_micro": 0.956030534351145,
        "accuracy": 0.956030534351145,
        "hamming_loss": 0.04396946564885496,
        "no_defect_precision": 0.9606908874329958,
        "no_defect_recall": 0.9538734476641041,
        "no_defect_f1": 0.9572700296735905,
        "no_defect_tp": 1613,
        "no_defect_fp": 66,
        "no_defect_tn": 1518,
        "no_defect_fn": 78,
        "no_defect_support": 1691,
        "defect_precision": 0.9511278195488722,
        "defect_recall": 0.9583333333333334,
        "defect_f1": 0.9547169811320755,
        "defect_tp": 1518,
        "defect_fp": 78,
        "defect_tn": 1613,
        "defect_fn": 66,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9555998546141715,
        "recall_macro": 0.9558077074709246,
        "f1_macro": 0.9556886862286829,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.9606674612634089,
        "no_defect_recall": 0.9532820816085157,
        "no_defect_f1": 0.9569605224102108,
        "no_defect_tp": 1612,
        "no_defect_fp": 66,
        "no_defect_tn": 1518,
        "no_defect_fn": 79,
        "no_defect_support": 1691,
        "defect_precision": 0.9505322479649343,
        "defect_recall": 0.9583333333333334,
        "defect_f1": 0.9544168500471549,
        "defect_tp": 1518,
        "defect_fp": 79,
        "defect_tn": 1612,
        "defect_fn": 66,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9555998546141715,
        "recall_macro": 0.9558077074709246,
        "f1_macro": 0.9556886862286829,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.9606674612634089,
        "no_defect_recall": 0.9532820816085157,
        "no_defect_f1": 0.9569605224102108,
        "no_defect_tp": 1612,
        "no_defect_fp": 66,
        "no_defect_tn": 1518,
        "no_defect_fn": 79,
        "no_defect_support": 1691,
        "defect_precision": 0.9505322479649343,
        "defect_recall": 0.9583333333333334,
        "defect_f1": 0.9544168500471549,
        "defect_tp": 1518,
        "defect_fp": 79,
        "defect_tn": 1612,
        "defect_fn": 66,
        "defect_support": 1584
      }
    ],
    "test_metrics": [
      {
        "precision_macro": 0.9591201814329445,
        "recall_macro": 0.9590763725819076,
        "f1_macro": 0.9590925559529863,
        "precision_micro": 0.9590964590964591,
        "recall_micro": 0.9590964590964591,
        "f1_micro": 0.9590964590964591,
        "accuracy": 0.9590964590964591,
        "hamming_loss": 0.040903540903540904,
        "no_defect_precision": 0.9571773220747889,
        "no_defect_recall": 0.9618181818181818,
        "no_defect_f1": 0.9594921402660218,
        "no_defect_tp": 1587,
        "no_defect_fp": 71,
        "no_defect_tn": 1555,
        "no_defect_fn": 63,
        "no_defect_support": 1650,
        "defect_precision": 0.9610630407911002,
        "defect_recall": 0.9563345633456335,
        "defect_f1": 0.9586929716399507,
        "defect_tp": 1555,
        "defect_fp": 63,
        "defect_tn": 1587,
        "defect_fn": 71,
        "defect_support": 1626
      }
    ]
  }
}