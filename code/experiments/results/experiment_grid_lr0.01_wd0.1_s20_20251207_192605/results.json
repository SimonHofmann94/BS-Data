{
  "experiment_name": "experiment_grid_lr0.01_wd0.1_s20_20251207_192605",
  "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s20_20251207_192605",
  "timestamp": "2025-12-07T19:28:01.612671",
  "model": "ConvNextTiny",
  "loss": "CrossEntropyLossWrapper",
  "loss_params": {
    "weight": null,
    "reduction": "mean"
  },
  "best_epoch": 4,
  "split_info": {
    "train": {
      "total_samples": 15284,
      "class_counts": {
        "no_defect": 7734,
        "defect": 7550
      }
    },
    "val": {
      "total_samples": 3275,
      "class_counts": {
        "no_defect": 1691,
        "defect": 1584
      }
    },
    "test": {
      "total_samples": 3276,
      "class_counts": {
        "no_defect": 1650,
        "defect": 1626
      }
    },
    "total": {
      "total_samples": 21835,
      "class_counts": {
        "no_defect": 11075,
        "defect": 10760
      }
    }
  },
  "config": {
    "model": {
      "name": "convnext_tiny",
      "num_classes": 2,
      "pretrained": true,
      "cbam_stages": [
        3,
        4
      ]
    },
    "loss": {
      "type": "cross_entropy",
      "weight": null,
      "reduction": "mean"
    },
    "data": {
      "img_dir": "data/images",
      "ann_dir": "data/annotations",
      "splits_dir": "data/splits",
      "batch_size": 64,
      "num_workers": 8,
      "pin_memory": false,
      "image_size": [
        150,
        150
      ],
      "num_classes": 2,
      "class_names": [
        "no_defect",
        "defect"
      ],
      "split_strategy": "stratified_70_15_15",
      "use_saved_splits": true
    },
    "augmentation": {
      "horizontal_flip": 0.5,
      "vertical_flip": 0.3,
      "rotation": 10,
      "brightness_contrast": {
        "brightness": 0.2,
        "contrast": 0.2
      },
      "defect_blackout": {
        "enabled": false
      }
    },
    "training": {
      "num_epochs": 15,
      "learning_rate": 0.01,
      "weight_decay": 0.1,
      "warmup_epochs": 2,
      "log_interval": 5,
      "threshold": 0.5,
      "save_checkpoints": false,
      "freeze_backbone": true,
      "freeze_early_stages": null
    },
    "optimizer": {
      "type": "adamw",
      "lr": 0.01,
      "weight_decay": 0.1,
      "betas": [
        0.9,
        0.999
      ]
    },
    "scheduler": {
      "type": "cosine",
      "warmup_epochs": 3
    },
    "experiment": {
      "name": "grid_lr0.01_wd0.1_s20",
      "seed": 20,
      "save_dir": "code/experiments/results",
      "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s20_20251207_192605"
    }
  },
  "device": "cuda",
  "num_model_parameters": 28590666,
  "num_trainable_parameters": 772074,
  "best_val_metrics": {
    "precision_macro": 0.9645793659684104,
    "recall_macro": 0.9645023565041306,
    "f1_macro": 0.964539417531697,
    "precision_micro": 0.9645801526717557,
    "recall_micro": 0.9645801526717557,
    "f1_micro": 0.9645801526717557,
    "accuracy": 0.9645801526717557,
    "hamming_loss": 0.035419847328244276,
    "no_defect_precision": 0.9646017699115044,
    "no_defect_recall": 0.9668835008870491,
    "no_defect_f1": 0.9657412876550502,
    "no_defect_tp": 1635,
    "no_defect_fp": 60,
    "no_defect_tn": 1524,
    "no_defect_fn": 56,
    "no_defect_support": 1691,
    "defect_precision": 0.9645569620253165,
    "defect_recall": 0.9621212121212122,
    "defect_f1": 0.9633375474083439,
    "defect_tp": 1524,
    "defect_fp": 56,
    "defect_tn": 1635,
    "defect_fn": 60,
    "defect_support": 1584
  },
  "test_metrics": {
    "precision_macro": 0.9664252316940802,
    "recall_macro": 0.9664161914346416,
    "f1_macro": 0.9664203513022411,
    "precision_micro": 0.9664224664224664,
    "recall_micro": 0.9664224664224664,
    "f1_micro": 0.9664224664224664,
    "accuracy": 0.9664224664224664,
    "hamming_loss": 0.033577533577533576,
    "no_defect_precision": 0.9661016949152542,
    "no_defect_recall": 0.9672727272727273,
    "no_defect_f1": 0.966686856450636,
    "no_defect_tp": 1596,
    "no_defect_fp": 56,
    "no_defect_tn": 1570,
    "no_defect_fn": 54,
    "no_defect_support": 1650,
    "defect_precision": 0.9667487684729064,
    "defect_recall": 0.965559655596556,
    "defect_f1": 0.9661538461538461,
    "defect_tp": 1570,
    "defect_fp": 54,
    "defect_tn": 1596,
    "defect_fn": 56,
    "defect_support": 1626
  },
  "training_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15
    ],
    "train_loss": [
      0.3933924654163576,
      0.21921685101098096,
      0.1927733235840518,
      0.18487871076646709,
      0.18150621655720547,
      0.1829143237151112,
      0.18068808008562073,
      0.18831099610323687,
      0.17408747346019646,
      0.17690651776526264,
      0.1715554402338411,
      0.1718261555834794,
      0.16975294396468285,
      0.1708443832883775,
      0.17158373451507242
    ],
    "val_loss": [
      0.287839925633027,
      0.15608230634377554,
      0.13073214960212892,
      0.1159245793062907,
      0.12817296715309986,
      0.11896525065486248,
      0.11814366682217671,
      0.12996140100921577,
      0.1287804632089459,
      0.11794906037931259,
      0.11346898722247435,
      0.1202206456890473,
      0.11797406051594478,
      0.11752888438506769,
      0.11854769934255344
    ]
  },
  "metrics_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15
    ],
    "train_metrics": [
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null
    ],
    "val_metrics": [
      {
        "precision_macro": 0.918525351276055,
        "recall_macro": 0.9177209707960743,
        "f1_macro": 0.9180116235361286,
        "precision_micro": 0.9181679389312977,
        "recall_micro": 0.9181679389312977,
        "f1_micro": 0.9181679389312977,
        "accuracy": 0.9181679389312977,
        "hamming_loss": 0.08183206106870229,
        "no_defect_precision": 0.9119861030689056,
        "no_defect_recall": 0.9314015375517445,
        "no_defect_f1": 0.9215915740198947,
        "no_defect_tp": 1575,
        "no_defect_fp": 152,
        "no_defect_tn": 1432,
        "no_defect_fn": 116,
        "no_defect_support": 1691,
        "defect_precision": 0.9250645994832042,
        "defect_recall": 0.9040404040404041,
        "defect_f1": 0.9144316730523627,
        "defect_tp": 1432,
        "defect_fp": 116,
        "defect_tn": 1575,
        "defect_fn": 152,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9547998710992379,
        "recall_macro": 0.9541855575267757,
        "f1_macro": 0.9544275229277259,
        "precision_micro": 0.9545038167938932,
        "recall_micro": 0.9545038167938932,
        "f1_micro": 0.9545038167938932,
        "accuracy": 0.9545038167938932,
        "hamming_loss": 0.04549618320610687,
        "no_defect_precision": 0.9487776484284052,
        "no_defect_recall": 0.9639266706091071,
        "no_defect_f1": 0.9562921677911411,
        "no_defect_tp": 1630,
        "no_defect_fp": 88,
        "no_defect_tn": 1496,
        "no_defect_fn": 61,
        "no_defect_support": 1691,
        "defect_precision": 0.9608220937700707,
        "defect_recall": 0.9444444444444444,
        "defect_f1": 0.9525628780643107,
        "defect_tp": 1496,
        "defect_fp": 61,
        "defect_tn": 1630,
        "defect_fn": 88,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9559286330643114,
        "recall_macro": 0.956063443422994,
        "f1_macro": 0.9559903186166552,
        "precision_micro": 0.956030534351145,
        "recall_micro": 0.956030534351145,
        "f1_micro": 0.956030534351145,
        "accuracy": 0.956030534351145,
        "hamming_loss": 0.04396946564885496,
        "no_defect_precision": 0.9595959595959596,
        "no_defect_recall": 0.9550561797752809,
        "no_defect_f1": 0.9573206876111441,
        "no_defect_tp": 1615,
        "no_defect_fp": 68,
        "no_defect_tn": 1516,
        "no_defect_fn": 76,
        "no_defect_support": 1691,
        "defect_precision": 0.9522613065326633,
        "defect_recall": 0.9570707070707071,
        "defect_f1": 0.9546599496221663,
        "defect_tp": 1516,
        "defect_fp": 76,
        "defect_tn": 1615,
        "defect_fn": 68,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9645793659684104,
        "recall_macro": 0.9645023565041306,
        "f1_macro": 0.964539417531697,
        "precision_micro": 0.9645801526717557,
        "recall_micro": 0.9645801526717557,
        "f1_micro": 0.9645801526717557,
        "accuracy": 0.9645801526717557,
        "hamming_loss": 0.035419847328244276,
        "no_defect_precision": 0.9646017699115044,
        "no_defect_recall": 0.9668835008870491,
        "no_defect_f1": 0.9657412876550502,
        "no_defect_tp": 1635,
        "no_defect_fp": 60,
        "no_defect_tn": 1524,
        "no_defect_fn": 56,
        "no_defect_support": 1691,
        "defect_precision": 0.9645569620253165,
        "defect_recall": 0.9621212121212122,
        "defect_f1": 0.9633375474083439,
        "defect_tp": 1524,
        "defect_fp": 56,
        "defect_tn": 1635,
        "defect_fn": 60,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9573754632088363,
        "recall_macro": 0.9578453816700416,
        "f1_macro": 0.9572445377449137,
        "precision_micro": 0.9572519083969465,
        "recall_micro": 0.9572519083969465,
        "f1_micro": 0.9572519083969465,
        "accuracy": 0.9572519083969465,
        "hamming_loss": 0.042748091603053436,
        "no_defect_precision": 0.9766441303011678,
        "no_defect_recall": 0.9396806623299823,
        "no_defect_f1": 0.9578059071729957,
        "no_defect_tp": 1589,
        "no_defect_fp": 38,
        "no_defect_tn": 1546,
        "no_defect_fn": 102,
        "no_defect_support": 1691,
        "defect_precision": 0.9381067961165048,
        "defect_recall": 0.976010101010101,
        "defect_f1": 0.9566831683168316,
        "defect_tp": 1546,
        "defect_fp": 102,
        "defect_tn": 1589,
        "defect_fn": 38,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9581857898711648,
        "recall_macro": 0.9570824671911307,
        "f1_macro": 0.9574680291970803,
        "precision_micro": 0.9575572519083969,
        "recall_micro": 0.9575572519083969,
        "f1_micro": 0.9575572519083969,
        "accuracy": 0.9575572519083969,
        "hamming_loss": 0.042442748091603054,
        "no_defect_precision": 0.947520184544406,
        "no_defect_recall": 0.9716144293317563,
        "no_defect_f1": 0.9594160583941606,
        "no_defect_tp": 1643,
        "no_defect_fp": 91,
        "no_defect_tn": 1493,
        "no_defect_fn": 48,
        "no_defect_support": 1691,
        "defect_precision": 0.9688513951979234,
        "defect_recall": 0.9425505050505051,
        "defect_f1": 0.95552,
        "defect_tp": 1493,
        "defect_fp": 48,
        "defect_tn": 1643,
        "defect_fn": 91,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9609203505912167,
        "recall_macro": 0.9598434821305903,
        "f1_macro": 0.9602230090109483,
        "precision_micro": 0.9603053435114504,
        "recall_micro": 0.9603053435114504,
        "f1_micro": 0.9603053435114504,
        "accuracy": 0.9603053435114504,
        "hamming_loss": 0.03969465648854962,
        "no_defect_precision": 0.9503750721292556,
        "no_defect_recall": 0.97397989355411,
        "no_defect_f1": 0.9620327102803738,
        "no_defect_tp": 1647,
        "no_defect_fp": 86,
        "no_defect_tn": 1498,
        "no_defect_fn": 44,
        "no_defect_support": 1691,
        "defect_precision": 0.9714656290531777,
        "defect_recall": 0.9457070707070707,
        "defect_f1": 0.9584133077415227,
        "defect_tp": 1498,
        "defect_fp": 44,
        "defect_tn": 1647,
        "defect_fn": 86,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.956446013823063,
        "recall_macro": 0.9569183855109342,
        "f1_macro": 0.9563279949651655,
        "precision_micro": 0.9563358778625954,
        "recall_micro": 0.9563358778625954,
        "f1_micro": 0.9563358778625954,
        "accuracy": 0.9563358778625954,
        "hamming_loss": 0.04366412213740458,
        "no_defect_precision": 0.9754299754299754,
        "no_defect_recall": 0.9390892962743939,
        "no_defect_f1": 0.9569147333534197,
        "no_defect_tp": 1588,
        "no_defect_fp": 40,
        "no_defect_tn": 1544,
        "no_defect_fn": 103,
        "no_defect_support": 1691,
        "defect_precision": 0.9374620522161505,
        "defect_recall": 0.9747474747474747,
        "defect_f1": 0.9557412565769112,
        "defect_tp": 1544,
        "defect_fp": 103,
        "defect_tn": 1588,
        "defect_fn": 40,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9573002544206616,
        "recall_macro": 0.9577854610564546,
        "f1_macro": 0.9572423368195984,
        "precision_micro": 0.9572519083969465,
        "recall_micro": 0.9572519083969465,
        "f1_micro": 0.9572519083969465,
        "accuracy": 0.9572519083969465,
        "hamming_loss": 0.042748091603053436,
        "no_defect_precision": 0.9748928352725046,
        "no_defect_recall": 0.9414547604967475,
        "no_defect_f1": 0.9578820697954272,
        "no_defect_tp": 1592,
        "no_defect_fp": 41,
        "no_defect_tn": 1543,
        "no_defect_fn": 99,
        "no_defect_support": 1691,
        "defect_precision": 0.9397076735688186,
        "defect_recall": 0.9741161616161617,
        "defect_f1": 0.9566026038437694,
        "defect_tp": 1543,
        "defect_fp": 99,
        "defect_tn": 1592,
        "defect_fn": 41,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9626770652448193,
        "recall_macro": 0.9627482318752278,
        "f1_macro": 0.962711208270711,
        "precision_micro": 0.9627480916030534,
        "recall_micro": 0.9627480916030534,
        "f1_micro": 0.9627480916030534,
        "accuracy": 0.9627480916030534,
        "hamming_loss": 0.037251908396946566,
        "no_defect_precision": 0.965026674570243,
        "no_defect_recall": 0.9627439384979303,
        "no_defect_f1": 0.9638839550029603,
        "no_defect_tp": 1628,
        "no_defect_fp": 59,
        "no_defect_tn": 1525,
        "no_defect_fn": 63,
        "no_defect_support": 1691,
        "defect_precision": 0.9603274559193955,
        "defect_recall": 0.9627525252525253,
        "defect_f1": 0.9615384615384616,
        "defect_tp": 1525,
        "defect_fp": 63,
        "defect_tn": 1628,
        "defect_fn": 59,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9636340013351075,
        "recall_macro": 0.9636153074207481,
        "f1_macro": 0.9636245642484604,
        "precision_micro": 0.9636641221374046,
        "recall_micro": 0.9636641221374046,
        "f1_micro": 0.9636641221374046,
        "accuracy": 0.9636641221374046,
        "hamming_loss": 0.03633587786259542,
        "no_defect_precision": 0.9645390070921985,
        "no_defect_recall": 0.9651094027202839,
        "no_defect_f1": 0.964824120603015,
        "no_defect_tp": 1632,
        "no_defect_fp": 60,
        "no_defect_tn": 1524,
        "no_defect_fn": 59,
        "no_defect_support": 1691,
        "defect_precision": 0.9627289955780164,
        "defect_recall": 0.9621212121212122,
        "defect_f1": 0.962425007893906,
        "defect_tp": 1524,
        "defect_fp": 59,
        "defect_tn": 1632,
        "defect_fn": 60,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9607722911460692,
        "recall_macro": 0.9610939749356366,
        "f1_macro": 0.9608896850276161,
        "precision_micro": 0.9609160305343512,
        "recall_micro": 0.9609160305343512,
        "f1_micro": 0.9609160305343512,
        "accuracy": 0.9609160305343512,
        "hamming_loss": 0.039083969465648856,
        "no_defect_precision": 0.9682444577591373,
        "no_defect_recall": 0.9556475458308693,
        "no_defect_f1": 0.9619047619047619,
        "no_defect_tp": 1616,
        "no_defect_fp": 53,
        "no_defect_tn": 1531,
        "no_defect_fn": 75,
        "no_defect_support": 1691,
        "defect_precision": 0.9533001245330013,
        "defect_recall": 0.9665404040404041,
        "defect_f1": 0.9598746081504702,
        "defect_tp": 1531,
        "defect_fp": 75,
        "defect_tn": 1616,
        "defect_fn": 53,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9601725746268657,
        "recall_macro": 0.9604227147285989,
        "f1_macro": 0.9602746725308061,
        "precision_micro": 0.9603053435114504,
        "recall_micro": 0.9603053435114504,
        "f1_micro": 0.9603053435114504,
        "accuracy": 0.9603053435114504,
        "hamming_loss": 0.03969465648854962,
        "no_defect_precision": 0.9659701492537314,
        "no_defect_recall": 0.9568302779420461,
        "no_defect_f1": 0.9613784907902555,
        "no_defect_tp": 1618,
        "no_defect_fp": 57,
        "no_defect_tn": 1527,
        "no_defect_fn": 73,
        "no_defect_support": 1691,
        "defect_precision": 0.954375,
        "defect_recall": 0.9640151515151515,
        "defect_f1": 0.9591708542713567,
        "defect_tp": 1527,
        "defect_fp": 73,
        "defect_tn": 1618,
        "defect_fn": 57,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9620201486443924,
        "recall_macro": 0.9622167864332264,
        "f1_macro": 0.9621055185413284,
        "precision_micro": 0.9621374045801526,
        "recall_micro": 0.9621374045801526,
        "f1_micro": 0.9621374045801526,
        "accuracy": 0.9621374045801526,
        "hamming_loss": 0.03786259541984733,
        "no_defect_precision": 0.9666468135795117,
        "no_defect_recall": 0.9597871082199881,
        "no_defect_f1": 0.9632047477744807,
        "no_defect_tp": 1623,
        "no_defect_fp": 56,
        "no_defect_tn": 1528,
        "no_defect_fn": 68,
        "no_defect_support": 1691,
        "defect_precision": 0.9573934837092731,
        "defect_recall": 0.9646464646464646,
        "defect_f1": 0.9610062893081761,
        "defect_tp": 1528,
        "defect_fp": 68,
        "defect_tn": 1623,
        "defect_fn": 56,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9610818680285469,
        "recall_macro": 0.9613696844255686,
        "f1_macro": 0.9611933552910319,
        "precision_micro": 0.9612213740458015,
        "recall_micro": 0.9612213740458015,
        "f1_micro": 0.9612213740458015,
        "accuracy": 0.9612213740458015,
        "hamming_loss": 0.038778625954198474,
        "no_defect_precision": 0.9677033492822966,
        "no_defect_recall": 0.9568302779420461,
        "no_defect_f1": 0.9622360987213797,
        "no_defect_tp": 1618,
        "no_defect_fp": 54,
        "no_defect_tn": 1530,
        "no_defect_fn": 73,
        "no_defect_support": 1691,
        "defect_precision": 0.9544603867747973,
        "defect_recall": 0.9659090909090909,
        "defect_f1": 0.9601506118606841,
        "defect_tp": 1530,
        "defect_fp": 73,
        "defect_tn": 1618,
        "defect_fn": 54,
        "defect_support": 1584
      }
    ],
    "test_metrics": [
      {
        "precision_macro": 0.9664252316940802,
        "recall_macro": 0.9664161914346416,
        "f1_macro": 0.9664203513022411,
        "precision_micro": 0.9664224664224664,
        "recall_micro": 0.9664224664224664,
        "f1_micro": 0.9664224664224664,
        "accuracy": 0.9664224664224664,
        "hamming_loss": 0.033577533577533576,
        "no_defect_precision": 0.9661016949152542,
        "no_defect_recall": 0.9672727272727273,
        "no_defect_f1": 0.966686856450636,
        "no_defect_tp": 1596,
        "no_defect_fp": 56,
        "no_defect_tn": 1570,
        "no_defect_fn": 54,
        "no_defect_support": 1650,
        "defect_precision": 0.9667487684729064,
        "defect_recall": 0.965559655596556,
        "defect_f1": 0.9661538461538461,
        "defect_tp": 1570,
        "defect_fp": 54,
        "defect_tn": 1596,
        "defect_fn": 56,
        "defect_support": 1626
      }
    ]
  }
}