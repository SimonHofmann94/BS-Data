{
  "experiment_name": "experiment_grid_lr0.01_wd0.001_s150_20251207_135329",
  "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s150_20251207_135329",
  "timestamp": "2025-12-07T13:55:22.626925",
  "model": "ConvNextTiny",
  "loss": "CrossEntropyLossWrapper",
  "loss_params": {
    "weight": null,
    "reduction": "mean"
  },
  "best_epoch": 14,
  "split_info": {
    "train": {
      "total_samples": 15284,
      "class_counts": {
        "no_defect": 7734,
        "defect": 7550
      }
    },
    "val": {
      "total_samples": 3275,
      "class_counts": {
        "no_defect": 1691,
        "defect": 1584
      }
    },
    "test": {
      "total_samples": 3276,
      "class_counts": {
        "no_defect": 1650,
        "defect": 1626
      }
    },
    "total": {
      "total_samples": 21835,
      "class_counts": {
        "no_defect": 11075,
        "defect": 10760
      }
    }
  },
  "config": {
    "model": {
      "name": "convnext_tiny",
      "num_classes": 2,
      "pretrained": true,
      "cbam_stages": [
        3,
        4
      ]
    },
    "loss": {
      "type": "cross_entropy",
      "weight": null,
      "reduction": "mean"
    },
    "data": {
      "img_dir": "data/images",
      "ann_dir": "data/annotations",
      "splits_dir": "data/splits",
      "batch_size": 64,
      "num_workers": 8,
      "pin_memory": false,
      "image_size": [
        150,
        150
      ],
      "num_classes": 2,
      "class_names": [
        "no_defect",
        "defect"
      ],
      "split_strategy": "stratified_70_15_15",
      "use_saved_splits": true
    },
    "augmentation": {
      "horizontal_flip": 0.5,
      "vertical_flip": 0.3,
      "rotation": 10,
      "brightness_contrast": {
        "brightness": 0.2,
        "contrast": 0.2
      },
      "defect_blackout": {
        "enabled": false
      }
    },
    "training": {
      "num_epochs": 15,
      "learning_rate": 0.01,
      "weight_decay": 0.001,
      "warmup_epochs": 2,
      "log_interval": 5,
      "threshold": 0.5,
      "save_checkpoints": false,
      "freeze_backbone": true,
      "freeze_early_stages": null
    },
    "optimizer": {
      "type": "adamw",
      "lr": 0.01,
      "weight_decay": 0.001,
      "betas": [
        0.9,
        0.999
      ]
    },
    "scheduler": {
      "type": "cosine",
      "warmup_epochs": 3
    },
    "experiment": {
      "name": "grid_lr0.01_wd0.001_s150",
      "seed": 150,
      "save_dir": "code/experiments/results",
      "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s150_20251207_135329"
    }
  },
  "device": "cuda",
  "num_model_parameters": 28590666,
  "num_trainable_parameters": 772074,
  "best_val_metrics": {
    "precision_macro": 0.9657829181361791,
    "recall_macro": 0.9657450092288945,
    "f1_macro": 0.9657636023410676,
    "precision_micro": 0.9658015267175573,
    "recall_micro": 0.9658015267175573,
    "f1_micro": 0.9658015267175573,
    "accuracy": 0.9658015267175573,
    "hamming_loss": 0.03419847328244275,
    "no_defect_precision": 0.9663319551092735,
    "no_defect_recall": 0.9674748669426375,
    "no_defect_f1": 0.966903073286052,
    "no_defect_tp": 1636,
    "no_defect_fp": 57,
    "no_defect_tn": 1527,
    "no_defect_fn": 55,
    "no_defect_support": 1691,
    "defect_precision": 0.9652338811630847,
    "defect_recall": 0.9640151515151515,
    "defect_f1": 0.9646241313960834,
    "defect_tp": 1527,
    "defect_fp": 55,
    "defect_tn": 1636,
    "defect_fn": 57,
    "defect_support": 1584
  },
  "test_metrics": {
    "precision_macro": 0.9688808373590982,
    "recall_macro": 0.968849379402885,
    "f1_macro": 0.9688618576206595,
    "precision_micro": 0.9688644688644689,
    "recall_micro": 0.9688644688644689,
    "f1_micro": 0.9688644688644689,
    "accuracy": 0.9688644688644689,
    "hamming_loss": 0.031135531135531136,
    "no_defect_precision": 0.967391304347826,
    "no_defect_recall": 0.9709090909090909,
    "no_defect_f1": 0.969147005444646,
    "no_defect_tp": 1602,
    "no_defect_fp": 54,
    "no_defect_tn": 1572,
    "no_defect_fn": 48,
    "no_defect_support": 1650,
    "defect_precision": 0.9703703703703703,
    "defect_recall": 0.966789667896679,
    "defect_f1": 0.9685767097966729,
    "defect_tp": 1572,
    "defect_fp": 48,
    "defect_tn": 1602,
    "defect_fn": 54,
    "defect_support": 1626
  },
  "training_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15
    ],
    "train_loss": [
      0.390245316729386,
      0.22015195922871514,
      0.18170479819116234,
      0.18098419792482542,
      0.1876907410045548,
      0.18466917224321905,
      0.18811683719938768,
      0.18086227595369686,
      0.17687400357182056,
      0.17087023984251162,
      0.16605701113595125,
      0.17486604937512007,
      0.17204961370848212,
      0.168389381256313,
      0.16357198631133743
    ],
    "val_loss": [
      0.2895608724882969,
      0.15384001112901247,
      0.11729423049837351,
      0.10570229632923236,
      0.10364202341924493,
      0.10426944565887634,
      0.10642524593724655,
      0.09723959673339358,
      0.09749709037490763,
      0.09794901805714919,
      0.09609617830182497,
      0.09689646110368463,
      0.09682691057857412,
      0.09573882746581848,
      0.09614070053570546
    ]
  },
  "metrics_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15
    ],
    "train_metrics": [
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null
    ],
    "val_metrics": [
      {
        "precision_macro": 0.9180676911728363,
        "recall_macro": 0.9181004680154592,
        "f1_macro": 0.9180837362104045,
        "precision_micro": 0.9181679389312977,
        "recall_micro": 0.9181679389312977,
        "f1_micro": 0.9181679389312977,
        "accuracy": 0.9181679389312977,
        "hamming_loss": 0.08183206106870229,
        "no_defect_precision": 0.9212551805802249,
        "no_defect_recall": 0.9201655824955648,
        "no_defect_f1": 0.9207100591715977,
        "no_defect_tp": 1556,
        "no_defect_fp": 133,
        "no_defect_tn": 1451,
        "no_defect_fn": 135,
        "no_defect_support": 1691,
        "defect_precision": 0.9148802017654477,
        "defect_recall": 0.9160353535353535,
        "defect_f1": 0.9154574132492114,
        "defect_tp": 1451,
        "defect_fp": 135,
        "defect_tn": 1556,
        "defect_fn": 133,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9540845288952642,
        "recall_macro": 0.9545290277105771,
        "f1_macro": 0.9541781334041733,
        "precision_micro": 0.9541984732824428,
        "recall_micro": 0.9541984732824428,
        "f1_micro": 0.9541984732824428,
        "accuracy": 0.9541984732824428,
        "hamming_loss": 0.04580152671755725,
        "no_defect_precision": 0.9661222020568663,
        "no_defect_recall": 0.9444115907746895,
        "no_defect_f1": 0.9551435406698564,
        "no_defect_tp": 1597,
        "no_defect_fp": 56,
        "no_defect_tn": 1528,
        "no_defect_fn": 94,
        "no_defect_support": 1691,
        "defect_precision": 0.9420468557336621,
        "defect_recall": 0.9646464646464646,
        "defect_f1": 0.9532127261384903,
        "defect_tp": 1528,
        "defect_fp": 94,
        "defect_tn": 1597,
        "defect_fn": 56,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9589739034765259,
        "recall_macro": 0.9591401149281102,
        "f1_macro": 0.9590480445709568,
        "precision_micro": 0.9590839694656489,
        "recall_micro": 0.9590839694656489,
        "f1_micro": 0.9590839694656489,
        "accuracy": 0.9590839694656489,
        "hamming_loss": 0.040916030534351146,
        "no_defect_precision": 0.9631171921475312,
        "no_defect_recall": 0.9574216439976345,
        "no_defect_f1": 0.9602609727164887,
        "no_defect_tp": 1619,
        "no_defect_fp": 62,
        "no_defect_tn": 1522,
        "no_defect_fn": 72,
        "no_defect_support": 1691,
        "defect_precision": 0.9548306148055207,
        "defect_recall": 0.9608585858585859,
        "defect_f1": 0.9578351164254248,
        "defect_tp": 1522,
        "defect_fp": 72,
        "defect_tn": 1619,
        "defect_fn": 62,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9613821638657343,
        "recall_macro": 0.9617252880669498,
        "f1_macro": 0.9615019905332121,
        "precision_micro": 0.9615267175572519,
        "recall_micro": 0.9615267175572519,
        "f1_micro": 0.9615267175572519,
        "accuracy": 0.9615267175572519,
        "hamming_loss": 0.03847328244274809,
        "no_defect_precision": 0.9694061187762447,
        "no_defect_recall": 0.9556475458308693,
        "no_defect_f1": 0.9624776652769506,
        "no_defect_tp": 1616,
        "no_defect_fp": 51,
        "no_defect_tn": 1533,
        "no_defect_fn": 75,
        "no_defect_support": 1691,
        "defect_precision": 0.9533582089552238,
        "defect_recall": 0.9678030303030303,
        "defect_f1": 0.9605263157894737,
        "defect_tp": 1533,
        "defect_fp": 75,
        "defect_tn": 1616,
        "defect_fn": 51,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.965096016326433,
        "recall_macro": 0.9652335373247556,
        "f1_macro": 0.9651590022381853,
        "precision_micro": 0.9651908396946565,
        "recall_micro": 0.9651908396946565,
        "f1_micro": 0.9651908396946565,
        "accuracy": 0.9651908396946565,
        "hamming_loss": 0.03480916030534351,
        "no_defect_precision": 0.9685086155674391,
        "no_defect_recall": 0.9639266706091071,
        "no_defect_f1": 0.966212211025489,
        "no_defect_tp": 1630,
        "no_defect_fp": 53,
        "no_defect_tn": 1531,
        "no_defect_fn": 61,
        "no_defect_support": 1691,
        "defect_precision": 0.9616834170854272,
        "defect_recall": 0.9665404040404041,
        "defect_f1": 0.9641057934508817,
        "defect_tp": 1531,
        "defect_fp": 61,
        "defect_tn": 1630,
        "defect_fn": 53,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9620877489766448,
        "recall_macro": 0.9625763101147489,
        "f1_macro": 0.9621251122909746,
        "precision_micro": 0.9621374045801526,
        "recall_micro": 0.9621374045801526,
        "f1_micro": 0.9621374045801526,
        "accuracy": 0.9621374045801526,
        "hamming_loss": 0.03786259541984733,
        "no_defect_precision": 0.9768715763846622,
        "no_defect_recall": 0.9491425192193969,
        "no_defect_f1": 0.9628074385122976,
        "no_defect_tp": 1605,
        "no_defect_fp": 38,
        "no_defect_tn": 1546,
        "no_defect_fn": 86,
        "no_defect_support": 1691,
        "defect_precision": 0.9473039215686274,
        "defect_recall": 0.976010101010101,
        "defect_f1": 0.9614427860696517,
        "defect_tp": 1546,
        "defect_fp": 86,
        "defect_tn": 1605,
        "defect_fn": 38,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9604928362401879,
        "recall_macro": 0.960938106672879,
        "f1_macro": 0.960592683797038,
        "precision_micro": 0.9606106870229008,
        "recall_micro": 0.9606106870229008,
        "f1_micro": 0.9606106870229008,
        "accuracy": 0.9606106870229008,
        "hamming_loss": 0.03938931297709924,
        "no_defect_precision": 0.9721886336154776,
        "no_defect_recall": 0.9509166173861621,
        "no_defect_f1": 0.9614349775784753,
        "no_defect_tp": 1608,
        "no_defect_fp": 46,
        "no_defect_tn": 1538,
        "no_defect_fn": 83,
        "no_defect_support": 1691,
        "defect_precision": 0.9487970388648982,
        "defect_recall": 0.9709595959595959,
        "defect_f1": 0.9597503900156006,
        "defect_tp": 1538,
        "defect_fp": 83,
        "defect_tn": 1608,
        "defect_fn": 46,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9653559414593968,
        "recall_macro": 0.9657489292690358,
        "f1_macro": 0.9654766001641302,
        "precision_micro": 0.9654961832061069,
        "recall_micro": 0.9654961832061069,
        "f1_micro": 0.9654961832061069,
        "accuracy": 0.9654961832061069,
        "hamming_loss": 0.03450381679389313,
        "no_defect_precision": 0.9747292418772563,
        "no_defect_recall": 0.9580130100532229,
        "no_defect_f1": 0.9662988368625112,
        "no_defect_tp": 1620,
        "no_defect_fp": 42,
        "no_defect_tn": 1542,
        "no_defect_fn": 71,
        "no_defect_support": 1691,
        "defect_precision": 0.9559826410415375,
        "defect_recall": 0.9734848484848485,
        "defect_f1": 0.9646543634657492,
        "defect_tp": 1542,
        "defect_fp": 71,
        "defect_tn": 1620,
        "defect_fn": 42,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.964696378205727,
        "recall_macro": 0.9644024888148188,
        "f1_macro": 0.9645317367666686,
        "precision_micro": 0.9645801526717557,
        "recall_micro": 0.9645801526717557,
        "f1_micro": 0.9645801526717557,
        "accuracy": 0.9645801526717557,
        "hamming_loss": 0.035419847328244276,
        "no_defect_precision": 0.9618768328445748,
        "no_defect_recall": 0.9698403311649911,
        "no_defect_f1": 0.9658421672555948,
        "no_defect_tp": 1640,
        "no_defect_fp": 65,
        "no_defect_tn": 1519,
        "no_defect_fn": 51,
        "no_defect_support": 1691,
        "defect_precision": 0.967515923566879,
        "defect_recall": 0.9589646464646465,
        "defect_f1": 0.9632213062777425,
        "defect_tp": 1519,
        "defect_fp": 51,
        "defect_tn": 1640,
        "defect_fn": 65,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9635911045533403,
        "recall_macro": 0.9630999154764678,
        "f1_macro": 0.9633018407721965,
        "precision_micro": 0.9633587786259542,
        "recall_micro": 0.9633587786259542,
        "f1_micro": 0.9633587786259542,
        "accuracy": 0.9633587786259542,
        "hamming_loss": 0.0366412213740458,
        "no_defect_precision": 0.9585522475189726,
        "no_defect_recall": 0.9710230632761679,
        "no_defect_f1": 0.9647473560517039,
        "no_defect_tp": 1642,
        "no_defect_fp": 71,
        "no_defect_tn": 1513,
        "no_defect_fn": 49,
        "no_defect_support": 1691,
        "defect_precision": 0.9686299615877081,
        "defect_recall": 0.9551767676767676,
        "defect_f1": 0.9618563254926892,
        "defect_tp": 1513,
        "defect_fp": 49,
        "defect_tn": 1642,
        "defect_fn": 71,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9636169339032722,
        "recall_macro": 0.9636352809586104,
        "f1_macro": 0.9636260173118598,
        "precision_micro": 0.9636641221374046,
        "recall_micro": 0.9636641221374046,
        "f1_micro": 0.9636641221374046,
        "accuracy": 0.9636641221374046,
        "hamming_loss": 0.03633587786259542,
        "no_defect_precision": 0.9650887573964497,
        "no_defect_recall": 0.9645180366646955,
        "no_defect_f1": 0.9648033126293996,
        "no_defect_tp": 1631,
        "no_defect_fp": 59,
        "no_defect_tn": 1525,
        "no_defect_fn": 60,
        "no_defect_support": 1691,
        "defect_precision": 0.9621451104100947,
        "defect_recall": 0.9627525252525253,
        "defect_f1": 0.96244872199432,
        "defect_tp": 1525,
        "defect_fp": 60,
        "defect_tn": 1631,
        "defect_fn": 59,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9637011272807019,
        "recall_macro": 0.9625845235321876,
        "f1_macro": 0.9629757664233577,
        "precision_micro": 0.9630534351145038,
        "recall_micro": 0.9630534351145038,
        "f1_micro": 0.9630534351145038,
        "accuracy": 0.9630534351145038,
        "hamming_loss": 0.036946564885496185,
        "no_defect_precision": 0.9527104959630911,
        "no_defect_recall": 0.976936723832052,
        "no_defect_f1": 0.9646715328467154,
        "no_defect_tp": 1652,
        "no_defect_fp": 82,
        "no_defect_tn": 1502,
        "no_defect_fn": 39,
        "no_defect_support": 1691,
        "defect_precision": 0.9746917585983128,
        "defect_recall": 0.9482323232323232,
        "defect_f1": 0.96128,
        "defect_tp": 1502,
        "defect_fp": 39,
        "defect_tn": 1652,
        "defect_fn": 82,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9647964127194089,
        "recall_macro": 0.964917880759099,
        "f1_macro": 0.9648527267424906,
        "precision_micro": 0.9648854961832061,
        "recall_micro": 0.9648854961832061,
        "f1_micro": 0.9648854961832061,
        "accuracy": 0.9648854961832061,
        "hamming_loss": 0.035114503816793895,
        "no_defect_precision": 0.9679334916864608,
        "no_defect_recall": 0.9639266706091071,
        "no_defect_f1": 0.965925925925926,
        "no_defect_tp": 1630,
        "no_defect_fp": 54,
        "no_defect_tn": 1530,
        "no_defect_fn": 61,
        "no_defect_support": 1691,
        "defect_precision": 0.961659333752357,
        "defect_recall": 0.9659090909090909,
        "defect_f1": 0.9637795275590552,
        "defect_tp": 1530,
        "defect_fp": 61,
        "defect_tn": 1630,
        "defect_fn": 54,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9657829181361791,
        "recall_macro": 0.9657450092288945,
        "f1_macro": 0.9657636023410676,
        "precision_micro": 0.9658015267175573,
        "recall_micro": 0.9658015267175573,
        "f1_micro": 0.9658015267175573,
        "accuracy": 0.9658015267175573,
        "hamming_loss": 0.03419847328244275,
        "no_defect_precision": 0.9663319551092735,
        "no_defect_recall": 0.9674748669426375,
        "no_defect_f1": 0.966903073286052,
        "no_defect_tp": 1636,
        "no_defect_fp": 57,
        "no_defect_tn": 1527,
        "no_defect_fn": 55,
        "no_defect_support": 1691,
        "defect_precision": 0.9652338811630847,
        "defect_recall": 0.9640151515151515,
        "defect_f1": 0.9646241313960834,
        "defect_tp": 1527,
        "defect_fp": 55,
        "defect_tn": 1636,
        "defect_fn": 57,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9651536431733061,
        "recall_macro": 0.9651536431733061,
        "f1_macro": 0.9651536431733061,
        "precision_micro": 0.9651908396946565,
        "recall_micro": 0.9651908396946565,
        "f1_micro": 0.9651908396946565,
        "accuracy": 0.9651908396946565,
        "hamming_loss": 0.03480916030534351,
        "no_defect_precision": 0.9662921348314607,
        "no_defect_recall": 0.9662921348314607,
        "no_defect_f1": 0.9662921348314607,
        "no_defect_tp": 1634,
        "no_defect_fp": 57,
        "no_defect_tn": 1527,
        "no_defect_fn": 57,
        "no_defect_support": 1691,
        "defect_precision": 0.9640151515151515,
        "defect_recall": 0.9640151515151515,
        "defect_f1": 0.9640151515151515,
        "defect_tp": 1527,
        "defect_fp": 57,
        "defect_tn": 1634,
        "defect_fn": 57,
        "defect_support": 1584
      }
    ],
    "test_metrics": [
      {
        "precision_macro": 0.9688808373590982,
        "recall_macro": 0.968849379402885,
        "f1_macro": 0.9688618576206595,
        "precision_micro": 0.9688644688644689,
        "recall_micro": 0.9688644688644689,
        "f1_micro": 0.9688644688644689,
        "accuracy": 0.9688644688644689,
        "hamming_loss": 0.031135531135531136,
        "no_defect_precision": 0.967391304347826,
        "no_defect_recall": 0.9709090909090909,
        "no_defect_f1": 0.969147005444646,
        "no_defect_tp": 1602,
        "no_defect_fp": 54,
        "no_defect_tn": 1572,
        "no_defect_fn": 48,
        "no_defect_support": 1650,
        "defect_precision": 0.9703703703703703,
        "defect_recall": 0.966789667896679,
        "defect_f1": 0.9685767097966729,
        "defect_tp": 1572,
        "defect_fp": 48,
        "defect_tn": 1602,
        "defect_fn": 54,
        "defect_support": 1626
      }
    ]
  }
}