{
  "experiment_name": "experiment_grid_lr0.01_wd0.01_s46_20251129_050429",
  "experiment_dir": "/Users/ema/projects/DL4SE-project-UPM/code/experiments/results/experiment_grid_lr0.01_wd0.01_s46_20251129_050429",
  "timestamp": "2025-11-29T05:34:49.341180",
  "model": "ConvNextTiny",
  "loss": "CrossEntropyLossWrapper",
  "loss_params": {
    "weight": null,
    "reduction": "mean"
  },
  "best_epoch": 9,
  "split_info": {
    "train": {
      "total_samples": 15283,
      "class_counts": {
        "no_defect": 7752,
        "defect": 7531
      }
    },
    "val": {
      "total_samples": 3275,
      "class_counts": {
        "no_defect": 1661,
        "defect": 1614
      }
    },
    "test": {
      "total_samples": 3277,
      "class_counts": {
        "no_defect": 1662,
        "defect": 1615
      }
    },
    "total": {
      "total_samples": 21835,
      "class_counts": {
        "no_defect": 11075,
        "defect": 10760
      }
    }
  },
  "config": {
    "model": {
      "name": "convnext_tiny",
      "num_classes": 2,
      "pretrained": true,
      "cbam_stages": [
        3,
        4
      ]
    },
    "loss": {
      "type": "cross_entropy",
      "weight": null,
      "reduction": "mean"
    },
    "data": {
      "img_dir": "data/images",
      "ann_dir": "data/annotations",
      "splits_dir": "data/splits",
      "batch_size": 64,
      "num_workers": 0,
      "pin_memory": false,
      "image_size": [
        150,
        150
      ],
      "num_classes": 2,
      "class_names": [
        "no_defect",
        "defect"
      ],
      "split_strategy": "stratified_70_15_15",
      "use_saved_splits": true
    },
    "augmentation": {
      "horizontal_flip": 0.5,
      "vertical_flip": 0.3,
      "rotation": 10,
      "brightness_contrast": {
        "brightness": 0.2,
        "contrast": 0.2
      },
      "defect_blackout": {
        "enabled": false
      }
    },
    "training": {
      "num_epochs": 50,
      "learning_rate": 0.01,
      "weight_decay": 0.01,
      "warmup_epochs": 2,
      "early_stopping_patience": 5,
      "early_stopping_metric": "f1_macro",
      "log_interval": 5,
      "threshold": 0.5,
      "save_checkpoints": false,
      "freeze_backbone": true,
      "freeze_early_stages": null
    },
    "optimizer": {
      "type": "adamw",
      "lr": 0.01,
      "weight_decay": 0.01,
      "betas": [
        0.9,
        0.999
      ]
    },
    "scheduler": {
      "type": "cosine",
      "warmup_epochs": 3
    },
    "experiment": {
      "name": "grid_lr0.01_wd0.01_s46",
      "seed": 46,
      "save_dir": "code/experiments/results",
      "output_dir": "/Users/ema/projects/DL4SE-project-UPM/code/experiments/results/experiment_grid_lr0.01_wd0.01_s46_20251129_050429"
    }
  },
  "device": "mps",
  "num_model_parameters": 28590666,
  "num_trainable_parameters": 772074,
  "best_val_metrics": {
    "precision_macro": 0.9613315136398576,
    "recall_macro": 0.9607326620547034,
    "f1_macro": 0.9608884297674877,
    "precision_micro": 0.9609160305343512,
    "recall_micro": 0.9609160305343512,
    "f1_micro": 0.9609160305343512,
    "accuracy": 0.9609160305343512,
    "hamming_loss": 0.039083969465648856,
    "no_defect_precision": 0.9506172839506173,
    "no_defect_recall": 0.9735099337748344,
    "no_defect_f1": 0.9619274241522903,
    "no_defect_tp": 1617,
    "no_defect_fp": 84,
    "no_defect_tn": 1530,
    "no_defect_fn": 44,
    "no_defect_support": 1661,
    "defect_precision": 0.9720457433290979,
    "defect_recall": 0.9479553903345725,
    "defect_f1": 0.9598494353826851,
    "defect_tp": 1530,
    "defect_fp": 44,
    "defect_tn": 1617,
    "defect_fn": 84,
    "defect_support": 1614
  },
  "test_metrics": {
    "precision_macro": 0.9592782408029753,
    "recall_macro": 0.9582361882621184,
    "f1_macro": 0.9584559752953661,
    "precision_micro": 0.9584986267927983,
    "recall_micro": 0.9584986267927983,
    "f1_micro": 0.9584986267927983,
    "accuracy": 0.9584986267927983,
    "hamming_loss": 0.04150137320720171,
    "no_defect_precision": 0.9436046511627907,
    "no_defect_recall": 0.9765342960288809,
    "no_defect_f1": 0.9597871082199881,
    "no_defect_tp": 1623,
    "no_defect_fp": 97,
    "no_defect_tn": 1518,
    "no_defect_fn": 39,
    "no_defect_support": 1662,
    "defect_precision": 0.9749518304431599,
    "defect_recall": 0.939938080495356,
    "defect_f1": 0.957124842370744,
    "defect_tp": 1518,
    "defect_fp": 39,
    "defect_tn": 1623,
    "defect_fn": 97,
    "defect_support": 1615
  },
  "training_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14
    ],
    "train_loss": [
      0.3916043317467598,
      0.21578397517673142,
      0.1946468863901234,
      0.1862643151290746,
      0.1809965717181501,
      0.17872863997038937,
      0.1831596265371624,
      0.18232118168448305,
      0.18381670531992134,
      0.1776257152805518,
      0.18246446224124363,
      0.17259662225842476,
      0.1813025356087226,
      0.1886991718822942
    ],
    "val_loss": [
      0.2909489603569874,
      0.1639991637605887,
      0.1345776885461349,
      0.12308987896316327,
      0.12897624247349226,
      0.11627288463597114,
      0.1256688066686575,
      0.11357144638895988,
      0.10792173101351811,
      0.11446631642488334,
      0.11322704444711025,
      0.12488399675259224,
      0.12106439922578059,
      0.10991512984037399
    ]
  },
  "metrics_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14
    ],
    "train_metrics": [
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null
    ],
    "val_metrics": [
      {
        "precision_macro": 0.9210517967008605,
        "recall_macro": 0.9207989319821221,
        "f1_macro": 0.9208798845227352,
        "precision_micro": 0.9209160305343511,
        "recall_micro": 0.9209160305343511,
        "f1_micro": 0.9209160305343511,
        "accuracy": 0.9209160305343511,
        "hamming_loss": 0.07908396946564886,
        "no_defect_precision": 0.916270783847981,
        "no_defect_recall": 0.9289584587597832,
        "no_defect_f1": 0.9225710014947683,
        "no_defect_tp": 1543,
        "no_defect_fp": 141,
        "no_defect_tn": 1473,
        "no_defect_fn": 118,
        "no_defect_support": 1661,
        "defect_precision": 0.9258328095537398,
        "defect_recall": 0.912639405204461,
        "defect_f1": 0.919188767550702,
        "defect_tp": 1473,
        "defect_fp": 118,
        "defect_tn": 1543,
        "defect_fn": 141,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9481560409592973,
        "recall_macro": 0.9482299297164263,
        "f1_macro": 0.9480907851377135,
        "precision_micro": 0.9480916030534351,
        "recall_micro": 0.9480916030534351,
        "f1_micro": 0.9480916030534351,
        "accuracy": 0.9480916030534351,
        "hamming_loss": 0.051908396946564885,
        "no_defect_precision": 0.9582052858020897,
        "no_defect_recall": 0.938591210114389,
        "no_defect_f1": 0.9482968369829684,
        "no_defect_tp": 1559,
        "no_defect_fp": 68,
        "no_defect_tn": 1546,
        "no_defect_fn": 102,
        "no_defect_support": 1661,
        "defect_precision": 0.9381067961165048,
        "defect_recall": 0.9578686493184635,
        "defect_f1": 0.9478847332924586,
        "defect_tp": 1546,
        "defect_fp": 102,
        "defect_tn": 1559,
        "defect_fn": 68,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9532893961521651,
        "recall_macro": 0.9533823923272211,
        "f1_macro": 0.9532803344963017,
        "precision_micro": 0.9532824427480916,
        "recall_micro": 0.9532824427480916,
        "f1_micro": 0.9532824427480916,
        "accuracy": 0.9532824427480916,
        "hamming_loss": 0.0467175572519084,
        "no_defect_precision": 0.960880195599022,
        "no_defect_recall": 0.946417820590006,
        "no_defect_f1": 0.9535941765241128,
        "no_defect_tp": 1572,
        "no_defect_fp": 64,
        "no_defect_tn": 1550,
        "no_defect_fn": 89,
        "no_defect_support": 1661,
        "defect_precision": 0.9456985967053081,
        "defect_recall": 0.9603469640644362,
        "defect_f1": 0.9529664924684906,
        "defect_tp": 1550,
        "defect_fp": 89,
        "defect_tn": 1572,
        "defect_fn": 64,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9549610425866708,
        "recall_macro": 0.9547034265946598,
        "f1_macro": 0.9547890916254511,
        "precision_micro": 0.9548091603053435,
        "recall_micro": 0.9548091603053435,
        "f1_micro": 0.9548091603053435,
        "accuracy": 0.9548091603053435,
        "hamming_loss": 0.04519083969465649,
        "no_defect_precision": 0.9494949494949495,
        "no_defect_recall": 0.9620710415412402,
        "no_defect_f1": 0.9557416267942583,
        "no_defect_tp": 1598,
        "no_defect_fp": 85,
        "no_defect_tn": 1529,
        "no_defect_fn": 63,
        "no_defect_support": 1661,
        "defect_precision": 0.960427135678392,
        "defect_recall": 0.9473358116480793,
        "defect_f1": 0.9538365564566438,
        "defect_tp": 1529,
        "defect_fp": 63,
        "defect_tn": 1598,
        "defect_fn": 85,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9524385797033736,
        "recall_macro": 0.950793105480567,
        "f1_macro": 0.9510737628384687,
        "precision_micro": 0.9511450381679389,
        "recall_micro": 0.9511450381679389,
        "f1_micro": 0.9511450381679389,
        "accuracy": 0.9511450381679389,
        "hamming_loss": 0.04885496183206107,
        "no_defect_precision": 0.9315698677400805,
        "no_defect_recall": 0.975316074653823,
        "no_defect_f1": 0.9529411764705882,
        "no_defect_tp": 1620,
        "no_defect_fp": 119,
        "no_defect_tn": 1495,
        "no_defect_fn": 41,
        "no_defect_support": 1661,
        "defect_precision": 0.9733072916666666,
        "defect_recall": 0.926270136307311,
        "defect_f1": 0.9492063492063492,
        "defect_tp": 1495,
        "defect_fp": 41,
        "defect_tn": 1620,
        "defect_fn": 119,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9551493614691698,
        "recall_macro": 0.9546420655507536,
        "f1_macro": 0.9547801158644079,
        "precision_micro": 0.9548091603053435,
        "recall_micro": 0.9548091603053435,
        "f1_micro": 0.9548091603053435,
        "accuracy": 0.9548091603053435,
        "hamming_loss": 0.04519083969465649,
        "no_defect_precision": 0.9457866823806718,
        "no_defect_recall": 0.9662853702588802,
        "no_defect_f1": 0.9559261465157832,
        "no_defect_tp": 1605,
        "no_defect_fp": 92,
        "no_defect_tn": 1522,
        "no_defect_fn": 56,
        "no_defect_support": 1661,
        "defect_precision": 0.9645120405576679,
        "defect_recall": 0.942998760842627,
        "defect_f1": 0.9536340852130326,
        "defect_tp": 1522,
        "defect_fp": 56,
        "defect_tn": 1605,
        "defect_fn": 92,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9498936033688785,
        "recall_macro": 0.9498402374765653,
        "f1_macro": 0.9496181515066445,
        "precision_micro": 0.9496183206106871,
        "recall_micro": 0.9496183206106871,
        "f1_micro": 0.9496183206106871,
        "accuracy": 0.9496183206106871,
        "hamming_loss": 0.050381679389312976,
        "no_defect_precision": 0.9651741293532339,
        "no_defect_recall": 0.9343768813967489,
        "no_defect_f1": 0.9495258488834506,
        "no_defect_tp": 1552,
        "no_defect_fp": 56,
        "no_defect_tn": 1558,
        "no_defect_fn": 109,
        "no_defect_support": 1661,
        "defect_precision": 0.9346130773845231,
        "defect_recall": 0.9653035935563816,
        "defect_f1": 0.9497104541298385,
        "defect_tp": 1558,
        "defect_fp": 109,
        "defect_tn": 1552,
        "defect_fn": 56,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9597852474323063,
        "recall_macro": 0.959210012928716,
        "f1_macro": 0.9593612900041601,
        "precision_micro": 0.9593893129770993,
        "recall_micro": 0.9593893129770993,
        "f1_micro": 0.9593893129770993,
        "accuracy": 0.9593893129770993,
        "hamming_loss": 0.040610687022900764,
        "no_defect_precision": 0.9494117647058824,
        "no_defect_recall": 0.9717037928958459,
        "no_defect_f1": 0.9604284439155013,
        "no_defect_tp": 1614,
        "no_defect_fp": 86,
        "no_defect_tn": 1528,
        "no_defect_fn": 47,
        "no_defect_support": 1661,
        "defect_precision": 0.9701587301587301,
        "defect_recall": 0.9467162329615861,
        "defect_f1": 0.9582941360928191,
        "defect_tp": 1528,
        "defect_fp": 47,
        "defect_tn": 1614,
        "defect_fn": 86,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9613315136398576,
        "recall_macro": 0.9607326620547034,
        "f1_macro": 0.9608884297674877,
        "precision_micro": 0.9609160305343512,
        "recall_micro": 0.9609160305343512,
        "f1_micro": 0.9609160305343512,
        "accuracy": 0.9609160305343512,
        "hamming_loss": 0.039083969465648856,
        "no_defect_precision": 0.9506172839506173,
        "no_defect_recall": 0.9735099337748344,
        "no_defect_f1": 0.9619274241522903,
        "no_defect_tp": 1617,
        "no_defect_fp": 84,
        "no_defect_tn": 1530,
        "no_defect_fn": 44,
        "no_defect_support": 1661,
        "defect_precision": 0.9720457433290979,
        "defect_recall": 0.9479553903345725,
        "defect_f1": 0.9598494353826851,
        "defect_tp": 1530,
        "defect_fp": 44,
        "defect_tn": 1617,
        "defect_fn": 84,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9591736694677871,
        "recall_macro": 0.958599200105638,
        "f1_macro": 0.95875018158317,
        "precision_micro": 0.9587786259541985,
        "recall_micro": 0.9587786259541985,
        "f1_micro": 0.9587786259541985,
        "accuracy": 0.9587786259541985,
        "hamming_loss": 0.04122137404580153,
        "no_defect_precision": 0.9488235294117647,
        "no_defect_recall": 0.971101745936183,
        "no_defect_f1": 0.9598333829217495,
        "no_defect_tp": 1613,
        "no_defect_fp": 87,
        "no_defect_tn": 1527,
        "no_defect_fn": 48,
        "no_defect_support": 1661,
        "defect_precision": 0.9695238095238096,
        "defect_recall": 0.9460966542750929,
        "defect_f1": 0.9576669802445907,
        "defect_tp": 1527,
        "defect_fp": 48,
        "defect_tn": 1613,
        "defect_fn": 87,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9597196995949191,
        "recall_macro": 0.9592275446555464,
        "f1_macro": 0.959363837766577,
        "precision_micro": 0.9593893129770993,
        "recall_micro": 0.9593893129770993,
        "f1_micro": 0.9593893129770993,
        "accuracy": 0.9593893129770993,
        "hamming_loss": 0.040610687022900764,
        "no_defect_precision": 0.9504716981132075,
        "no_defect_recall": 0.9704996989765202,
        "no_defect_f1": 0.9603812928209711,
        "no_defect_tp": 1612,
        "no_defect_fp": 84,
        "no_defect_tn": 1530,
        "no_defect_fn": 49,
        "no_defect_support": 1661,
        "defect_precision": 0.9689677010766308,
        "defect_recall": 0.9479553903345725,
        "defect_f1": 0.9583463827121829,
        "defect_tp": 1530,
        "defect_fp": 49,
        "defect_tn": 1612,
        "defect_fn": 84,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9556656947840808,
        "recall_macro": 0.9554076797915888,
        "f1_macro": 0.9551124782415448,
        "precision_micro": 0.9551145038167939,
        "recall_micro": 0.9551145038167939,
        "f1_micro": 0.9551145038167939,
        "accuracy": 0.9551145038167939,
        "hamming_loss": 0.04488549618320611,
        "no_defect_precision": 0.9755025125628141,
        "no_defect_recall": 0.9349789283564118,
        "no_defect_f1": 0.9548109437442361,
        "no_defect_tp": 1553,
        "no_defect_fp": 39,
        "no_defect_tn": 1575,
        "no_defect_fn": 108,
        "no_defect_support": 1661,
        "defect_precision": 0.9358288770053476,
        "defect_recall": 0.9758364312267658,
        "defect_f1": 0.9554140127388535,
        "defect_tp": 1575,
        "defect_fp": 108,
        "defect_tn": 1553,
        "defect_fn": 39,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.955840538761547,
        "recall_macro": 0.9556824056811748,
        "f1_macro": 0.9554189121151659,
        "precision_micro": 0.9554198473282443,
        "recall_micro": 0.9554198473282443,
        "f1_micro": 0.9554198473282443,
        "accuracy": 0.9554198473282443,
        "hamming_loss": 0.044580152671755725,
        "no_defect_precision": 0.9737335834896811,
        "no_defect_recall": 0.9373871161950632,
        "no_defect_f1": 0.9552147239263804,
        "no_defect_tp": 1557,
        "no_defect_fp": 42,
        "no_defect_tn": 1572,
        "no_defect_fn": 104,
        "no_defect_support": 1661,
        "defect_precision": 0.9379474940334129,
        "defect_recall": 0.9739776951672863,
        "defect_f1": 0.9556231003039514,
        "defect_tp": 1572,
        "defect_fp": 104,
        "defect_tn": 1557,
        "defect_fn": 42,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.959019970339525,
        "recall_macro": 0.9578919627849931,
        "f1_macro": 0.9581223974961268,
        "precision_micro": 0.9581679389312977,
        "recall_micro": 0.9581679389312977,
        "f1_micro": 0.9581679389312977,
        "accuracy": 0.9581679389312977,
        "hamming_loss": 0.04183206106870229,
        "no_defect_precision": 0.9425087108013938,
        "no_defect_recall": 0.9771222155328115,
        "no_defect_f1": 0.9595033993496896,
        "no_defect_tp": 1623,
        "no_defect_fp": 99,
        "no_defect_tn": 1515,
        "no_defect_fn": 38,
        "no_defect_support": 1661,
        "defect_precision": 0.9755312298776562,
        "defect_recall": 0.9386617100371747,
        "defect_f1": 0.9567413956425639,
        "defect_tp": 1515,
        "defect_fp": 38,
        "defect_tn": 1623,
        "defect_fn": 99,
        "defect_support": 1614
      }
    ],
    "test_metrics": [
      {
        "precision_macro": 0.9592782408029753,
        "recall_macro": 0.9582361882621184,
        "f1_macro": 0.9584559752953661,
        "precision_micro": 0.9584986267927983,
        "recall_micro": 0.9584986267927983,
        "f1_micro": 0.9584986267927983,
        "accuracy": 0.9584986267927983,
        "hamming_loss": 0.04150137320720171,
        "no_defect_precision": 0.9436046511627907,
        "no_defect_recall": 0.9765342960288809,
        "no_defect_f1": 0.9597871082199881,
        "no_defect_tp": 1623,
        "no_defect_fp": 97,
        "no_defect_tn": 1518,
        "no_defect_fn": 39,
        "no_defect_support": 1662,
        "defect_precision": 0.9749518304431599,
        "defect_recall": 0.939938080495356,
        "defect_f1": 0.957124842370744,
        "defect_tp": 1518,
        "defect_fp": 39,
        "defect_tn": 1623,
        "defect_fn": 97,
        "defect_support": 1615
      }
    ]
  }
}