2025-11-16 23:02:10,564 - __main__ - INFO - 
======================================================================
2025-11-16 23:02:10,564 - __main__ - INFO - SEVERSTAL DEFECT CLASSIFICATION - TRAINING PIPELINE
2025-11-16 23:02:10,564 - __main__ - INFO - ======================================================================
2025-11-16 23:02:10,564 - __main__ - INFO - 
Configuration:
2025-11-16 23:02:10,566 - __main__ - INFO - model:
  name: convnext_tiny
  num_classes: 2
  pretrained: true
  cbam_stages:
  - 3
  - 4
loss:
  type: cross_entropy
  weight: null
  reduction: mean
data:
  img_dir: data/images
  ann_dir: data/annotations
  splits_dir: data/splits
  batch_size: 32
  num_workers: 0
  pin_memory: false
  image_size:
  - 150
  - 150
  num_classes: 2
  class_names:
  - no_defect
  - defect
  split_strategy: stratified_70_15_15
  use_saved_splits: true
augmentation:
  horizontal_flip: 0.5
  vertical_flip: 0.5
  rotation: 15
  brightness_contrast:
    brightness: 0.3
    contrast: 0.3
  defect_blackout:
    enabled: false
training:
  num_epochs: 50
  learning_rate: 0.001
  weight_decay: 0.001
  warmup_epochs: 3
  early_stopping_patience: 8
  early_stopping_metric: f1_macro
  log_interval: 5
  threshold: 0.5
  freeze_backbone: true
  freeze_early_stages: null
optimizer:
  type: adamw
  lr: 0.001
  weight_decay: 0.0001
  betas:
  - 0.9
  - 0.999
scheduler:
  type: cosine
  warmup_epochs: 3
experiment:
  name: null
  seed: 42
  save_dir: code/experiments/results

2025-11-16 23:02:10,568 - __main__ - INFO - Random seed set to 42
2025-11-16 23:02:10,695 - __main__ - INFO - Using Apple Silicon GPU (MPS)
2025-11-16 23:02:10,695 - __main__ - INFO - 
============================================================
2025-11-16 23:02:10,695 - __main__ - INFO - Loading Data
2025-11-16 23:02:10,695 - __main__ - INFO - ============================================================
2025-11-16 23:02:10,695 - __main__ - INFO - Image directory: /Users/ema/projects/DL4SE-simon-convnext-cbam-run/data/images
2025-11-16 23:02:10,695 - __main__ - INFO - Annotation directory: /Users/ema/projects/DL4SE-simon-convnext-cbam-run/data/annotations
2025-11-16 23:02:10,715 - __main__ - INFO - Found 21835 images
2025-11-16 23:02:10,849 - core.data.dataset - INFO - Loaded 21835 samples from 21835 images
2025-11-16 23:02:10,857 - __main__ - INFO - Label matrix shape: (21835, 2)
2025-11-16 23:02:10,857 - __main__ - INFO - Using split strategy: stratified_70_15_15 (0.7, 0.15, 0.15)
2025-11-16 23:02:10,857 - __main__ - INFO - Attempting to load splits from /Users/ema/projects/DL4SE-simon-convnext-cbam-run/data/splits
2025-11-16 23:02:10,876 - core.data.splitting - INFO - Loaded splits from /Users/ema/projects/DL4SE-simon-convnext-cbam-run/data/splits
2025-11-16 23:02:10,876 - core.data.splitting - INFO -   train: 15283 images
2025-11-16 23:02:10,876 - core.data.splitting - INFO -   val: 3275 images
2025-11-16 23:02:10,876 - core.data.splitting - INFO -   test: 3277 images
2025-11-16 23:02:10,876 - __main__ - INFO - âœ… Using saved splits
2025-11-16 23:02:10,877 - core.augmentation.pipelines - INFO - Building augmentation pipeline...
2025-11-16 23:02:10,878 - core.augmentation.pipelines - INFO - Built augmentation pipeline with 7 transforms
2025-11-16 23:02:10,878 - core.augmentation.pipelines - INFO - Building augmentation pipeline...
2025-11-16 23:02:10,878 - core.augmentation.pipelines - INFO - Built augmentation pipeline with 3 transforms
2025-11-16 23:02:10,933 - core.data.dataset - INFO - Loaded 15283 samples from 15283 images
2025-11-16 23:02:10,945 - core.data.dataset - INFO - Loaded 3275 samples from 3275 images
2025-11-16 23:02:10,957 - core.data.dataset - INFO - Loaded 3277 samples from 3277 images
2025-11-16 23:02:10,957 - __main__ - INFO - Train set: 15283 samples
2025-11-16 23:02:10,957 - __main__ - INFO - Val set: 3275 samples
2025-11-16 23:02:10,957 - __main__ - INFO - Test set: 3277 samples
2025-11-16 23:02:10,958 - core.data.loaders - INFO - Created DataLoaders: train=478 batches, val=103 batches, test=103 batches
2025-11-16 23:02:10,962 - __main__ - INFO - 
============================================================
2025-11-16 23:02:10,962 - __main__ - INFO - Building Model
2025-11-16 23:02:10,962 - __main__ - INFO - ============================================================
2025-11-16 23:02:10,962 - core.models.registry - INFO - Registered model: convnext_tiny_cbam
2025-11-16 23:02:10,962 - core.models.registry - INFO - Registered model: convnext_tiny
2025-11-16 23:02:10,962 - core.models.registry - INFO - Registered model: resnet50
2025-11-16 23:02:10,962 - __main__ - INFO - Model: convnext_tiny
2025-11-16 23:02:10,962 - __main__ - INFO - Available models: ['convnext_tiny_cbam', 'convnext_tiny', 'resnet50']
2025-11-16 23:02:11,440 - core.models.registry - INFO - Instantiated model: convnext_tiny with kwargs: {'num_classes': 2, 'pretrained': True, 'cbam_stages': [3, 4]}
2025-11-16 23:02:11,440 - __main__ - INFO - Freezing backbone weights
2025-11-16 23:02:11,441 - __main__ - INFO - Total parameters: 28,590,666
2025-11-16 23:02:11,441 - __main__ - INFO - Trainable parameters: 772,074
2025-11-16 23:02:11,441 - __main__ - INFO - 
============================================================
2025-11-16 23:02:11,441 - __main__ - INFO - Building Loss Function
2025-11-16 23:02:11,441 - __main__ - INFO - ============================================================
2025-11-16 23:02:11,442 - core.losses.registry - INFO - Registered loss function: focal_loss
2025-11-16 23:02:11,442 - core.losses.registry - INFO - Registered loss function: bce_with_logits
2025-11-16 23:02:11,442 - core.losses.registry - INFO - Registered loss function: cross_entropy
2025-11-16 23:02:11,442 - __main__ - INFO - Loss: cross_entropy
2025-11-16 23:02:11,442 - __main__ - INFO - Available losses: ['focal_loss', 'bce_with_logits', 'cross_entropy']
2025-11-16 23:02:11,442 - core.losses.registry - INFO - Instantiated loss: cross_entropy
2025-11-16 23:02:11,442 - __main__ - INFO - Loss configuration: CrossEntropyLossWrapper(weight=None, reduction=mean)
2025-11-16 23:02:11,442 - __main__ - INFO - 
============================================================
2025-11-16 23:02:11,442 - __main__ - INFO - Building Optimizer
2025-11-16 23:02:11,442 - __main__ - INFO - ============================================================
2025-11-16 23:02:11,443 - __main__ - INFO - Optimizer: adamw
2025-11-16 23:02:11,443 - __main__ - INFO - Learning rate: 0.001
2025-11-16 23:02:11,443 - __main__ - INFO - Weight decay: 0.0001
2025-11-16 23:02:11,443 - __main__ - INFO - 
============================================================
2025-11-16 23:02:11,443 - __main__ - INFO - Initializing Trainer
2025-11-16 23:02:11,443 - __main__ - INFO - ============================================================
2025-11-16 23:02:11,761 - core.training.trainer - INFO - Trainer initialized. Experiment: experiment_20251116_230211
2025-11-16 23:02:11,761 - core.training.trainer - INFO - Model: ConvNextTiny
2025-11-16 23:02:11,761 - core.training.trainer - INFO - Loss: CrossEntropyLossWrapper
2025-11-16 23:02:11,761 - core.training.trainer - INFO - Device: mps
2025-11-16 23:02:11,761 - core.training.trainer - INFO - Starting training for 50 epochs...
2025-11-16 23:02:11,761 - core.training.trainer - INFO - Warmup: 3, Early stopping patience: 8
2025-11-16 23:02:11,761 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:02:11,761 - core.training.trainer - INFO - Epoch 1/50
2025-11-16 23:02:11,761 - core.training.trainer - INFO - ============================================================
2025-11-16 23:05:12,367 - core.training.trainer - INFO - Train Loss: 0.5746
2025-11-16 23:05:38,943 - core.training.trainer - INFO - Val Loss: 0.5225
2025-11-16 23:05:38,943 - core.training.trainer - INFO - Val F1 (macro): 0.8306 [threshold=0.5]
2025-11-16 23:05:38,943 - core.training.trainer - INFO - Precision (macro): 0.8545, Recall (macro): 0.8318
2025-11-16 23:05:38,944 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:05:38,944 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:05:38,944 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:05:38,944 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:05:38,944 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:05:38,944 - core.training.trainer - INFO - no_defect           0.7719     0.9536     0.8532       1661   1584    468   1146     77
2025-11-16 23:05:38,944 - core.training.trainer - INFO - defect              0.9370     0.7100     0.8079       1614   1146     77   1584    468
2025-11-16 23:05:38,944 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:05:38,944 - core.training.trainer - INFO - MACRO AVG           0.8545     0.8318     0.8306
2025-11-16 23:05:38,944 - core.training.trainer - INFO - MICRO AVG           0.8336     0.8336     0.8336
2025-11-16 23:05:38,944 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:05:38,944 - core.training.trainer - INFO - 
Epoch 1 Summary: Train Loss: 0.5746, Val Loss: 0.5225, F1 (macro): 0.8306
2025-11-16 23:05:39,396 - core.training.callbacks - INFO - Saved checkpoint: /Users/ema/projects/DL4SE-simon-convnext-cbam-run/code/experiments/results/experiment_20251116_230211/checkpoints/best_model_epoch1_val_f1_macro_0.8306.pt
2025-11-16 23:05:39,396 - core.training.callbacks - INFO - Epoch 1: val_f1_macro improved to 0.8306
2025-11-16 23:05:39,398 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:05:39,398 - core.training.trainer - INFO - Epoch 2/50
2025-11-16 23:05:39,398 - core.training.trainer - INFO - ============================================================
2025-11-16 23:07:38,182 - core.training.trainer - INFO - Train Loss: 0.3774
2025-11-16 23:08:01,485 - core.training.trainer - INFO - Val Loss: 0.3251
2025-11-16 23:08:01,485 - core.training.trainer - INFO - Val F1 (macro): 0.9048 [threshold=0.5]
2025-11-16 23:08:01,485 - core.training.trainer - INFO - Precision (macro): 0.9070, Recall (macro): 0.9046
2025-11-16 23:08:01,485 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:08:01,485 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:08:01,485 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:08:01,485 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:08:01,485 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:08:01,485 - core.training.trainer - INFO - no_defect           0.8822     0.9380     0.9093       1661   1558    208   1406    103
2025-11-16 23:08:01,485 - core.training.trainer - INFO - defect              0.9317     0.8711     0.9004       1614   1406    103   1558    208
2025-11-16 23:08:01,485 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:08:01,485 - core.training.trainer - INFO - MACRO AVG           0.9070     0.9046     0.9048
2025-11-16 23:08:01,485 - core.training.trainer - INFO - MICRO AVG           0.9050     0.9050     0.9050
2025-11-16 23:08:01,485 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:08:01,485 - core.training.trainer - INFO - 
Epoch 2 Summary: Train Loss: 0.3774, Val Loss: 0.3251, F1 (macro): 0.9048
2025-11-16 23:08:01,926 - core.training.callbacks - INFO - Saved checkpoint: /Users/ema/projects/DL4SE-simon-convnext-cbam-run/code/experiments/results/experiment_20251116_230211/checkpoints/best_model_epoch2_val_f1_macro_0.9048.pt
2025-11-16 23:08:01,926 - core.training.callbacks - INFO - Epoch 2: val_f1_macro improved to 0.9048
2025-11-16 23:08:01,927 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:08:01,927 - core.training.trainer - INFO - Epoch 3/50
2025-11-16 23:08:01,927 - core.training.trainer - INFO - ============================================================
2025-11-16 23:10:04,624 - core.training.trainer - INFO - Train Loss: 0.2746
2025-11-16 23:10:31,925 - core.training.trainer - INFO - Val Loss: 0.2406
2025-11-16 23:10:31,926 - core.training.trainer - INFO - Val F1 (macro): 0.9297 [threshold=0.5]
2025-11-16 23:10:31,926 - core.training.trainer - INFO - Precision (macro): 0.9310, Recall (macro): 0.9294
2025-11-16 23:10:31,926 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:10:31,926 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:10:31,926 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:10:31,926 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:10:31,926 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:10:31,927 - core.training.trainer - INFO - no_defect           0.9114     0.9542     0.9324       1661   1585    154   1460     76
2025-11-16 23:10:31,927 - core.training.trainer - INFO - defect              0.9505     0.9046     0.9270       1614   1460     76   1585    154
2025-11-16 23:10:31,929 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:10:31,929 - core.training.trainer - INFO - MACRO AVG           0.9310     0.9294     0.9297
2025-11-16 23:10:31,929 - core.training.trainer - INFO - MICRO AVG           0.9298     0.9298     0.9298
2025-11-16 23:10:31,929 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:10:31,929 - core.training.trainer - INFO - 
Epoch 3 Summary: Train Loss: 0.2746, Val Loss: 0.2406, F1 (macro): 0.9297
2025-11-16 23:10:32,383 - core.training.callbacks - INFO - Saved checkpoint: /Users/ema/projects/DL4SE-simon-convnext-cbam-run/code/experiments/results/experiment_20251116_230211/checkpoints/best_model_epoch3_val_f1_macro_0.9297.pt
2025-11-16 23:10:32,383 - core.training.callbacks - INFO - Epoch 3: val_f1_macro improved to 0.9297
2025-11-16 23:10:32,385 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:10:32,385 - core.training.trainer - INFO - Epoch 4/50
2025-11-16 23:10:32,385 - core.training.trainer - INFO - ============================================================
2025-11-16 23:12:52,554 - core.training.trainer - INFO - Train Loss: 0.2244
2025-11-16 23:13:25,730 - core.training.trainer - INFO - Val Loss: 0.1934
2025-11-16 23:13:25,731 - core.training.trainer - INFO - Val F1 (macro): 0.9420 [threshold=0.5]
2025-11-16 23:13:25,732 - core.training.trainer - INFO - Precision (macro): 0.9422, Recall (macro): 0.9418
2025-11-16 23:13:25,732 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:13:25,732 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:13:25,732 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:13:25,732 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:13:25,732 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:13:25,732 - core.training.trainer - INFO - no_defect           0.9344     0.9524     0.9434       1661   1582    111   1503     79
2025-11-16 23:13:25,732 - core.training.trainer - INFO - defect              0.9501     0.9312     0.9406       1614   1503     79   1582    111
2025-11-16 23:13:25,732 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:13:25,732 - core.training.trainer - INFO - MACRO AVG           0.9422     0.9418     0.9420
2025-11-16 23:13:25,732 - core.training.trainer - INFO - MICRO AVG           0.9420     0.9420     0.9420
2025-11-16 23:13:25,732 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:13:25,732 - core.training.trainer - INFO - 
Epoch 4 Summary: Train Loss: 0.2244, Val Loss: 0.1934, F1 (macro): 0.9420
2025-11-16 23:13:26,735 - core.training.callbacks - INFO - Saved checkpoint: /Users/ema/projects/DL4SE-simon-convnext-cbam-run/code/experiments/results/experiment_20251116_230211/checkpoints/best_model_epoch4_val_f1_macro_0.9420.pt
2025-11-16 23:13:26,735 - core.training.callbacks - INFO - Epoch 4: val_f1_macro improved to 0.9420
2025-11-16 23:13:26,737 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:13:26,737 - core.training.trainer - INFO - Epoch 5/50
2025-11-16 23:13:26,737 - core.training.trainer - INFO - ============================================================
2025-11-16 23:15:39,639 - core.training.trainer - INFO - Train Loss: 0.2014
2025-11-16 23:16:07,176 - core.training.trainer - INFO - Val Loss: 0.1721
2025-11-16 23:16:07,178 - core.training.trainer - INFO - Val F1 (macro): 0.9478 [threshold=0.5]
2025-11-16 23:16:07,178 - core.training.trainer - INFO - Precision (macro): 0.9478, Recall (macro): 0.9478
2025-11-16 23:16:07,178 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:16:07,178 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:16:07,178 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:16:07,178 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:16:07,178 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:16:07,178 - core.training.trainer - INFO - no_defect           0.9493     0.9476     0.9485       1661   1574     84   1530     87
2025-11-16 23:16:07,178 - core.training.trainer - INFO - defect              0.9462     0.9480     0.9471       1614   1530     87   1574     84
2025-11-16 23:16:07,182 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:16:07,182 - core.training.trainer - INFO - MACRO AVG           0.9478     0.9478     0.9478
2025-11-16 23:16:07,182 - core.training.trainer - INFO - MICRO AVG           0.9478     0.9478     0.9478
2025-11-16 23:16:07,182 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:16:07,182 - core.training.trainer - INFO - 
Epoch 5 Summary: Train Loss: 0.2014, Val Loss: 0.1721, F1 (macro): 0.9478
2025-11-16 23:16:07,427 - core.training.callbacks - INFO - Saved checkpoint: /Users/ema/projects/DL4SE-simon-convnext-cbam-run/code/experiments/results/experiment_20251116_230211/checkpoints/best_model_epoch5_val_f1_macro_0.9478.pt
2025-11-16 23:16:07,427 - core.training.callbacks - INFO - Epoch 5: val_f1_macro improved to 0.9478
2025-11-16 23:16:07,428 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:16:07,428 - core.training.trainer - INFO - Epoch 6/50
2025-11-16 23:16:07,428 - core.training.trainer - INFO - ============================================================
2025-11-16 23:18:21,256 - core.training.trainer - INFO - Train Loss: 0.1877
2025-11-16 23:18:45,758 - core.training.trainer - INFO - Val Loss: 0.1576
2025-11-16 23:18:45,758 - core.training.trainer - INFO - Val F1 (macro): 0.9499 [threshold=0.5]
2025-11-16 23:18:45,758 - core.training.trainer - INFO - Precision (macro): 0.9501, Recall (macro): 0.9498
2025-11-16 23:18:45,758 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:18:45,758 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:18:45,758 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:18:45,758 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:18:45,758 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:18:45,758 - core.training.trainer - INFO - no_defect           0.9447     0.9573     0.9510       1661   1590     93   1521     71
2025-11-16 23:18:45,758 - core.training.trainer - INFO - defect              0.9554     0.9424     0.9488       1614   1521     71   1590     93
2025-11-16 23:18:45,758 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:18:45,758 - core.training.trainer - INFO - MACRO AVG           0.9501     0.9498     0.9499
2025-11-16 23:18:45,758 - core.training.trainer - INFO - MICRO AVG           0.9499     0.9499     0.9499
2025-11-16 23:18:45,758 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:18:45,758 - core.training.trainer - INFO - 
Epoch 6 Summary: Train Loss: 0.1877, Val Loss: 0.1576, F1 (macro): 0.9499
2025-11-16 23:18:46,076 - core.training.callbacks - INFO - Saved checkpoint: /Users/ema/projects/DL4SE-simon-convnext-cbam-run/code/experiments/results/experiment_20251116_230211/checkpoints/best_model_epoch6_val_f1_macro_0.9499.pt
2025-11-16 23:18:46,076 - core.training.callbacks - INFO - Epoch 6: val_f1_macro improved to 0.9499
2025-11-16 23:18:46,076 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:18:46,076 - core.training.trainer - INFO - Epoch 7/50
2025-11-16 23:18:46,076 - core.training.trainer - INFO - ============================================================
2025-11-16 23:21:02,520 - core.training.trainer - INFO - Train Loss: 0.1831
2025-11-16 23:21:28,988 - core.training.trainer - INFO - Val Loss: 0.1488
2025-11-16 23:21:28,988 - core.training.trainer - INFO - Val F1 (macro): 0.9530 [threshold=0.5]
2025-11-16 23:21:28,988 - core.training.trainer - INFO - Precision (macro): 0.9530, Recall (macro): 0.9529
2025-11-16 23:21:28,988 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:21:28,988 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:21:28,988 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:21:28,988 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:21:28,988 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:21:28,988 - core.training.trainer - INFO - no_defect           0.9520     0.9554     0.9537       1661   1587     80   1534     74
2025-11-16 23:21:28,988 - core.training.trainer - INFO - defect              0.9540     0.9504     0.9522       1614   1534     74   1587     80
2025-11-16 23:21:28,988 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:21:28,988 - core.training.trainer - INFO - MACRO AVG           0.9530     0.9529     0.9530
2025-11-16 23:21:28,988 - core.training.trainer - INFO - MICRO AVG           0.9530     0.9530     0.9530
2025-11-16 23:21:28,988 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:21:28,988 - core.training.trainer - INFO - 
Epoch 7 Summary: Train Loss: 0.1831, Val Loss: 0.1488, F1 (macro): 0.9530
2025-11-16 23:21:29,316 - core.training.callbacks - INFO - Saved checkpoint: /Users/ema/projects/DL4SE-simon-convnext-cbam-run/code/experiments/results/experiment_20251116_230211/checkpoints/best_model_epoch7_val_f1_macro_0.9530.pt
2025-11-16 23:21:29,317 - core.training.callbacks - INFO - Epoch 7: val_f1_macro improved to 0.9530
2025-11-16 23:21:29,317 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:21:29,317 - core.training.trainer - INFO - Epoch 8/50
2025-11-16 23:21:29,317 - core.training.trainer - INFO - ============================================================
2025-11-16 23:23:50,244 - core.training.trainer - INFO - Train Loss: 0.1741
2025-11-16 23:24:17,534 - core.training.trainer - INFO - Val Loss: 0.1415
2025-11-16 23:24:17,536 - core.training.trainer - INFO - Val F1 (macro): 0.9529 [threshold=0.5]
2025-11-16 23:24:17,536 - core.training.trainer - INFO - Precision (macro): 0.9533, Recall (macro): 0.9528
2025-11-16 23:24:17,536 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:24:17,536 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:24:17,536 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:24:17,536 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:24:17,536 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:24:17,536 - core.training.trainer - INFO - no_defect           0.9451     0.9633     0.9541       1661   1600     93   1521     61
2025-11-16 23:24:17,536 - core.training.trainer - INFO - defect              0.9614     0.9424     0.9518       1614   1521     61   1600     93
2025-11-16 23:24:17,540 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:24:17,540 - core.training.trainer - INFO - MACRO AVG           0.9533     0.9528     0.9529
2025-11-16 23:24:17,540 - core.training.trainer - INFO - MICRO AVG           0.9530     0.9530     0.9530
2025-11-16 23:24:17,540 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:24:17,540 - core.training.trainer - INFO - 
Epoch 8 Summary: Train Loss: 0.1741, Val Loss: 0.1415, F1 (macro): 0.9529
2025-11-16 23:24:17,540 - core.training.callbacks - INFO - Epoch 8: No improvement (0.9529). Patience: 1/8
2025-11-16 23:24:17,540 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:24:17,540 - core.training.trainer - INFO - Epoch 9/50
2025-11-16 23:24:17,540 - core.training.trainer - INFO - ============================================================
2025-11-16 23:26:48,606 - core.training.trainer - INFO - Train Loss: 0.1741
2025-11-16 23:27:15,026 - core.training.trainer - INFO - Val Loss: 0.1367
2025-11-16 23:27:15,026 - core.training.trainer - INFO - Val F1 (macro): 0.9551 [threshold=0.5]
2025-11-16 23:27:15,026 - core.training.trainer - INFO - Precision (macro): 0.9553, Recall (macro): 0.9550
2025-11-16 23:27:15,026 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:27:15,026 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:27:15,027 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:27:15,027 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:27:15,027 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:27:15,027 - core.training.trainer - INFO - no_defect           0.9490     0.9633     0.9561       1661   1600     86   1528     61
2025-11-16 23:27:15,027 - core.training.trainer - INFO - defect              0.9616     0.9467     0.9541       1614   1528     61   1600     86
2025-11-16 23:27:15,027 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:27:15,027 - core.training.trainer - INFO - MACRO AVG           0.9553     0.9550     0.9551
2025-11-16 23:27:15,027 - core.training.trainer - INFO - MICRO AVG           0.9551     0.9551     0.9551
2025-11-16 23:27:15,027 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:27:15,027 - core.training.trainer - INFO - 
Epoch 9 Summary: Train Loss: 0.1741, Val Loss: 0.1367, F1 (macro): 0.9551
2025-11-16 23:27:15,347 - core.training.callbacks - INFO - Saved checkpoint: /Users/ema/projects/DL4SE-simon-convnext-cbam-run/code/experiments/results/experiment_20251116_230211/checkpoints/best_model_epoch9_val_f1_macro_0.9551.pt
2025-11-16 23:27:15,347 - core.training.callbacks - INFO - Epoch 9: val_f1_macro improved to 0.9551
2025-11-16 23:27:15,348 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:27:15,348 - core.training.trainer - INFO - Epoch 10/50
2025-11-16 23:27:15,348 - core.training.trainer - INFO - ============================================================
2025-11-16 23:29:19,846 - core.training.trainer - INFO - Train Loss: 0.1698
2025-11-16 23:29:43,723 - core.training.trainer - INFO - Val Loss: 0.1332
2025-11-16 23:29:43,723 - core.training.trainer - INFO - Val F1 (macro): 0.9557 [threshold=0.5]
2025-11-16 23:29:43,723 - core.training.trainer - INFO - Precision (macro): 0.9559, Recall (macro): 0.9556
2025-11-16 23:29:43,723 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:29:43,723 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:29:43,723 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:29:43,723 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:29:43,723 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:29:43,723 - core.training.trainer - INFO - no_defect           0.9496     0.9639     0.9567       1661   1601     85   1529     60
2025-11-16 23:29:43,723 - core.training.trainer - INFO - defect              0.9622     0.9473     0.9547       1614   1529     60   1601     85
2025-11-16 23:29:43,723 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:29:43,723 - core.training.trainer - INFO - MACRO AVG           0.9559     0.9556     0.9557
2025-11-16 23:29:43,723 - core.training.trainer - INFO - MICRO AVG           0.9557     0.9557     0.9557
2025-11-16 23:29:43,723 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:29:43,724 - core.training.trainer - INFO - 
Epoch 10 Summary: Train Loss: 0.1698, Val Loss: 0.1332, F1 (macro): 0.9557
2025-11-16 23:29:44,047 - core.training.callbacks - INFO - Saved checkpoint: /Users/ema/projects/DL4SE-simon-convnext-cbam-run/code/experiments/results/experiment_20251116_230211/checkpoints/best_model_epoch10_val_f1_macro_0.9557.pt
2025-11-16 23:29:44,048 - core.training.callbacks - INFO - Epoch 10: val_f1_macro improved to 0.9557
2025-11-16 23:29:44,049 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:29:44,049 - core.training.trainer - INFO - Epoch 11/50
2025-11-16 23:29:44,049 - core.training.trainer - INFO - ============================================================
2025-11-16 23:31:45,779 - core.training.trainer - INFO - Train Loss: 0.1694
2025-11-16 23:32:09,867 - core.training.trainer - INFO - Val Loss: 0.1332
2025-11-16 23:32:09,867 - core.training.trainer - INFO - Val F1 (macro): 0.9554 [threshold=0.5]
2025-11-16 23:32:09,867 - core.training.trainer - INFO - Precision (macro): 0.9554, Recall (macro): 0.9555
2025-11-16 23:32:09,867 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:32:09,867 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:32:09,867 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:32:09,867 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:32:09,867 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:32:09,867 - core.training.trainer - INFO - no_defect           0.9594     0.9524     0.9559       1661   1582     67   1547     79
2025-11-16 23:32:09,867 - core.training.trainer - INFO - defect              0.9514     0.9585     0.9549       1614   1547     79   1582     67
2025-11-16 23:32:09,867 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:32:09,867 - core.training.trainer - INFO - MACRO AVG           0.9554     0.9555     0.9554
2025-11-16 23:32:09,867 - core.training.trainer - INFO - MICRO AVG           0.9554     0.9554     0.9554
2025-11-16 23:32:09,867 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:32:09,867 - core.training.trainer - INFO - 
Epoch 11 Summary: Train Loss: 0.1694, Val Loss: 0.1332, F1 (macro): 0.9554
2025-11-16 23:32:09,868 - core.training.callbacks - INFO - Epoch 11: No improvement (0.9554). Patience: 1/8
2025-11-16 23:32:09,868 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:32:09,868 - core.training.trainer - INFO - Epoch 12/50
2025-11-16 23:32:09,868 - core.training.trainer - INFO - ============================================================
2025-11-16 23:34:20,934 - core.training.trainer - INFO - Train Loss: 0.1722
2025-11-16 23:34:46,831 - core.training.trainer - INFO - Val Loss: 0.1278
2025-11-16 23:34:46,831 - core.training.trainer - INFO - Val F1 (macro): 0.9585 [threshold=0.5]
2025-11-16 23:34:46,831 - core.training.trainer - INFO - Precision (macro): 0.9585, Recall (macro): 0.9584
2025-11-16 23:34:46,831 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:34:46,831 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:34:46,831 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:34:46,831 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:34:46,831 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:34:46,831 - core.training.trainer - INFO - no_defect           0.9552     0.9633     0.9592       1661   1600     75   1539     61
2025-11-16 23:34:46,831 - core.training.trainer - INFO - defect              0.9619     0.9535     0.9577       1614   1539     61   1600     75
2025-11-16 23:34:46,832 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:34:46,832 - core.training.trainer - INFO - MACRO AVG           0.9585     0.9584     0.9585
2025-11-16 23:34:46,832 - core.training.trainer - INFO - MICRO AVG           0.9585     0.9585     0.9585
2025-11-16 23:34:46,832 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:34:46,832 - core.training.trainer - INFO - 
Epoch 12 Summary: Train Loss: 0.1722, Val Loss: 0.1278, F1 (macro): 0.9585
2025-11-16 23:34:47,134 - core.training.callbacks - INFO - Saved checkpoint: /Users/ema/projects/DL4SE-simon-convnext-cbam-run/code/experiments/results/experiment_20251116_230211/checkpoints/best_model_epoch12_val_f1_macro_0.9585.pt
2025-11-16 23:34:47,134 - core.training.callbacks - INFO - Epoch 12: val_f1_macro improved to 0.9585
2025-11-16 23:34:47,135 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:34:47,135 - core.training.trainer - INFO - Epoch 13/50
2025-11-16 23:34:47,135 - core.training.trainer - INFO - ============================================================
2025-11-16 23:36:47,076 - core.training.trainer - INFO - Train Loss: 0.1616
2025-11-16 23:37:19,556 - core.training.trainer - INFO - Val Loss: 0.1283
2025-11-16 23:37:19,557 - core.training.trainer - INFO - Val F1 (macro): 0.9582 [threshold=0.5]
2025-11-16 23:37:19,557 - core.training.trainer - INFO - Precision (macro): 0.9581, Recall (macro): 0.9582
2025-11-16 23:37:19,557 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:37:19,557 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:37:19,557 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:37:19,557 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:37:19,557 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:37:19,558 - core.training.trainer - INFO - no_defect           0.9635     0.9536     0.9585       1661   1584     60   1554     77
2025-11-16 23:37:19,558 - core.training.trainer - INFO - defect              0.9528     0.9628     0.9578       1614   1554     77   1584     60
2025-11-16 23:37:19,565 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:37:19,565 - core.training.trainer - INFO - MACRO AVG           0.9581     0.9582     0.9582
2025-11-16 23:37:19,565 - core.training.trainer - INFO - MICRO AVG           0.9582     0.9582     0.9582
2025-11-16 23:37:19,565 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:37:19,565 - core.training.trainer - INFO - 
Epoch 13 Summary: Train Loss: 0.1616, Val Loss: 0.1283, F1 (macro): 0.9582
2025-11-16 23:37:19,565 - core.training.callbacks - INFO - Epoch 13: No improvement (0.9582). Patience: 1/8
2025-11-16 23:37:19,566 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:37:19,566 - core.training.trainer - INFO - Epoch 14/50
2025-11-16 23:37:19,566 - core.training.trainer - INFO - ============================================================
2025-11-16 23:39:37,539 - core.training.trainer - INFO - Train Loss: 0.1712
2025-11-16 23:40:01,791 - core.training.trainer - INFO - Val Loss: 0.1244
2025-11-16 23:40:01,791 - core.training.trainer - INFO - Val F1 (macro): 0.9591 [threshold=0.5]
2025-11-16 23:40:01,791 - core.training.trainer - INFO - Precision (macro): 0.9591, Recall (macro): 0.9591
2025-11-16 23:40:01,791 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:40:01,791 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:40:01,791 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:40:01,791 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:40:01,791 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:40:01,791 - core.training.trainer - INFO - no_defect           0.9586     0.9609     0.9597       1661   1596     69   1545     65
2025-11-16 23:40:01,791 - core.training.trainer - INFO - defect              0.9596     0.9572     0.9584       1614   1545     65   1596     69
2025-11-16 23:40:01,791 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:40:01,791 - core.training.trainer - INFO - MACRO AVG           0.9591     0.9591     0.9591
2025-11-16 23:40:01,791 - core.training.trainer - INFO - MICRO AVG           0.9591     0.9591     0.9591
2025-11-16 23:40:01,791 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:40:01,791 - core.training.trainer - INFO - 
Epoch 14 Summary: Train Loss: 0.1712, Val Loss: 0.1244, F1 (macro): 0.9591
2025-11-16 23:40:02,080 - core.training.callbacks - INFO - Saved checkpoint: /Users/ema/projects/DL4SE-simon-convnext-cbam-run/code/experiments/results/experiment_20251116_230211/checkpoints/best_model_epoch14_val_f1_macro_0.9591.pt
2025-11-16 23:40:02,080 - core.training.callbacks - INFO - Epoch 14: val_f1_macro improved to 0.9591
2025-11-16 23:40:02,081 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:40:02,081 - core.training.trainer - INFO - Epoch 15/50
2025-11-16 23:40:02,081 - core.training.trainer - INFO - ============================================================
2025-11-16 23:41:57,533 - core.training.trainer - INFO - Train Loss: 0.1690
2025-11-16 23:42:19,710 - core.training.trainer - INFO - Val Loss: 0.1233
2025-11-16 23:42:19,710 - core.training.trainer - INFO - Val F1 (macro): 0.9603 [threshold=0.5]
2025-11-16 23:42:19,710 - core.training.trainer - INFO - Precision (macro): 0.9603, Recall (macro): 0.9603
2025-11-16 23:42:19,710 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:42:19,710 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:42:19,710 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:42:19,710 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:42:19,710 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:42:19,710 - core.training.trainer - INFO - no_defect           0.9598     0.9621     0.9609       1661   1598     67   1547     63
2025-11-16 23:42:19,710 - core.training.trainer - INFO - defect              0.9609     0.9585     0.9597       1614   1547     63   1598     67
2025-11-16 23:42:19,710 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:42:19,710 - core.training.trainer - INFO - MACRO AVG           0.9603     0.9603     0.9603
2025-11-16 23:42:19,710 - core.training.trainer - INFO - MICRO AVG           0.9603     0.9603     0.9603
2025-11-16 23:42:19,710 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:42:19,710 - core.training.trainer - INFO - 
Epoch 15 Summary: Train Loss: 0.1690, Val Loss: 0.1233, F1 (macro): 0.9603
2025-11-16 23:42:19,995 - core.training.callbacks - INFO - Saved checkpoint: /Users/ema/projects/DL4SE-simon-convnext-cbam-run/code/experiments/results/experiment_20251116_230211/checkpoints/best_model_epoch15_val_f1_macro_0.9603.pt
2025-11-16 23:42:19,995 - core.training.callbacks - INFO - Epoch 15: val_f1_macro improved to 0.9603
2025-11-16 23:42:19,995 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:42:19,995 - core.training.trainer - INFO - Epoch 16/50
2025-11-16 23:42:19,995 - core.training.trainer - INFO - ============================================================
2025-11-16 23:44:14,249 - core.training.trainer - INFO - Train Loss: 0.1685
2025-11-16 23:44:36,470 - core.training.trainer - INFO - Val Loss: 0.1296
2025-11-16 23:44:36,470 - core.training.trainer - INFO - Val F1 (macro): 0.9573 [threshold=0.5]
2025-11-16 23:44:36,470 - core.training.trainer - INFO - Precision (macro): 0.9574, Recall (macro): 0.9574
2025-11-16 23:44:36,470 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:44:36,470 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:44:36,470 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:44:36,470 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:44:36,470 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:44:36,470 - core.training.trainer - INFO - no_defect           0.9692     0.9458     0.9573       1661   1571     50   1564     90
2025-11-16 23:44:36,470 - core.training.trainer - INFO - defect              0.9456     0.9690     0.9572       1614   1564     90   1571     50
2025-11-16 23:44:36,470 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:44:36,470 - core.training.trainer - INFO - MACRO AVG           0.9574     0.9574     0.9573
2025-11-16 23:44:36,470 - core.training.trainer - INFO - MICRO AVG           0.9573     0.9573     0.9573
2025-11-16 23:44:36,470 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:44:36,470 - core.training.trainer - INFO - 
Epoch 16 Summary: Train Loss: 0.1685, Val Loss: 0.1296, F1 (macro): 0.9573
2025-11-16 23:44:36,470 - core.training.callbacks - INFO - Epoch 16: No improvement (0.9573). Patience: 1/8
2025-11-16 23:44:36,470 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:44:36,470 - core.training.trainer - INFO - Epoch 17/50
2025-11-16 23:44:36,470 - core.training.trainer - INFO - ============================================================
2025-11-16 23:46:37,865 - core.training.trainer - INFO - Train Loss: 0.1675
2025-11-16 23:47:03,146 - core.training.trainer - INFO - Val Loss: 0.1228
2025-11-16 23:47:03,147 - core.training.trainer - INFO - Val F1 (macro): 0.9585 [threshold=0.5]
2025-11-16 23:47:03,147 - core.training.trainer - INFO - Precision (macro): 0.9587, Recall (macro): 0.9583
2025-11-16 23:47:03,147 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:47:03,147 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:47:03,147 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:47:03,147 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:47:03,147 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:47:03,147 - core.training.trainer - INFO - no_defect           0.9515     0.9675     0.9594       1661   1607     82   1532     54
2025-11-16 23:47:03,147 - core.training.trainer - INFO - defect              0.9660     0.9492     0.9575       1614   1532     54   1607     82
2025-11-16 23:47:03,147 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:47:03,147 - core.training.trainer - INFO - MACRO AVG           0.9587     0.9583     0.9585
2025-11-16 23:47:03,147 - core.training.trainer - INFO - MICRO AVG           0.9585     0.9585     0.9585
2025-11-16 23:47:03,147 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:47:03,147 - core.training.trainer - INFO - 
Epoch 17 Summary: Train Loss: 0.1675, Val Loss: 0.1228, F1 (macro): 0.9585
2025-11-16 23:47:03,147 - core.training.callbacks - INFO - Epoch 17: No improvement (0.9585). Patience: 2/8
2025-11-16 23:47:03,147 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:47:03,147 - core.training.trainer - INFO - Epoch 18/50
2025-11-16 23:47:03,147 - core.training.trainer - INFO - ============================================================
2025-11-16 23:49:05,533 - core.training.trainer - INFO - Train Loss: 0.1694
2025-11-16 23:49:27,176 - core.training.trainer - INFO - Val Loss: 0.1204
2025-11-16 23:49:27,176 - core.training.trainer - INFO - Val F1 (macro): 0.9612 [threshold=0.5]
2025-11-16 23:49:27,176 - core.training.trainer - INFO - Precision (macro): 0.9612, Recall (macro): 0.9612
2025-11-16 23:49:27,176 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:49:27,176 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:49:27,176 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:49:27,176 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:49:27,176 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:49:27,176 - core.training.trainer - INFO - no_defect           0.9604     0.9633     0.9618       1661   1600     66   1548     61
2025-11-16 23:49:27,176 - core.training.trainer - INFO - defect              0.9621     0.9591     0.9606       1614   1548     61   1600     66
2025-11-16 23:49:27,176 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:49:27,176 - core.training.trainer - INFO - MACRO AVG           0.9612     0.9612     0.9612
2025-11-16 23:49:27,176 - core.training.trainer - INFO - MICRO AVG           0.9612     0.9612     0.9612
2025-11-16 23:49:27,176 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:49:27,176 - core.training.trainer - INFO - 
Epoch 18 Summary: Train Loss: 0.1694, Val Loss: 0.1204, F1 (macro): 0.9612
2025-11-16 23:49:27,598 - core.training.callbacks - INFO - Saved checkpoint: /Users/ema/projects/DL4SE-simon-convnext-cbam-run/code/experiments/results/experiment_20251116_230211/checkpoints/best_model_epoch18_val_f1_macro_0.9612.pt
2025-11-16 23:49:27,598 - core.training.callbacks - INFO - Epoch 18: val_f1_macro improved to 0.9612
2025-11-16 23:49:27,598 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:49:27,598 - core.training.trainer - INFO - Epoch 19/50
2025-11-16 23:49:27,598 - core.training.trainer - INFO - ============================================================
2025-11-16 23:51:17,152 - core.training.trainer - INFO - Train Loss: 0.1671
2025-11-16 23:51:39,104 - core.training.trainer - INFO - Val Loss: 0.1185
2025-11-16 23:51:39,104 - core.training.trainer - INFO - Val F1 (macro): 0.9618 [threshold=0.5]
2025-11-16 23:51:39,104 - core.training.trainer - INFO - Precision (macro): 0.9619, Recall (macro): 0.9618
2025-11-16 23:51:39,104 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:51:39,104 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:51:39,104 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:51:39,104 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:51:39,104 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:51:39,104 - core.training.trainer - INFO - no_defect           0.9599     0.9651     0.9625       1661   1603     67   1547     58
2025-11-16 23:51:39,104 - core.training.trainer - INFO - defect              0.9639     0.9585     0.9612       1614   1547     58   1603     67
2025-11-16 23:51:39,104 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:51:39,104 - core.training.trainer - INFO - MACRO AVG           0.9619     0.9618     0.9618
2025-11-16 23:51:39,104 - core.training.trainer - INFO - MICRO AVG           0.9618     0.9618     0.9618
2025-11-16 23:51:39,104 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:51:39,104 - core.training.trainer - INFO - 
Epoch 19 Summary: Train Loss: 0.1671, Val Loss: 0.1185, F1 (macro): 0.9618
2025-11-16 23:51:39,449 - core.training.callbacks - INFO - Saved checkpoint: /Users/ema/projects/DL4SE-simon-convnext-cbam-run/code/experiments/results/experiment_20251116_230211/checkpoints/best_model_epoch19_val_f1_macro_0.9618.pt
2025-11-16 23:51:39,449 - core.training.callbacks - INFO - Epoch 19: val_f1_macro improved to 0.9618
2025-11-16 23:51:39,449 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:51:39,449 - core.training.trainer - INFO - Epoch 20/50
2025-11-16 23:51:39,449 - core.training.trainer - INFO - ============================================================
2025-11-16 23:53:29,746 - core.training.trainer - INFO - Train Loss: 0.1687
2025-11-16 23:53:51,520 - core.training.trainer - INFO - Val Loss: 0.1207
2025-11-16 23:53:51,520 - core.training.trainer - INFO - Val F1 (macro): 0.9612 [threshold=0.5]
2025-11-16 23:53:51,520 - core.training.trainer - INFO - Precision (macro): 0.9612, Recall (macro): 0.9613
2025-11-16 23:53:51,520 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:53:51,520 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:53:51,520 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:53:51,520 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:53:51,520 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:53:51,520 - core.training.trainer - INFO - no_defect           0.9677     0.9554     0.9615       1661   1587     53   1561     74
2025-11-16 23:53:51,520 - core.training.trainer - INFO - defect              0.9547     0.9672     0.9609       1614   1561     74   1587     53
2025-11-16 23:53:51,520 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:53:51,520 - core.training.trainer - INFO - MACRO AVG           0.9612     0.9613     0.9612
2025-11-16 23:53:51,520 - core.training.trainer - INFO - MICRO AVG           0.9612     0.9612     0.9612
2025-11-16 23:53:51,520 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:53:51,521 - core.training.trainer - INFO - 
Epoch 20 Summary: Train Loss: 0.1687, Val Loss: 0.1207, F1 (macro): 0.9612
2025-11-16 23:53:51,521 - core.training.callbacks - INFO - Epoch 20: No improvement (0.9612). Patience: 1/8
2025-11-16 23:53:51,521 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:53:51,521 - core.training.trainer - INFO - Epoch 21/50
2025-11-16 23:53:51,521 - core.training.trainer - INFO - ============================================================
2025-11-16 23:55:43,328 - core.training.trainer - INFO - Train Loss: 0.1614
2025-11-16 23:56:04,946 - core.training.trainer - INFO - Val Loss: 0.1187
2025-11-16 23:56:04,946 - core.training.trainer - INFO - Val F1 (macro): 0.9615 [threshold=0.5]
2025-11-16 23:56:04,946 - core.training.trainer - INFO - Precision (macro): 0.9615, Recall (macro): 0.9615
2025-11-16 23:56:04,946 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:56:04,946 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:56:04,946 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:56:04,946 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:56:04,946 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:56:04,946 - core.training.trainer - INFO - no_defect           0.9610     0.9633     0.9621       1661   1600     65   1549     61
2025-11-16 23:56:04,946 - core.training.trainer - INFO - defect              0.9621     0.9597     0.9609       1614   1549     61   1600     65
2025-11-16 23:56:04,946 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:56:04,946 - core.training.trainer - INFO - MACRO AVG           0.9615     0.9615     0.9615
2025-11-16 23:56:04,946 - core.training.trainer - INFO - MICRO AVG           0.9615     0.9615     0.9615
2025-11-16 23:56:04,946 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:56:04,946 - core.training.trainer - INFO - 
Epoch 21 Summary: Train Loss: 0.1614, Val Loss: 0.1187, F1 (macro): 0.9615
2025-11-16 23:56:04,946 - core.training.callbacks - INFO - Epoch 21: No improvement (0.9615). Patience: 2/8
2025-11-16 23:56:04,948 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:56:04,948 - core.training.trainer - INFO - Epoch 22/50
2025-11-16 23:56:04,948 - core.training.trainer - INFO - ============================================================
2025-11-16 23:57:54,987 - core.training.trainer - INFO - Train Loss: 0.1671
2025-11-16 23:58:16,492 - core.training.trainer - INFO - Val Loss: 0.1181
2025-11-16 23:58:16,492 - core.training.trainer - INFO - Val F1 (macro): 0.9606 [threshold=0.5]
2025-11-16 23:58:16,492 - core.training.trainer - INFO - Precision (macro): 0.9607, Recall (macro): 0.9605
2025-11-16 23:58:16,492 - core.training.trainer - INFO - 
================================================================================
2025-11-16 23:58:16,492 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-16 23:58:16,492 - core.training.trainer - INFO - ================================================================================
2025-11-16 23:58:16,492 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-16 23:58:16,492 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:58:16,492 - core.training.trainer - INFO - no_defect           0.9576     0.9651     0.9613       1661   1603     71   1543     58
2025-11-16 23:58:16,492 - core.training.trainer - INFO - defect              0.9638     0.9560     0.9599       1614   1543     58   1603     71
2025-11-16 23:58:16,492 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-16 23:58:16,492 - core.training.trainer - INFO - MACRO AVG           0.9607     0.9605     0.9606
2025-11-16 23:58:16,492 - core.training.trainer - INFO - MICRO AVG           0.9606     0.9606     0.9606
2025-11-16 23:58:16,492 - core.training.trainer - INFO - ================================================================================

2025-11-16 23:58:16,492 - core.training.trainer - INFO - 
Epoch 22 Summary: Train Loss: 0.1671, Val Loss: 0.1181, F1 (macro): 0.9606
2025-11-16 23:58:16,492 - core.training.callbacks - INFO - Epoch 22: No improvement (0.9606). Patience: 3/8
2025-11-16 23:58:16,492 - core.training.trainer - INFO - 
============================================================
2025-11-16 23:58:16,492 - core.training.trainer - INFO - Epoch 23/50
2025-11-16 23:58:16,492 - core.training.trainer - INFO - ============================================================
2025-11-17 00:00:05,461 - core.training.trainer - INFO - Train Loss: 0.1614
2025-11-17 00:00:27,416 - core.training.trainer - INFO - Val Loss: 0.1186
2025-11-17 00:00:27,416 - core.training.trainer - INFO - Val F1 (macro): 0.9612 [threshold=0.5]
2025-11-17 00:00:27,416 - core.training.trainer - INFO - Precision (macro): 0.9612, Recall (macro): 0.9612
2025-11-17 00:00:27,416 - core.training.trainer - INFO - 
================================================================================
2025-11-17 00:00:27,416 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-17 00:00:27,416 - core.training.trainer - INFO - ================================================================================
2025-11-17 00:00:27,416 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-17 00:00:27,416 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:00:27,416 - core.training.trainer - INFO - no_defect           0.9632     0.9603     0.9617       1661   1595     61   1553     66
2025-11-17 00:00:27,416 - core.training.trainer - INFO - defect              0.9592     0.9622     0.9607       1614   1553     66   1595     61
2025-11-17 00:00:27,416 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:00:27,416 - core.training.trainer - INFO - MACRO AVG           0.9612     0.9612     0.9612
2025-11-17 00:00:27,416 - core.training.trainer - INFO - MICRO AVG           0.9612     0.9612     0.9612
2025-11-17 00:00:27,416 - core.training.trainer - INFO - ================================================================================

2025-11-17 00:00:27,416 - core.training.trainer - INFO - 
Epoch 23 Summary: Train Loss: 0.1614, Val Loss: 0.1186, F1 (macro): 0.9612
2025-11-17 00:00:27,416 - core.training.callbacks - INFO - Epoch 23: No improvement (0.9612). Patience: 4/8
2025-11-17 00:00:27,417 - core.training.trainer - INFO - 
============================================================
2025-11-17 00:00:27,417 - core.training.trainer - INFO - Epoch 24/50
2025-11-17 00:00:27,417 - core.training.trainer - INFO - ============================================================
2025-11-17 00:02:16,024 - core.training.trainer - INFO - Train Loss: 0.1655
2025-11-17 00:02:37,469 - core.training.trainer - INFO - Val Loss: 0.1179
2025-11-17 00:02:37,469 - core.training.trainer - INFO - Val F1 (macro): 0.9591 [threshold=0.5]
2025-11-17 00:02:37,469 - core.training.trainer - INFO - Precision (macro): 0.9594, Recall (macro): 0.9589
2025-11-17 00:02:37,469 - core.training.trainer - INFO - 
================================================================================
2025-11-17 00:02:37,469 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-17 00:02:37,469 - core.training.trainer - INFO - ================================================================================
2025-11-17 00:02:37,469 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-17 00:02:37,469 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:02:37,469 - core.training.trainer - INFO - no_defect           0.9499     0.9705     0.9601       1661   1612     85   1529     49
2025-11-17 00:02:37,469 - core.training.trainer - INFO - defect              0.9689     0.9473     0.9580       1614   1529     49   1612     85
2025-11-17 00:02:37,469 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:02:37,469 - core.training.trainer - INFO - MACRO AVG           0.9594     0.9589     0.9591
2025-11-17 00:02:37,469 - core.training.trainer - INFO - MICRO AVG           0.9591     0.9591     0.9591
2025-11-17 00:02:37,469 - core.training.trainer - INFO - ================================================================================

2025-11-17 00:02:37,469 - core.training.trainer - INFO - 
Epoch 24 Summary: Train Loss: 0.1655, Val Loss: 0.1179, F1 (macro): 0.9591
2025-11-17 00:02:37,469 - core.training.callbacks - INFO - Epoch 24: No improvement (0.9591). Patience: 5/8
2025-11-17 00:02:37,469 - core.training.trainer - INFO - 
============================================================
2025-11-17 00:02:37,469 - core.training.trainer - INFO - Epoch 25/50
2025-11-17 00:02:37,469 - core.training.trainer - INFO - ============================================================
2025-11-17 00:04:26,187 - core.training.trainer - INFO - Train Loss: 0.1733
2025-11-17 00:04:47,751 - core.training.trainer - INFO - Val Loss: 0.1171
2025-11-17 00:04:47,751 - core.training.trainer - INFO - Val F1 (macro): 0.9609 [threshold=0.5]
2025-11-17 00:04:47,751 - core.training.trainer - INFO - Precision (macro): 0.9610, Recall (macro): 0.9609
2025-11-17 00:04:47,751 - core.training.trainer - INFO - 
================================================================================
2025-11-17 00:04:47,751 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-17 00:04:47,751 - core.training.trainer - INFO - ================================================================================
2025-11-17 00:04:47,751 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-17 00:04:47,751 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:04:47,751 - core.training.trainer - INFO - no_defect           0.9587     0.9645     0.9616       1661   1602     69   1545     59
2025-11-17 00:04:47,751 - core.training.trainer - INFO - defect              0.9632     0.9572     0.9602       1614   1545     59   1602     69
2025-11-17 00:04:47,751 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:04:47,751 - core.training.trainer - INFO - MACRO AVG           0.9610     0.9609     0.9609
2025-11-17 00:04:47,751 - core.training.trainer - INFO - MICRO AVG           0.9609     0.9609     0.9609
2025-11-17 00:04:47,751 - core.training.trainer - INFO - ================================================================================

2025-11-17 00:04:47,751 - core.training.trainer - INFO - 
Epoch 25 Summary: Train Loss: 0.1733, Val Loss: 0.1171, F1 (macro): 0.9609
2025-11-17 00:04:47,751 - core.training.callbacks - INFO - Epoch 25: No improvement (0.9609). Patience: 6/8
2025-11-17 00:04:47,751 - core.training.trainer - INFO - 
============================================================
2025-11-17 00:04:47,751 - core.training.trainer - INFO - Epoch 26/50
2025-11-17 00:04:47,751 - core.training.trainer - INFO - ============================================================
2025-11-17 00:06:36,340 - core.training.trainer - INFO - Train Loss: 0.1681
2025-11-17 00:06:57,781 - core.training.trainer - INFO - Val Loss: 0.1179
2025-11-17 00:06:57,781 - core.training.trainer - INFO - Val F1 (macro): 0.9621 [threshold=0.5]
2025-11-17 00:06:57,781 - core.training.trainer - INFO - Precision (macro): 0.9621, Recall (macro): 0.9622
2025-11-17 00:06:57,781 - core.training.trainer - INFO - 
================================================================================
2025-11-17 00:06:57,781 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-17 00:06:57,781 - core.training.trainer - INFO - ================================================================================
2025-11-17 00:06:57,781 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-17 00:06:57,781 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:06:57,781 - core.training.trainer - INFO - no_defect           0.9655     0.9597     0.9626       1661   1594     57   1557     67
2025-11-17 00:06:57,781 - core.training.trainer - INFO - defect              0.9587     0.9647     0.9617       1614   1557     67   1594     57
2025-11-17 00:06:57,781 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:06:57,781 - core.training.trainer - INFO - MACRO AVG           0.9621     0.9622     0.9621
2025-11-17 00:06:57,781 - core.training.trainer - INFO - MICRO AVG           0.9621     0.9621     0.9621
2025-11-17 00:06:57,781 - core.training.trainer - INFO - ================================================================================

2025-11-17 00:06:57,781 - core.training.trainer - INFO - 
Epoch 26 Summary: Train Loss: 0.1681, Val Loss: 0.1179, F1 (macro): 0.9621
2025-11-17 00:06:58,132 - core.training.callbacks - INFO - Saved checkpoint: /Users/ema/projects/DL4SE-simon-convnext-cbam-run/code/experiments/results/experiment_20251116_230211/checkpoints/best_model_epoch26_val_f1_macro_0.9621.pt
2025-11-17 00:06:58,133 - core.training.callbacks - INFO - Epoch 26: val_f1_macro improved to 0.9621
2025-11-17 00:06:58,133 - core.training.trainer - INFO - 
============================================================
2025-11-17 00:06:58,133 - core.training.trainer - INFO - Epoch 27/50
2025-11-17 00:06:58,133 - core.training.trainer - INFO - ============================================================
2025-11-17 00:08:46,370 - core.training.trainer - INFO - Train Loss: 0.1633
2025-11-17 00:09:07,671 - core.training.trainer - INFO - Val Loss: 0.1168
2025-11-17 00:09:07,671 - core.training.trainer - INFO - Val F1 (macro): 0.9624 [threshold=0.5]
2025-11-17 00:09:07,671 - core.training.trainer - INFO - Precision (macro): 0.9624, Recall (macro): 0.9624
2025-11-17 00:09:07,671 - core.training.trainer - INFO - 
================================================================================
2025-11-17 00:09:07,671 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-17 00:09:07,671 - core.training.trainer - INFO - ================================================================================
2025-11-17 00:09:07,671 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-17 00:09:07,671 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:09:07,671 - core.training.trainer - INFO - no_defect           0.9621     0.9639     0.9630       1661   1601     63   1551     60
2025-11-17 00:09:07,671 - core.training.trainer - INFO - defect              0.9628     0.9610     0.9619       1614   1551     60   1601     63
2025-11-17 00:09:07,671 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:09:07,671 - core.training.trainer - INFO - MACRO AVG           0.9624     0.9624     0.9624
2025-11-17 00:09:07,671 - core.training.trainer - INFO - MICRO AVG           0.9624     0.9624     0.9624
2025-11-17 00:09:07,671 - core.training.trainer - INFO - ================================================================================

2025-11-17 00:09:07,671 - core.training.trainer - INFO - 
Epoch 27 Summary: Train Loss: 0.1633, Val Loss: 0.1168, F1 (macro): 0.9624
2025-11-17 00:09:07,974 - core.training.callbacks - INFO - Saved checkpoint: /Users/ema/projects/DL4SE-simon-convnext-cbam-run/code/experiments/results/experiment_20251116_230211/checkpoints/best_model_epoch27_val_f1_macro_0.9624.pt
2025-11-17 00:09:07,974 - core.training.callbacks - INFO - Epoch 27: val_f1_macro improved to 0.9624
2025-11-17 00:09:07,974 - core.training.trainer - INFO - 
============================================================
2025-11-17 00:09:07,974 - core.training.trainer - INFO - Epoch 28/50
2025-11-17 00:09:07,974 - core.training.trainer - INFO - ============================================================
2025-11-17 00:11:14,274 - core.training.trainer - INFO - Train Loss: 0.1597
2025-11-17 00:11:37,254 - core.training.trainer - INFO - Val Loss: 0.1167
2025-11-17 00:11:37,254 - core.training.trainer - INFO - Val F1 (macro): 0.9612 [threshold=0.5]
2025-11-17 00:11:37,254 - core.training.trainer - INFO - Precision (macro): 0.9612, Recall (macro): 0.9612
2025-11-17 00:11:37,254 - core.training.trainer - INFO - 
================================================================================
2025-11-17 00:11:37,254 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-17 00:11:37,254 - core.training.trainer - INFO - ================================================================================
2025-11-17 00:11:37,254 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-17 00:11:37,254 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:11:37,254 - core.training.trainer - INFO - no_defect           0.9615     0.9621     0.9618       1661   1598     64   1550     63
2025-11-17 00:11:37,254 - core.training.trainer - INFO - defect              0.9609     0.9603     0.9606       1614   1550     63   1598     64
2025-11-17 00:11:37,254 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:11:37,254 - core.training.trainer - INFO - MACRO AVG           0.9612     0.9612     0.9612
2025-11-17 00:11:37,254 - core.training.trainer - INFO - MICRO AVG           0.9612     0.9612     0.9612
2025-11-17 00:11:37,254 - core.training.trainer - INFO - ================================================================================

2025-11-17 00:11:37,254 - core.training.trainer - INFO - 
Epoch 28 Summary: Train Loss: 0.1597, Val Loss: 0.1167, F1 (macro): 0.9612
2025-11-17 00:11:37,254 - core.training.callbacks - INFO - Epoch 28: No improvement (0.9612). Patience: 1/8
2025-11-17 00:11:37,255 - core.training.trainer - INFO - 
============================================================
2025-11-17 00:11:37,255 - core.training.trainer - INFO - Epoch 29/50
2025-11-17 00:11:37,255 - core.training.trainer - INFO - ============================================================
2025-11-17 00:13:44,191 - core.training.trainer - INFO - Train Loss: 0.1611
2025-11-17 00:14:07,659 - core.training.trainer - INFO - Val Loss: 0.1153
2025-11-17 00:14:07,659 - core.training.trainer - INFO - Val F1 (macro): 0.9615 [threshold=0.5]
2025-11-17 00:14:07,659 - core.training.trainer - INFO - Precision (macro): 0.9616, Recall (macro): 0.9614
2025-11-17 00:14:07,659 - core.training.trainer - INFO - 
================================================================================
2025-11-17 00:14:07,659 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-17 00:14:07,659 - core.training.trainer - INFO - ================================================================================
2025-11-17 00:14:07,659 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-17 00:14:07,659 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:14:07,660 - core.training.trainer - INFO - no_defect           0.9577     0.9669     0.9623       1661   1606     71   1543     55
2025-11-17 00:14:07,660 - core.training.trainer - INFO - defect              0.9656     0.9560     0.9608       1614   1543     55   1606     71
2025-11-17 00:14:07,664 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:14:07,664 - core.training.trainer - INFO - MACRO AVG           0.9616     0.9614     0.9615
2025-11-17 00:14:07,664 - core.training.trainer - INFO - MICRO AVG           0.9615     0.9615     0.9615
2025-11-17 00:14:07,664 - core.training.trainer - INFO - ================================================================================

2025-11-17 00:14:07,664 - core.training.trainer - INFO - 
Epoch 29 Summary: Train Loss: 0.1611, Val Loss: 0.1153, F1 (macro): 0.9615
2025-11-17 00:14:07,664 - core.training.callbacks - INFO - Epoch 29: No improvement (0.9615). Patience: 2/8
2025-11-17 00:14:07,665 - core.training.trainer - INFO - 
============================================================
2025-11-17 00:14:07,665 - core.training.trainer - INFO - Epoch 30/50
2025-11-17 00:14:07,665 - core.training.trainer - INFO - ============================================================
2025-11-17 00:16:23,740 - core.training.trainer - INFO - Train Loss: 0.1655
2025-11-17 00:16:48,697 - core.training.trainer - INFO - Val Loss: 0.1159
2025-11-17 00:16:48,697 - core.training.trainer - INFO - Val F1 (macro): 0.9618 [threshold=0.5]
2025-11-17 00:16:48,697 - core.training.trainer - INFO - Precision (macro): 0.9618, Recall (macro): 0.9619
2025-11-17 00:16:48,697 - core.training.trainer - INFO - 
================================================================================
2025-11-17 00:16:48,697 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-17 00:16:48,697 - core.training.trainer - INFO - ================================================================================
2025-11-17 00:16:48,697 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-17 00:16:48,697 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:16:48,697 - core.training.trainer - INFO - no_defect           0.9643     0.9603     0.9623       1661   1595     59   1555     66
2025-11-17 00:16:48,697 - core.training.trainer - INFO - defect              0.9593     0.9634     0.9614       1614   1555     66   1595     59
2025-11-17 00:16:48,697 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:16:48,697 - core.training.trainer - INFO - MACRO AVG           0.9618     0.9619     0.9618
2025-11-17 00:16:48,697 - core.training.trainer - INFO - MICRO AVG           0.9618     0.9618     0.9618
2025-11-17 00:16:48,697 - core.training.trainer - INFO - ================================================================================

2025-11-17 00:16:48,697 - core.training.trainer - INFO - 
Epoch 30 Summary: Train Loss: 0.1655, Val Loss: 0.1159, F1 (macro): 0.9618
2025-11-17 00:16:48,697 - core.training.callbacks - INFO - Epoch 30: No improvement (0.9618). Patience: 3/8
2025-11-17 00:16:48,698 - core.training.trainer - INFO - 
============================================================
2025-11-17 00:16:48,698 - core.training.trainer - INFO - Epoch 31/50
2025-11-17 00:16:48,698 - core.training.trainer - INFO - ============================================================
2025-11-17 00:19:01,023 - core.training.trainer - INFO - Train Loss: 0.1679
2025-11-17 00:19:26,310 - core.training.trainer - INFO - Val Loss: 0.1150
2025-11-17 00:19:26,310 - core.training.trainer - INFO - Val F1 (macro): 0.9603 [threshold=0.5]
2025-11-17 00:19:26,310 - core.training.trainer - INFO - Precision (macro): 0.9604, Recall (macro): 0.9602
2025-11-17 00:19:26,310 - core.training.trainer - INFO - 
================================================================================
2025-11-17 00:19:26,310 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-17 00:19:26,310 - core.training.trainer - INFO - ================================================================================
2025-11-17 00:19:26,310 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-17 00:19:26,310 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:19:26,310 - core.training.trainer - INFO - no_defect           0.9565     0.9657     0.9611       1661   1604     73   1541     57
2025-11-17 00:19:26,310 - core.training.trainer - INFO - defect              0.9643     0.9548     0.9595       1614   1541     57   1604     73
2025-11-17 00:19:26,310 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:19:26,310 - core.training.trainer - INFO - MACRO AVG           0.9604     0.9602     0.9603
2025-11-17 00:19:26,310 - core.training.trainer - INFO - MICRO AVG           0.9603     0.9603     0.9603
2025-11-17 00:19:26,310 - core.training.trainer - INFO - ================================================================================

2025-11-17 00:19:26,310 - core.training.trainer - INFO - 
Epoch 31 Summary: Train Loss: 0.1679, Val Loss: 0.1150, F1 (macro): 0.9603
2025-11-17 00:19:26,310 - core.training.callbacks - INFO - Epoch 31: No improvement (0.9603). Patience: 4/8
2025-11-17 00:19:26,311 - core.training.trainer - INFO - 
============================================================
2025-11-17 00:19:26,311 - core.training.trainer - INFO - Epoch 32/50
2025-11-17 00:19:26,311 - core.training.trainer - INFO - ============================================================
2025-11-17 00:21:38,070 - core.training.trainer - INFO - Train Loss: 0.1683
2025-11-17 00:22:02,638 - core.training.trainer - INFO - Val Loss: 0.1173
2025-11-17 00:22:02,638 - core.training.trainer - INFO - Val F1 (macro): 0.9609 [threshold=0.5]
2025-11-17 00:22:02,639 - core.training.trainer - INFO - Precision (macro): 0.9609, Recall (macro): 0.9610
2025-11-17 00:22:02,639 - core.training.trainer - INFO - 
================================================================================
2025-11-17 00:22:02,639 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-17 00:22:02,639 - core.training.trainer - INFO - ================================================================================
2025-11-17 00:22:02,639 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-17 00:22:02,639 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:22:02,639 - core.training.trainer - INFO - no_defect           0.9654     0.9573     0.9613       1661   1590     57   1557     71
2025-11-17 00:22:02,639 - core.training.trainer - INFO - defect              0.9564     0.9647     0.9605       1614   1557     71   1590     57
2025-11-17 00:22:02,639 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:22:02,639 - core.training.trainer - INFO - MACRO AVG           0.9609     0.9610     0.9609
2025-11-17 00:22:02,639 - core.training.trainer - INFO - MICRO AVG           0.9609     0.9609     0.9609
2025-11-17 00:22:02,639 - core.training.trainer - INFO - ================================================================================

2025-11-17 00:22:02,639 - core.training.trainer - INFO - 
Epoch 32 Summary: Train Loss: 0.1683, Val Loss: 0.1173, F1 (macro): 0.9609
2025-11-17 00:22:02,639 - core.training.callbacks - INFO - Epoch 32: No improvement (0.9609). Patience: 5/8
2025-11-17 00:22:02,640 - core.training.trainer - INFO - 
============================================================
2025-11-17 00:22:02,640 - core.training.trainer - INFO - Epoch 33/50
2025-11-17 00:22:02,640 - core.training.trainer - INFO - ============================================================
2025-11-17 00:24:22,259 - core.training.trainer - INFO - Train Loss: 0.1619
2025-11-17 00:24:58,195 - core.training.trainer - INFO - Val Loss: 0.1160
2025-11-17 00:24:58,196 - core.training.trainer - INFO - Val F1 (macro): 0.9609 [threshold=0.5]
2025-11-17 00:24:58,196 - core.training.trainer - INFO - Precision (macro): 0.9609, Recall (macro): 0.9609
2025-11-17 00:24:58,196 - core.training.trainer - INFO - 
================================================================================
2025-11-17 00:24:58,196 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-17 00:24:58,196 - core.training.trainer - INFO - ================================================================================
2025-11-17 00:24:58,196 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-17 00:24:58,197 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:24:58,197 - core.training.trainer - INFO - no_defect           0.9593     0.9639     0.9616       1661   1601     68   1546     60
2025-11-17 00:24:58,197 - core.training.trainer - INFO - defect              0.9626     0.9579     0.9602       1614   1546     60   1601     68
2025-11-17 00:24:58,209 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:24:58,209 - core.training.trainer - INFO - MACRO AVG           0.9609     0.9609     0.9609
2025-11-17 00:24:58,209 - core.training.trainer - INFO - MICRO AVG           0.9609     0.9609     0.9609
2025-11-17 00:24:58,209 - core.training.trainer - INFO - ================================================================================

2025-11-17 00:24:58,209 - core.training.trainer - INFO - 
Epoch 33 Summary: Train Loss: 0.1619, Val Loss: 0.1160, F1 (macro): 0.9609
2025-11-17 00:24:58,209 - core.training.callbacks - INFO - Epoch 33: No improvement (0.9609). Patience: 6/8
2025-11-17 00:24:58,213 - core.training.trainer - INFO - 
============================================================
2025-11-17 00:24:58,213 - core.training.trainer - INFO - Epoch 34/50
2025-11-17 00:24:58,215 - core.training.trainer - INFO - ============================================================
2025-11-17 00:27:08,205 - core.training.trainer - INFO - Train Loss: 0.1675
2025-11-17 00:27:36,736 - core.training.trainer - INFO - Val Loss: 0.1170
2025-11-17 00:27:36,738 - core.training.trainer - INFO - Val F1 (macro): 0.9615 [threshold=0.5]
2025-11-17 00:27:36,738 - core.training.trainer - INFO - Precision (macro): 0.9615, Recall (macro): 0.9616
2025-11-17 00:27:36,738 - core.training.trainer - INFO - 
================================================================================
2025-11-17 00:27:36,738 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-17 00:27:36,738 - core.training.trainer - INFO - ================================================================================
2025-11-17 00:27:36,738 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-17 00:27:36,738 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:27:36,738 - core.training.trainer - INFO - no_defect           0.9649     0.9591     0.9620       1661   1593     58   1556     68
2025-11-17 00:27:36,738 - core.training.trainer - INFO - defect              0.9581     0.9641     0.9611       1614   1556     68   1593     58
2025-11-17 00:27:36,741 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:27:36,742 - core.training.trainer - INFO - MACRO AVG           0.9615     0.9616     0.9615
2025-11-17 00:27:36,742 - core.training.trainer - INFO - MICRO AVG           0.9615     0.9615     0.9615
2025-11-17 00:27:36,742 - core.training.trainer - INFO - ================================================================================

2025-11-17 00:27:36,742 - core.training.trainer - INFO - 
Epoch 34 Summary: Train Loss: 0.1675, Val Loss: 0.1170, F1 (macro): 0.9615
2025-11-17 00:27:36,742 - core.training.callbacks - INFO - Epoch 34: No improvement (0.9615). Patience: 7/8
2025-11-17 00:27:36,743 - core.training.trainer - INFO - 
============================================================
2025-11-17 00:27:36,743 - core.training.trainer - INFO - Epoch 35/50
2025-11-17 00:27:36,743 - core.training.trainer - INFO - ============================================================
2025-11-17 00:29:53,329 - core.training.trainer - INFO - Train Loss: 0.1622
2025-11-17 00:30:20,419 - core.training.trainer - INFO - Val Loss: 0.1164
2025-11-17 00:30:20,419 - core.training.trainer - INFO - Val F1 (macro): 0.9615 [threshold=0.5]
2025-11-17 00:30:20,419 - core.training.trainer - INFO - Precision (macro): 0.9615, Recall (macro): 0.9616
2025-11-17 00:30:20,419 - core.training.trainer - INFO - 
================================================================================
2025-11-17 00:30:20,419 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-17 00:30:20,419 - core.training.trainer - INFO - ================================================================================
2025-11-17 00:30:20,419 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-17 00:30:20,419 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:30:20,419 - core.training.trainer - INFO - no_defect           0.9643     0.9597     0.9620       1661   1594     59   1555     67
2025-11-17 00:30:20,419 - core.training.trainer - INFO - defect              0.9587     0.9634     0.9611       1614   1555     67   1594     59
2025-11-17 00:30:20,419 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:30:20,419 - core.training.trainer - INFO - MACRO AVG           0.9615     0.9616     0.9615
2025-11-17 00:30:20,419 - core.training.trainer - INFO - MICRO AVG           0.9615     0.9615     0.9615
2025-11-17 00:30:20,419 - core.training.trainer - INFO - ================================================================================

2025-11-17 00:30:20,419 - core.training.trainer - INFO - 
Epoch 35 Summary: Train Loss: 0.1622, Val Loss: 0.1164, F1 (macro): 0.9615
2025-11-17 00:30:20,419 - core.training.callbacks - INFO - Epoch 35: No improvement (0.9615). Patience: 8/8
2025-11-17 00:30:20,419 - core.training.callbacks - INFO - Early stopping triggered! Best metric: 0.9624 (epoch 27)
2025-11-17 00:30:20,420 - core.training.trainer - INFO - 
Early stopping at epoch 35
2025-11-17 00:30:20,420 - core.training.trainer - INFO - 
============================================================
2025-11-17 00:30:20,420 - core.training.trainer - INFO - Training completed!
2025-11-17 00:30:20,420 - core.training.trainer - INFO - ============================================================
2025-11-17 00:30:20,420 - core.training.trainer - INFO - 
============================================================
2025-11-17 00:30:20,420 - core.training.trainer - INFO - TEST EVALUATION
2025-11-17 00:30:20,420 - core.training.trainer - INFO - ============================================================
2025-11-17 00:30:20,420 - core.training.trainer - INFO - Using fixed threshold: 0.5
2025-11-17 00:30:47,533 - core.training.trainer - INFO - Test F1 (macro): 0.9600, Precision (macro): 0.9600, Recall (macro): 0.9600
2025-11-17 00:30:47,533 - core.training.trainer - INFO - 
================================================================================
2025-11-17 00:30:47,533 - core.training.trainer - INFO - PER-CLASS METRICS
2025-11-17 00:30:47,533 - core.training.trainer - INFO - ================================================================================
2025-11-17 00:30:47,533 - core.training.trainer - INFO - Class            Precision     Recall         F1    Support     TP     FP     TN     FN
2025-11-17 00:30:47,533 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:30:47,533 - core.training.trainer - INFO - no_defect           0.9603     0.9609     0.9606       1662   1597     66   1549     65
2025-11-17 00:30:47,533 - core.training.trainer - INFO - defect              0.9597     0.9591     0.9594       1615   1549     65   1597     66
2025-11-17 00:30:47,533 - core.training.trainer - INFO - --------------------------------------------------------------------------------
2025-11-17 00:30:47,533 - core.training.trainer - INFO - MACRO AVG           0.9600     0.9600     0.9600
2025-11-17 00:30:47,534 - core.training.trainer - INFO - MICRO AVG           0.9600     0.9600     0.9600
2025-11-17 00:30:47,534 - core.training.trainer - INFO - ================================================================================

2025-11-17 00:30:47,574 - core.training.trainer - INFO - Results saved to /Users/ema/projects/DL4SE-simon-convnext-cbam-run/code/experiments/results/experiment_20251116_230211/results.json
2025-11-17 00:30:48,228 - core.training.trainer - INFO - Model saved to /Users/ema/projects/DL4SE-simon-convnext-cbam-run/code/experiments/results/experiment_20251116_230211/model_final.pt
2025-11-17 00:30:48,228 - __main__ - INFO - 
======================================================================
2025-11-17 00:30:48,228 - __main__ - INFO - TRAINING COMPLETED SUCCESSFULLY
2025-11-17 00:30:48,228 - __main__ - INFO - ======================================================================
2025-11-17 00:30:48,228 - __main__ - INFO - Experiment directory: /Users/ema/projects/DL4SE-simon-convnext-cbam-run/code/experiments/results/experiment_20251116_230211