[
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.001_s10_20251207_194745",
    "lr": 0.001,
    "weight_decay": 0.001,
    "seed": 10,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9559980383858333,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.001_s10_20251207_194745",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s10_20251207_194745",
      "timestamp": "2025-12-07T19:49:38.086783",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.001_s10",
          "seed": 10,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s10_20251207_194745"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9558906492407503,
        "recall_macro": 0.9561633111123058,
        "f1_macro": 0.9559980383858333,
        "precision_micro": 0.956030534351145,
        "recall_micro": 0.956030534351145,
        "f1_micro": 0.956030534351145,
        "accuracy": 0.956030534351145,
        "hamming_loss": 0.04396946564885496,
        "no_defect_precision": 0.9623430962343096,
        "no_defect_recall": 0.9520993494973389,
        "no_defect_f1": 0.9571938168846611,
        "no_defect_tp": 1610,
        "no_defect_fp": 63,
        "no_defect_tn": 1521,
        "no_defect_fn": 81,
        "no_defect_support": 1691,
        "defect_precision": 0.949438202247191,
        "defect_recall": 0.9602272727272727,
        "defect_f1": 0.9548022598870056,
        "defect_tp": 1521,
        "defect_fp": 81,
        "defect_tn": 1610,
        "defect_fn": 63,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9612448770014407,
        "recall_macro": 0.961219948563122,
        "f1_macro": 0.9612301731331656,
        "precision_micro": 0.9612332112332113,
        "recall_micro": 0.9612332112332113,
        "f1_micro": 0.9612332112332113,
        "accuracy": 0.9612332112332113,
        "hamming_loss": 0.03876678876678877,
        "no_defect_precision": 0.9601208459214502,
        "no_defect_recall": 0.963030303030303,
        "no_defect_f1": 0.9615733736762481,
        "no_defect_tp": 1589,
        "no_defect_fp": 66,
        "no_defect_tn": 1560,
        "no_defect_fn": 61,
        "no_defect_support": 1650,
        "defect_precision": 0.9623689080814312,
        "defect_recall": 0.959409594095941,
        "defect_f1": 0.9608869725900832,
        "defect_tp": 1560,
        "defect_fp": 61,
        "defect_tn": 1589,
        "defect_fn": 66,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6181975575670537,
          0.41586130371153607,
          0.2923080573894988,
          0.2437388113228347,
          0.21862324688848592,
          0.2053689822928676,
          0.2003047193505774,
          0.19555937106015792,
          0.18982450582991087,
          0.18222181982201013,
          0.18337060532933996,
          0.18214896371175054,
          0.17611216173885258,
          0.17732224775532798,
          0.1827046534350477
        ],
        "val_loss": [
          0.5707972703071741,
          0.34958601685670704,
          0.2524917910878475,
          0.21265351514403635,
          0.1903830419939298,
          0.17547029084884203,
          0.16686492312986118,
          0.15855571441352367,
          0.15424711973621294,
          0.14912275310892326,
          0.14723955710920003,
          0.14532241511803407,
          0.14366498202658617,
          0.1433463330165698,
          0.1431554055844362
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8465725117809524,
            "recall_macro": 0.8348670023714375,
            "f1_macro": 0.8355815710939134,
            "precision_micro": 0.8375572519083969,
            "recall_micro": 0.8375572519083969,
            "f1_micro": 0.8375572519083969,
            "accuracy": 0.8375572519083969,
            "hamming_loss": 0.16244274809160306,
            "no_defect_precision": 0.7982501286670097,
            "no_defect_recall": 0.9172087522176227,
            "no_defect_f1": 0.8536048431480462,
            "no_defect_tp": 1551,
            "no_defect_fp": 392,
            "no_defect_tn": 1192,
            "no_defect_fn": 140,
            "no_defect_support": 1691,
            "defect_precision": 0.8948948948948949,
            "defect_recall": 0.7525252525252525,
            "defect_f1": 0.8175582990397805,
            "defect_tp": 1192,
            "defect_fp": 140,
            "defect_tn": 1551,
            "defect_fn": 392,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9011583555672467,
            "recall_macro": 0.8985458144424732,
            "f1_macro": 0.8991808806209367,
            "precision_micro": 0.8995419847328244,
            "recall_micro": 0.8995419847328244,
            "f1_micro": 0.8995419847328244,
            "accuracy": 0.8995419847328244,
            "hamming_loss": 0.10045801526717557,
            "no_defect_precision": 0.8825842696629214,
            "no_defect_recall": 0.9290360733293909,
            "no_defect_f1": 0.9052146355517142,
            "no_defect_tp": 1571,
            "no_defect_fp": 209,
            "no_defect_tn": 1375,
            "no_defect_fn": 120,
            "no_defect_support": 1691,
            "defect_precision": 0.919732441471572,
            "defect_recall": 0.8680555555555556,
            "defect_f1": 0.8931471256901592,
            "defect_tp": 1375,
            "defect_fp": 120,
            "defect_tn": 1571,
            "defect_fn": 209,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9330511638325276,
            "recall_macro": 0.9330683012860719,
            "f1_macro": 0.9330596453050193,
            "precision_micro": 0.9331297709923664,
            "recall_micro": 0.9331297709923664,
            "f1_micro": 0.9331297709923664,
            "accuracy": 0.9331297709923664,
            "hamming_loss": 0.06687022900763359,
            "no_defect_precision": 0.9355029585798816,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.935226264418811,
            "no_defect_tp": 1581,
            "no_defect_fp": 109,
            "no_defect_tn": 1475,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9305993690851735,
            "defect_recall": 0.9311868686868687,
            "defect_f1": 0.9308930261912275,
            "defect_tp": 1475,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 109,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9386650200314004,
            "recall_macro": 0.9374796531249814,
            "f1_macro": 0.9378779057082245,
            "precision_micro": 0.9380152671755725,
            "recall_micro": 0.9380152671755725,
            "f1_micro": 0.9380152671755725,
            "accuracy": 0.9380152671755725,
            "hamming_loss": 0.06198473282442748,
            "no_defect_precision": 0.928078250863061,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9407990667833187,
            "no_defect_tp": 1613,
            "no_defect_fp": 125,
            "no_defect_tn": 1459,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9492517891997397,
            "defect_recall": 0.9210858585858586,
            "defect_f1": 0.9349567446331304,
            "defect_tp": 1459,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 125,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9455140332690759,
            "recall_macro": 0.9457305909479179,
            "f1_macro": 0.9456049915573199,
            "precision_micro": 0.945648854961832,
            "recall_micro": 0.945648854961832,
            "f1_micro": 0.945648854961832,
            "accuracy": 0.945648854961832,
            "hamming_loss": 0.05435114503816794,
            "no_defect_precision": 0.951103160405486,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9471496437054632,
            "no_defect_tp": 1595,
            "no_defect_fp": 82,
            "no_defect_tn": 1502,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9399249061326659,
            "defect_recall": 0.9482323232323232,
            "defect_f1": 0.9440603394091767,
            "defect_tp": 1502,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 82,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9480209828898063,
            "recall_macro": 0.9480561080945469,
            "f1_macro": 0.9480381908797342,
            "precision_micro": 0.9480916030534351,
            "recall_micro": 0.9480916030534351,
            "f1_micro": 0.9480916030534351,
            "accuracy": 0.9480916030534351,
            "hamming_loss": 0.051908396946564885,
            "no_defect_precision": 0.9502664298401421,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9497041420118343,
            "no_defect_tp": 1605,
            "no_defect_fp": 84,
            "no_defect_tn": 1500,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9457755359394704,
            "defect_recall": 0.946969696969697,
            "defect_f1": 0.9463722397476341,
            "defect_tp": 1500,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 84,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9513026790764029,
            "recall_macro": 0.9516281980060809,
            "f1_macro": 0.9514184216195277,
            "precision_micro": 0.9514503816793893,
            "recall_micro": 0.9514503816793893,
            "f1_micro": 0.9514503816793893,
            "accuracy": 0.9514503816793893,
            "hamming_loss": 0.04854961832061069,
            "no_defect_precision": 0.9592326139088729,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.9526644834772253,
            "no_defect_tp": 1600,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9433727442439328,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9501723597618301,
            "defect_tp": 1516,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.951362495866078,
            "recall_macro": 0.9514484361653197,
            "f1_macro": 0.9514032421729799,
            "precision_micro": 0.9514503816793893,
            "recall_micro": 0.9514503816793893,
            "f1_micro": 0.9514503816793893,
            "accuracy": 0.9514503816793893,
            "hamming_loss": 0.04854961832061069,
            "no_defect_precision": 0.9543297746144721,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9529167900503406,
            "no_defect_tp": 1609,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.948395217117684,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.9498896942956193,
            "defect_tp": 1507,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9528297698669221,
            "recall_macro": 0.953166533758639,
            "f1_macro": 0.9529468773183704,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.9610077984403119,
            "no_defect_recall": 0.9473684210526315,
            "no_defect_f1": 0.9541393686718285,
            "no_defect_tp": 1602,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 89,
            "no_defect_support": 1691,
            "defect_precision": 0.9446517412935324,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9517543859649122,
            "defect_tp": 1519,
            "defect_fp": 89,
            "defect_tn": 1602,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546735074626865,
            "recall_macro": 0.9549206583875419,
            "f1_macro": 0.9547742425735332,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9605970149253731,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9560308972073678,
            "no_defect_tp": 1609,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.94875,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9535175879396985,
            "defect_tp": 1518,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549680728348249,
            "recall_macro": 0.9552962355667856,
            "f1_macro": 0.9550849558369219,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9628297362110312,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.956236975290265,
            "no_defect_tp": 1606,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9471064094586186,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9539329363835788,
            "defect_tp": 1522,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555789717945619,
            "recall_macro": 0.9559075751602364,
            "f1_macro": 0.9556960448731542,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9634292565947242,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9568323905924382,
            "no_defect_tp": 1607,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9477286869943995,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9545596991538703,
            "defect_tp": 1523,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9558955223880596,
            "recall_macro": 0.9561433375744435,
            "f1_macro": 0.9559965603418161,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9617910447761194,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9572192513368984,
            "no_defect_tp": 1611,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.95,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9547738693467337,
            "defect_tp": 1520,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9558906492407503,
            "recall_macro": 0.9561633111123058,
            "f1_macro": 0.9559980383858333,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9623430962343096,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9571938168846611,
            "no_defect_tp": 1610,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.949438202247191,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9548022598870056,
            "defect_tp": 1521,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9558906492407503,
            "recall_macro": 0.9561633111123058,
            "f1_macro": 0.9559980383858333,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9623430962343096,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9571938168846611,
            "no_defect_tp": 1610,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.949438202247191,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9548022598870056,
            "defect_tp": 1521,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 63,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9612448770014407,
            "recall_macro": 0.961219948563122,
            "f1_macro": 0.9612301731331656,
            "precision_micro": 0.9612332112332113,
            "recall_micro": 0.9612332112332113,
            "f1_micro": 0.9612332112332113,
            "accuracy": 0.9612332112332113,
            "hamming_loss": 0.03876678876678877,
            "no_defect_precision": 0.9601208459214502,
            "no_defect_recall": 0.963030303030303,
            "no_defect_f1": 0.9615733736762481,
            "no_defect_tp": 1589,
            "no_defect_fp": 66,
            "no_defect_tn": 1560,
            "no_defect_fn": 61,
            "no_defect_support": 1650,
            "defect_precision": 0.9623689080814312,
            "defect_recall": 0.959409594095941,
            "defect_f1": 0.9608869725900832,
            "defect_tp": 1560,
            "defect_fp": 61,
            "defect_tn": 1589,
            "defect_fn": 66,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.001_s20_20251207_135555",
    "lr": 0.001,
    "weight_decay": 0.001,
    "seed": 20,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9562934819543152,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.001_s20_20251207_135555",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s20_20251207_135555",
      "timestamp": "2025-12-07T13:57:51.452669",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.001_s20",
          "seed": 20,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s20_20251207_135555"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9562522815889489,
        "recall_macro": 0.9563391529129258,
        "f1_macro": 0.9562934819543152,
        "precision_micro": 0.9563358778625954,
        "recall_micro": 0.9563358778625954,
        "f1_micro": 0.9563358778625954,
        "accuracy": 0.9563358778625954,
        "hamming_loss": 0.04366412213740458,
        "no_defect_precision": 0.9590747330960854,
        "no_defect_recall": 0.9562389118864577,
        "no_defect_f1": 0.9576547231270358,
        "no_defect_tp": 1617,
        "no_defect_fp": 69,
        "no_defect_tn": 1515,
        "no_defect_fn": 74,
        "no_defect_support": 1691,
        "defect_precision": 0.9534298300818125,
        "defect_recall": 0.9564393939393939,
        "defect_f1": 0.9549322407815947,
        "defect_tp": 1515,
        "defect_fp": 74,
        "defect_tn": 1617,
        "defect_fn": 69,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9603256015756743,
        "recall_macro": 0.9603063848820306,
        "f1_macro": 0.9603145612423812,
        "precision_micro": 0.9603174603174603,
        "recall_micro": 0.9603174603174603,
        "f1_micro": 0.9603174603174603,
        "accuracy": 0.9603174603174603,
        "hamming_loss": 0.03968253968253968,
        "no_defect_precision": 0.9594921402660218,
        "no_defect_recall": 0.9618181818181818,
        "no_defect_f1": 0.9606537530266344,
        "no_defect_tp": 1587,
        "no_defect_fp": 67,
        "no_defect_tn": 1559,
        "no_defect_fn": 63,
        "no_defect_support": 1650,
        "defect_precision": 0.9611590628853267,
        "defect_recall": 0.9587945879458795,
        "defect_f1": 0.9599753694581281,
        "defect_tp": 1559,
        "defect_fp": 63,
        "defect_tn": 1587,
        "defect_fn": 67,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6241896992946768,
          0.414756435355382,
          0.2897418851508256,
          0.24192610202224685,
          0.2168680713765292,
          0.2043051438787991,
          0.1975386007747391,
          0.19666442399743211,
          0.18473274806303958,
          0.18595445891803278,
          0.18116056940919684,
          0.18178933827697483,
          0.18006535887593506,
          0.1819198334503872,
          0.18219641508791737
        ],
        "val_loss": [
          0.5756267572824771,
          0.348935230420186,
          0.25006521435884327,
          0.21089256984683183,
          0.1926044520850365,
          0.17305261441148245,
          0.16276488768366668,
          0.15944554255558893,
          0.1527884338910763,
          0.14888126102204507,
          0.14525887456077796,
          0.14342948206915304,
          0.14353020990697238,
          0.14317201049282,
          0.1432617439960058
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8444569901762053,
            "recall_macro": 0.8170786068849345,
            "f1_macro": 0.8167906805015941,
            "precision_micro": 0.8213740458015267,
            "recall_micro": 0.8213740458015267,
            "f1_micro": 0.8213740458015267,
            "accuracy": 0.8213740458015267,
            "hamming_loss": 0.17862595419847327,
            "no_defect_precision": 0.7630827783063748,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.8457685209596625,
            "no_defect_tp": 1604,
            "no_defect_fp": 498,
            "no_defect_tn": 1086,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9258312020460358,
            "defect_recall": 0.6856060606060606,
            "defect_f1": 0.7878128400435256,
            "defect_tp": 1086,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 498,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9051535298268125,
            "recall_macro": 0.9017384071346224,
            "f1_macro": 0.9024882924154627,
            "precision_micro": 0.9029007633587787,
            "recall_micro": 0.9029007633587787,
            "f1_micro": 0.9029007633587787,
            "accuracy": 0.9029007633587787,
            "hamming_loss": 0.09709923664122137,
            "no_defect_precision": 0.8820255982192543,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.9088302752293578,
            "no_defect_tp": 1585,
            "no_defect_fp": 212,
            "no_defect_tn": 1372,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.9282814614343707,
            "defect_recall": 0.8661616161616161,
            "defect_f1": 0.8961463096015676,
            "defect_tp": 1372,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 212,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9303456591639871,
            "recall_macro": 0.9297120002508825,
            "f1_macro": 0.9299555464401335,
            "precision_micro": 0.9300763358778626,
            "recall_micro": 0.9300763358778626,
            "f1_micro": 0.9300763358778626,
            "accuracy": 0.9300763358778626,
            "hamming_loss": 0.06992366412213741,
            "no_defect_precision": 0.925,
            "no_defect_recall": 0.9408633944411591,
            "no_defect_f1": 0.9328642626795661,
            "no_defect_tp": 1591,
            "no_defect_fp": 129,
            "no_defect_tn": 1455,
            "no_defect_fn": 100,
            "no_defect_support": 1691,
            "defect_precision": 0.9356913183279743,
            "defect_recall": 0.9185606060606061,
            "defect_f1": 0.9270468302007009,
            "defect_tp": 1455,
            "defect_fp": 100,
            "defect_tn": 1591,
            "defect_fn": 129,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9400292366451528,
            "recall_macro": 0.9401885875311363,
            "f1_macro": 0.9401001248948322,
            "precision_micro": 0.9401526717557251,
            "recall_micro": 0.9401526717557251,
            "f1_micro": 0.9401526717557251,
            "accuracy": 0.9401526717557251,
            "hamming_loss": 0.05984732824427481,
            "no_defect_precision": 0.9446757882212968,
            "no_defect_recall": 0.9390892962743939,
            "no_defect_f1": 0.9418742586002372,
            "no_defect_tp": 1588,
            "no_defect_fp": 93,
            "no_defect_tn": 1491,
            "no_defect_fn": 103,
            "no_defect_support": 1691,
            "defect_precision": 0.9353826850690088,
            "defect_recall": 0.9412878787878788,
            "defect_f1": 0.9383259911894273,
            "defect_tp": 1491,
            "defect_fp": 103,
            "defect_tn": 1588,
            "defect_fn": 93,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9430104471088078,
            "recall_macro": 0.9434689144550173,
            "f1_macro": 0.9428904549544471,
            "precision_micro": 0.9429007633587786,
            "recall_micro": 0.9429007633587786,
            "f1_micro": 0.9429007633587786,
            "accuracy": 0.9429007633587786,
            "hamming_loss": 0.05709923664122137,
            "no_defect_precision": 0.961916461916462,
            "no_defect_recall": 0.9260792430514488,
            "no_defect_f1": 0.943657728231395,
            "no_defect_tp": 1566,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 125,
            "no_defect_support": 1691,
            "defect_precision": 0.9241044323011536,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9421231816774992,
            "defect_tp": 1522,
            "defect_fp": 125,
            "defect_tn": 1566,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9516887328959658,
            "recall_macro": 0.9517241456552515,
            "f1_macro": 0.9517060832882236,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.9538188277087034,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9532544378698224,
            "no_defect_tp": 1611,
            "no_defect_fp": 78,
            "no_defect_tn": 1506,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9495586380832283,
            "defect_recall": 0.9507575757575758,
            "defect_f1": 0.9501577287066246,
            "defect_tp": 1506,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 78,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.952865924025807,
            "recall_macro": 0.9524114593600105,
            "f1_macro": 0.952599348543935,
            "precision_micro": 0.9526717557251908,
            "recall_micro": 0.9526717557251908,
            "f1_micro": 0.9526717557251908,
            "accuracy": 0.9526717557251908,
            "hamming_loss": 0.04732824427480916,
            "no_defect_precision": 0.9485981308411215,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9544519541580958,
            "no_defect_tp": 1624,
            "no_defect_fp": 88,
            "no_defect_tn": 1496,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9571337172104927,
            "defect_recall": 0.9444444444444444,
            "defect_f1": 0.9507467429297743,
            "defect_tp": 1496,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 88,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9525530988007314,
            "recall_macro": 0.952990691958019,
            "f1_macro": 0.9526501239421774,
            "precision_micro": 0.9526717557251908,
            "recall_micro": 0.9526717557251908,
            "f1_micro": 0.9526717557251908,
            "accuracy": 0.9526717557251908,
            "hamming_loss": 0.04732824427480916,
            "no_defect_precision": 0.964328899637243,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.953662182361734,
            "no_defect_tp": 1595,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9407772979642196,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9516380655226209,
            "defect_tp": 1525,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549695002518328,
            "recall_macro": 0.9552762620289232,
            "f1_macro": 0.9550835310572297,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9622754491017964,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9562630169592383,
            "no_defect_tp": 1607,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9476635514018692,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9539040451552211,
            "defect_tp": 1521,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9558906492407503,
            "recall_macro": 0.9561633111123058,
            "f1_macro": 0.9559980383858333,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9623430962343096,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9571938168846611,
            "no_defect_tp": 1610,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.949438202247191,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9548022598870056,
            "defect_tp": 1521,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556177330517805,
            "recall_macro": 0.9557677603951997,
            "f1_macro": 0.9556855105080515,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9595719381688466,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9570115624073525,
            "no_defect_tp": 1614,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9516635279347144,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9543594586087504,
            "defect_tp": 1516,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9562522815889489,
            "recall_macro": 0.9563391529129258,
            "f1_macro": 0.9562934819543152,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9590747330960854,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9576547231270358,
            "no_defect_tp": 1617,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9534298300818125,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9549322407815947,
            "defect_tp": 1515,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9559017570412629,
            "recall_macro": 0.9561233640365812,
            "f1_macro": 0.955995049349742,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9612403100775194,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9572446555819477,
            "no_defect_tp": 1612,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505632040050063,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9547454431175362,
            "defect_tp": 1519,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9559017570412629,
            "recall_macro": 0.9561233640365812,
            "f1_macro": 0.955995049349742,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9612403100775194,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9572446555819477,
            "no_defect_tp": 1612,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505632040050063,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9547454431175362,
            "defect_tp": 1519,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555929571137092,
            "recall_macro": 0.9558276810087869,
            "f1_macro": 0.9556902243047389,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.961217183770883,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9569349569349569,
            "no_defect_tp": 1611,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9499687304565353,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9544454916745209,
            "defect_tp": 1519,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 65,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9603256015756743,
            "recall_macro": 0.9603063848820306,
            "f1_macro": 0.9603145612423812,
            "precision_micro": 0.9603174603174603,
            "recall_micro": 0.9603174603174603,
            "f1_micro": 0.9603174603174603,
            "accuracy": 0.9603174603174603,
            "hamming_loss": 0.03968253968253968,
            "no_defect_precision": 0.9594921402660218,
            "no_defect_recall": 0.9618181818181818,
            "no_defect_f1": 0.9606537530266344,
            "no_defect_tp": 1587,
            "no_defect_fp": 67,
            "no_defect_tn": 1559,
            "no_defect_fn": 63,
            "no_defect_support": 1650,
            "defect_precision": 0.9611590628853267,
            "defect_recall": 0.9587945879458795,
            "defect_f1": 0.9599753694581281,
            "defect_tp": 1559,
            "defect_fp": 63,
            "defect_tn": 1587,
            "defect_fn": 67,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.001_s30_20251207_151640",
    "lr": 0.001,
    "weight_decay": 0.001,
    "seed": 30,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9553838694795995,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.001_s30_20251207_151640",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s30_20251207_151640",
      "timestamp": "2025-12-07T15:18:36.134622",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 9,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.001_s30",
          "seed": 30,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s30_20251207_151640"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9552907144664282,
        "recall_macro": 0.9555120244431303,
        "f1_macro": 0.9553838694795995,
        "precision_micro": 0.9554198473282443,
        "recall_micro": 0.9554198473282443,
        "f1_micro": 0.9554198473282443,
        "accuracy": 0.9554198473282443,
        "hamming_loss": 0.044580152671755725,
        "no_defect_precision": 0.960644007155635,
        "no_defect_recall": 0.9526907155529273,
        "no_defect_f1": 0.9566508313539193,
        "no_defect_tp": 1611,
        "no_defect_fp": 66,
        "no_defect_tn": 1518,
        "no_defect_fn": 80,
        "no_defect_support": 1691,
        "defect_precision": 0.9499374217772215,
        "defect_recall": 0.9583333333333334,
        "defect_f1": 0.9541169076052797,
        "defect_tp": 1518,
        "defect_fp": 80,
        "defect_tn": 1611,
        "defect_fn": 66,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9590942636699094,
        "recall_macro": 0.9590942636699094,
        "f1_macro": 0.9590942636699094,
        "precision_micro": 0.9590964590964591,
        "recall_micro": 0.9590964590964591,
        "f1_micro": 0.9590964590964591,
        "accuracy": 0.9590964590964591,
        "hamming_loss": 0.040903540903540904,
        "no_defect_precision": 0.9593939393939394,
        "no_defect_recall": 0.9593939393939394,
        "no_defect_f1": 0.9593939393939394,
        "no_defect_tp": 1583,
        "no_defect_fp": 67,
        "no_defect_tn": 1559,
        "no_defect_fn": 67,
        "no_defect_support": 1650,
        "defect_precision": 0.9587945879458795,
        "defect_recall": 0.9587945879458795,
        "defect_f1": 0.9587945879458795,
        "defect_tp": 1559,
        "defect_fp": 67,
        "defect_tn": 1583,
        "defect_fn": 67,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6293311388422754,
          0.41445254107399465,
          0.2913727452316045,
          0.2409251059198978,
          0.22136431390022135,
          0.20702684312185982,
          0.1964897982557947,
          0.19161488680036498,
          0.1907047051702583,
          0.18455284113789203,
          0.18749114082323456,
          0.18180083707910202,
          0.18006194061813993,
          0.17765900760764358,
          0.18060849532173268
        ],
        "val_loss": [
          0.5765697474663074,
          0.345910122188238,
          0.25132256058546215,
          0.21247223105568153,
          0.18947379462994063,
          0.17623595664134392,
          0.1645128556455557,
          0.1563817010476039,
          0.15211390560636154,
          0.1491000374349264,
          0.14671180569208586,
          0.145176184292023,
          0.14536554036805263,
          0.14454290471397913,
          0.14438602127707922
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8657826465067088,
            "recall_macro": 0.8545696841268988,
            "f1_macro": 0.8554956347934305,
            "precision_micro": 0.8570992366412213,
            "recall_micro": 0.8570992366412213,
            "f1_micro": 0.8570992366412213,
            "accuracy": 0.8570992366412213,
            "hamming_loss": 0.14290076335877863,
            "no_defect_precision": 0.8170036288232244,
            "no_defect_recall": 0.9319929036073329,
            "no_defect_f1": 0.8707182320441988,
            "no_defect_tp": 1576,
            "no_defect_fp": 353,
            "no_defect_tn": 1231,
            "no_defect_fn": 115,
            "no_defect_support": 1691,
            "defect_precision": 0.9145616641901931,
            "defect_recall": 0.7771464646464646,
            "defect_f1": 0.8402730375426621,
            "defect_tp": 1231,
            "defect_fp": 115,
            "defect_tn": 1576,
            "defect_fn": 353,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9050848212181364,
            "recall_macro": 0.904251526202295,
            "f1_macro": 0.9045457093212264,
            "precision_micro": 0.9047328244274809,
            "recall_micro": 0.9047328244274809,
            "f1_micro": 0.9047328244274809,
            "accuracy": 0.9047328244274809,
            "hamming_loss": 0.09526717557251908,
            "no_defect_precision": 0.8987854251012146,
            "no_defect_recall": 0.918982850384388,
            "no_defect_f1": 0.9087719298245615,
            "no_defect_tp": 1554,
            "no_defect_fp": 175,
            "no_defect_tn": 1409,
            "no_defect_fn": 137,
            "no_defect_support": 1691,
            "defect_precision": 0.9113842173350583,
            "defect_recall": 0.889520202020202,
            "defect_f1": 0.9003194888178914,
            "defect_tp": 1409,
            "defect_fp": 137,
            "defect_tn": 1554,
            "defect_fn": 175,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9287176559950403,
            "recall_macro": 0.9264915939405887,
            "f1_macro": 0.9271006279755514,
            "precision_micro": 0.9273282442748092,
            "recall_micro": 0.9273282442748092,
            "f1_micro": 0.9273282442748092,
            "accuracy": 0.9273282442748092,
            "hamming_loss": 0.07267175572519084,
            "no_defect_precision": 0.9111488398415394,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9311740890688259,
            "no_defect_tp": 1610,
            "no_defect_fp": 157,
            "no_defect_tn": 1427,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9462864721485411,
            "defect_recall": 0.9008838383838383,
            "defect_f1": 0.9230271668822768,
            "defect_tp": 1427,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 157,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.940771557171582,
            "recall_macro": 0.9406201652838257,
            "f1_macro": 0.9406902281468206,
            "precision_micro": 0.9407633587786259,
            "recall_micro": 0.9407633587786259,
            "f1_micro": 0.9407633587786259,
            "accuracy": 0.9407633587786259,
            "hamming_loss": 0.059236641221374044,
            "no_defect_precision": 0.9405532666274279,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.9427728613569322,
            "no_defect_tp": 1598,
            "no_defect_fp": 101,
            "no_defect_tn": 1483,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.940989847715736,
            "defect_recall": 0.9362373737373737,
            "defect_f1": 0.9386075949367089,
            "defect_tp": 1483,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 101,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9447572362278245,
            "recall_macro": 0.9445838858723247,
            "f1_macro": 0.9446634010348418,
            "precision_micro": 0.944732824427481,
            "recall_micro": 0.944732824427481,
            "f1_micro": 0.944732824427481,
            "accuracy": 0.944732824427481,
            "hamming_loss": 0.05526717557251908,
            "no_defect_precision": 0.9441176470588235,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.946623414921852,
            "no_defect_tp": 1605,
            "no_defect_fp": 95,
            "no_defect_tn": 1489,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9453968253968253,
            "defect_recall": 0.9400252525252525,
            "defect_f1": 0.9427033871478316,
            "defect_tp": 1489,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 95,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9485535728675161,
            "recall_macro": 0.9488871566044836,
            "f1_macro": 0.9486693207109494,
            "precision_micro": 0.9487022900763359,
            "recall_micro": 0.9487022900763359,
            "f1_micro": 0.9487022900763359,
            "accuracy": 0.9487022900763359,
            "hamming_loss": 0.05129770992366412,
            "no_defect_precision": 0.9568086382723455,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9499702203692674,
            "no_defect_tp": 1595,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9402985074626866,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.9473684210526315,
            "defect_tp": 1512,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.952300024563659,
            "recall_macro": 0.9523354852487023,
            "f1_macro": 0.9523173986896385,
            "precision_micro": 0.9523664122137404,
            "recall_micro": 0.9523664122137404,
            "f1_micro": 0.9523664122137404,
            "accuracy": 0.9523664122137404,
            "hamming_loss": 0.04763358778625954,
            "no_defect_precision": 0.9544108940201302,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9538461538461539,
            "no_defect_tp": 1612,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9501891551071879,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.950788643533123,
            "defect_tp": 1507,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9544812326423504,
            "recall_macro": 0.954425239981124,
            "f1_macro": 0.9544524327893947,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9551357733175915,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9559822747415067,
            "no_defect_tp": 1618,
            "no_defect_fp": 76,
            "no_defect_tn": 1508,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9538266919671095,
            "defect_recall": 0.952020202020202,
            "defect_f1": 0.9529225908372828,
            "defect_tp": 1508,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 76,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552907144664282,
            "recall_macro": 0.9555120244431303,
            "f1_macro": 0.9553838694795995,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.960644007155635,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9566508313539193,
            "no_defect_tp": 1611,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9499374217772215,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9541169076052797,
            "defect_tp": 1518,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954365439163247,
            "recall_macro": 0.9546249753597478,
            "f1_macro": 0.954469432075036,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9605734767025089,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9557206537890045,
            "no_defect_tp": 1608,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.948157401623985,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9532182103610675,
            "defect_tp": 1518,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954981932323454,
            "recall_macro": 0.9552163414153361,
            "f1_macro": 0.9550790549848043,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9606205250596659,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9563409563409564,
            "no_defect_tp": 1610,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.949343339587242,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9538171536286523,
            "defect_tp": 1518,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546735074626865,
            "recall_macro": 0.9549206583875419,
            "f1_macro": 0.9547742425735332,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9605970149253731,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9560308972073678,
            "no_defect_tp": 1609,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.94875,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9535175879396985,
            "defect_tp": 1518,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543571738750878,
            "recall_macro": 0.9546848959733347,
            "f1_macro": 0.9544738668006896,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9622302158273381,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9556415599880917,
            "no_defect_tp": 1605,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9464841319228375,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9533061736132874,
            "defect_tp": 1521,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546631602431565,
            "recall_macro": 0.954980579001129,
            "f1_macro": 0.9547786983131811,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9622528460155781,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.955952380952381,
            "no_defect_tp": 1606,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9470734744707348,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9536050156739811,
            "defect_tp": 1521,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546631602431565,
            "recall_macro": 0.954980579001129,
            "f1_macro": 0.9547786983131811,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9622528460155781,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.955952380952381,
            "no_defect_tp": 1606,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9470734744707348,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9536050156739811,
            "defect_tp": 1521,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 63,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9590942636699094,
            "recall_macro": 0.9590942636699094,
            "f1_macro": 0.9590942636699094,
            "precision_micro": 0.9590964590964591,
            "recall_micro": 0.9590964590964591,
            "f1_micro": 0.9590964590964591,
            "accuracy": 0.9590964590964591,
            "hamming_loss": 0.040903540903540904,
            "no_defect_precision": 0.9593939393939394,
            "no_defect_recall": 0.9593939393939394,
            "no_defect_f1": 0.9593939393939394,
            "no_defect_tp": 1583,
            "no_defect_fp": 67,
            "no_defect_tn": 1559,
            "no_defect_fn": 67,
            "no_defect_support": 1650,
            "defect_precision": 0.9587945879458795,
            "defect_recall": 0.9587945879458795,
            "defect_f1": 0.9587945879458795,
            "defect_tp": 1559,
            "defect_fp": 67,
            "defect_tn": 1583,
            "defect_fn": 67,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.001_s40_20251207_203758",
    "lr": 0.001,
    "weight_decay": 0.001,
    "seed": 40,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9556902243047389,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.001_s40_20251207_203758",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s40_20251207_203758",
      "timestamp": "2025-12-07T20:39:54.222801",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.001_s40",
          "seed": 40,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s40_20251207_203758"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9555929571137092,
        "recall_macro": 0.9558276810087869,
        "f1_macro": 0.9556902243047389,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.961217183770883,
        "no_defect_recall": 0.9526907155529273,
        "no_defect_f1": 0.9569349569349569,
        "no_defect_tp": 1611,
        "no_defect_fp": 65,
        "no_defect_tn": 1519,
        "no_defect_fn": 80,
        "no_defect_support": 1691,
        "defect_precision": 0.9499687304565353,
        "defect_recall": 0.9589646464646465,
        "defect_f1": 0.9544454916745209,
        "defect_tp": 1519,
        "defect_fp": 80,
        "defect_tn": 1611,
        "defect_fn": 65,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.962207273573201,
        "recall_macro": 0.9621156211562116,
        "f1_macro": 0.9621438686568633,
        "precision_micro": 0.9621489621489622,
        "recall_micro": 0.9621489621489622,
        "f1_micro": 0.9621489621489622,
        "accuracy": 0.9621489621489622,
        "hamming_loss": 0.03785103785103785,
        "no_defect_precision": 0.9585336538461539,
        "no_defect_recall": 0.9666666666666667,
        "no_defect_f1": 0.9625829812914907,
        "no_defect_tp": 1595,
        "no_defect_fp": 69,
        "no_defect_tn": 1557,
        "no_defect_fn": 55,
        "no_defect_support": 1650,
        "defect_precision": 0.9658808933002482,
        "defect_recall": 0.9575645756457565,
        "defect_f1": 0.9617047560222359,
        "defect_tp": 1557,
        "defect_fp": 55,
        "defect_tn": 1595,
        "defect_fn": 69,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.616692041253445,
          0.4125119128486601,
          0.29169178738504276,
          0.24256261310318025,
          0.21512204804555143,
          0.20605514388702903,
          0.19387631040362632,
          0.19029386403919762,
          0.18813398464828354,
          0.1807288659042893,
          0.18555104539234768,
          0.17817420359685332,
          0.18072093521326654,
          0.1822951571961327,
          0.18170381038134067
        ],
        "val_loss": [
          0.5666595066969211,
          0.3478352645268807,
          0.25291409658697933,
          0.21390748052642897,
          0.1889108018233226,
          0.17413249053061008,
          0.16573434982162255,
          0.15888185211672232,
          0.15169100993527815,
          0.1515072942353212,
          0.14612236905556458,
          0.1446558996461905,
          0.1432973136408971,
          0.14273433745480502,
          0.14273319063851467
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8496576771688993,
            "recall_macro": 0.8334406677657713,
            "f1_macro": 0.8340401751357445,
            "precision_micro": 0.8366412213740458,
            "recall_micro": 0.8366412213740458,
            "f1_micro": 0.8366412213740458,
            "accuracy": 0.8366412213740458,
            "hamming_loss": 0.1633587786259542,
            "no_defect_precision": 0.7898696088264794,
            "no_defect_recall": 0.9314015375517445,
            "no_defect_f1": 0.8548168249660787,
            "no_defect_tp": 1575,
            "no_defect_fp": 419,
            "no_defect_tn": 1165,
            "no_defect_fn": 116,
            "no_defect_support": 1691,
            "defect_precision": 0.9094457455113193,
            "defect_recall": 0.735479797979798,
            "defect_f1": 0.8132635253054101,
            "defect_tp": 1165,
            "defect_fp": 116,
            "defect_tn": 1575,
            "defect_fn": 419,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9003757146828575,
            "recall_macro": 0.8968077433112915,
            "f1_macro": 0.8975655464382009,
            "precision_micro": 0.8980152671755726,
            "recall_micro": 0.8980152671755726,
            "f1_micro": 0.8980152671755726,
            "accuracy": 0.8980152671755726,
            "hamming_loss": 0.10198473282442748,
            "no_defect_precision": 0.8767351471404775,
            "no_defect_recall": 0.9337670017740982,
            "no_defect_f1": 0.9043528064146621,
            "no_defect_tp": 1579,
            "no_defect_fp": 222,
            "no_defect_tn": 1362,
            "no_defect_fn": 112,
            "no_defect_support": 1691,
            "defect_precision": 0.9240162822252375,
            "defect_recall": 0.8598484848484849,
            "defect_f1": 0.8907782864617397,
            "defect_tp": 1362,
            "defect_fp": 112,
            "defect_tn": 1579,
            "defect_fn": 222,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.929515331910592,
            "recall_macro": 0.9282895856853575,
            "f1_macro": 0.9286931695798516,
            "precision_micro": 0.9288549618320611,
            "recall_micro": 0.9288549618320611,
            "f1_micro": 0.9288549618320611,
            "accuracy": 0.9288549618320611,
            "hamming_loss": 0.07114503816793893,
            "no_defect_precision": 0.9189655172413793,
            "no_defect_recall": 0.9455943228858663,
            "no_defect_f1": 0.9320897697464297,
            "no_defect_tp": 1599,
            "no_defect_fp": 141,
            "no_defect_tn": 1443,
            "no_defect_fn": 92,
            "no_defect_support": 1691,
            "defect_precision": 0.9400651465798046,
            "defect_recall": 0.9109848484848485,
            "defect_f1": 0.9252965694132735,
            "defect_tp": 1443,
            "defect_fp": 92,
            "defect_tn": 1599,
            "defect_fn": 141,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9415454558345766,
            "recall_macro": 0.9417468968215568,
            "f1_macro": 0.9416313039288167,
            "precision_micro": 0.9416793893129771,
            "recall_micro": 0.9416793893129771,
            "f1_micro": 0.9416793893129771,
            "accuracy": 0.9416793893129771,
            "hamming_loss": 0.0583206106870229,
            "no_defect_precision": 0.9469606674612634,
            "no_defect_recall": 0.9396806623299823,
            "no_defect_f1": 0.9433066191748293,
            "no_defect_tp": 1589,
            "no_defect_fp": 89,
            "no_defect_tn": 1495,
            "no_defect_fn": 102,
            "no_defect_support": 1691,
            "defect_precision": 0.9361302442078898,
            "defect_recall": 0.9438131313131313,
            "defect_f1": 0.9399559886828042,
            "defect_tp": 1495,
            "defect_fp": 102,
            "defect_tn": 1589,
            "defect_fn": 89,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9468666468001012,
            "recall_macro": 0.946753534756196,
            "f1_macro": 0.9468069019129912,
            "precision_micro": 0.9468702290076336,
            "recall_micro": 0.9468702290076336,
            "f1_micro": 0.9468702290076336,
            "accuracy": 0.9468702290076336,
            "hamming_loss": 0.05312977099236641,
            "no_defect_precision": 0.9469652327637006,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.948642266824085,
            "no_defect_tp": 1607,
            "no_defect_fp": 90,
            "no_defect_tn": 1494,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9467680608365019,
            "defect_recall": 0.9431818181818182,
            "defect_f1": 0.9449715370018975,
            "defect_tp": 1494,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 90,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9480526269020276,
            "recall_macro": 0.9480161610188222,
            "f1_macro": 0.948034039267692,
            "precision_micro": 0.9480916030534351,
            "recall_micro": 0.9480916030534351,
            "f1_micro": 0.9480916030534351,
            "accuracy": 0.9480916030534351,
            "hamming_loss": 0.051908396946564885,
            "no_defect_precision": 0.9492025989367986,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9497635933806147,
            "no_defect_tp": 1607,
            "no_defect_fp": 86,
            "no_defect_tn": 1498,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9469026548672567,
            "defect_recall": 0.9457070707070707,
            "defect_f1": 0.9463044851547694,
            "defect_tp": 1498,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 86,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9516184701492538,
            "recall_macro": 0.9518639604202881,
            "f1_macro": 0.9517184481528259,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.9576119402985075,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9530600118835413,
            "no_defect_tp": 1604,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.945625,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.9503768844221105,
            "defect_tp": 1513,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537462749153509,
            "recall_macro": 0.954073556379884,
            "f1_macro": 0.9538627777644572,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9616306954436451,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9550461446859184,
            "no_defect_tp": 1604,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9458618543870566,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9526794108429959,
            "defect_tp": 1520,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9541338995667388,
            "recall_macro": 0.9541695040290545,
            "f1_macro": 0.9541513448938831,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9561870929544108,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9556213017751479,
            "no_defect_tp": 1615,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9520807061790668,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9526813880126183,
            "defect_tp": 1510,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9534467374948431,
            "recall_macro": 0.9538377939656768,
            "f1_macro": 0.9535621159406013,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.963275135460566,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.954653937947494,
            "no_defect_tp": 1600,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9436183395291202,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9524702939337085,
            "defect_tp": 1523,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9547063152960286,
            "recall_macro": 0.9548407642360924,
            "f1_macro": 0.9547678274671179,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.958407605466429,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9561351511558981,
            "no_defect_tp": 1613,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9510050251256281,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9534005037783375,
            "defect_tp": 1514,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555929571137092,
            "recall_macro": 0.9558276810087869,
            "f1_macro": 0.9556902243047389,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.961217183770883,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9569349569349569,
            "no_defect_tp": 1611,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9499687304565353,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9544454916745209,
            "defect_tp": 1519,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549970144797731,
            "recall_macro": 0.9551763943396114,
            "f1_macro": 0.9550759027580974,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9595238095238096,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9563927617917531,
            "no_defect_tp": 1612,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9504702194357367,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9537590437244416,
            "defect_tp": 1516,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556287146672718,
            "recall_macro": 0.9557477868573374,
            "f1_macro": 0.9556838728492272,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9590261282660333,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.957037037037037,
            "no_defect_tp": 1615,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9522313010685104,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9543307086614173,
            "defect_tp": 1515,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556177330517805,
            "recall_macro": 0.9557677603951997,
            "f1_macro": 0.9556855105080515,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9595719381688466,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9570115624073525,
            "no_defect_tp": 1614,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9516635279347144,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9543594586087504,
            "defect_tp": 1516,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 68,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.962207273573201,
            "recall_macro": 0.9621156211562116,
            "f1_macro": 0.9621438686568633,
            "precision_micro": 0.9621489621489622,
            "recall_micro": 0.9621489621489622,
            "f1_micro": 0.9621489621489622,
            "accuracy": 0.9621489621489622,
            "hamming_loss": 0.03785103785103785,
            "no_defect_precision": 0.9585336538461539,
            "no_defect_recall": 0.9666666666666667,
            "no_defect_f1": 0.9625829812914907,
            "no_defect_tp": 1595,
            "no_defect_fp": 69,
            "no_defect_tn": 1557,
            "no_defect_fn": 55,
            "no_defect_support": 1650,
            "defect_precision": 0.9658808933002482,
            "defect_recall": 0.9575645756457565,
            "defect_f1": 0.9617047560222359,
            "defect_tp": 1557,
            "defect_fp": 55,
            "defect_tn": 1595,
            "defect_fn": 69,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.001_s50_20251207_204052",
    "lr": 0.001,
    "weight_decay": 0.001,
    "seed": 50,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9556886862286829,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.001_s50_20251207_204052",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s50_20251207_204052",
      "timestamp": "2025-12-07T20:42:49.641650",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 15,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.001_s50",
          "seed": 50,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s50_20251207_204052"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9555998546141715,
        "recall_macro": 0.9558077074709246,
        "f1_macro": 0.9556886862286829,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.9606674612634089,
        "no_defect_recall": 0.9532820816085157,
        "no_defect_f1": 0.9569605224102108,
        "no_defect_tp": 1612,
        "no_defect_fp": 66,
        "no_defect_tn": 1518,
        "no_defect_fn": 79,
        "no_defect_support": 1691,
        "defect_precision": 0.9505322479649343,
        "defect_recall": 0.9583333333333334,
        "defect_f1": 0.9544168500471549,
        "defect_tp": 1518,
        "defect_fp": 79,
        "defect_tn": 1612,
        "defect_fn": 66,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9612448770014407,
        "recall_macro": 0.961219948563122,
        "f1_macro": 0.9612301731331656,
        "precision_micro": 0.9612332112332113,
        "recall_micro": 0.9612332112332113,
        "f1_micro": 0.9612332112332113,
        "accuracy": 0.9612332112332113,
        "hamming_loss": 0.03876678876678877,
        "no_defect_precision": 0.9601208459214502,
        "no_defect_recall": 0.963030303030303,
        "no_defect_f1": 0.9615733736762481,
        "no_defect_tp": 1589,
        "no_defect_fp": 66,
        "no_defect_tn": 1560,
        "no_defect_fn": 61,
        "no_defect_support": 1650,
        "defect_precision": 0.9623689080814312,
        "defect_recall": 0.959409594095941,
        "defect_f1": 0.9608869725900832,
        "defect_tp": 1560,
        "defect_fp": 61,
        "defect_tn": 1589,
        "defect_fn": 66,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6095932420327573,
          0.40835814483494937,
          0.28929938294897517,
          0.241645598199577,
          0.21538875810022634,
          0.2087521173652246,
          0.19980934031588263,
          0.1902651014624779,
          0.18835093782411957,
          0.1869753949874116,
          0.1864950714874467,
          0.18132913240453688,
          0.1805257872993976,
          0.17851616448438318,
          0.18217245997494733
        ],
        "val_loss": [
          0.5647420653930078,
          0.34707855719786423,
          0.2507070073714623,
          0.215420715797406,
          0.18993376510647628,
          0.17359695225380933,
          0.16369007112315068,
          0.15490234843813455,
          0.15130310519956625,
          0.1480437729221124,
          0.146480280905962,
          0.1447563419261804,
          0.14364170010846394,
          0.1431748614861415,
          0.1430723790365916
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.857268352303109,
            "recall_macro": 0.8387429887282045,
            "f1_macro": 0.8393682597734027,
            "precision_micro": 0.8421374045801526,
            "recall_micro": 0.8421374045801526,
            "f1_micro": 0.8421374045801526,
            "accuracy": 0.8421374045801526,
            "hamming_loss": 0.15786259541984732,
            "no_defect_precision": 0.791459781529295,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.8604588394062078,
            "no_defect_tp": 1594,
            "no_defect_fp": 420,
            "no_defect_tn": 1164,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.9230769230769231,
            "defect_recall": 0.7348484848484849,
            "defect_f1": 0.8182776801405975,
            "defect_tp": 1164,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 420,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9044320910620758,
            "recall_macro": 0.8992691551828157,
            "f1_macro": 0.9002002698706596,
            "precision_micro": 0.9007633587786259,
            "recall_micro": 0.9007633587786259,
            "f1_micro": 0.9007633587786259,
            "accuracy": 0.9007633587786259,
            "hamming_loss": 0.09923664122137404,
            "no_defect_precision": 0.8732240437158469,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.9076966770803749,
            "no_defect_tp": 1598,
            "no_defect_fp": 232,
            "no_defect_tn": 1352,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.9356401384083045,
            "defect_recall": 0.8535353535353535,
            "defect_f1": 0.8927038626609443,
            "defect_tp": 1352,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 232,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9313234570151566,
            "recall_macro": 0.9311144412785454,
            "f1_macro": 0.9312084047155536,
            "precision_micro": 0.9312977099236641,
            "recall_micro": 0.9312977099236641,
            "f1_micro": 0.9312977099236641,
            "accuracy": 0.9312977099236641,
            "hamming_loss": 0.06870229007633588,
            "no_defect_precision": 0.9306698002350177,
            "no_defect_recall": 0.9367238320520402,
            "no_defect_f1": 0.9336870026525199,
            "no_defect_tp": 1584,
            "no_defect_fp": 118,
            "no_defect_tn": 1466,
            "no_defect_fn": 107,
            "no_defect_support": 1691,
            "defect_precision": 0.9319771137952956,
            "defect_recall": 0.9255050505050505,
            "defect_f1": 0.9287298067785873,
            "defect_tp": 1466,
            "defect_fp": 107,
            "defect_tn": 1584,
            "defect_fn": 118,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9394267270284644,
            "recall_macro": 0.9398568774677586,
            "f1_macro": 0.9395151360935089,
            "precision_micro": 0.9395419847328245,
            "recall_micro": 0.9395419847328245,
            "f1_micro": 0.9395419847328245,
            "accuracy": 0.9395419847328245,
            "hamming_loss": 0.06045801526717557,
            "no_defect_precision": 0.9516031457955233,
            "no_defect_recall": 0.9302188054405677,
            "no_defect_f1": 0.9407894736842105,
            "no_defect_tp": 1573,
            "no_defect_fp": 80,
            "no_defect_tn": 1504,
            "no_defect_fn": 118,
            "no_defect_support": 1691,
            "defect_precision": 0.9272503082614056,
            "defect_recall": 0.9494949494949495,
            "defect_f1": 0.9382407985028073,
            "defect_tp": 1504,
            "defect_fp": 118,
            "defect_tn": 1573,
            "defect_fn": 80,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9439834860988595,
            "recall_macro": 0.9442122287332222,
            "f1_macro": 0.9440780072259809,
            "precision_micro": 0.9441221374045802,
            "recall_micro": 0.9441221374045802,
            "f1_micro": 0.9441221374045802,
            "accuracy": 0.9441221374045802,
            "hamming_loss": 0.055877862595419846,
            "no_defect_precision": 0.9498806682577565,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9456489456489456,
            "no_defect_tp": 1592,
            "no_defect_fp": 84,
            "no_defect_tn": 1500,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.9380863039399625,
            "defect_recall": 0.946969696969697,
            "defect_f1": 0.942507068803016,
            "defect_tp": 1500,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 84,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.94858224807314,
            "recall_macro": 0.9481320822058551,
            "f1_macro": 0.9483179993801615,
            "precision_micro": 0.9483969465648855,
            "recall_micro": 0.9483969465648855,
            "f1_micro": 0.9483969465648855,
            "accuracy": 0.9483969465648855,
            "hamming_loss": 0.0516030534351145,
            "no_defect_precision": 0.9445093457943925,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9503379371143109,
            "no_defect_tp": 1617,
            "no_defect_fp": 95,
            "no_defect_tn": 1489,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9526551503518874,
            "defect_recall": 0.9400252525252525,
            "defect_f1": 0.946298061646012,
            "defect_tp": 1489,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 95,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9516505208753214,
            "recall_macro": 0.9517840662688386,
            "f1_macro": 0.9517115995932744,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.9554367201426025,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9531713100177831,
            "no_defect_tp": 1608,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9478643216080402,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9502518891687658,
            "defect_tp": 1509,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543514277579369,
            "recall_macro": 0.9539697686504309,
            "f1_macro": 0.9541316526610644,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9508484493856056,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9558823529411765,
            "no_defect_tp": 1625,
            "no_defect_fp": 84,
            "no_defect_tn": 1500,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9578544061302682,
            "defect_recall": 0.946969696969697,
            "defect_f1": 0.9523809523809523,
            "defect_tp": 1500,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 84,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9547779097839472,
            "recall_macro": 0.9547408965467806,
            "f1_macro": 0.9547590459506966,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9556999409332546,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9562647754137116,
            "no_defect_tp": 1618,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9538558786346397,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9532533164876816,
            "defect_tp": 1509,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9535226078990455,
            "recall_macro": 0.9535581644356038,
            "f1_macro": 0.9535400294924683,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.955595026642984,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9550295857988166,
            "no_defect_tp": 1614,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9514501891551072,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9520504731861199,
            "defect_tp": 1509,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546652518912175,
            "recall_macro": 0.9549606054632667,
            "f1_macro": 0.9547772469186576,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9616995810891682,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9559785841760856,
            "no_defect_tp": 1607,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9476309226932669,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9535759096612296,
            "defect_tp": 1520,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540543091702223,
            "recall_macro": 0.9543492658698158,
            "f1_macro": 0.9541661286337746,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9611011370436864,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9553837001784652,
            "no_defect_tp": 1606,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9470074812967582,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9529485570890841,
            "defect_tp": 1519,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954981932323454,
            "recall_macro": 0.9552163414153361,
            "f1_macro": 0.9550790549848043,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9606205250596659,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9563409563409564,
            "no_defect_tp": 1610,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.949343339587242,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9538171536286523,
            "defect_tp": 1518,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552907144664282,
            "recall_macro": 0.9555120244431303,
            "f1_macro": 0.9553838694795995,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.960644007155635,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9566508313539193,
            "no_defect_tp": 1611,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9499374217772215,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9541169076052797,
            "defect_tp": 1518,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555998546141715,
            "recall_macro": 0.9558077074709246,
            "f1_macro": 0.9556886862286829,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9606674612634089,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9569605224102108,
            "no_defect_tp": 1612,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505322479649343,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9544168500471549,
            "defect_tp": 1518,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 66,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9612448770014407,
            "recall_macro": 0.961219948563122,
            "f1_macro": 0.9612301731331656,
            "precision_micro": 0.9612332112332113,
            "recall_micro": 0.9612332112332113,
            "f1_micro": 0.9612332112332113,
            "accuracy": 0.9612332112332113,
            "hamming_loss": 0.03876678876678877,
            "no_defect_precision": 0.9601208459214502,
            "no_defect_recall": 0.963030303030303,
            "no_defect_f1": 0.9615733736762481,
            "no_defect_tp": 1589,
            "no_defect_fp": 66,
            "no_defect_tn": 1560,
            "no_defect_fn": 61,
            "no_defect_support": 1650,
            "defect_precision": 0.9623689080814312,
            "defect_recall": 0.959409594095941,
            "defect_f1": 0.9608869725900832,
            "defect_tp": 1560,
            "defect_fp": 61,
            "defect_tn": 1589,
            "defect_fn": 66,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.001_s60_20251207_185831",
    "lr": 0.001,
    "weight_decay": 0.001,
    "seed": 60,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9556987562067221,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.001_s60_20251207_185831",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s60_20251207_185831",
      "timestamp": "2025-12-07T19:00:29.528930",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.001_s60",
          "seed": 60,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s60_20251207_185831"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9555801386501457,
        "recall_macro": 0.955947522235961,
        "f1_macro": 0.9556987562067221,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.9645432692307693,
        "no_defect_recall": 0.9491425192193969,
        "no_defect_f1": 0.9567809239940388,
        "no_defect_tp": 1605,
        "no_defect_fp": 59,
        "no_defect_tn": 1525,
        "no_defect_fn": 86,
        "no_defect_support": 1691,
        "defect_precision": 0.946617008069522,
        "defect_recall": 0.9627525252525253,
        "defect_f1": 0.9546165884194053,
        "defect_tp": 1525,
        "defect_fp": 86,
        "defect_tn": 1605,
        "defect_fn": 59,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9597047970479704,
        "recall_macro": 0.9597047970479704,
        "f1_macro": 0.9597047970479704,
        "precision_micro": 0.9597069597069597,
        "recall_micro": 0.9597069597069597,
        "f1_micro": 0.9597069597069597,
        "accuracy": 0.9597069597069597,
        "hamming_loss": 0.040293040293040296,
        "no_defect_precision": 0.96,
        "no_defect_recall": 0.96,
        "no_defect_f1": 0.96,
        "no_defect_tp": 1584,
        "no_defect_fp": 66,
        "no_defect_tn": 1560,
        "no_defect_fn": 66,
        "no_defect_support": 1650,
        "defect_precision": 0.959409594095941,
        "defect_recall": 0.959409594095941,
        "defect_f1": 0.959409594095941,
        "defect_tp": 1560,
        "defect_fp": 66,
        "defect_tn": 1584,
        "defect_fn": 66,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6184099827850215,
          0.4173517301990397,
          0.29186519631282054,
          0.23845372975620766,
          0.21679785009083888,
          0.20271725341615318,
          0.19592192332614913,
          0.19053766913867895,
          0.18797252096516318,
          0.18491376471943435,
          0.18634985882991528,
          0.17933357612981957,
          0.18081018540649732,
          0.1810350855773463,
          0.18107618379044232
        ],
        "val_loss": [
          0.569600733426901,
          0.3493716659454199,
          0.25123149471787304,
          0.21441463381052017,
          0.18925008836847085,
          0.1741040162742138,
          0.16315975226461887,
          0.15560209951721704,
          0.15136361337051943,
          0.1506653634401468,
          0.1467317511829046,
          0.14565611645006216,
          0.14395342108148795,
          0.1431924355431245,
          0.14334772871090815
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8483273819041021,
            "recall_macro": 0.8367209946896523,
            "f1_macro": 0.8374578795445555,
            "precision_micro": 0.8393893129770993,
            "recall_micro": 0.8393893129770993,
            "f1_micro": 0.8393893129770993,
            "accuracy": 0.8393893129770993,
            "hamming_loss": 0.16061068702290077,
            "no_defect_precision": 0.8001030396702731,
            "no_defect_recall": 0.9183914843287996,
            "no_defect_f1": 0.8551762114537445,
            "no_defect_tp": 1553,
            "no_defect_fp": 388,
            "no_defect_tn": 1196,
            "no_defect_fn": 138,
            "no_defect_support": 1691,
            "defect_precision": 0.896551724137931,
            "defect_recall": 0.7550505050505051,
            "defect_f1": 0.8197395476353667,
            "defect_tp": 1196,
            "defect_fp": 138,
            "defect_tn": 1553,
            "defect_fn": 388,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9035739401359192,
            "recall_macro": 0.9002200449199267,
            "f1_macro": 0.9009590306086288,
            "precision_micro": 0.9013740458015267,
            "recall_micro": 0.9013740458015267,
            "f1_micro": 0.9013740458015267,
            "accuracy": 0.9013740458015267,
            "hamming_loss": 0.09862595419847328,
            "no_defect_precision": 0.8808463251670379,
            "no_defect_recall": 0.9355410999408634,
            "no_defect_f1": 0.9073702322913679,
            "no_defect_tp": 1582,
            "no_defect_fp": 214,
            "no_defect_tn": 1370,
            "no_defect_fn": 109,
            "no_defect_support": 1691,
            "defect_precision": 0.9263015551048005,
            "defect_recall": 0.86489898989899,
            "defect_f1": 0.8945478289258897,
            "defect_tp": 1370,
            "defect_fp": 109,
            "defect_tn": 1582,
            "defect_fn": 214,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9342763185931218,
            "recall_macro": 0.9337156679151062,
            "f1_macro": 0.9339368483337965,
            "precision_micro": 0.9340458015267176,
            "recall_micro": 0.9340458015267176,
            "f1_micro": 0.9340458015267176,
            "accuracy": 0.9340458015267176,
            "hamming_loss": 0.06595419847328245,
            "no_defect_precision": 0.9295282469423413,
            "no_defect_recall": 0.9438202247191011,
            "no_defect_f1": 0.9366197183098591,
            "no_defect_tp": 1596,
            "no_defect_fp": 121,
            "no_defect_tn": 1463,
            "no_defect_fn": 95,
            "no_defect_support": 1691,
            "defect_precision": 0.9390243902439024,
            "defect_recall": 0.9236111111111112,
            "defect_f1": 0.9312539783577339,
            "defect_tp": 1463,
            "defect_fp": 95,
            "defect_tn": 1596,
            "defect_fn": 121,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9394175897952333,
            "recall_macro": 0.9398369039298962,
            "f1_macro": 0.9395135563510346,
            "precision_micro": 0.9395419847328245,
            "recall_micro": 0.9395419847328245,
            "f1_micro": 0.9395419847328245,
            "accuracy": 0.9395419847328245,
            "hamming_loss": 0.06045801526717557,
            "no_defect_precision": 0.9510574018126888,
            "no_defect_recall": 0.9308101714961561,
            "no_defect_f1": 0.9408248655110579,
            "no_defect_tp": 1574,
            "no_defect_fp": 81,
            "no_defect_tn": 1503,
            "no_defect_fn": 117,
            "no_defect_support": 1691,
            "defect_precision": 0.9277777777777778,
            "defect_recall": 0.9488636363636364,
            "defect_f1": 0.9382022471910112,
            "defect_tp": 1503,
            "defect_fp": 117,
            "defect_tn": 1574,
            "defect_fn": 81,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9471114180650702,
            "recall_macro": 0.9471291119354396,
            "f1_macro": 0.9471201764281658,
            "precision_micro": 0.947175572519084,
            "recall_micro": 0.947175572519084,
            "f1_micro": 0.947175572519084,
            "accuracy": 0.947175572519084,
            "hamming_loss": 0.05282442748091603,
            "no_defect_precision": 0.9491124260355029,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9488317065956817,
            "no_defect_tp": 1604,
            "no_defect_fp": 86,
            "no_defect_tn": 1498,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9451104100946373,
            "defect_recall": 0.9457070707070707,
            "defect_f1": 0.94540864626065,
            "defect_tp": 1498,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 86,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9504395050669056,
            "recall_macro": 0.9505414135440747,
            "f1_macro": 0.9504872602334729,
            "precision_micro": 0.9505343511450381,
            "recall_micro": 0.9505343511450381,
            "f1_micro": 0.9505343511450381,
            "accuracy": 0.9505343511450381,
            "hamming_loss": 0.04946564885496183,
            "no_defect_precision": 0.9537091988130564,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9520142180094787,
            "no_defect_tp": 1607,
            "no_defect_fp": 78,
            "no_defect_tn": 1506,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9471698113207547,
            "defect_recall": 0.9507575757575758,
            "defect_f1": 0.9489603024574669,
            "defect_tp": 1506,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 78,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.951584121570626,
            "recall_macro": 0.9512287272488337,
            "f1_macro": 0.9513806821858204,
            "precision_micro": 0.9514503816793893,
            "recall_micro": 0.9514503816793893,
            "f1_micro": 0.9514503816793893,
            "accuracy": 0.9514503816793893,
            "hamming_loss": 0.04854961832061069,
            "no_defect_precision": 0.9484777517564403,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9532215357458076,
            "no_defect_tp": 1620,
            "no_defect_fp": 88,
            "no_defect_tn": 1496,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9546904913848118,
            "defect_recall": 0.9444444444444444,
            "defect_f1": 0.9495398286258331,
            "defect_tp": 1496,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 88,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9535226078990455,
            "recall_macro": 0.9535581644356038,
            "f1_macro": 0.9535400294924683,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.955595026642984,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9550295857988166,
            "no_defect_tp": 1614,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9514501891551072,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9520504731861199,
            "defect_tp": 1509,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.953774817136886,
            "recall_macro": 0.9539537151527098,
            "f1_macro": 0.9538534783433518,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9583333333333334,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9552061702758825,
            "no_defect_tp": 1610,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9492163009404389,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.952500786410821,
            "defect_tp": 1514,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546650273281119,
            "recall_macro": 0.9550404996147162,
            "f1_macro": 0.9547828494622452,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9639206253758268,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9558735837805605,
            "no_defect_tp": 1603,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9454094292803971,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9536921151439299,
            "defect_tp": 1524,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552761946122128,
            "recall_macro": 0.9555719450567174,
            "f1_macro": 0.9553883652035406,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9622980251346499,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9565734681737061,
            "no_defect_tp": 1608,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9482543640897756,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9542032622333751,
            "defect_tp": 1521,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555801386501457,
            "recall_macro": 0.955947522235961,
            "f1_macro": 0.9556987562067221,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9645432692307693,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9567809239940388,
            "no_defect_tp": 1605,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.946617008069522,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9546165884194053,
            "defect_tp": 1525,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549722858157701,
            "recall_macro": 0.9552562884910608,
            "f1_macro": 0.9550820726596982,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9617224880382775,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9562890276538805,
            "no_defect_tp": 1608,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9482220835932627,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9538751176655161,
            "defect_tp": 1520,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552845149253731,
            "recall_macro": 0.9555319979809926,
            "f1_macro": 0.9553854014576746,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9611940298507463,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9566250742721331,
            "no_defect_tp": 1610,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.949375,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9541457286432161,
            "defect_tp": 1519,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549764297552978,
            "recall_macro": 0.9552363149531985,
            "f1_macro": 0.9550805806377872,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9611708482676224,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9563150074294205,
            "no_defect_tp": 1609,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9487820112429731,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9538461538461539,
            "defect_tp": 1519,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 65,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9597047970479704,
            "recall_macro": 0.9597047970479704,
            "f1_macro": 0.9597047970479704,
            "precision_micro": 0.9597069597069597,
            "recall_micro": 0.9597069597069597,
            "f1_micro": 0.9597069597069597,
            "accuracy": 0.9597069597069597,
            "hamming_loss": 0.040293040293040296,
            "no_defect_precision": 0.96,
            "no_defect_recall": 0.96,
            "no_defect_f1": 0.96,
            "no_defect_tp": 1584,
            "no_defect_fp": 66,
            "no_defect_tn": 1560,
            "no_defect_fn": 66,
            "no_defect_support": 1650,
            "defect_precision": 0.959409594095941,
            "defect_recall": 0.959409594095941,
            "defect_f1": 0.959409594095941,
            "defect_tp": 1560,
            "defect_fp": 66,
            "defect_tn": 1584,
            "defect_fn": 66,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.001_s70_20251207_210633",
    "lr": 0.001,
    "weight_decay": 0.001,
    "seed": 70,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.954469432075036,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.001_s70_20251207_210633",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s70_20251207_210633",
      "timestamp": "2025-12-07T21:08:30.620034",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 15,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.001_s70",
          "seed": 70,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s70_20251207_210633"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.954365439163247,
        "recall_macro": 0.9546249753597478,
        "f1_macro": 0.954469432075036,
        "precision_micro": 0.9545038167938932,
        "recall_micro": 0.9545038167938932,
        "f1_micro": 0.9545038167938932,
        "accuracy": 0.9545038167938932,
        "hamming_loss": 0.04549618320610687,
        "no_defect_precision": 0.9605734767025089,
        "no_defect_recall": 0.9509166173861621,
        "no_defect_f1": 0.9557206537890045,
        "no_defect_tp": 1608,
        "no_defect_fp": 66,
        "no_defect_tn": 1518,
        "no_defect_fn": 83,
        "no_defect_support": 1691,
        "defect_precision": 0.948157401623985,
        "defect_recall": 0.9583333333333334,
        "defect_f1": 0.9532182103610675,
        "defect_tp": 1518,
        "defect_fp": 83,
        "defect_tn": 1608,
        "defect_fn": 66,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9606188847014991,
        "recall_macro": 0.9606228335010623,
        "f1_macro": 0.9606207695799163,
        "precision_micro": 0.9606227106227107,
        "recall_micro": 0.9606227106227107,
        "f1_micro": 0.9606227106227107,
        "accuracy": 0.9606227106227107,
        "hamming_loss": 0.039377289377289376,
        "no_defect_precision": 0.9611885991510006,
        "no_defect_recall": 0.9606060606060606,
        "no_defect_f1": 0.9608972415883601,
        "no_defect_tp": 1585,
        "no_defect_fp": 64,
        "no_defect_tn": 1562,
        "no_defect_fn": 65,
        "no_defect_support": 1650,
        "defect_precision": 0.9600491702519975,
        "defect_recall": 0.9606396063960639,
        "defect_f1": 0.9603442975714724,
        "defect_tp": 1562,
        "defect_fp": 65,
        "defect_tn": 1585,
        "defect_fn": 64,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6164124660412138,
          0.4083046031546892,
          0.28914629646175577,
          0.23776971277582096,
          0.2180917203488709,
          0.20527939750933746,
          0.19181753108940364,
          0.190610286019836,
          0.19441211317124227,
          0.18723464317650976,
          0.17952019789852358,
          0.18247176865778209,
          0.1846994073071739,
          0.17598671357003215,
          0.1797453239871867
        ],
        "val_loss": [
          0.5677176140821897,
          0.34771034923883587,
          0.2513645173838505,
          0.2111135357274459,
          0.18921184912323952,
          0.1742755647462148,
          0.1663065329194069,
          0.1558330554801684,
          0.15404378895003062,
          0.14696742064104631,
          0.1450070241609445,
          0.14392776214159453,
          0.14402296480077964,
          0.14347019591010535,
          0.14331951895012304
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8476297494905909,
            "recall_macro": 0.8248341263014534,
            "f1_macro": 0.8250055790767336,
            "precision_micro": 0.8287022900763359,
            "recall_micro": 0.8287022900763359,
            "f1_micro": 0.8287022900763359,
            "accuracy": 0.8287022900763359,
            "hamming_loss": 0.1712977099236641,
            "no_defect_precision": 0.7742718446601942,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.8504398826979472,
            "no_defect_tp": 1595,
            "no_defect_fp": 465,
            "no_defect_tn": 1119,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9209876543209876,
            "defect_recall": 0.7064393939393939,
            "defect_f1": 0.7995712754555199,
            "defect_tp": 1119,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 465,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.8994071165816153,
            "recall_macro": 0.8914936622284346,
            "f1_macro": 0.8925929319340977,
            "precision_micro": 0.8934351145038167,
            "recall_micro": 0.8934351145038167,
            "f1_micro": 0.8934351145038167,
            "accuracy": 0.8934351145038167,
            "hamming_loss": 0.1065648854961832,
            "no_defect_precision": 0.8580576307363927,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9021037868162692,
            "no_defect_tp": 1608,
            "no_defect_fp": 266,
            "no_defect_tn": 1318,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.940756602426838,
            "defect_recall": 0.8320707070707071,
            "defect_f1": 0.8830820770519263,
            "defect_tp": 1318,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 266,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9274298713071135,
            "recall_macro": 0.9270708265385972,
            "f1_macro": 0.9272222222222222,
            "precision_micro": 0.9273282442748092,
            "recall_micro": 0.9273282442748092,
            "f1_micro": 0.9273282442748092,
            "accuracy": 0.9273282442748092,
            "hamming_loss": 0.07267175572519084,
            "no_defect_precision": 0.92510239906378,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.93,
            "no_defect_tp": 1581,
            "no_defect_fp": 128,
            "no_defect_tn": 1456,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.929757343550447,
            "defect_recall": 0.9191919191919192,
            "defect_f1": 0.9244444444444444,
            "defect_tp": 1456,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 128,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9398250699033303,
            "recall_macro": 0.9397331162004432,
            "f1_macro": 0.9397768951807608,
            "precision_micro": 0.9398473282442749,
            "recall_micro": 0.9398473282442749,
            "f1_micro": 0.9398473282442749,
            "accuracy": 0.9398473282442749,
            "hamming_loss": 0.06015267175572519,
            "no_defect_precision": 0.9404481132075472,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9418364334219073,
            "no_defect_tp": 1595,
            "no_defect_fp": 101,
            "no_defect_tn": 1483,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9392020265991133,
            "defect_recall": 0.9362373737373737,
            "defect_f1": 0.9377173569396143,
            "defect_tp": 1483,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 101,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9476729344270004,
            "recall_macro": 0.9478203456803398,
            "f1_macro": 0.9477394641163918,
            "precision_micro": 0.9477862595419847,
            "recall_micro": 0.9477862595419847,
            "f1_micro": 0.9477862595419847,
            "accuracy": 0.9477862595419847,
            "hamming_loss": 0.052213740458015266,
            "no_defect_precision": 0.9518430439952438,
            "no_defect_recall": 0.9467770549970431,
            "no_defect_f1": 0.9493032908390158,
            "no_defect_tp": 1601,
            "no_defect_fp": 81,
            "no_defect_tn": 1503,
            "no_defect_fn": 90,
            "no_defect_support": 1691,
            "defect_precision": 0.943502824858757,
            "defect_recall": 0.9488636363636364,
            "defect_f1": 0.9461756373937678,
            "defect_tp": 1503,
            "defect_fp": 90,
            "defect_tn": 1601,
            "defect_fn": 81,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9510134164425866,
            "recall_macro": 0.9512326472889749,
            "f1_macro": 0.9511056103886022,
            "precision_micro": 0.9511450381679389,
            "recall_micro": 0.9511450381679389,
            "f1_micro": 0.9511450381679389,
            "accuracy": 0.9511450381679389,
            "hamming_loss": 0.04885496183206107,
            "no_defect_precision": 0.9564698867024448,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9524940617577197,
            "no_defect_tp": 1604,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9455569461827285,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.9497171590194846,
            "defect_tp": 1511,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9506917801166659,
            "recall_macro": 0.9510168584126302,
            "f1_macro": 0.9508073325832954,
            "precision_micro": 0.9508396946564885,
            "recall_micro": 0.9508396946564885,
            "f1_micro": 0.9508396946564885,
            "accuracy": 0.9508396946564885,
            "hamming_loss": 0.04916030534351145,
            "no_defect_precision": 0.9586330935251799,
            "no_defect_recall": 0.9455943228858663,
            "no_defect_f1": 0.9520690681750521,
            "no_defect_tp": 1599,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 92,
            "no_defect_support": 1691,
            "defect_precision": 0.9427504667081519,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9495455969915387,
            "defect_tp": 1515,
            "defect_fp": 92,
            "defect_tn": 1599,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537843179845236,
            "recall_macro": 0.9539337416148475,
            "f1_macro": 0.9538518074945915,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9577883472057075,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9552327305069671,
            "no_defect_tp": 1611,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9497802887633396,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.952470884482216,
            "defect_tp": 1513,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9531435338878735,
            "recall_macro": 0.9535421109378827,
            "f1_macro": 0.9532572706947644,
            "precision_micro": 0.9532824427480916,
            "recall_micro": 0.9532824427480916,
            "f1_micro": 0.9532824427480916,
            "accuracy": 0.9532824427480916,
            "hamming_loss": 0.0467175572519084,
            "no_defect_precision": 0.9632530120481928,
            "no_defect_recall": 0.9455943228858663,
            "no_defect_f1": 0.954341987466428,
            "no_defect_tp": 1599,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 92,
            "no_defect_support": 1691,
            "defect_precision": 0.9430340557275542,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.952172553923101,
            "defect_tp": 1523,
            "defect_fp": 92,
            "defect_tn": 1599,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9541338995667388,
            "recall_macro": 0.9541695040290545,
            "f1_macro": 0.9541513448938831,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9561870929544108,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9556213017751479,
            "no_defect_tp": 1615,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9520807061790668,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9526813880126183,
            "defect_tp": 1510,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537843179845236,
            "recall_macro": 0.9539337416148475,
            "f1_macro": 0.9538518074945915,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9577883472057075,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9552327305069671,
            "no_defect_tp": 1611,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9497802887633396,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.952470884482216,
            "defect_tp": 1513,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540686293167593,
            "recall_macro": 0.9542893452562288,
            "f1_macro": 0.9541615097393146,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9594514013118665,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9554631828978623,
            "no_defect_tp": 1609,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9486858573216521,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9528598365807668,
            "defect_tp": 1516,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537544485711962,
            "recall_macro": 0.9540136357662969,
            "f1_macro": 0.9538582835122849,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9599761051373955,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9551263001485885,
            "no_defect_tp": 1607,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9475327920049968,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9525902668759811,
            "defect_tp": 1517,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540577267059331,
            "recall_macro": 0.9543292923319535,
            "f1_macro": 0.9541646233185764,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9605499103407054,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.955410225921522,
            "no_defect_tp": 1607,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.947565543071161,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9529190207156308,
            "defect_tp": 1518,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954365439163247,
            "recall_macro": 0.9546249753597478,
            "f1_macro": 0.954469432075036,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9605734767025089,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9557206537890045,
            "no_defect_tp": 1608,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.948157401623985,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9532182103610675,
            "defect_tp": 1518,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 66,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9606188847014991,
            "recall_macro": 0.9606228335010623,
            "f1_macro": 0.9606207695799163,
            "precision_micro": 0.9606227106227107,
            "recall_micro": 0.9606227106227107,
            "f1_micro": 0.9606227106227107,
            "accuracy": 0.9606227106227107,
            "hamming_loss": 0.039377289377289376,
            "no_defect_precision": 0.9611885991510006,
            "no_defect_recall": 0.9606060606060606,
            "no_defect_f1": 0.9608972415883601,
            "no_defect_tp": 1585,
            "no_defect_fp": 64,
            "no_defect_tn": 1562,
            "no_defect_fn": 65,
            "no_defect_support": 1650,
            "defect_precision": 0.9600491702519975,
            "defect_recall": 0.9606396063960639,
            "defect_f1": 0.9603442975714724,
            "defect_tp": 1562,
            "defect_fp": 65,
            "defect_tn": 1585,
            "defect_fn": 64,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.001_s80_20251207_143049",
    "lr": 0.001,
    "weight_decay": 0.001,
    "seed": 80,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9550835310572297,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.001_s80_20251207_143049",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s80_20251207_143049",
      "timestamp": "2025-12-07T14:32:47.543836",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.001_s80",
          "seed": 80,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s80_20251207_143049"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9549695002518328,
        "recall_macro": 0.9552762620289232,
        "f1_macro": 0.9550835310572297,
        "precision_micro": 0.9551145038167939,
        "recall_micro": 0.9551145038167939,
        "f1_micro": 0.9551145038167939,
        "accuracy": 0.9551145038167939,
        "hamming_loss": 0.04488549618320611,
        "no_defect_precision": 0.9622754491017964,
        "no_defect_recall": 0.9503252513305737,
        "no_defect_f1": 0.9562630169592383,
        "no_defect_tp": 1607,
        "no_defect_fp": 63,
        "no_defect_tn": 1521,
        "no_defect_fn": 84,
        "no_defect_support": 1691,
        "defect_precision": 0.9476635514018692,
        "defect_recall": 0.9602272727272727,
        "defect_f1": 0.9539040451552211,
        "defect_tp": 1521,
        "defect_fp": 84,
        "defect_tn": 1607,
        "defect_fn": 63,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9606277948680101,
        "recall_macro": 0.9606138879570614,
        "f1_macro": 0.9606200356764563,
        "precision_micro": 0.9606227106227107,
        "recall_micro": 0.9606227106227107,
        "f1_micro": 0.9606227106227107,
        "accuracy": 0.9606227106227107,
        "hamming_loss": 0.039377289377289376,
        "no_defect_precision": 0.9600725952813067,
        "no_defect_recall": 0.9618181818181818,
        "no_defect_f1": 0.96094459582198,
        "no_defect_tp": 1587,
        "no_defect_fp": 66,
        "no_defect_tn": 1560,
        "no_defect_fn": 63,
        "no_defect_support": 1650,
        "defect_precision": 0.9611829944547134,
        "defect_recall": 0.959409594095941,
        "defect_f1": 0.9602954755309326,
        "defect_tp": 1560,
        "defect_fp": 63,
        "defect_tn": 1587,
        "defect_fn": 66,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6065823690163041,
          0.40432100415728583,
          0.2866906137770689,
          0.24286668757015692,
          0.22013791251506765,
          0.20552784553631578,
          0.19697587095419233,
          0.1904110127600167,
          0.18515308940136282,
          0.1844368172988732,
          0.18119521831867585,
          0.17683236943129216,
          0.18087851343419262,
          0.18073009668409076,
          0.17769594022918445
        ],
        "val_loss": [
          0.5643287954422144,
          0.3433939745792976,
          0.25097911948194873,
          0.21013608832771963,
          0.18888153450993392,
          0.1754740377744803,
          0.1636584376773009,
          0.16023050234294856,
          0.15308794608482948,
          0.14731957605825022,
          0.14590722437088305,
          0.1448411912872241,
          0.1434267213424811,
          0.14319094642996788,
          0.1429510097950697
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8573778394847468,
            "recall_macro": 0.8459510092050009,
            "f1_macro": 0.8467897529847891,
            "precision_micro": 0.8485496183206107,
            "recall_micro": 0.8485496183206107,
            "f1_micro": 0.8485496183206107,
            "accuracy": 0.8485496183206107,
            "hamming_loss": 0.15145038167938932,
            "no_defect_precision": 0.8087855297157622,
            "no_defect_recall": 0.9254878769958604,
            "no_defect_f1": 0.8632101489244346,
            "no_defect_tp": 1565,
            "no_defect_fp": 370,
            "no_defect_tn": 1214,
            "no_defect_fn": 126,
            "no_defect_support": 1691,
            "defect_precision": 0.9059701492537313,
            "defect_recall": 0.7664141414141414,
            "defect_f1": 0.8303693570451436,
            "defect_tp": 1214,
            "defect_fp": 126,
            "defect_tn": 1565,
            "defect_fn": 370,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9037429222736966,
            "recall_macro": 0.901762300712626,
            "f1_macro": 0.9023002882666361,
            "precision_micro": 0.9025954198473283,
            "recall_micro": 0.9025954198473283,
            "f1_micro": 0.9025954198473283,
            "accuracy": 0.9025954198473283,
            "hamming_loss": 0.09740458015267175,
            "no_defect_precision": 0.8888888888888888,
            "no_defect_recall": 0.9272619751626257,
            "no_defect_f1": 0.9076700434153401,
            "no_defect_tp": 1568,
            "no_defect_fp": 196,
            "no_defect_tn": 1388,
            "no_defect_fn": 123,
            "no_defect_support": 1691,
            "defect_precision": 0.9185969556585043,
            "defect_recall": 0.8762626262626263,
            "defect_f1": 0.8969305331179321,
            "defect_tp": 1388,
            "defect_fp": 123,
            "defect_tn": 1568,
            "defect_fn": 196,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9326702889926706,
            "recall_macro": 0.9329723536369012,
            "f1_macro": 0.9327791461412152,
            "precision_micro": 0.932824427480916,
            "recall_micro": 0.932824427480916,
            "f1_micro": 0.932824427480916,
            "accuracy": 0.932824427480916,
            "hamming_loss": 0.06717557251908397,
            "no_defect_precision": 0.9406830437387658,
            "no_defect_recall": 0.9284447072738025,
            "no_defect_f1": 0.9345238095238095,
            "no_defect_tp": 1570,
            "no_defect_fp": 99,
            "no_defect_tn": 1485,
            "no_defect_fn": 121,
            "no_defect_support": 1691,
            "defect_precision": 0.9246575342465754,
            "defect_recall": 0.9375,
            "defect_f1": 0.9310344827586207,
            "defect_tp": 1485,
            "defect_fp": 121,
            "defect_tn": 1570,
            "defect_fn": 99,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9438976782412163,
            "recall_macro": 0.9436169426374926,
            "f1_macro": 0.9437399962505779,
            "precision_micro": 0.9438167938931298,
            "recall_micro": 0.9438167938931298,
            "f1_micro": 0.9438167938931298,
            "accuracy": 0.9438167938931298,
            "hamming_loss": 0.05618320610687023,
            "no_defect_precision": 0.9419354838709677,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9458186101295641,
            "no_defect_tp": 1606,
            "no_defect_fp": 99,
            "no_defect_tn": 1485,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.945859872611465,
            "defect_recall": 0.9375,
            "defect_f1": 0.9416613823715916,
            "defect_tp": 1485,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 99,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.947203548085901,
            "recall_macro": 0.9470292442461278,
            "f1_macro": 0.9471092175636886,
            "precision_micro": 0.947175572519084,
            "recall_micro": 0.947175572519084,
            "f1_micro": 0.947175572519084,
            "accuracy": 0.947175572519084,
            "hamming_loss": 0.05282442748091603,
            "no_defect_precision": 0.9464705882352941,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9489826010026541,
            "no_defect_tp": 1609,
            "no_defect_fp": 91,
            "no_defect_tn": 1493,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.947936507936508,
            "defect_recall": 0.9425505050505051,
            "defect_f1": 0.945235834124723,
            "defect_tp": 1493,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 91,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9494745237066763,
            "recall_macro": 0.9498540998393157,
            "f1_macro": 0.9495897259033759,
            "precision_micro": 0.9496183206106871,
            "recall_micro": 0.9496183206106871,
            "f1_micro": 0.9496183206106871,
            "accuracy": 0.9496183206106871,
            "hamming_loss": 0.050381679389312976,
            "no_defect_precision": 0.9590854392298436,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.9507903370116314,
            "no_defect_tp": 1594,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.939863608183509,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9483891147951204,
            "defect_tp": 1516,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9534650354295506,
            "recall_macro": 0.9536580321249156,
            "f1_macro": 0.9535487001474348,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9583085169743896,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9548961424332344,
            "no_defect_tp": 1609,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9486215538847118,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9522012578616352,
            "defect_tp": 1514,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.953457556920373,
            "recall_macro": 0.9538777410414017,
            "f1_macro": 0.953564715004138,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9643934821967411,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.954599761051374,
            "no_defect_tp": 1598,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.9425216316440049,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9525296689569019,
            "defect_tp": 1525,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954370518906104,
            "recall_macro": 0.9547847636626465,
            "f1_macro": 0.9544805767158646,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9650180940892642,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.955509107196178,
            "no_defect_tp": 1600,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9437229437229437,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9534520462355514,
            "defect_tp": 1526,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543859158083297,
            "recall_macro": 0.9545650547461606,
            "f1_macro": 0.9544646905507246,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9589285714285715,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9557994660338178,
            "no_defect_tp": 1611,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9498432601880877,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9531299150676313,
            "defect_tp": 1515,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537544485711962,
            "recall_macro": 0.9540136357662969,
            "f1_macro": 0.9538582835122849,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9599761051373955,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9551263001485885,
            "no_defect_tp": 1607,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9475327920049968,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9525902668759811,
            "defect_tp": 1517,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549695002518328,
            "recall_macro": 0.9552762620289232,
            "f1_macro": 0.9550835310572297,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9622754491017964,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9562630169592383,
            "no_defect_tp": 1607,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9476635514018692,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9539040451552211,
            "defect_tp": 1521,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954365439163247,
            "recall_macro": 0.9546249753597478,
            "f1_macro": 0.954469432075036,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9605734767025089,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9557206537890045,
            "no_defect_tp": 1608,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.948157401623985,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9532182103610675,
            "defect_tp": 1518,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549722858157701,
            "recall_macro": 0.9552562884910608,
            "f1_macro": 0.9550820726596982,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9617224880382775,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9562890276538805,
            "no_defect_tp": 1608,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9482220835932627,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9538751176655161,
            "defect_tp": 1520,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546687008842056,
            "recall_macro": 0.9549406319254043,
            "f1_macro": 0.9547757616743288,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9611476389719068,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9560047562425684,
            "no_defect_tp": 1608,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9481897627965044,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9535467671060891,
            "defect_tp": 1519,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 65,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9606277948680101,
            "recall_macro": 0.9606138879570614,
            "f1_macro": 0.9606200356764563,
            "precision_micro": 0.9606227106227107,
            "recall_micro": 0.9606227106227107,
            "f1_micro": 0.9606227106227107,
            "accuracy": 0.9606227106227107,
            "hamming_loss": 0.039377289377289376,
            "no_defect_precision": 0.9600725952813067,
            "no_defect_recall": 0.9618181818181818,
            "no_defect_f1": 0.96094459582198,
            "no_defect_tp": 1587,
            "no_defect_fp": 66,
            "no_defect_tn": 1560,
            "no_defect_fn": 63,
            "no_defect_support": 1650,
            "defect_precision": 0.9611829944547134,
            "defect_recall": 0.959409594095941,
            "defect_f1": 0.9602954755309326,
            "defect_tp": 1560,
            "defect_fp": 63,
            "defect_tn": 1587,
            "defect_fn": 66,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.001_s90_20251207_170205",
    "lr": 0.001,
    "weight_decay": 0.001,
    "seed": 90,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9560022748950996,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.001_s90_20251207_170205",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s90_20251207_170205",
      "timestamp": "2025-12-07T17:04:06.260557",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.001_s90",
          "seed": 90,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s90_20251207_170205"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9558841962950693,
        "recall_macro": 0.956223231725893,
        "f1_macro": 0.9560022748950996,
        "precision_micro": 0.956030534351145,
        "recall_micro": 0.956030534351145,
        "f1_micro": 0.956030534351145,
        "accuracy": 0.956030534351145,
        "hamming_loss": 0.04396946564885496,
        "no_defect_precision": 0.9640071985602879,
        "no_defect_recall": 0.9503252513305737,
        "no_defect_f1": 0.9571173317450864,
        "no_defect_tp": 1607,
        "no_defect_fp": 60,
        "no_defect_tn": 1524,
        "no_defect_fn": 84,
        "no_defect_support": 1691,
        "defect_precision": 0.9477611940298507,
        "defect_recall": 0.9621212121212122,
        "defect_f1": 0.9548872180451128,
        "defect_tp": 1524,
        "defect_fp": 84,
        "defect_tn": 1607,
        "defect_fn": 60,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9606158212073788,
        "recall_macro": 0.9606362518170636,
        "f1_macro": 0.9606216502279609,
        "precision_micro": 0.9606227106227107,
        "recall_micro": 0.9606227106227107,
        "f1_micro": 0.9606227106227107,
        "accuracy": 0.9606227106227107,
        "hamming_loss": 0.039377289377289376,
        "no_defect_precision": 0.9628727936701157,
        "no_defect_recall": 0.9587878787878787,
        "no_defect_f1": 0.9608259945338598,
        "no_defect_tp": 1582,
        "no_defect_fp": 61,
        "no_defect_tn": 1565,
        "no_defect_fn": 68,
        "no_defect_support": 1650,
        "defect_precision": 0.9583588487446417,
        "defect_recall": 0.9624846248462484,
        "defect_f1": 0.960417305922062,
        "defect_tp": 1565,
        "defect_fp": 68,
        "defect_tn": 1582,
        "defect_fn": 61,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6188253393731855,
          0.4120798521211457,
          0.29073131159259685,
          0.24198299858360608,
          0.21964641760208617,
          0.20736399757438126,
          0.19663522676194561,
          0.18678182703306487,
          0.18758649463184707,
          0.18323287065433158,
          0.18016893706561132,
          0.1832304005530589,
          0.1783622795380808,
          0.18361742856861657,
          0.18109565742594427
        ],
        "val_loss": [
          0.576545387506485,
          0.34920327308086246,
          0.2515299217059062,
          0.21387248113751411,
          0.18894792176209962,
          0.17890926479147032,
          0.16767809325112745,
          0.15744126086624768,
          0.15312453359365463,
          0.1494070513603779,
          0.14552620741037223,
          0.1453578105339637,
          0.14292428155358022,
          0.1443531604913565,
          0.14409509645058557
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8662700050354251,
            "recall_macro": 0.855200997258212,
            "f1_macro": 0.856131838910646,
            "precision_micro": 0.8577099236641221,
            "recall_micro": 0.8577099236641221,
            "f1_micro": 0.8577099236641221,
            "accuracy": 0.8577099236641221,
            "hamming_loss": 0.14229007633587787,
            "no_defect_precision": 0.8178515827711469,
            "no_defect_recall": 0.9319929036073329,
            "no_defect_f1": 0.871199557766722,
            "no_defect_tp": 1576,
            "no_defect_fp": 351,
            "no_defect_tn": 1233,
            "no_defect_fn": 115,
            "no_defect_support": 1691,
            "defect_precision": 0.9146884272997032,
            "defect_recall": 0.7784090909090909,
            "defect_f1": 0.8410641200545702,
            "defect_tp": 1233,
            "defect_fp": 115,
            "defect_tn": 1576,
            "defect_fn": 351,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9010291771090637,
            "recall_macro": 0.8985857615181979,
            "f1_macro": 0.8991955194806956,
            "precision_micro": 0.8995419847328244,
            "recall_micro": 0.8995419847328244,
            "f1_micro": 0.8995419847328244,
            "accuracy": 0.8995419847328244,
            "hamming_loss": 0.10045801526717557,
            "no_defect_precision": 0.8834459459459459,
            "no_defect_recall": 0.9278533412182141,
            "no_defect_f1": 0.9051052783386213,
            "no_defect_tp": 1569,
            "no_defect_fp": 207,
            "no_defect_tn": 1377,
            "no_defect_fn": 122,
            "no_defect_support": 1691,
            "defect_precision": 0.9186124082721815,
            "defect_recall": 0.8693181818181818,
            "defect_f1": 0.89328576062277,
            "defect_tp": 1377,
            "defect_fp": 122,
            "defect_tn": 1569,
            "defect_fn": 207,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9303228387874102,
            "recall_macro": 0.9288210311273588,
            "f1_macro": 0.929288329482876,
            "precision_micro": 0.9294656488549619,
            "recall_micro": 0.9294656488549619,
            "f1_micro": 0.9294656488549619,
            "accuracy": 0.9294656488549619,
            "hamming_loss": 0.07053435114503817,
            "no_defect_precision": 0.9176201372997712,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9328293108461763,
            "no_defect_tp": 1604,
            "no_defect_fp": 144,
            "no_defect_tn": 1440,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9430255402750491,
            "defect_recall": 0.9090909090909091,
            "defect_f1": 0.9257473481195757,
            "defect_tp": 1440,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 144,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9400609789783781,
            "recall_macro": 0.9401286669175493,
            "f1_macro": 0.9400934165660602,
            "precision_micro": 0.9401526717557251,
            "recall_micro": 0.9401526717557251,
            "f1_micro": 0.9401526717557251,
            "accuracy": 0.9401526717557251,
            "hamming_loss": 0.05984732824427481,
            "no_defect_precision": 0.943094250148192,
            "no_defect_recall": 0.9408633944411591,
            "no_defect_f1": 0.9419775014801658,
            "no_defect_tp": 1591,
            "no_defect_fp": 96,
            "no_defect_tn": 1488,
            "no_defect_fn": 100,
            "no_defect_support": 1691,
            "defect_precision": 0.9370277078085643,
            "defect_recall": 0.9393939393939394,
            "defect_f1": 0.9382093316519546,
            "defect_tp": 1488,
            "defect_fp": 100,
            "defect_tn": 1591,
            "defect_fn": 96,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9465919701213819,
            "recall_macro": 0.9464179046526771,
            "f1_macro": 0.9464977634314768,
            "precision_micro": 0.9465648854961832,
            "recall_micro": 0.9465648854961832,
            "f1_micro": 0.9465648854961832,
            "accuracy": 0.9465648854961832,
            "hamming_loss": 0.05343511450381679,
            "no_defect_precision": 0.9458823529411765,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9483928044824536,
            "no_defect_tp": 1608,
            "no_defect_fp": 92,
            "no_defect_tn": 1492,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9473015873015873,
            "defect_recall": 0.9419191919191919,
            "defect_f1": 0.9446027223805001,
            "defect_tp": 1492,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 92,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9495605594764456,
            "recall_macro": 0.950033861680077,
            "f1_macro": 0.9496014045854211,
            "precision_micro": 0.9496183206106871,
            "recall_micro": 0.9496183206106871,
            "f1_micro": 0.9496183206106871,
            "accuracy": 0.9496183206106871,
            "hamming_loss": 0.050381679389312976,
            "no_defect_precision": 0.9641119221411192,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.9505247376311844,
            "no_defect_tp": 1585,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.935009196811772,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9486780715396579,
            "defect_tp": 1525,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9498004550371115,
            "recall_macro": 0.9502296770185593,
            "f1_macro": 0.949900117381665,
            "precision_micro": 0.9499236641221374,
            "recall_micro": 0.9499236641221374,
            "f1_micro": 0.9499236641221374,
            "accuracy": 0.9499236641221374,
            "hamming_loss": 0.050076335877862595,
            "no_defect_precision": 0.9613293051359516,
            "no_defect_recall": 0.9408633944411591,
            "no_defect_f1": 0.9509862522414824,
            "no_defect_tp": 1591,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 100,
            "no_defect_support": 1691,
            "defect_precision": 0.9382716049382716,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9488139825218477,
            "defect_tp": 1520,
            "defect_fp": 100,
            "defect_tn": 1591,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537843179845236,
            "recall_macro": 0.9539337416148475,
            "f1_macro": 0.9538518074945915,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9577883472057075,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9552327305069671,
            "no_defect_tp": 1611,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9497802887633396,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.952470884482216,
            "defect_tp": 1513,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540577267059331,
            "recall_macro": 0.9543292923319535,
            "f1_macro": 0.9541646233185764,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9605499103407054,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.955410225921522,
            "no_defect_tp": 1607,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.947565543071161,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9529190207156308,
            "defect_tp": 1518,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546735074626865,
            "recall_macro": 0.9549206583875419,
            "f1_macro": 0.9547742425735332,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9605970149253731,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9560308972073678,
            "no_defect_tp": 1609,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.94875,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9535175879396985,
            "defect_tp": 1518,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9559183120521109,
            "recall_macro": 0.9560834169608563,
            "f1_macro": 0.9559919284941625,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9601427721594289,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9572953736654805,
            "no_defect_tp": 1614,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.951693851944793,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9546884833228445,
            "defect_tp": 1517,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546652518912175,
            "recall_macro": 0.9549606054632667,
            "f1_macro": 0.9547772469186576,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9616995810891682,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9559785841760856,
            "no_defect_tp": 1607,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9476309226932669,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9535759096612296,
            "defect_tp": 1520,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.955909353490934,
            "recall_macro": 0.9561033904987187,
            "f1_macro": 0.955993505402833,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9606908874329958,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9572700296735905,
            "no_defect_tp": 1613,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9511278195488722,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9547169811320755,
            "defect_tp": 1518,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9558841962950693,
            "recall_macro": 0.956223231725893,
            "f1_macro": 0.9560022748950996,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9640071985602879,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9571173317450864,
            "no_defect_tp": 1607,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9477611940298507,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9548872180451128,
            "defect_tp": 1524,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9558849864237391,
            "recall_macro": 0.9562032581880305,
            "f1_macro": 0.9560008956560682,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.96345116836429,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9571428571428572,
            "no_defect_tp": 1608,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9483188044831881,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.954858934169279,
            "defect_tp": 1523,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 61,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9606158212073788,
            "recall_macro": 0.9606362518170636,
            "f1_macro": 0.9606216502279609,
            "precision_micro": 0.9606227106227107,
            "recall_micro": 0.9606227106227107,
            "f1_micro": 0.9606227106227107,
            "accuracy": 0.9606227106227107,
            "hamming_loss": 0.039377289377289376,
            "no_defect_precision": 0.9628727936701157,
            "no_defect_recall": 0.9587878787878787,
            "no_defect_f1": 0.9608259945338598,
            "no_defect_tp": 1582,
            "no_defect_fp": 61,
            "no_defect_tn": 1565,
            "no_defect_fn": 68,
            "no_defect_support": 1650,
            "defect_precision": 0.9583588487446417,
            "defect_recall": 0.9624846248462484,
            "defect_f1": 0.960417305922062,
            "defect_tp": 1565,
            "defect_fp": 68,
            "defect_tn": 1582,
            "defect_fn": 61,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.001_s100_20251207_133806",
    "lr": 0.001,
    "weight_decay": 0.001,
    "seed": 100,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9556886862286829,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.001_s100_20251207_133806",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s100_20251207_133806",
      "timestamp": "2025-12-07T13:39:56.019470",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.001_s100",
          "seed": 100,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s100_20251207_133806"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9555998546141715,
        "recall_macro": 0.9558077074709246,
        "f1_macro": 0.9556886862286829,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.9606674612634089,
        "no_defect_recall": 0.9532820816085157,
        "no_defect_f1": 0.9569605224102108,
        "no_defect_tp": 1612,
        "no_defect_fp": 66,
        "no_defect_tn": 1518,
        "no_defect_fn": 79,
        "no_defect_support": 1691,
        "defect_precision": 0.9505322479649343,
        "defect_recall": 0.9583333333333334,
        "defect_f1": 0.9544168500471549,
        "defect_tp": 1518,
        "defect_fp": 79,
        "defect_tn": 1612,
        "defect_fn": 66,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9609433709071391,
        "recall_macro": 0.9609124454880913,
        "f1_macro": 0.9609246840729844,
        "precision_micro": 0.960927960927961,
        "recall_micro": 0.960927960927961,
        "f1_micro": 0.960927960927961,
        "accuracy": 0.960927960927961,
        "hamming_loss": 0.03907203907203907,
        "no_defect_precision": 0.9595410628019324,
        "no_defect_recall": 0.963030303030303,
        "no_defect_f1": 0.9612825166364186,
        "no_defect_tp": 1589,
        "no_defect_fp": 67,
        "no_defect_tn": 1559,
        "no_defect_fn": 61,
        "no_defect_support": 1650,
        "defect_precision": 0.9623456790123457,
        "defect_recall": 0.9587945879458795,
        "defect_f1": 0.9605668515095502,
        "defect_tp": 1559,
        "defect_fp": 61,
        "defect_tn": 1589,
        "defect_fn": 67,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6180125769212156,
          0.41306515954528394,
          0.2880144878660785,
          0.23846440378841496,
          0.22070061231507418,
          0.20518777706508357,
          0.1948190786910855,
          0.19550090928456773,
          0.19051904761267507,
          0.18146553766527934,
          0.1845020346624083,
          0.18295617223908212,
          0.18604301711131338,
          0.17928038007544672,
          0.18010386606390008
        ],
        "val_loss": [
          0.5668531702114985,
          0.34467529448179096,
          0.25024479684921414,
          0.21282555707372153,
          0.19113643925923568,
          0.1740433364533461,
          0.16558646568312094,
          0.157096750747699,
          0.15367841032835153,
          0.14814734774140212,
          0.14634903591985887,
          0.1448725022089023,
          0.1441358525592547,
          0.14351400102560335,
          0.1434453702889956
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8545206060096056,
            "recall_macro": 0.8397338255410403,
            "f1_macro": 0.8404624269801979,
            "precision_micro": 0.8427480916030534,
            "recall_micro": 0.8427480916030534,
            "f1_micro": 0.8427480916030534,
            "accuracy": 0.8427480916030534,
            "hamming_loss": 0.15725190839694655,
            "no_defect_precision": 0.7975708502024291,
            "no_defect_recall": 0.9319929036073329,
            "no_defect_f1": 0.85955822197982,
            "no_defect_tp": 1576,
            "no_defect_fp": 400,
            "no_defect_tn": 1184,
            "no_defect_fn": 115,
            "no_defect_support": 1691,
            "defect_precision": 0.9114703618167821,
            "defect_recall": 0.7474747474747475,
            "defect_f1": 0.8213666319805758,
            "defect_tp": 1184,
            "defect_fp": 115,
            "defect_tn": 1576,
            "defect_fn": 400,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9063100207479591,
            "recall_macro": 0.9054742053891965,
            "f1_macro": 0.9057694822786466,
            "precision_micro": 0.9059541984732824,
            "recall_micro": 0.9059541984732824,
            "f1_micro": 0.9059541984732824,
            "accuracy": 0.9059541984732824,
            "hamming_loss": 0.09404580152671756,
            "no_defect_precision": 0.8999421631000578,
            "no_defect_recall": 0.9201655824955648,
            "no_defect_f1": 0.9099415204678363,
            "no_defect_tp": 1556,
            "no_defect_fp": 173,
            "no_defect_tn": 1411,
            "no_defect_fn": 135,
            "no_defect_support": 1691,
            "defect_precision": 0.9126778783958602,
            "defect_recall": 0.8907828282828283,
            "defect_f1": 0.9015974440894569,
            "defect_tp": 1411,
            "defect_fp": 135,
            "defect_tn": 1556,
            "defect_fn": 173,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9330511638325276,
            "recall_macro": 0.9330683012860719,
            "f1_macro": 0.9330596453050193,
            "precision_micro": 0.9331297709923664,
            "recall_micro": 0.9331297709923664,
            "f1_micro": 0.9331297709923664,
            "accuracy": 0.9331297709923664,
            "hamming_loss": 0.06687022900763359,
            "no_defect_precision": 0.9355029585798816,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.935226264418811,
            "no_defect_tp": 1581,
            "no_defect_fp": 109,
            "no_defect_tn": 1475,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9305993690851735,
            "defect_recall": 0.9311868686868687,
            "defect_f1": 0.9308930261912275,
            "defect_tp": 1475,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 109,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9393903329858746,
            "recall_macro": 0.9396970891648597,
            "f1_macro": 0.9395012315270936,
            "precision_micro": 0.9395419847328245,
            "recall_micro": 0.9395419847328245,
            "f1_micro": 0.9395419847328245,
            "accuracy": 0.9395419847328245,
            "hamming_loss": 0.06045801526717557,
            "no_defect_precision": 0.9472738166566806,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.9410714285714286,
            "no_defect_tp": 1581,
            "no_defect_fp": 88,
            "no_defect_tn": 1496,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9315068493150684,
            "defect_recall": 0.9444444444444444,
            "defect_f1": 0.9379310344827586,
            "defect_tp": 1496,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 88,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.944605015023886,
            "recall_macro": 0.9450233037052966,
            "f1_macro": 0.9447060993106533,
            "precision_micro": 0.944732824427481,
            "recall_micro": 0.944732824427481,
            "f1_micro": 0.944732824427481,
            "accuracy": 0.944732824427481,
            "hamming_loss": 0.05526717557251908,
            "no_defect_precision": 0.9559178743961353,
            "no_defect_recall": 0.9361324659964518,
            "no_defect_f1": 0.9459217209441291,
            "no_defect_tp": 1583,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 108,
            "no_defect_support": 1691,
            "defect_precision": 0.9332921556516368,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.9434904776771776,
            "defect_tp": 1511,
            "defect_fp": 108,
            "defect_tn": 1583,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9482614749454784,
            "recall_macro": 0.947836399178061,
            "f1_macro": 0.948013426588889,
            "precision_micro": 0.9480916030534351,
            "recall_micro": 0.9480916030534351,
            "f1_micro": 0.9480916030534351,
            "accuracy": 0.9480916030534351,
            "hamming_loss": 0.051908396946564885,
            "no_defect_precision": 0.9444769140853302,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9500293944738389,
            "no_defect_tp": 1616,
            "no_defect_fp": 95,
            "no_defect_tn": 1489,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9520460358056266,
            "defect_recall": 0.9400252525252525,
            "defect_f1": 0.945997458703939,
            "defect_tp": 1489,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 95,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9513316007331226,
            "recall_macro": 0.9517680127711174,
            "f1_macro": 0.9514281916568142,
            "precision_micro": 0.9514503816793893,
            "recall_micro": 0.9514503816793893,
            "f1_micro": 0.9514503816793893,
            "accuracy": 0.9514503816793893,
            "hamming_loss": 0.04854961832061069,
            "no_defect_precision": 0.9631197097944377,
            "no_defect_recall": 0.9420461265523359,
            "no_defect_f1": 0.9524663677130045,
            "no_defect_tp": 1593,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 98,
            "no_defect_support": 1691,
            "defect_precision": 0.9395434916718075,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.950390015600624,
            "defect_tp": 1523,
            "defect_fp": 98,
            "defect_tn": 1593,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9534575867419247,
            "recall_macro": 0.953678005662778,
            "f1_macro": 0.9535503298691721,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9588550983899821,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9548693586698337,
            "no_defect_tp": 1608,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9480600750938674,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9522313010685104,
            "defect_tp": 1515,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9534413340625739,
            "recall_macro": 0.9537578998142275,
            "f1_macro": 0.9535565009702941,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9610545236668664,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9547619047619048,
            "no_defect_tp": 1604,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9458281444582815,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9523510971786834,
            "defect_tp": 1519,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543954563402759,
            "recall_macro": 0.9545450812082983,
            "f1_macro": 0.9544630418324115,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9583828775267539,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9558256744737622,
            "no_defect_tp": 1612,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9504080351537979,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9531004091910608,
            "defect_tp": 1514,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.95531747418017,
            "recall_macro": 0.9554521038295432,
            "f1_macro": 0.9553790730418865,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9590017825311943,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9567279193835211,
            "no_defect_tp": 1614,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9516331658291457,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9540302267002518,
            "defect_tp": 1515,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9550065946960282,
            "recall_macro": 0.955156420801749,
            "f1_macro": 0.9550742761702316,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9589774078478003,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9564186184405574,
            "no_defect_tp": 1613,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9510357815442562,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9537299338999056,
            "defect_tp": 1515,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555998546141715,
            "recall_macro": 0.9558077074709246,
            "f1_macro": 0.9556886862286829,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9606674612634089,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9569605224102108,
            "no_defect_tp": 1612,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505322479649343,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9544168500471549,
            "defect_tp": 1518,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552982739755882,
            "recall_macro": 0.955492050905268,
            "f1_macro": 0.9553823040889835,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9600952948183442,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9566765578635015,
            "no_defect_tp": 1612,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505012531328321,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9540880503144654,
            "defect_tp": 1517,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552982739755882,
            "recall_macro": 0.955492050905268,
            "f1_macro": 0.9553823040889835,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9600952948183442,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9566765578635015,
            "no_defect_tp": 1612,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505012531328321,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9540880503144654,
            "defect_tp": 1517,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 67,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9609433709071391,
            "recall_macro": 0.9609124454880913,
            "f1_macro": 0.9609246840729844,
            "precision_micro": 0.960927960927961,
            "recall_micro": 0.960927960927961,
            "f1_micro": 0.960927960927961,
            "accuracy": 0.960927960927961,
            "hamming_loss": 0.03907203907203907,
            "no_defect_precision": 0.9595410628019324,
            "no_defect_recall": 0.963030303030303,
            "no_defect_f1": 0.9612825166364186,
            "no_defect_tp": 1589,
            "no_defect_fp": 67,
            "no_defect_tn": 1559,
            "no_defect_fn": 61,
            "no_defect_support": 1650,
            "defect_precision": 0.9623456790123457,
            "defect_recall": 0.9587945879458795,
            "defect_f1": 0.9605668515095502,
            "defect_tp": 1559,
            "defect_fp": 61,
            "defect_tn": 1589,
            "defect_fn": 67,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.001_s110_20251207_184435",
    "lr": 0.001,
    "weight_decay": 0.001,
    "seed": 110,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9559903186166552,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.001_s110_20251207_184435",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s110_20251207_184435",
      "timestamp": "2025-12-07T18:46:33.451757",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.001_s110",
          "seed": 110,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s110_20251207_184435"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9559286330643114,
        "recall_macro": 0.956063443422994,
        "f1_macro": 0.9559903186166552,
        "precision_micro": 0.956030534351145,
        "recall_micro": 0.956030534351145,
        "f1_micro": 0.956030534351145,
        "accuracy": 0.956030534351145,
        "hamming_loss": 0.04396946564885496,
        "no_defect_precision": 0.9595959595959596,
        "no_defect_recall": 0.9550561797752809,
        "no_defect_f1": 0.9573206876111441,
        "no_defect_tp": 1615,
        "no_defect_fp": 68,
        "no_defect_tn": 1516,
        "no_defect_fn": 76,
        "no_defect_support": 1691,
        "defect_precision": 0.9522613065326633,
        "defect_recall": 0.9570707070707071,
        "defect_f1": 0.9546599496221663,
        "defect_tp": 1516,
        "defect_fp": 76,
        "defect_tn": 1615,
        "defect_fn": 68,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9609433709071391,
        "recall_macro": 0.9609124454880913,
        "f1_macro": 0.9609246840729844,
        "precision_micro": 0.960927960927961,
        "recall_micro": 0.960927960927961,
        "f1_micro": 0.960927960927961,
        "accuracy": 0.960927960927961,
        "hamming_loss": 0.03907203907203907,
        "no_defect_precision": 0.9595410628019324,
        "no_defect_recall": 0.963030303030303,
        "no_defect_f1": 0.9612825166364186,
        "no_defect_tp": 1589,
        "no_defect_fp": 67,
        "no_defect_tn": 1559,
        "no_defect_fn": 61,
        "no_defect_support": 1650,
        "defect_precision": 0.9623456790123457,
        "defect_recall": 0.9587945879458795,
        "defect_f1": 0.9605668515095502,
        "defect_tp": 1559,
        "defect_fp": 61,
        "defect_tn": 1589,
        "defect_fn": 67,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6217886204500078,
          0.4157738001027367,
          0.29079599460298544,
          0.24113422937722387,
          0.21713086760069036,
          0.20378237429647764,
          0.20006598398151756,
          0.1920173416327233,
          0.1861043829611156,
          0.18692511447927443,
          0.1809077167486047,
          0.1797316765186677,
          0.179044279749174,
          0.18306480525801871,
          0.18537023454655163
        ],
        "val_loss": [
          0.5813443889984717,
          0.3501562579320027,
          0.2533720637170168,
          0.21482547974357238,
          0.19244350951451522,
          0.17529684792344385,
          0.16765256999776915,
          0.16457161149726465,
          0.15396097760934097,
          0.14922560335924992,
          0.14731271321383807,
          0.14594335295259953,
          0.14393057058063838,
          0.1436570186454516,
          0.14385627439388862
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8429348068880436,
            "recall_macro": 0.7980514787138087,
            "f1_macro": 0.7956644663677583,
            "precision_micro": 0.8036641221374046,
            "recall_micro": 0.8036641221374046,
            "f1_micro": 0.8036641221374046,
            "accuracy": 0.8036641221374046,
            "hamming_loss": 0.19633587786259543,
            "no_defect_precision": 0.7347670250896058,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.8360948253887331,
            "no_defect_tp": 1640,
            "no_defect_fp": 592,
            "no_defect_tn": 992,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.9511025886864813,
            "defect_recall": 0.6262626262626263,
            "defect_f1": 0.7552341073467834,
            "defect_tp": 992,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 592,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9006996245089545,
            "recall_macro": 0.896727849159842,
            "f1_macro": 0.8975316159250586,
            "precision_micro": 0.8980152671755726,
            "recall_micro": 0.8980152671755726,
            "f1_micro": 0.8980152671755726,
            "accuracy": 0.8980152671755726,
            "hamming_loss": 0.10198473282442748,
            "no_defect_precision": 0.875069098949696,
            "no_defect_recall": 0.9361324659964518,
            "no_defect_f1": 0.9045714285714286,
            "no_defect_tp": 1583,
            "no_defect_fp": 226,
            "no_defect_tn": 1358,
            "no_defect_fn": 108,
            "no_defect_support": 1691,
            "defect_precision": 0.9263301500682128,
            "defect_recall": 0.8573232323232324,
            "defect_f1": 0.8904918032786885,
            "defect_tp": 1358,
            "defect_fp": 108,
            "defect_tn": 1583,
            "defect_fn": 226,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9303456591639871,
            "recall_macro": 0.9297120002508825,
            "f1_macro": 0.9299555464401335,
            "precision_micro": 0.9300763358778626,
            "recall_micro": 0.9300763358778626,
            "f1_micro": 0.9300763358778626,
            "accuracy": 0.9300763358778626,
            "hamming_loss": 0.06992366412213741,
            "no_defect_precision": 0.925,
            "no_defect_recall": 0.9408633944411591,
            "no_defect_f1": 0.9328642626795661,
            "no_defect_tp": 1591,
            "no_defect_fp": 129,
            "no_defect_tn": 1455,
            "no_defect_fn": 100,
            "no_defect_support": 1691,
            "defect_precision": 0.9356913183279743,
            "defect_recall": 0.9185606060606061,
            "defect_f1": 0.9270468302007009,
            "defect_tp": 1455,
            "defect_fp": 100,
            "defect_tn": 1591,
            "defect_fn": 129,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9400741912097939,
            "recall_macro": 0.9401086933796869,
            "f1_macro": 0.9400910906613407,
            "precision_micro": 0.9401526717557251,
            "recall_micro": 0.9401526717557251,
            "f1_micro": 0.9401526717557251,
            "accuracy": 0.9401526717557251,
            "hamming_loss": 0.05984732824427481,
            "no_defect_precision": 0.9425695677915926,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9420118343195266,
            "no_defect_tp": 1592,
            "no_defect_fp": 97,
            "no_defect_tn": 1487,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.937578814627995,
            "defect_recall": 0.9387626262626263,
            "defect_f1": 0.9381703470031546,
            "defect_tp": 1487,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 97,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9451940502739318,
            "recall_macro": 0.9455347756094356,
            "f1_macro": 0.9453092252647917,
            "precision_micro": 0.9453435114503816,
            "recall_micro": 0.9453435114503816,
            "f1_micro": 0.9453435114503816,
            "accuracy": 0.9453435114503816,
            "hamming_loss": 0.05465648854961832,
            "no_defect_precision": 0.9537815126050421,
            "no_defect_recall": 0.9396806623299823,
            "no_defect_f1": 0.946678582067322,
            "no_defect_tp": 1589,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 102,
            "no_defect_support": 1691,
            "defect_precision": 0.9366065879428216,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.9439398684622612,
            "defect_tp": 1507,
            "defect_fp": 102,
            "defect_tn": 1589,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9491960109183979,
            "recall_macro": 0.9493586814328979,
            "f1_macro": 0.9492684731252151,
            "precision_micro": 0.9493129770992367,
            "recall_micro": 0.9493129770992367,
            "f1_micro": 0.9493129770992367,
            "accuracy": 0.9493129770992367,
            "hamming_loss": 0.05068702290076336,
            "no_defect_precision": 0.9535990481856038,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9507710557532622,
            "no_defect_tp": 1603,
            "no_defect_fp": 78,
            "no_defect_tn": 1506,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.944792973651192,
            "defect_recall": 0.9507575757575758,
            "defect_f1": 0.9477658904971681,
            "defect_tp": 1506,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 78,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9482626914127862,
            "recall_macro": 0.9486713677281389,
            "f1_macro": 0.9483705870132961,
            "precision_micro": 0.9483969465648855,
            "recall_micro": 0.9483969465648855,
            "f1_micro": 0.9483969465648855,
            "accuracy": 0.9483969465648855,
            "hamming_loss": 0.0516030534351145,
            "no_defect_precision": 0.9589867310012062,
            "no_defect_recall": 0.9402720283855707,
            "no_defect_f1": 0.9495371752762019,
            "no_defect_tp": 1590,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 101,
            "no_defect_support": 1691,
            "defect_precision": 0.9375386518243661,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9472039987503905,
            "defect_tp": 1516,
            "defect_fp": 101,
            "defect_tn": 1590,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9493180070455575,
            "recall_macro": 0.9497980992658699,
            "f1_macro": 0.949299698885069,
            "precision_micro": 0.9493129770992367,
            "recall_micro": 0.9493129770992367,
            "f1_micro": 0.9493129770992367,
            "accuracy": 0.9493129770992367,
            "hamming_loss": 0.05068702290076336,
            "no_defect_precision": 0.9657910812461821,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.9501201923076923,
            "no_defect_tp": 1581,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9328449328449329,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9484792054624457,
            "defect_tp": 1528,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9525257895424105,
            "recall_macro": 0.9528309036551201,
            "f1_macro": 0.9526390973732695,
            "precision_micro": 0.9526717557251908,
            "recall_micro": 0.9526717557251908,
            "f1_micro": 0.9526717557251908,
            "accuracy": 0.9526717557251908,
            "hamming_loss": 0.04732824427480916,
            "no_defect_precision": 0.9598802395209581,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9538827729842309,
            "no_defect_tp": 1603,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9451713395638629,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.951395421762308,
            "defect_tp": 1517,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9559677745698187,
            "recall_macro": 0.9560035228094068,
            "f1_macro": 0.9559852910981278,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9579632918886916,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9573964497041421,
            "no_defect_tp": 1618,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9539722572509458,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.9545741324921135,
            "defect_tp": 1513,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543954563402759,
            "recall_macro": 0.9545450812082983,
            "f1_macro": 0.9544630418324115,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9583828775267539,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9558256744737622,
            "no_defect_tp": 1612,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9504080351537979,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9531004091910608,
            "defect_tp": 1514,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546796718915938,
            "recall_macro": 0.9549006848496795,
            "f1_macro": 0.954772689609457,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9600477042337507,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9560570071258907,
            "no_defect_tp": 1610,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9493116395494368,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9534883720930233,
            "defect_tp": 1517,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.955329115577702,
            "recall_macro": 0.9554321302916808,
            "f1_macro": 0.9553774073709076,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9584569732937686,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9567535545023697,
            "no_defect_tp": 1615,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9522012578616352,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9540012602394455,
            "defect_tp": 1514,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9559286330643114,
            "recall_macro": 0.956063443422994,
            "f1_macro": 0.9559903186166552,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9595959595959596,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9573206876111441,
            "no_defect_tp": 1615,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9522613065326633,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9546599496221663,
            "defect_tp": 1516,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549970144797731,
            "recall_macro": 0.9551763943396114,
            "f1_macro": 0.9550759027580974,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9595238095238096,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9563927617917531,
            "no_defect_tp": 1612,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9504702194357367,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9537590437244416,
            "defect_tp": 1516,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 68,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9609433709071391,
            "recall_macro": 0.9609124454880913,
            "f1_macro": 0.9609246840729844,
            "precision_micro": 0.960927960927961,
            "recall_micro": 0.960927960927961,
            "f1_micro": 0.960927960927961,
            "accuracy": 0.960927960927961,
            "hamming_loss": 0.03907203907203907,
            "no_defect_precision": 0.9595410628019324,
            "no_defect_recall": 0.963030303030303,
            "no_defect_f1": 0.9612825166364186,
            "no_defect_tp": 1589,
            "no_defect_fp": 67,
            "no_defect_tn": 1559,
            "no_defect_fn": 61,
            "no_defect_support": 1650,
            "defect_precision": 0.9623456790123457,
            "defect_recall": 0.9587945879458795,
            "defect_f1": 0.9605668515095502,
            "defect_tp": 1559,
            "defect_fp": 61,
            "defect_tn": 1589,
            "defect_fn": 67,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.001_s120_20251207_203509",
    "lr": 0.001,
    "weight_decay": 0.001,
    "seed": 120,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9562998767634596,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.001_s120_20251207_203509",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s120_20251207_203509",
      "timestamp": "2025-12-07T20:37:04.975795",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 15,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.001_s120",
          "seed": 120,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s120_20251207_203509"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9562109154306757,
        "recall_macro": 0.9564190470643753,
        "f1_macro": 0.9562998767634596,
        "precision_micro": 0.9563358778625954,
        "recall_micro": 0.9563358778625954,
        "f1_micro": 0.9563358778625954,
        "accuracy": 0.9563358778625954,
        "hamming_loss": 0.04366412213740458,
        "no_defect_precision": 0.9612634088200238,
        "no_defect_recall": 0.9538734476641041,
        "no_defect_f1": 0.9575541703769664,
        "no_defect_tp": 1613,
        "no_defect_fp": 65,
        "no_defect_tn": 1519,
        "no_defect_fn": 78,
        "no_defect_support": 1691,
        "defect_precision": 0.9511584220413275,
        "defect_recall": 0.9589646464646465,
        "defect_f1": 0.9550455831499528,
        "defect_tp": 1519,
        "defect_fp": 78,
        "defect_tn": 1613,
        "defect_fn": 65,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9594210348371388,
        "recall_macro": 0.9593838756569384,
        "f1_macro": 0.9593980737502696,
        "precision_micro": 0.9594017094017094,
        "recall_micro": 0.9594017094017094,
        "f1_micro": 0.9594017094017094,
        "accuracy": 0.9594017094017094,
        "hamming_loss": 0.0405982905982906,
        "no_defect_precision": 0.9577549788774894,
        "no_defect_recall": 0.9618181818181818,
        "no_defect_f1": 0.9597822800120955,
        "no_defect_tp": 1587,
        "no_defect_fp": 70,
        "no_defect_tn": 1556,
        "no_defect_fn": 63,
        "no_defect_support": 1650,
        "defect_precision": 0.9610870907967881,
        "defect_recall": 0.956949569495695,
        "defect_f1": 0.9590138674884437,
        "defect_tp": 1556,
        "defect_fp": 63,
        "defect_tn": 1587,
        "defect_fn": 70,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.611671994171382,
          0.4108858148423199,
          0.2945277477033966,
          0.24533715993789448,
          0.2228877921296463,
          0.2051958808652028,
          0.19974820636929827,
          0.1900646602695956,
          0.18611678443693216,
          0.18646610216490894,
          0.1818117109676784,
          0.1791105593036408,
          0.18111155634145856,
          0.1821638277759113,
          0.18207559828104833
        ],
        "val_loss": [
          0.5727103914205844,
          0.34915961898290193,
          0.2544018766627862,
          0.2116590583553681,
          0.18902650303565538,
          0.17561497138096735,
          0.16852395795285702,
          0.15604972882339588,
          0.15187262242230085,
          0.14865923200089198,
          0.14744640657534966,
          0.14487068125834832,
          0.14416417579811353,
          0.1433141462218303,
          0.14327453062511408
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8501598294046262,
            "recall_macro": 0.8149810120722303,
            "f1_macro": 0.814117364117364,
            "precision_micro": 0.8198473282442749,
            "recall_micro": 0.8198473282442749,
            "f1_micro": 0.8198473282442749,
            "accuracy": 0.8198473282442749,
            "hamming_loss": 0.1801526717557252,
            "no_defect_precision": 0.7549791570171376,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.8467532467532467,
            "no_defect_tp": 1630,
            "no_defect_fp": 529,
            "no_defect_tn": 1055,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9453405017921147,
            "defect_recall": 0.6660353535353535,
            "defect_f1": 0.7814814814814814,
            "defect_tp": 1055,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 529,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9031120527306968,
            "recall_macro": 0.8995687582507512,
            "f1_macro": 0.9003297977548207,
            "precision_micro": 0.9007633587786259,
            "recall_micro": 0.9007633587786259,
            "f1_micro": 0.9007633587786259,
            "accuracy": 0.9007633587786259,
            "hamming_loss": 0.09923664122137404,
            "no_defect_precision": 0.8794444444444445,
            "no_defect_recall": 0.9361324659964518,
            "no_defect_f1": 0.9069034660555715,
            "no_defect_tp": 1583,
            "no_defect_fp": 217,
            "no_defect_tn": 1367,
            "no_defect_fn": 108,
            "no_defect_support": 1691,
            "defect_precision": 0.9267796610169492,
            "defect_recall": 0.8630050505050505,
            "defect_f1": 0.8937561294540699,
            "defect_tp": 1367,
            "defect_fp": 108,
            "defect_tn": 1583,
            "defect_fn": 217,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9311721988216879,
            "recall_macro": 0.9313141766571689,
            "f1_macro": 0.9312361369952522,
            "precision_micro": 0.9312977099236641,
            "recall_micro": 0.9312977099236641,
            "f1_micro": 0.9312977099236641,
            "accuracy": 0.9312977099236641,
            "hamming_loss": 0.06870229007633588,
            "no_defect_precision": 0.9357907253269917,
            "no_defect_recall": 0.9308101714961561,
            "no_defect_f1": 0.933293803735547,
            "no_defect_tp": 1574,
            "no_defect_fp": 108,
            "no_defect_tn": 1476,
            "no_defect_fn": 117,
            "no_defect_support": 1691,
            "defect_precision": 0.9265536723163842,
            "defect_recall": 0.9318181818181818,
            "defect_f1": 0.9291784702549575,
            "defect_tp": 1476,
            "defect_fp": 117,
            "defect_tn": 1574,
            "defect_fn": 108,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9374854917817964,
            "recall_macro": 0.9362370004002174,
            "f1_macro": 0.9366501549486235,
            "precision_micro": 0.936793893129771,
            "recall_micro": 0.936793893129771,
            "f1_micro": 0.936793893129771,
            "accuracy": 0.936793893129771,
            "hamming_loss": 0.06320610687022901,
            "no_defect_precision": 0.9264367816091954,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9396677353541242,
            "no_defect_tp": 1612,
            "no_defect_fp": 128,
            "no_defect_tn": 1456,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9485342019543974,
            "defect_recall": 0.9191919191919192,
            "defect_f1": 0.9336325745431228,
            "defect_tp": 1456,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 128,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9457854779781294,
            "recall_macro": 0.9454110143421202,
            "f1_macro": 0.9455695611577964,
            "precision_micro": 0.945648854961832,
            "recall_micro": 0.945648854961832,
            "f1_micro": 0.945648854961832,
            "accuracy": 0.945648854961832,
            "hamming_loss": 0.05435114503816794,
            "no_defect_precision": 0.9426565242832066,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9476470588235294,
            "no_defect_tp": 1611,
            "no_defect_fp": 98,
            "no_defect_tn": 1486,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9489144316730523,
            "defect_recall": 0.9381313131313131,
            "defect_f1": 0.9434920634920635,
            "defect_tp": 1486,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 98,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9504023738677521,
            "recall_macro": 0.9506213076955241,
            "f1_macro": 0.9504944305184597,
            "precision_micro": 0.9505343511450381,
            "recall_micro": 0.9505343511450381,
            "f1_micro": 0.9505343511450381,
            "accuracy": 0.9505343511450381,
            "hamming_loss": 0.04946564885496183,
            "no_defect_precision": 0.9558735837805605,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9519002375296912,
            "no_defect_tp": 1603,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9449311639549437,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9490886235072281,
            "defect_tp": 1510,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9481398798979335,
            "recall_macro": 0.948615367154693,
            "f1_macro": 0.9480799804237979,
            "precision_micro": 0.9480916030534351,
            "recall_micro": 0.9480916030534351,
            "f1_micro": 0.9480916030534351,
            "accuracy": 0.9480916030534351,
            "hamming_loss": 0.051908396946564885,
            "no_defect_precision": 0.9657072872014697,
            "no_defect_recall": 0.9325842696629213,
            "no_defect_f1": 0.9488567990373045,
            "no_defect_tp": 1577,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 114,
            "no_defect_support": 1691,
            "defect_precision": 0.9305724725943971,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9473031618102914,
            "defect_tp": 1528,
            "defect_fp": 114,
            "defect_tn": 1577,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9499047832418506,
            "recall_macro": 0.9498302062613122,
            "f1_macro": 0.9498660730620544,
            "precision_micro": 0.9499236641221374,
            "recall_micro": 0.9499236641221374,
            "f1_micro": 0.9499236641221374,
            "accuracy": 0.9499236641221374,
            "hamming_loss": 0.050076335877862595,
            "no_defect_precision": 0.9504424778761061,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9515652687536916,
            "no_defect_tp": 1611,
            "no_defect_fp": 84,
            "no_defect_tn": 1500,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9493670886075949,
            "defect_recall": 0.946969696969697,
            "defect_f1": 0.9481668773704172,
            "defect_tp": 1500,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 84,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9513397645615143,
            "recall_macro": 0.9514883832410443,
            "f1_macro": 0.9514068701433116,
            "precision_micro": 0.9514503816793893,
            "recall_micro": 0.9514503816793893,
            "f1_micro": 0.9514503816793893,
            "accuracy": 0.9514503816793893,
            "hamming_loss": 0.04854961832061069,
            "no_defect_precision": 0.955410225921522,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9528609546397866,
            "no_defect_tp": 1607,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9472693032015066,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9499527856468366,
            "defect_tp": 1509,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537544485711962,
            "recall_macro": 0.9540136357662969,
            "f1_macro": 0.9538582835122849,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9599761051373955,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9551263001485885,
            "no_defect_tp": 1607,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9475327920049968,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9525902668759811,
            "defect_tp": 1517,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9534413340625739,
            "recall_macro": 0.9537578998142275,
            "f1_macro": 0.9535565009702941,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9610545236668664,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9547619047619048,
            "no_defect_tp": 1604,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9458281444582815,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9523510971786834,
            "defect_tp": 1519,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546687008842056,
            "recall_macro": 0.9549406319254043,
            "f1_macro": 0.9547757616743288,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9611476389719068,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9560047562425684,
            "no_defect_tp": 1608,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9481897627965044,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9535467671060891,
            "defect_tp": 1519,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546687008842056,
            "recall_macro": 0.9549406319254043,
            "f1_macro": 0.9547757616743288,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9611476389719068,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9560047562425684,
            "no_defect_tp": 1608,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9481897627965044,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9535467671060891,
            "defect_tp": 1519,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.955909353490934,
            "recall_macro": 0.9561033904987187,
            "f1_macro": 0.955993505402833,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9606908874329958,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9572700296735905,
            "no_defect_tp": 1613,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9511278195488722,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9547169811320755,
            "defect_tp": 1518,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9562109154306757,
            "recall_macro": 0.9564190470643753,
            "f1_macro": 0.9562998767634596,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9612634088200238,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9575541703769664,
            "no_defect_tp": 1613,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9511584220413275,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9550455831499528,
            "defect_tp": 1519,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 65,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9594210348371388,
            "recall_macro": 0.9593838756569384,
            "f1_macro": 0.9593980737502696,
            "precision_micro": 0.9594017094017094,
            "recall_micro": 0.9594017094017094,
            "f1_micro": 0.9594017094017094,
            "accuracy": 0.9594017094017094,
            "hamming_loss": 0.0405982905982906,
            "no_defect_precision": 0.9577549788774894,
            "no_defect_recall": 0.9618181818181818,
            "no_defect_f1": 0.9597822800120955,
            "no_defect_tp": 1587,
            "no_defect_fp": 70,
            "no_defect_tn": 1556,
            "no_defect_fn": 63,
            "no_defect_support": 1650,
            "defect_precision": 0.9610870907967881,
            "defect_recall": 0.956949569495695,
            "defect_f1": 0.9590138674884437,
            "defect_tp": 1556,
            "defect_fp": 63,
            "defect_tn": 1587,
            "defect_fn": 70,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.001_s130_20251207_191245",
    "lr": 0.001,
    "weight_decay": 0.001,
    "seed": 130,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9556917292005385,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.001_s130_20251207_191245",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s130_20251207_191245",
      "timestamp": "2025-12-07T19:14:37.986660",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 15,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.001_s130",
          "seed": 130,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s130_20251207_191245"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9555874203473487,
        "recall_macro": 0.9558476545466492,
        "f1_macro": 0.9556917292005385,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.961768219832736,
        "no_defect_recall": 0.9520993494973389,
        "no_defect_f1": 0.9569093610698366,
        "no_defect_tp": 1610,
        "no_defect_fp": 64,
        "no_defect_tn": 1520,
        "no_defect_fn": 81,
        "no_defect_support": 1691,
        "defect_precision": 0.9494066208619613,
        "defect_recall": 0.9595959595959596,
        "defect_f1": 0.9544740973312402,
        "defect_tp": 1520,
        "defect_fp": 81,
        "defect_tn": 1610,
        "defect_fn": 64,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9600172430566505,
        "recall_macro": 0.9600033545790003,
        "f1_macro": 0.9600094935939207,
        "precision_micro": 0.96001221001221,
        "recall_micro": 0.96001221001221,
        "f1_micro": 0.96001221001221,
        "accuracy": 0.96001221001221,
        "hamming_loss": 0.039987789987789985,
        "no_defect_precision": 0.9594676346037507,
        "no_defect_recall": 0.9612121212121212,
        "no_defect_f1": 0.9603390856796852,
        "no_defect_tp": 1586,
        "no_defect_fp": 67,
        "no_defect_tn": 1559,
        "no_defect_fn": 64,
        "no_defect_support": 1650,
        "defect_precision": 0.9605668515095502,
        "defect_recall": 0.9587945879458795,
        "defect_f1": 0.9596799015081564,
        "defect_tp": 1559,
        "defect_fp": 64,
        "defect_tn": 1586,
        "defect_fn": 67,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6103374267222991,
          0.4109431629899157,
          0.2890740992135084,
          0.24164708912621982,
          0.21644062667336922,
          0.20607180974473513,
          0.19250706078243057,
          0.19079536417787543,
          0.1898066957625385,
          0.18463915798454603,
          0.18382170041984094,
          0.18464288573758872,
          0.18458062896668662,
          0.18497928671507655,
          0.18171610705024527
        ],
        "val_loss": [
          0.5676874908117148,
          0.34522331391389555,
          0.2505623698234558,
          0.2130225570156024,
          0.19300767349509093,
          0.17459168342443612,
          0.16240848471912053,
          0.1591527106670233,
          0.1539670402327409,
          0.15038627515045497,
          0.14663242190503156,
          0.14448275445745543,
          0.14453450088890699,
          0.14408802498991674,
          0.14393909447468245
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8592862426092729,
            "recall_macro": 0.8467381905990717,
            "f1_macro": 0.8475828057979847,
            "precision_micro": 0.8494656488549618,
            "recall_micro": 0.8494656488549618,
            "f1_micro": 0.8494656488549618,
            "accuracy": 0.8494656488549618,
            "hamming_loss": 0.15053435114503816,
            "no_defect_precision": 0.8074948665297741,
            "no_defect_recall": 0.9302188054405677,
            "no_defect_f1": 0.8645232206650179,
            "no_defect_tp": 1573,
            "no_defect_fp": 375,
            "no_defect_tn": 1209,
            "no_defect_fn": 118,
            "no_defect_support": 1691,
            "defect_precision": 0.9110776186887717,
            "defect_recall": 0.7632575757575758,
            "defect_f1": 0.8306423909309516,
            "defect_tp": 1209,
            "defect_fp": 118,
            "defect_tn": 1573,
            "defect_fn": 375,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9055859824626962,
            "recall_macro": 0.9035963194929783,
            "f1_macro": 0.904137900399552,
            "precision_micro": 0.9044274809160305,
            "recall_micro": 0.9044274809160305,
            "f1_micro": 0.9044274809160305,
            "accuracy": 0.9044274809160305,
            "hamming_loss": 0.09557251908396946,
            "no_defect_precision": 0.8905895691609977,
            "no_defect_recall": 0.9290360733293909,
            "no_defect_f1": 0.9094066570188133,
            "no_defect_tp": 1571,
            "no_defect_fp": 193,
            "no_defect_tn": 1391,
            "no_defect_fn": 120,
            "no_defect_support": 1691,
            "defect_precision": 0.9205823957643945,
            "defect_recall": 0.8781565656565656,
            "defect_f1": 0.8988691437802908,
            "defect_tp": 1391,
            "defect_fp": 120,
            "defect_tn": 1571,
            "defect_fn": 193,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9319635343618513,
            "recall_macro": 0.9311904153898536,
            "f1_macro": 0.9314760375364851,
            "precision_micro": 0.9316030534351145,
            "recall_micro": 0.9316030534351145,
            "f1_micro": 0.9316030534351145,
            "accuracy": 0.9316030534351145,
            "hamming_loss": 0.0683969465648855,
            "no_defect_precision": 0.9252173913043479,
            "no_defect_recall": 0.9438202247191011,
            "no_defect_f1": 0.9344262295081968,
            "no_defect_tp": 1596,
            "no_defect_fp": 129,
            "no_defect_tn": 1455,
            "no_defect_fn": 95,
            "no_defect_support": 1691,
            "defect_precision": 0.9387096774193548,
            "defect_recall": 0.9185606060606061,
            "defect_f1": 0.9285258455647735,
            "defect_tp": 1455,
            "defect_fp": 95,
            "defect_tn": 1596,
            "defect_fn": 129,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9407927319829057,
            "recall_macro": 0.9406001917459634,
            "f1_macro": 0.9406876590748863,
            "precision_micro": 0.9407633587786259,
            "recall_micro": 0.9407633587786259,
            "f1_micro": 0.9407633587786259,
            "accuracy": 0.9407633587786259,
            "hamming_loss": 0.059236641221374044,
            "no_defect_precision": 0.9400352733686067,
            "no_defect_recall": 0.9455943228858663,
            "no_defect_f1": 0.9428066037735849,
            "no_defect_tp": 1599,
            "no_defect_fp": 102,
            "no_defect_tn": 1482,
            "no_defect_fn": 92,
            "no_defect_support": 1691,
            "defect_precision": 0.9415501905972046,
            "defect_recall": 0.9356060606060606,
            "defect_f1": 0.9385687143761875,
            "defect_tp": 1482,
            "defect_fp": 92,
            "defect_tn": 1599,
            "defect_fn": 102,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9445979949167955,
            "recall_macro": 0.9450033301674343,
            "f1_macro": 0.944704593191755,
            "precision_micro": 0.944732824427481,
            "recall_micro": 0.944732824427481,
            "f1_micro": 0.944732824427481,
            "accuracy": 0.944732824427481,
            "hamming_loss": 0.05526717557251908,
            "no_defect_precision": 0.9553679131483716,
            "no_defect_recall": 0.9367238320520402,
            "no_defect_f1": 0.9459540161242161,
            "no_defect_tp": 1584,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 107,
            "no_defect_support": 1691,
            "defect_precision": 0.9338280766852195,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9434551702592939,
            "defect_tp": 1510,
            "defect_fp": 107,
            "defect_tn": 1584,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9492171024392064,
            "recall_macro": 0.9493187343571732,
            "f1_macro": 0.9492647234491141,
            "precision_micro": 0.9493129770992367,
            "recall_micro": 0.9493129770992367,
            "f1_micro": 0.9493129770992367,
            "accuracy": 0.9493129770992367,
            "hamming_loss": 0.05068702290076336,
            "no_defect_precision": 0.9525222551928784,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9508293838862559,
            "no_defect_tp": 1605,
            "no_defect_fp": 80,
            "no_defect_tn": 1504,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9459119496855346,
            "defect_recall": 0.9494949494949495,
            "defect_f1": 0.9477000630119723,
            "defect_tp": 1504,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 80,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9506803064237337,
            "recall_macro": 0.9503017310897264,
            "f1_macro": 0.9504621848739496,
            "precision_micro": 0.9505343511450381,
            "recall_micro": 0.9505343511450381,
            "f1_micro": 0.9505343511450381,
            "accuracy": 0.9505343511450381,
            "hamming_loss": 0.04946564885496183,
            "no_defect_precision": 0.9473376243417203,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9523529411764706,
            "no_defect_tp": 1619,
            "no_defect_fp": 90,
            "no_defect_tn": 1494,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9540229885057471,
            "defect_recall": 0.9431818181818182,
            "defect_f1": 0.9485714285714286,
            "defect_tp": 1494,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 90,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.952840678507272,
            "recall_macro": 0.9532464279100885,
            "f1_macro": 0.9529524253731343,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.9632308619650392,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.9540298507462687,
            "no_defect_tp": 1598,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.942450495049505,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.951875,
            "defect_tp": 1523,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9534413340625739,
            "recall_macro": 0.9537578998142275,
            "f1_macro": 0.9535565009702941,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9610545236668664,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9547619047619048,
            "no_defect_tp": 1604,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9458281444582815,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9523510971786834,
            "defect_tp": 1519,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549722858157701,
            "recall_macro": 0.9552562884910608,
            "f1_macro": 0.9550820726596982,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9617224880382775,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9562890276538805,
            "no_defect_tp": 1608,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9482220835932627,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9538751176655161,
            "defect_tp": 1520,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543954563402759,
            "recall_macro": 0.9545450812082983,
            "f1_macro": 0.9544630418324115,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9583828775267539,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9558256744737622,
            "no_defect_tp": 1612,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9504080351537979,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9531004091910608,
            "defect_tp": 1514,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543954563402759,
            "recall_macro": 0.9545450812082983,
            "f1_macro": 0.9544630418324115,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9583828775267539,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9558256744737622,
            "no_defect_tp": 1612,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9504080351537979,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9531004091910608,
            "defect_tp": 1514,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549722858157701,
            "recall_macro": 0.9552562884910608,
            "f1_macro": 0.9550820726596982,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9617224880382775,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9562890276538805,
            "no_defect_tp": 1608,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9482220835932627,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9538751176655161,
            "defect_tp": 1520,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552796750624779,
            "recall_macro": 0.955551971518855,
            "f1_macro": 0.955386900030081,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9617453676031081,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9565992865636147,
            "no_defect_tp": 1609,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9488139825218477,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9541745134965474,
            "defect_tp": 1520,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555874203473487,
            "recall_macro": 0.9558476545466492,
            "f1_macro": 0.9556917292005385,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.961768219832736,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9569093610698366,
            "no_defect_tp": 1610,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9494066208619613,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9544740973312402,
            "defect_tp": 1520,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 64,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9600172430566505,
            "recall_macro": 0.9600033545790003,
            "f1_macro": 0.9600094935939207,
            "precision_micro": 0.96001221001221,
            "recall_micro": 0.96001221001221,
            "f1_micro": 0.96001221001221,
            "accuracy": 0.96001221001221,
            "hamming_loss": 0.039987789987789985,
            "no_defect_precision": 0.9594676346037507,
            "no_defect_recall": 0.9612121212121212,
            "no_defect_f1": 0.9603390856796852,
            "no_defect_tp": 1586,
            "no_defect_fp": 67,
            "no_defect_tn": 1559,
            "no_defect_fn": 64,
            "no_defect_support": 1650,
            "defect_precision": 0.9605668515095502,
            "defect_recall": 0.9587945879458795,
            "defect_f1": 0.9596799015081564,
            "defect_tp": 1559,
            "defect_fp": 64,
            "defect_tn": 1586,
            "defect_fn": 67,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.001_s140_20251207_192057",
    "lr": 0.001,
    "weight_decay": 0.001,
    "seed": 140,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9566119943275115,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.001_s140_20251207_192057",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s140_20251207_192057",
      "timestamp": "2025-12-07T19:22:48.378268",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 15,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.001_s140",
          "seed": 140,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s140_20251207_192057"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9564958995140302,
        "recall_macro": 0.9568145977814813,
        "f1_macro": 0.9566119943275115,
        "precision_micro": 0.9566412213740458,
        "recall_micro": 0.9566412213740458,
        "f1_micro": 0.9566412213740458,
        "accuracy": 0.9566412213740458,
        "hamming_loss": 0.0433587786259542,
        "no_defect_precision": 0.9640503295386459,
        "no_defect_recall": 0.9515079834417505,
        "no_defect_f1": 0.9577380952380953,
        "no_defect_tp": 1609,
        "no_defect_fp": 60,
        "no_defect_tn": 1524,
        "no_defect_fn": 82,
        "no_defect_support": 1691,
        "defect_precision": 0.9489414694894147,
        "defect_recall": 0.9621212121212122,
        "defect_f1": 0.9554858934169279,
        "defect_tp": 1524,
        "defect_fp": 82,
        "defect_tn": 1609,
        "defect_fn": 60,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.960005971010409,
        "recall_macro": 0.9600167728950016,
        "f1_macro": 0.9600105667909242,
        "precision_micro": 0.96001221001221,
        "recall_micro": 0.96001221001221,
        "f1_micro": 0.96001221001221,
        "accuracy": 0.96001221001221,
        "hamming_loss": 0.039987789987789985,
        "no_defect_precision": 0.9611414693381907,
        "no_defect_recall": 0.9593939393939394,
        "no_defect_f1": 0.9602669093114953,
        "no_defect_tp": 1583,
        "no_defect_fp": 64,
        "no_defect_tn": 1562,
        "no_defect_fn": 67,
        "no_defect_support": 1650,
        "defect_precision": 0.9588704726826274,
        "defect_recall": 0.9606396063960639,
        "defect_f1": 0.9597542242703533,
        "defect_tp": 1562,
        "defect_fp": 67,
        "defect_tn": 1583,
        "defect_fn": 64,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6104890822616083,
          0.41040871307939664,
          0.2883010190525813,
          0.23819213214030327,
          0.2158995296915206,
          0.20676802725348015,
          0.1965463703272233,
          0.19078186226065688,
          0.18705522350062884,
          0.18342701729122066,
          0.17712492062456936,
          0.18250161119460062,
          0.17850626942752296,
          0.179729904153357,
          0.17983110019913778
        ],
        "val_loss": [
          0.5680710272147105,
          0.3462025018838736,
          0.24893116693084055,
          0.21076394015779862,
          0.1891549862921238,
          0.1769556337251113,
          0.16528515288463005,
          0.15937100164592266,
          0.1565055255419933,
          0.14860342328365034,
          0.14580843425714052,
          0.1432344000786543,
          0.14427171633220637,
          0.1432118435891775,
          0.14290995408709234
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8605387517035121,
            "recall_macro": 0.8472696360410731,
            "f1_macro": 0.8481167095374518,
            "precision_micro": 0.8500763358778626,
            "recall_micro": 0.8500763358778626,
            "f1_micro": 0.8500763358778626,
            "accuracy": 0.8500763358778626,
            "hamming_loss": 0.1499236641221374,
            "no_defect_precision": 0.8067484662576687,
            "no_defect_recall": 0.9331756357185098,
            "no_defect_f1": 0.8653687962709076,
            "no_defect_tp": 1578,
            "no_defect_fp": 378,
            "no_defect_tn": 1206,
            "no_defect_fn": 113,
            "no_defect_support": 1691,
            "defect_precision": 0.9143290371493555,
            "defect_recall": 0.7613636363636364,
            "defect_f1": 0.8308646228039959,
            "defect_tp": 1206,
            "defect_fp": 113,
            "defect_tn": 1578,
            "defect_fn": 378,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9082013343433342,
            "recall_macro": 0.9055862065360882,
            "f1_macro": 0.9062324563045024,
            "precision_micro": 0.9065648854961832,
            "recall_micro": 0.9065648854961832,
            "f1_micro": 0.9065648854961832,
            "accuracy": 0.9065648854961832,
            "hamming_loss": 0.0934351145038168,
            "no_defect_precision": 0.8892636312535133,
            "no_defect_recall": 0.9355410999408634,
            "no_defect_f1": 0.9118155619596542,
            "no_defect_tp": 1582,
            "no_defect_fp": 197,
            "no_defect_tn": 1387,
            "no_defect_fn": 109,
            "no_defect_support": 1691,
            "defect_precision": 0.9271390374331551,
            "defect_recall": 0.8756313131313131,
            "defect_f1": 0.9006493506493507,
            "defect_tp": 1387,
            "defect_fp": 109,
            "defect_tn": 1582,
            "defect_fn": 197,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9325053450561875,
            "recall_macro": 0.931841702059029,
            "f1_macro": 0.9320949118957049,
            "precision_micro": 0.9322137404580153,
            "recall_micro": 0.9322137404580153,
            "f1_micro": 0.9322137404580153,
            "accuracy": 0.9322137404580153,
            "hamming_loss": 0.06778625954198474,
            "no_defect_precision": 0.926786751888437,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9349355216881594,
            "no_defect_tp": 1595,
            "no_defect_fp": 126,
            "no_defect_tn": 1458,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9382239382239382,
            "defect_recall": 0.9204545454545454,
            "defect_f1": 0.9292543021032504,
            "defect_tp": 1458,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 126,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9425059612774529,
            "recall_macro": 0.9425740252913524,
            "f1_macro": 0.9425385832368333,
            "precision_micro": 0.9425954198473282,
            "recall_micro": 0.9425954198473282,
            "f1_micro": 0.9425954198473282,
            "accuracy": 0.9425954198473282,
            "hamming_loss": 0.057404580152671754,
            "no_defect_precision": 0.945465323058684,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9443457667258733,
            "no_defect_tp": 1595,
            "no_defect_fp": 92,
            "no_defect_tn": 1492,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9395465994962217,
            "defect_recall": 0.9419191919191919,
            "defect_f1": 0.9407313997477932,
            "defect_tp": 1492,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 92,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9467361184187449,
            "recall_macro": 0.9469532701348196,
            "f1_macro": 0.9468273512976049,
            "precision_micro": 0.9468702290076336,
            "recall_micro": 0.9468702290076336,
            "f1_micro": 0.9468702290076336,
            "accuracy": 0.9468702290076336,
            "hamming_loss": 0.05312977099236641,
            "no_defect_precision": 0.9522957662492546,
            "no_defect_recall": 0.9444115907746895,
            "no_defect_f1": 0.9483372921615202,
            "no_defect_tp": 1597,
            "no_defect_fp": 80,
            "no_defect_tn": 1504,
            "no_defect_fn": 94,
            "no_defect_support": 1691,
            "defect_precision": 0.9411764705882353,
            "defect_recall": 0.9494949494949495,
            "defect_f1": 0.9453174104336896,
            "defect_tp": 1504,
            "defect_fp": 94,
            "defect_tn": 1597,
            "defect_fn": 80,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9473574279213756,
            "recall_macro": 0.9477843186447563,
            "f1_macro": 0.9474562206685755,
            "precision_micro": 0.9474809160305343,
            "recall_micro": 0.9474809160305343,
            "f1_micro": 0.9474809160305343,
            "accuracy": 0.9474809160305343,
            "hamming_loss": 0.05251908396946565,
            "no_defect_precision": 0.9589123867069487,
            "no_defect_recall": 0.9384979302188055,
            "no_defect_f1": 0.9485953377166766,
            "no_defect_tp": 1587,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 104,
            "no_defect_support": 1691,
            "defect_precision": 0.9358024691358025,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9463171036204744,
            "defect_tp": 1516,
            "defect_fp": 104,
            "defect_tn": 1587,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9510083015534827,
            "recall_macro": 0.9514124091297361,
            "f1_macro": 0.9511194029850746,
            "precision_micro": 0.9511450381679389,
            "recall_micro": 0.9511450381679389,
            "f1_micro": 0.9511450381679389,
            "accuracy": 0.9511450381679389,
            "hamming_loss": 0.04885496183206107,
            "no_defect_precision": 0.9614225437010248,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9522388059701492,
            "no_defect_tp": 1595,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9405940594059405,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.95,
            "defect_tp": 1520,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9528467832837131,
            "recall_macro": 0.9532664014479508,
            "f1_macro": 0.9529537244120871,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.963789981894991,
            "no_defect_recall": 0.9444115907746895,
            "no_defect_f1": 0.9540023894862605,
            "no_defect_tp": 1597,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 94,
            "no_defect_support": 1691,
            "defect_precision": 0.9419035846724351,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9519050593379138,
            "defect_tp": 1524,
            "defect_fp": 94,
            "defect_tn": 1597,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9505197650186246,
            "recall_macro": 0.951000804914909,
            "f1_macro": 0.9505203961725701,
            "precision_micro": 0.9505343511450381,
            "recall_micro": 0.9505343511450381,
            "f1_micro": 0.9505343511450381,
            "accuracy": 0.9505343511450381,
            "hamming_loss": 0.04946564885496183,
            "no_defect_precision": 0.9664429530201343,
            "no_defect_recall": 0.9367238320520402,
            "no_defect_f1": 0.9513513513513514,
            "no_defect_tp": 1584,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 107,
            "no_defect_support": 1691,
            "defect_precision": 0.934596577017115,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9496894409937888,
            "defect_tp": 1529,
            "defect_fp": 107,
            "defect_tn": 1584,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543585725744772,
            "recall_macro": 0.9546649224354724,
            "f1_macro": 0.9544724226362397,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9616766467065868,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9556679559654865,
            "no_defect_tp": 1606,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9470404984423676,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9532768893069928,
            "defect_tp": 1520,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555804279291884,
            "recall_macro": 0.955887601622374,
            "f1_macro": 0.9556946394782198,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.962874251497006,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9568580779529902,
            "no_defect_tp": 1608,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9482866043613707,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9545312010034493,
            "defect_tp": 1522,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9558955223880596,
            "recall_macro": 0.9561433375744435,
            "f1_macro": 0.9559965603418161,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9617910447761194,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9572192513368984,
            "no_defect_tp": 1611,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.95,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9547738693467337,
            "defect_tp": 1520,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552758624805838,
            "recall_macro": 0.9556518392081669,
            "f1_macro": 0.9553938920370797,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9645219482862297,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9564698867024448,
            "no_defect_tp": 1604,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9460297766749379,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9543178973717147,
            "defect_tp": 1525,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9561898707542988,
            "recall_macro": 0.9565189147536871,
            "f1_macro": 0.9563071339093866,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9640287769784173,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9574278058946115,
            "no_defect_tp": 1608,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9483509645301804,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9551864619241617,
            "defect_tp": 1524,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9564958995140302,
            "recall_macro": 0.9568145977814813,
            "f1_macro": 0.9566119943275115,
            "precision_micro": 0.9566412213740458,
            "recall_micro": 0.9566412213740458,
            "f1_micro": 0.9566412213740458,
            "accuracy": 0.9566412213740458,
            "hamming_loss": 0.0433587786259542,
            "no_defect_precision": 0.9640503295386459,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9577380952380953,
            "no_defect_tp": 1609,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9489414694894147,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9554858934169279,
            "defect_tp": 1524,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 60,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.960005971010409,
            "recall_macro": 0.9600167728950016,
            "f1_macro": 0.9600105667909242,
            "precision_micro": 0.96001221001221,
            "recall_micro": 0.96001221001221,
            "f1_micro": 0.96001221001221,
            "accuracy": 0.96001221001221,
            "hamming_loss": 0.039987789987789985,
            "no_defect_precision": 0.9611414693381907,
            "no_defect_recall": 0.9593939393939394,
            "no_defect_f1": 0.9602669093114953,
            "no_defect_tp": 1583,
            "no_defect_fp": 64,
            "no_defect_tn": 1562,
            "no_defect_fn": 67,
            "no_defect_support": 1650,
            "defect_precision": 0.9588704726826274,
            "defect_recall": 0.9606396063960639,
            "defect_f1": 0.9597542242703533,
            "defect_tp": 1562,
            "defect_fp": 67,
            "defect_tn": 1583,
            "defect_fn": 64,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.001_s150_20251207_152752",
    "lr": 0.001,
    "weight_decay": 0.001,
    "seed": 150,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9556974171139374,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.001_s150_20251207_152752",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s150_20251207_152752",
      "timestamp": "2025-12-07T15:29:47.581671",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 11,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.001_s150",
          "seed": 150,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.001_s150_20251207_152752"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9555788754283565,
        "recall_macro": 0.9559275486980987,
        "f1_macro": 0.9556974171139374,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.963985594237695,
        "no_defect_recall": 0.9497338852749853,
        "no_defect_f1": 0.956806672624367,
        "no_defect_tp": 1606,
        "no_defect_fp": 60,
        "no_defect_tn": 1524,
        "no_defect_fn": 85,
        "no_defect_support": 1691,
        "defect_precision": 0.947172156619018,
        "defect_recall": 0.9621212121212122,
        "defect_f1": 0.9545881616035077,
        "defect_tp": 1524,
        "defect_fp": 85,
        "defect_tn": 1606,
        "defect_fn": 60,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9600316176007377,
        "recall_macro": 0.9599944090349994,
        "f1_macro": 0.9600086290322205,
        "precision_micro": 0.96001221001221,
        "recall_micro": 0.96001221001221,
        "f1_micro": 0.96001221001221,
        "accuracy": 0.96001221001221,
        "hamming_loss": 0.039987789987789985,
        "no_defect_precision": 0.9583584791792396,
        "no_defect_recall": 0.9624242424242424,
        "no_defect_f1": 0.9603870577562745,
        "no_defect_tp": 1588,
        "no_defect_fp": 69,
        "no_defect_tn": 1557,
        "no_defect_fn": 62,
        "no_defect_support": 1650,
        "defect_precision": 0.9617047560222359,
        "defect_recall": 0.9575645756457565,
        "defect_f1": 0.9596302003081664,
        "defect_tp": 1557,
        "defect_fp": 62,
        "defect_tn": 1588,
        "defect_fn": 69,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6138981508410626,
          0.4153968732975517,
          0.2876202451010628,
          0.23961356743609058,
          0.2209574187088711,
          0.20797926380793919,
          0.20050285834522927,
          0.19440809977104476,
          0.1874939826741877,
          0.1826426781184005,
          0.17904107054407128,
          0.18420535260538676,
          0.1835238328788071,
          0.18126607059684258,
          0.178526084885687
        ],
        "val_loss": [
          0.570004389836238,
          0.3504531950904773,
          0.25283536372276455,
          0.2152326049712988,
          0.18924924788566735,
          0.1733610678750735,
          0.16558820940554142,
          0.1571949448149938,
          0.15331568855505723,
          0.14851571017732987,
          0.14704166710949862,
          0.14351437613368034,
          0.14348470204724714,
          0.14286408645029253,
          0.1428336095638
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8203164556962026,
            "recall_macro": 0.8070371440603552,
            "f1_macro": 0.8073300554709355,
            "precision_micro": 0.8100763358778625,
            "recall_micro": 0.8100763358778625,
            "f1_micro": 0.8100763358778625,
            "accuracy": 0.8100763358778625,
            "hamming_loss": 0.1899236641221374,
            "no_defect_precision": 0.7706329113924051,
            "no_defect_recall": 0.9000591366055588,
            "no_defect_f1": 0.8303327877795963,
            "no_defect_tp": 1522,
            "no_defect_fp": 453,
            "no_defect_tn": 1131,
            "no_defect_fn": 169,
            "no_defect_support": 1691,
            "defect_precision": 0.87,
            "defect_recall": 0.7140151515151515,
            "defect_f1": 0.7843273231622746,
            "defect_tp": 1131,
            "defect_fp": 169,
            "defect_tn": 1522,
            "defect_fn": 453,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9036507501376313,
            "recall_macro": 0.9002000713820644,
            "f1_macro": 0.900951129460968,
            "precision_micro": 0.9013740458015267,
            "recall_micro": 0.9013740458015267,
            "f1_micro": 0.9013740458015267,
            "accuracy": 0.9013740458015267,
            "hamming_loss": 0.09862595419847328,
            "no_defect_precision": 0.8804226918798665,
            "no_defect_recall": 0.9361324659964518,
            "no_defect_f1": 0.9074233304671826,
            "no_defect_tp": 1583,
            "no_defect_fp": 215,
            "no_defect_tn": 1369,
            "no_defect_fn": 108,
            "no_defect_support": 1691,
            "defect_precision": 0.926878808395396,
            "defect_recall": 0.8642676767676768,
            "defect_f1": 0.8944789284547533,
            "defect_tp": 1369,
            "defect_fp": 108,
            "defect_tn": 1583,
            "defect_fn": 215,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9248834911065753,
            "recall_macro": 0.9224679527385027,
            "f1_macro": 0.9231053889041831,
            "precision_micro": 0.9233587786259542,
            "recall_micro": 0.9233587786259542,
            "f1_micro": 0.9233587786259542,
            "accuracy": 0.9233587786259542,
            "hamming_loss": 0.0766412213740458,
            "no_defect_precision": 0.9063205417607223,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9275194917701415,
            "no_defect_tp": 1606,
            "no_defect_fp": 166,
            "no_defect_tn": 1418,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9434464404524284,
            "defect_recall": 0.8952020202020202,
            "defect_f1": 0.9186912860382248,
            "defect_tp": 1418,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 166,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9382706863938515,
            "recall_macro": 0.9387340659701688,
            "f1_macro": 0.9383005861514264,
            "precision_micro": 0.9383206106870229,
            "recall_micro": 0.9383206106870229,
            "f1_micro": 0.9383206106870229,
            "accuracy": 0.9383206106870229,
            "hamming_loss": 0.0616793893129771,
            "no_defect_precision": 0.953134510042605,
            "no_defect_recall": 0.9260792430514488,
            "no_defect_f1": 0.9394121175764847,
            "no_defect_tp": 1566,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 125,
            "no_defect_support": 1691,
            "defect_precision": 0.9234068627450981,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.9371890547263682,
            "defect_tp": 1507,
            "defect_fp": 125,
            "defect_tn": 1566,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9468666468001012,
            "recall_macro": 0.946753534756196,
            "f1_macro": 0.9468069019129912,
            "precision_micro": 0.9468702290076336,
            "recall_micro": 0.9468702290076336,
            "f1_micro": 0.9468702290076336,
            "accuracy": 0.9468702290076336,
            "hamming_loss": 0.05312977099236641,
            "no_defect_precision": 0.9469652327637006,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.948642266824085,
            "no_defect_tp": 1607,
            "no_defect_fp": 90,
            "no_defect_tn": 1494,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9467680608365019,
            "defect_recall": 0.9431818181818182,
            "defect_f1": 0.9449715370018975,
            "defect_tp": 1494,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 90,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9493332521668465,
            "recall_macro": 0.9491789195921366,
            "f1_macro": 0.9492504014039804,
            "precision_micro": 0.9493129770992367,
            "recall_micro": 0.9493129770992367,
            "f1_micro": 0.9493129770992367,
            "accuracy": 0.9493129770992367,
            "hamming_loss": 0.05068702290076336,
            "no_defect_precision": 0.9487934078869924,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9510324483775812,
            "no_defect_tp": 1612,
            "no_defect_fp": 87,
            "no_defect_tn": 1497,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9498730964467005,
            "defect_recall": 0.9450757575757576,
            "defect_f1": 0.9474683544303798,
            "defect_tp": 1497,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 87,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9516244590174212,
            "recall_macro": 0.9518439868824258,
            "f1_macro": 0.9517167902587447,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.9570661896243292,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9530878859857482,
            "no_defect_tp": 1605,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9461827284105131,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.950345694531741,
            "defect_tp": 1512,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9528728386436043,
            "recall_macro": 0.9530067454557402,
            "f1_macro": 0.9529340907428118,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.9566250742721331,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9543568464730291,
            "no_defect_tp": 1610,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9491206030150754,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.9515113350125944,
            "defect_tp": 1511,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543571738750878,
            "recall_macro": 0.9546848959733347,
            "f1_macro": 0.9544738668006896,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9622302158273381,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9556415599880917,
            "no_defect_tp": 1605,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9464841319228375,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9533061736132874,
            "defect_tp": 1521,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546960754823449,
            "recall_macro": 0.9548607377739549,
            "f1_macro": 0.9547694820634448,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9589530041641879,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9561091340450771,
            "no_defect_tp": 1612,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9504391468005019,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9534298300818125,
            "defect_tp": 1515,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555788754283565,
            "recall_macro": 0.9559275486980987,
            "f1_macro": 0.9556974171139374,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.963985594237695,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.956806672624367,
            "no_defect_tp": 1606,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.947172156619018,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9545881616035077,
            "defect_tp": 1524,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9550585182834637,
            "recall_macro": 0.9550765266502996,
            "f1_macro": 0.9550674331499445,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9568047337278106,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9565217391304348,
            "no_defect_tp": 1617,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9533123028391167,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.9536131271694541,
            "defect_tp": 1511,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546735074626865,
            "recall_macro": 0.9549206583875419,
            "f1_macro": 0.9547742425735332,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9605970149253731,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9560308972073678,
            "no_defect_tp": 1609,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.94875,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9535175879396985,
            "defect_tp": 1518,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552907144664282,
            "recall_macro": 0.9555120244431303,
            "f1_macro": 0.9553838694795995,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.960644007155635,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9566508313539193,
            "no_defect_tp": 1611,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9499374217772215,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9541169076052797,
            "defect_tp": 1518,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552907144664282,
            "recall_macro": 0.9555120244431303,
            "f1_macro": 0.9553838694795995,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.960644007155635,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9566508313539193,
            "no_defect_tp": 1611,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9499374217772215,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9541169076052797,
            "defect_tp": 1518,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 66,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9600316176007377,
            "recall_macro": 0.9599944090349994,
            "f1_macro": 0.9600086290322205,
            "precision_micro": 0.96001221001221,
            "recall_micro": 0.96001221001221,
            "f1_micro": 0.96001221001221,
            "accuracy": 0.96001221001221,
            "hamming_loss": 0.039987789987789985,
            "no_defect_precision": 0.9583584791792396,
            "no_defect_recall": 0.9624242424242424,
            "no_defect_f1": 0.9603870577562745,
            "no_defect_tp": 1588,
            "no_defect_fp": 69,
            "no_defect_tn": 1557,
            "no_defect_fn": 62,
            "no_defect_support": 1650,
            "defect_precision": 0.9617047560222359,
            "defect_recall": 0.9575645756457565,
            "defect_f1": 0.9596302003081664,
            "defect_tp": 1557,
            "defect_fp": 62,
            "defect_tn": 1588,
            "defect_fn": 69,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.01_s10_20251207_185013",
    "lr": 0.001,
    "weight_decay": 0.01,
    "seed": 10,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9559980383858333,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.01_s10_20251207_185013",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s10_20251207_185013",
      "timestamp": "2025-12-07T18:52:08.026998",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.01_s10",
          "seed": 10,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s10_20251207_185013"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9558906492407503,
        "recall_macro": 0.9561633111123058,
        "f1_macro": 0.9559980383858333,
        "precision_micro": 0.956030534351145,
        "recall_micro": 0.956030534351145,
        "f1_micro": 0.956030534351145,
        "accuracy": 0.956030534351145,
        "hamming_loss": 0.04396946564885496,
        "no_defect_precision": 0.9623430962343096,
        "no_defect_recall": 0.9520993494973389,
        "no_defect_f1": 0.9571938168846611,
        "no_defect_tp": 1610,
        "no_defect_fp": 63,
        "no_defect_tn": 1521,
        "no_defect_fn": 81,
        "no_defect_support": 1691,
        "defect_precision": 0.949438202247191,
        "defect_recall": 0.9602272727272727,
        "defect_f1": 0.9548022598870056,
        "defect_tp": 1521,
        "defect_fp": 81,
        "defect_tn": 1610,
        "defect_fn": 63,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9612448770014407,
        "recall_macro": 0.961219948563122,
        "f1_macro": 0.9612301731331656,
        "precision_micro": 0.9612332112332113,
        "recall_micro": 0.9612332112332113,
        "f1_micro": 0.9612332112332113,
        "accuracy": 0.9612332112332113,
        "hamming_loss": 0.03876678876678877,
        "no_defect_precision": 0.9601208459214502,
        "no_defect_recall": 0.963030303030303,
        "no_defect_f1": 0.9615733736762481,
        "no_defect_tp": 1589,
        "no_defect_fp": 66,
        "no_defect_tn": 1560,
        "no_defect_fn": 61,
        "no_defect_support": 1650,
        "defect_precision": 0.9623689080814312,
        "defect_recall": 0.959409594095941,
        "defect_f1": 0.9608869725900832,
        "defect_tp": 1560,
        "defect_fp": 61,
        "defect_tn": 1589,
        "defect_fn": 66,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6182012415830062,
          0.4159121690434891,
          0.2924418137038602,
          0.24394152235535896,
          0.21886985892406569,
          0.20565448495633432,
          0.20059039783527663,
          0.19585072545326904,
          0.19014600000371493,
          0.18255511393856305,
          0.18369916564625177,
          0.18246009366033467,
          0.17644722716080094,
          0.17765247662820577,
          0.1829982678012369
        ],
        "val_loss": [
          0.5708073240060073,
          0.3496908046878301,
          0.25272033965358365,
          0.21297742770268366,
          0.19076335745362136,
          0.17593122459948063,
          0.1673546228557825,
          0.1590917666371052,
          0.1548018025664183,
          0.14969798707618162,
          0.14782607082564098,
          0.14592296644472158,
          0.1442683280373995,
          0.14394904501163042,
          0.14375855042957342
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8465725117809524,
            "recall_macro": 0.8348670023714375,
            "f1_macro": 0.8355815710939134,
            "precision_micro": 0.8375572519083969,
            "recall_micro": 0.8375572519083969,
            "f1_micro": 0.8375572519083969,
            "accuracy": 0.8375572519083969,
            "hamming_loss": 0.16244274809160306,
            "no_defect_precision": 0.7982501286670097,
            "no_defect_recall": 0.9172087522176227,
            "no_defect_f1": 0.8536048431480462,
            "no_defect_tp": 1551,
            "no_defect_fp": 392,
            "no_defect_tn": 1192,
            "no_defect_fn": 140,
            "no_defect_support": 1691,
            "defect_precision": 0.8948948948948949,
            "defect_recall": 0.7525252525252525,
            "defect_f1": 0.8175582990397805,
            "defect_tp": 1192,
            "defect_fp": 140,
            "defect_tn": 1551,
            "defect_fn": 392,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9011583555672467,
            "recall_macro": 0.8985458144424732,
            "f1_macro": 0.8991808806209367,
            "precision_micro": 0.8995419847328244,
            "recall_micro": 0.8995419847328244,
            "f1_micro": 0.8995419847328244,
            "accuracy": 0.8995419847328244,
            "hamming_loss": 0.10045801526717557,
            "no_defect_precision": 0.8825842696629214,
            "no_defect_recall": 0.9290360733293909,
            "no_defect_f1": 0.9052146355517142,
            "no_defect_tp": 1571,
            "no_defect_fp": 209,
            "no_defect_tn": 1375,
            "no_defect_fn": 120,
            "no_defect_support": 1691,
            "defect_precision": 0.919732441471572,
            "defect_recall": 0.8680555555555556,
            "defect_f1": 0.8931471256901592,
            "defect_tp": 1375,
            "defect_fp": 120,
            "defect_tn": 1571,
            "defect_fn": 209,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9330511638325276,
            "recall_macro": 0.9330683012860719,
            "f1_macro": 0.9330596453050193,
            "precision_micro": 0.9331297709923664,
            "recall_micro": 0.9331297709923664,
            "f1_micro": 0.9331297709923664,
            "accuracy": 0.9331297709923664,
            "hamming_loss": 0.06687022900763359,
            "no_defect_precision": 0.9355029585798816,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.935226264418811,
            "no_defect_tp": 1581,
            "no_defect_fp": 109,
            "no_defect_tn": 1475,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9305993690851735,
            "defect_recall": 0.9311868686868687,
            "defect_f1": 0.9308930261912275,
            "defect_tp": 1475,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 109,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9383816579212191,
            "recall_macro": 0.9371639965593248,
            "f1_macro": 0.9375700829782463,
            "precision_micro": 0.9377099236641221,
            "recall_micro": 0.9377099236641221,
            "f1_micro": 0.9377099236641221,
            "accuracy": 0.9377099236641221,
            "hamming_loss": 0.06229007633587786,
            "no_defect_precision": 0.9275445658424382,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9405247813411078,
            "no_defect_tp": 1613,
            "no_defect_fp": 126,
            "no_defect_tn": 1458,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.94921875,
            "defect_recall": 0.9204545454545454,
            "defect_f1": 0.9346153846153846,
            "defect_tp": 1458,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 126,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9455140332690759,
            "recall_macro": 0.9457305909479179,
            "f1_macro": 0.9456049915573199,
            "precision_micro": 0.945648854961832,
            "recall_micro": 0.945648854961832,
            "f1_micro": 0.945648854961832,
            "accuracy": 0.945648854961832,
            "hamming_loss": 0.05435114503816794,
            "no_defect_precision": 0.951103160405486,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9471496437054632,
            "no_defect_tp": 1595,
            "no_defect_fp": 82,
            "no_defect_tn": 1502,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9399249061326659,
            "defect_recall": 0.9482323232323232,
            "defect_f1": 0.9440603394091767,
            "defect_tp": 1502,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 82,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9480209828898063,
            "recall_macro": 0.9480561080945469,
            "f1_macro": 0.9480381908797342,
            "precision_micro": 0.9480916030534351,
            "recall_micro": 0.9480916030534351,
            "f1_micro": 0.9480916030534351,
            "accuracy": 0.9480916030534351,
            "hamming_loss": 0.051908396946564885,
            "no_defect_precision": 0.9502664298401421,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9497041420118343,
            "no_defect_tp": 1605,
            "no_defect_fp": 84,
            "no_defect_tn": 1500,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9457755359394704,
            "defect_recall": 0.946969696969697,
            "defect_f1": 0.9463722397476341,
            "defect_tp": 1500,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 84,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9509976817014087,
            "recall_macro": 0.9513125414404243,
            "f1_macro": 0.95111210628452,
            "precision_micro": 0.9511450381679389,
            "recall_micro": 0.9511450381679389,
            "f1_micro": 0.9511450381679389,
            "accuracy": 0.9511450381679389,
            "hamming_loss": 0.04885496183206107,
            "no_defect_precision": 0.9586578789694428,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.9523809523809523,
            "no_defect_tp": 1600,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9433374844333748,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9498432601880877,
            "defect_tp": 1515,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.951674644898983,
            "recall_macro": 0.9517441191931139,
            "f1_macro": 0.9517079582522322,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.9543568464730291,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9532267613972765,
            "no_defect_tp": 1610,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.948992443324937,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.9501891551071879,
            "defect_tp": 1507,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9528297698669221,
            "recall_macro": 0.953166533758639,
            "f1_macro": 0.9529468773183704,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.9610077984403119,
            "no_defect_recall": 0.9473684210526315,
            "no_defect_f1": 0.9541393686718285,
            "no_defect_tp": 1602,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 89,
            "no_defect_support": 1691,
            "defect_precision": 0.9446517412935324,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9517543859649122,
            "defect_tp": 1519,
            "defect_fp": 89,
            "defect_tn": 1602,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546735074626865,
            "recall_macro": 0.9549206583875419,
            "f1_macro": 0.9547742425735332,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9605970149253731,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9560308972073678,
            "no_defect_tp": 1609,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.94875,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9535175879396985,
            "defect_tp": 1518,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549680728348249,
            "recall_macro": 0.9552962355667856,
            "f1_macro": 0.9550849558369219,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9628297362110312,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.956236975290265,
            "no_defect_tp": 1606,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9471064094586186,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9539329363835788,
            "defect_tp": 1522,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555789717945619,
            "recall_macro": 0.9559075751602364,
            "f1_macro": 0.9556960448731542,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9634292565947242,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9568323905924382,
            "no_defect_tp": 1607,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9477286869943995,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9545596991538703,
            "defect_tp": 1523,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9558955223880596,
            "recall_macro": 0.9561433375744435,
            "f1_macro": 0.9559965603418161,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9617910447761194,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9572192513368984,
            "no_defect_tp": 1611,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.95,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9547738693467337,
            "defect_tp": 1520,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9558906492407503,
            "recall_macro": 0.9561633111123058,
            "f1_macro": 0.9559980383858333,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9623430962343096,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9571938168846611,
            "no_defect_tp": 1610,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.949438202247191,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9548022598870056,
            "defect_tp": 1521,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9558906492407503,
            "recall_macro": 0.9561633111123058,
            "f1_macro": 0.9559980383858333,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9623430962343096,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9571938168846611,
            "no_defect_tp": 1610,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.949438202247191,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9548022598870056,
            "defect_tp": 1521,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 63,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9612448770014407,
            "recall_macro": 0.961219948563122,
            "f1_macro": 0.9612301731331656,
            "precision_micro": 0.9612332112332113,
            "recall_micro": 0.9612332112332113,
            "f1_micro": 0.9612332112332113,
            "accuracy": 0.9612332112332113,
            "hamming_loss": 0.03876678876678877,
            "no_defect_precision": 0.9601208459214502,
            "no_defect_recall": 0.963030303030303,
            "no_defect_f1": 0.9615733736762481,
            "no_defect_tp": 1589,
            "no_defect_fp": 66,
            "no_defect_tn": 1560,
            "no_defect_fn": 61,
            "no_defect_support": 1650,
            "defect_precision": 0.9623689080814312,
            "defect_recall": 0.959409594095941,
            "defect_f1": 0.9608869725900832,
            "defect_tp": 1560,
            "defect_fp": 61,
            "defect_tn": 1589,
            "defect_fn": 66,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.01_s20_20251207_134305",
    "lr": 0.001,
    "weight_decay": 0.01,
    "seed": 20,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9562934819543152,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.01_s20_20251207_134305",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s20_20251207_134305",
      "timestamp": "2025-12-07T13:44:56.503772",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.01_s20",
          "seed": 20,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s20_20251207_134305"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9562522815889489,
        "recall_macro": 0.9563391529129258,
        "f1_macro": 0.9562934819543152,
        "precision_micro": 0.9563358778625954,
        "recall_micro": 0.9563358778625954,
        "f1_micro": 0.9563358778625954,
        "accuracy": 0.9563358778625954,
        "hamming_loss": 0.04366412213740458,
        "no_defect_precision": 0.9590747330960854,
        "no_defect_recall": 0.9562389118864577,
        "no_defect_f1": 0.9576547231270358,
        "no_defect_tp": 1617,
        "no_defect_fp": 69,
        "no_defect_tn": 1515,
        "no_defect_fn": 74,
        "no_defect_support": 1691,
        "defect_precision": 0.9534298300818125,
        "defect_recall": 0.9564393939393939,
        "defect_f1": 0.9549322407815947,
        "defect_tp": 1515,
        "defect_fp": 74,
        "defect_tn": 1617,
        "defect_fn": 69,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.960023744247984,
        "recall_macro": 0.9599988818069999,
        "f1_macro": 0.9600090762239739,
        "precision_micro": 0.96001221001221,
        "recall_micro": 0.96001221001221,
        "f1_micro": 0.96001221001221,
        "accuracy": 0.96001221001221,
        "hamming_loss": 0.039987789987789985,
        "no_defect_precision": 0.9589123867069487,
        "no_defect_recall": 0.9618181818181818,
        "no_defect_f1": 0.9603630862329803,
        "no_defect_tp": 1587,
        "no_defect_fp": 68,
        "no_defect_tn": 1558,
        "no_defect_fn": 63,
        "no_defect_support": 1650,
        "defect_precision": 0.9611351017890192,
        "defect_recall": 0.958179581795818,
        "defect_f1": 0.9596550662149677,
        "defect_tp": 1558,
        "defect_fp": 63,
        "defect_tn": 1587,
        "defect_fn": 68,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6241928528542299,
          0.4148089939330911,
          0.28987833171708816,
          0.24213401885960392,
          0.21712209212605424,
          0.2045812498326082,
          0.1978244720393145,
          0.19695403361420252,
          0.18505795783203516,
          0.1862761029763202,
          0.1814761076387501,
          0.18210131528487267,
          0.18037860522584437,
          0.18223078754656485,
          0.18250283910639614
        ],
        "val_loss": [
          0.5756359043029639,
          0.3490434644313959,
          0.2503004982494391,
          0.21121727732511666,
          0.19300036848737642,
          0.1735076934385758,
          0.163283359259367,
          0.15998504525766924,
          0.1533571815548035,
          0.14946824197585767,
          0.14586193716296783,
          0.14404247801464337,
          0.14413929573045328,
          0.14378345886675212,
          0.14387295925273344
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8444569901762053,
            "recall_macro": 0.8170786068849345,
            "f1_macro": 0.8167906805015941,
            "precision_micro": 0.8213740458015267,
            "recall_micro": 0.8213740458015267,
            "f1_micro": 0.8213740458015267,
            "accuracy": 0.8213740458015267,
            "hamming_loss": 0.17862595419847327,
            "no_defect_precision": 0.7630827783063748,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.8457685209596625,
            "no_defect_tp": 1604,
            "no_defect_fp": 498,
            "no_defect_tn": 1086,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9258312020460358,
            "defect_recall": 0.6856060606060606,
            "defect_f1": 0.7878128400435256,
            "defect_tp": 1086,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 498,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9051535298268125,
            "recall_macro": 0.9017384071346224,
            "f1_macro": 0.9024882924154627,
            "precision_micro": 0.9029007633587787,
            "recall_micro": 0.9029007633587787,
            "f1_micro": 0.9029007633587787,
            "accuracy": 0.9029007633587787,
            "hamming_loss": 0.09709923664122137,
            "no_defect_precision": 0.8820255982192543,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.9088302752293578,
            "no_defect_tp": 1585,
            "no_defect_fp": 212,
            "no_defect_tn": 1372,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.9282814614343707,
            "defect_recall": 0.8661616161616161,
            "defect_f1": 0.8961463096015676,
            "defect_tp": 1372,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 212,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9303456591639871,
            "recall_macro": 0.9297120002508825,
            "f1_macro": 0.9299555464401335,
            "precision_micro": 0.9300763358778626,
            "recall_micro": 0.9300763358778626,
            "f1_micro": 0.9300763358778626,
            "accuracy": 0.9300763358778626,
            "hamming_loss": 0.06992366412213741,
            "no_defect_precision": 0.925,
            "no_defect_recall": 0.9408633944411591,
            "no_defect_f1": 0.9328642626795661,
            "no_defect_tp": 1591,
            "no_defect_fp": 129,
            "no_defect_tn": 1455,
            "no_defect_fn": 100,
            "no_defect_support": 1691,
            "defect_precision": 0.9356913183279743,
            "defect_recall": 0.9185606060606061,
            "defect_f1": 0.9270468302007009,
            "defect_tp": 1455,
            "defect_fp": 100,
            "defect_tn": 1591,
            "defect_fn": 129,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9397281358022203,
            "recall_macro": 0.9398729309654797,
            "f1_macro": 0.939793417724732,
            "precision_micro": 0.9398473282442749,
            "recall_micro": 0.9398473282442749,
            "f1_micro": 0.9398473282442749,
            "accuracy": 0.9398473282442749,
            "hamming_loss": 0.06015267175572519,
            "no_defect_precision": 0.9441141498216409,
            "no_defect_recall": 0.9390892962743939,
            "no_defect_f1": 0.9415950192706789,
            "no_defect_tp": 1588,
            "no_defect_fp": 94,
            "no_defect_tn": 1490,
            "no_defect_fn": 103,
            "no_defect_support": 1691,
            "defect_precision": 0.9353421217827997,
            "defect_recall": 0.9406565656565656,
            "defect_f1": 0.937991816178785,
            "defect_tp": 1490,
            "defect_fp": 103,
            "defect_tn": 1588,
            "defect_fn": 94,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9430104471088078,
            "recall_macro": 0.9434689144550173,
            "f1_macro": 0.9428904549544471,
            "precision_micro": 0.9429007633587786,
            "recall_micro": 0.9429007633587786,
            "f1_micro": 0.9429007633587786,
            "accuracy": 0.9429007633587786,
            "hamming_loss": 0.05709923664122137,
            "no_defect_precision": 0.961916461916462,
            "no_defect_recall": 0.9260792430514488,
            "no_defect_f1": 0.943657728231395,
            "no_defect_tp": 1566,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 125,
            "no_defect_support": 1691,
            "defect_precision": 0.9241044323011536,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9421231816774992,
            "defect_tp": 1522,
            "defect_fp": 125,
            "defect_tn": 1566,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9520019412763893,
            "recall_macro": 0.9520198286830457,
            "f1_macro": 0.9520107959492604,
            "precision_micro": 0.9520610687022901,
            "recall_micro": 0.9520610687022901,
            "f1_micro": 0.9520610687022901,
            "accuracy": 0.9520610687022901,
            "hamming_loss": 0.04793893129770992,
            "no_defect_precision": 0.9538461538461539,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.953564034309376,
            "no_defect_tp": 1612,
            "no_defect_fp": 78,
            "no_defect_tn": 1506,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9501577287066246,
            "defect_recall": 0.9507575757575758,
            "defect_f1": 0.9504575575891449,
            "defect_tp": 1506,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 78,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.952575320307986,
            "recall_macro": 0.9520958027943539,
            "f1_macro": 0.9522923930038555,
            "precision_micro": 0.9523664122137404,
            "recall_micro": 0.9523664122137404,
            "f1_micro": 0.9523664122137404,
            "accuracy": 0.9523664122137404,
            "hamming_loss": 0.04763358778625954,
            "no_defect_precision": 0.9480443666082895,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.954171562867215,
            "no_defect_tp": 1624,
            "no_defect_fp": 89,
            "no_defect_tn": 1495,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9571062740076824,
            "defect_recall": 0.9438131313131313,
            "defect_f1": 0.9504132231404959,
            "defect_tp": 1495,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 89,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9525530988007314,
            "recall_macro": 0.952990691958019,
            "f1_macro": 0.9526501239421774,
            "precision_micro": 0.9526717557251908,
            "recall_micro": 0.9526717557251908,
            "f1_micro": 0.9526717557251908,
            "accuracy": 0.9526717557251908,
            "hamming_loss": 0.04732824427480916,
            "no_defect_precision": 0.964328899637243,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.953662182361734,
            "no_defect_tp": 1595,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9407772979642196,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9516380655226209,
            "defect_tp": 1525,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549695002518328,
            "recall_macro": 0.9552762620289232,
            "f1_macro": 0.9550835310572297,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9622754491017964,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9562630169592383,
            "no_defect_tp": 1607,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9476635514018692,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9539040451552211,
            "defect_tp": 1521,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9558906492407503,
            "recall_macro": 0.9561633111123058,
            "f1_macro": 0.9559980383858333,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9623430962343096,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9571938168846611,
            "no_defect_tp": 1610,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.949438202247191,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9548022598870056,
            "defect_tp": 1521,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556177330517805,
            "recall_macro": 0.9557677603951997,
            "f1_macro": 0.9556855105080515,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9595719381688466,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9570115624073525,
            "no_defect_tp": 1614,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9516635279347144,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9543594586087504,
            "defect_tp": 1516,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9562522815889489,
            "recall_macro": 0.9563391529129258,
            "f1_macro": 0.9562934819543152,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9590747330960854,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9576547231270358,
            "no_defect_tp": 1617,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9534298300818125,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9549322407815947,
            "defect_tp": 1515,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9559017570412629,
            "recall_macro": 0.9561233640365812,
            "f1_macro": 0.955995049349742,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9612403100775194,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9572446555819477,
            "no_defect_tp": 1612,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505632040050063,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9547454431175362,
            "defect_tp": 1519,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9559017570412629,
            "recall_macro": 0.9561233640365812,
            "f1_macro": 0.955995049349742,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9612403100775194,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9572446555819477,
            "no_defect_tp": 1612,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505632040050063,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9547454431175362,
            "defect_tp": 1519,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555929571137092,
            "recall_macro": 0.9558276810087869,
            "f1_macro": 0.9556902243047389,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.961217183770883,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9569349569349569,
            "no_defect_tp": 1611,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9499687304565353,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9544454916745209,
            "defect_tp": 1519,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 65,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.960023744247984,
            "recall_macro": 0.9599988818069999,
            "f1_macro": 0.9600090762239739,
            "precision_micro": 0.96001221001221,
            "recall_micro": 0.96001221001221,
            "f1_micro": 0.96001221001221,
            "accuracy": 0.96001221001221,
            "hamming_loss": 0.039987789987789985,
            "no_defect_precision": 0.9589123867069487,
            "no_defect_recall": 0.9618181818181818,
            "no_defect_f1": 0.9603630862329803,
            "no_defect_tp": 1587,
            "no_defect_fp": 68,
            "no_defect_tn": 1558,
            "no_defect_fn": 63,
            "no_defect_support": 1650,
            "defect_precision": 0.9611351017890192,
            "defect_recall": 0.958179581795818,
            "defect_f1": 0.9596550662149677,
            "defect_tp": 1558,
            "defect_fp": 63,
            "defect_tn": 1587,
            "defect_fn": 68,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.01_s30_20251207_161540",
    "lr": 0.001,
    "weight_decay": 0.01,
    "seed": 30,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9556886862286829,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.01_s30_20251207_161540",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s30_20251207_161540",
      "timestamp": "2025-12-07T16:17:33.772770",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 9,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.01_s30",
          "seed": 30,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s30_20251207_161540"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9555998546141715,
        "recall_macro": 0.9558077074709246,
        "f1_macro": 0.9556886862286829,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.9606674612634089,
        "no_defect_recall": 0.9532820816085157,
        "no_defect_f1": 0.9569605224102108,
        "no_defect_tp": 1612,
        "no_defect_fp": 66,
        "no_defect_tn": 1518,
        "no_defect_fn": 79,
        "no_defect_support": 1691,
        "defect_precision": 0.9505322479649343,
        "defect_recall": 0.9583333333333334,
        "defect_f1": 0.9544168500471549,
        "defect_tp": 1518,
        "defect_fp": 79,
        "defect_tn": 1612,
        "defect_fn": 66,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9590942636699094,
        "recall_macro": 0.9590942636699094,
        "f1_macro": 0.9590942636699094,
        "precision_micro": 0.9590964590964591,
        "recall_micro": 0.9590964590964591,
        "f1_micro": 0.9590964590964591,
        "accuracy": 0.9590964590964591,
        "hamming_loss": 0.040903540903540904,
        "no_defect_precision": 0.9593939393939394,
        "no_defect_recall": 0.9593939393939394,
        "no_defect_f1": 0.9593939393939394,
        "no_defect_tp": 1583,
        "no_defect_fp": 67,
        "no_defect_tn": 1559,
        "no_defect_fn": 67,
        "no_defect_support": 1650,
        "defect_precision": 0.9587945879458795,
        "defect_recall": 0.9587945879458795,
        "defect_f1": 0.9587945879458795,
        "defect_tp": 1559,
        "defect_fp": 67,
        "defect_tn": 1583,
        "defect_fn": 67,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6293339115805207,
          0.41450445173175765,
          0.291508954563899,
          0.24112880678855225,
          0.2216116562173955,
          0.20730748841203905,
          0.1967917918597804,
          0.1919157968904184,
          0.19101816864692017,
          0.18486743142914075,
          0.18778832381489885,
          0.1821210670546009,
          0.18038330941020694,
          0.1779967588859622,
          0.18093208747304135
        ],
        "val_loss": [
          0.5765788234197177,
          0.3460186335902948,
          0.25156543031334877,
          0.21279794121017823,
          0.1898764704282467,
          0.1766900630811086,
          0.16501027016112438,
          0.1569141291368466,
          0.15268436045600817,
          0.14968741642167935,
          0.14731353535675085,
          0.1457791831344366,
          0.14597712442851984,
          0.14515235303686216,
          0.14499545083023035
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8657826465067088,
            "recall_macro": 0.8545696841268988,
            "f1_macro": 0.8554956347934305,
            "precision_micro": 0.8570992366412213,
            "recall_micro": 0.8570992366412213,
            "f1_micro": 0.8570992366412213,
            "accuracy": 0.8570992366412213,
            "hamming_loss": 0.14290076335877863,
            "no_defect_precision": 0.8170036288232244,
            "no_defect_recall": 0.9319929036073329,
            "no_defect_f1": 0.8707182320441988,
            "no_defect_tp": 1576,
            "no_defect_fp": 353,
            "no_defect_tn": 1231,
            "no_defect_fn": 115,
            "no_defect_support": 1691,
            "defect_precision": 0.9145616641901931,
            "defect_recall": 0.7771464646464646,
            "defect_f1": 0.8402730375426621,
            "defect_tp": 1231,
            "defect_fp": 115,
            "defect_tn": 1576,
            "defect_fn": 353,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9050848212181364,
            "recall_macro": 0.904251526202295,
            "f1_macro": 0.9045457093212264,
            "precision_micro": 0.9047328244274809,
            "recall_micro": 0.9047328244274809,
            "f1_micro": 0.9047328244274809,
            "accuracy": 0.9047328244274809,
            "hamming_loss": 0.09526717557251908,
            "no_defect_precision": 0.8987854251012146,
            "no_defect_recall": 0.918982850384388,
            "no_defect_f1": 0.9087719298245615,
            "no_defect_tp": 1554,
            "no_defect_fp": 175,
            "no_defect_tn": 1409,
            "no_defect_fn": 137,
            "no_defect_support": 1691,
            "defect_precision": 0.9113842173350583,
            "defect_recall": 0.889520202020202,
            "defect_f1": 0.9003194888178914,
            "defect_tp": 1409,
            "defect_fp": 137,
            "defect_tn": 1554,
            "defect_fn": 175,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9287176559950403,
            "recall_macro": 0.9264915939405887,
            "f1_macro": 0.9271006279755514,
            "precision_micro": 0.9273282442748092,
            "recall_micro": 0.9273282442748092,
            "f1_micro": 0.9273282442748092,
            "accuracy": 0.9273282442748092,
            "hamming_loss": 0.07267175572519084,
            "no_defect_precision": 0.9111488398415394,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9311740890688259,
            "no_defect_tp": 1610,
            "no_defect_fp": 157,
            "no_defect_tn": 1427,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9462864721485411,
            "defect_recall": 0.9008838383838383,
            "defect_f1": 0.9230271668822768,
            "defect_tp": 1427,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 157,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.940771557171582,
            "recall_macro": 0.9406201652838257,
            "f1_macro": 0.9406902281468206,
            "precision_micro": 0.9407633587786259,
            "recall_micro": 0.9407633587786259,
            "f1_micro": 0.9407633587786259,
            "accuracy": 0.9407633587786259,
            "hamming_loss": 0.059236641221374044,
            "no_defect_precision": 0.9405532666274279,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.9427728613569322,
            "no_defect_tp": 1598,
            "no_defect_fp": 101,
            "no_defect_tn": 1483,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.940989847715736,
            "defect_recall": 0.9362373737373737,
            "defect_f1": 0.9386075949367089,
            "defect_tp": 1483,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 101,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9447572362278245,
            "recall_macro": 0.9445838858723247,
            "f1_macro": 0.9446634010348418,
            "precision_micro": 0.944732824427481,
            "recall_micro": 0.944732824427481,
            "f1_micro": 0.944732824427481,
            "accuracy": 0.944732824427481,
            "hamming_loss": 0.05526717557251908,
            "no_defect_precision": 0.9441176470588235,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.946623414921852,
            "no_defect_tp": 1605,
            "no_defect_fp": 95,
            "no_defect_tn": 1489,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9453968253968253,
            "defect_recall": 0.9400252525252525,
            "defect_f1": 0.9427033871478316,
            "defect_tp": 1489,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 95,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9485535728675161,
            "recall_macro": 0.9488871566044836,
            "f1_macro": 0.9486693207109494,
            "precision_micro": 0.9487022900763359,
            "recall_micro": 0.9487022900763359,
            "f1_micro": 0.9487022900763359,
            "accuracy": 0.9487022900763359,
            "hamming_loss": 0.05129770992366412,
            "no_defect_precision": 0.9568086382723455,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9499702203692674,
            "no_defect_tp": 1595,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9402985074626866,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.9473684210526315,
            "defect_tp": 1512,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.952300024563659,
            "recall_macro": 0.9523354852487023,
            "f1_macro": 0.9523173986896385,
            "precision_micro": 0.9523664122137404,
            "recall_micro": 0.9523664122137404,
            "f1_micro": 0.9523664122137404,
            "accuracy": 0.9523664122137404,
            "hamming_loss": 0.04763358778625954,
            "no_defect_precision": 0.9544108940201302,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9538461538461539,
            "no_defect_tp": 1612,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9501891551071879,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.950788643533123,
            "defect_tp": 1507,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9544812326423504,
            "recall_macro": 0.954425239981124,
            "f1_macro": 0.9544524327893947,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9551357733175915,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9559822747415067,
            "no_defect_tp": 1618,
            "no_defect_fp": 76,
            "no_defect_tn": 1508,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9538266919671095,
            "defect_recall": 0.952020202020202,
            "defect_f1": 0.9529225908372828,
            "defect_tp": 1508,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 76,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555998546141715,
            "recall_macro": 0.9558077074709246,
            "f1_macro": 0.9556886862286829,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9606674612634089,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9569605224102108,
            "no_defect_tp": 1612,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505322479649343,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9544168500471549,
            "defect_tp": 1518,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954365439163247,
            "recall_macro": 0.9546249753597478,
            "f1_macro": 0.954469432075036,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9605734767025089,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9557206537890045,
            "no_defect_tp": 1608,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.948157401623985,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9532182103610675,
            "defect_tp": 1518,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954981932323454,
            "recall_macro": 0.9552163414153361,
            "f1_macro": 0.9550790549848043,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9606205250596659,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9563409563409564,
            "no_defect_tp": 1610,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.949343339587242,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9538171536286523,
            "defect_tp": 1518,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954365439163247,
            "recall_macro": 0.9546249753597478,
            "f1_macro": 0.954469432075036,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9605734767025089,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9557206537890045,
            "no_defect_tp": 1608,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.948157401623985,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9532182103610675,
            "defect_tp": 1518,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543571738750878,
            "recall_macro": 0.9546848959733347,
            "f1_macro": 0.9544738668006896,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9622302158273381,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9556415599880917,
            "no_defect_tp": 1605,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9464841319228375,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9533061736132874,
            "defect_tp": 1521,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546631602431565,
            "recall_macro": 0.954980579001129,
            "f1_macro": 0.9547786983131811,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9622528460155781,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.955952380952381,
            "no_defect_tp": 1606,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9470734744707348,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9536050156739811,
            "defect_tp": 1521,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543585725744772,
            "recall_macro": 0.9546649224354724,
            "f1_macro": 0.9544724226362397,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9616766467065868,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9556679559654865,
            "no_defect_tp": 1606,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9470404984423676,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9532768893069928,
            "defect_tp": 1520,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 64,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9590942636699094,
            "recall_macro": 0.9590942636699094,
            "f1_macro": 0.9590942636699094,
            "precision_micro": 0.9590964590964591,
            "recall_micro": 0.9590964590964591,
            "f1_micro": 0.9590964590964591,
            "accuracy": 0.9590964590964591,
            "hamming_loss": 0.040903540903540904,
            "no_defect_precision": 0.9593939393939394,
            "no_defect_recall": 0.9593939393939394,
            "no_defect_f1": 0.9593939393939394,
            "no_defect_tp": 1583,
            "no_defect_fp": 67,
            "no_defect_tn": 1559,
            "no_defect_fn": 67,
            "no_defect_support": 1650,
            "defect_precision": 0.9587945879458795,
            "defect_recall": 0.9587945879458795,
            "defect_f1": 0.9587945879458795,
            "defect_tp": 1559,
            "defect_fp": 67,
            "defect_tn": 1583,
            "defect_fn": 67,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.01_s40_20251207_141910",
    "lr": 0.001,
    "weight_decay": 0.01,
    "seed": 40,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9562934819543152,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.01_s40_20251207_141910",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s40_20251207_141910",
      "timestamp": "2025-12-07T14:21:03.385414",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.01_s40",
          "seed": 40,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s40_20251207_141910"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9562522815889489,
        "recall_macro": 0.9563391529129258,
        "f1_macro": 0.9562934819543152,
        "precision_micro": 0.9563358778625954,
        "recall_micro": 0.9563358778625954,
        "f1_micro": 0.9563358778625954,
        "accuracy": 0.9563358778625954,
        "hamming_loss": 0.04366412213740458,
        "no_defect_precision": 0.9590747330960854,
        "no_defect_recall": 0.9562389118864577,
        "no_defect_f1": 0.9576547231270358,
        "no_defect_tp": 1617,
        "no_defect_fp": 69,
        "no_defect_tn": 1515,
        "no_defect_fn": 74,
        "no_defect_support": 1691,
        "defect_precision": 0.9534298300818125,
        "defect_recall": 0.9564393939393939,
        "defect_f1": 0.9549322407815947,
        "defect_tp": 1515,
        "defect_fp": 74,
        "defect_tn": 1617,
        "defect_fn": 69,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.962207273573201,
        "recall_macro": 0.9621156211562116,
        "f1_macro": 0.9621438686568633,
        "precision_micro": 0.9621489621489622,
        "recall_micro": 0.9621489621489622,
        "f1_micro": 0.9621489621489622,
        "accuracy": 0.9621489621489622,
        "hamming_loss": 0.03785103785103785,
        "no_defect_precision": 0.9585336538461539,
        "no_defect_recall": 0.9666666666666667,
        "no_defect_f1": 0.9625829812914907,
        "no_defect_tp": 1595,
        "no_defect_fp": 69,
        "no_defect_tn": 1557,
        "no_defect_fn": 55,
        "no_defect_support": 1650,
        "defect_precision": 0.9658808933002482,
        "defect_recall": 0.9575645756457565,
        "defect_f1": 0.9617047560222359,
        "defect_tp": 1557,
        "defect_fp": 55,
        "defect_tn": 1595,
        "defect_fn": 69,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6166958494665233,
          0.41256391628017985,
          0.29182421456570407,
          0.24276293465033735,
          0.2153798499803164,
          0.20632974192437767,
          0.19417636539147987,
          0.19059983924592389,
          0.1884452103633262,
          0.1810504756400276,
          0.18585794313058693,
          0.1785046715741377,
          0.18103695760586272,
          0.18259039608504482,
          0.1820100661226895
        ],
        "val_loss": [
          0.5666704269555899,
          0.3479415946281873,
          0.25314779293078643,
          0.21422436374884385,
          0.18930083943101075,
          0.17458550445735455,
          0.1662278320067204,
          0.1594057363959459,
          0.15225508364920431,
          0.15208735001774934,
          0.14670961593779233,
          0.14525198893478283,
          0.1438997836353687,
          0.14334259339823172,
          0.14334205222817567
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8496576771688993,
            "recall_macro": 0.8334406677657713,
            "f1_macro": 0.8340401751357445,
            "precision_micro": 0.8366412213740458,
            "recall_micro": 0.8366412213740458,
            "f1_micro": 0.8366412213740458,
            "accuracy": 0.8366412213740458,
            "hamming_loss": 0.1633587786259542,
            "no_defect_precision": 0.7898696088264794,
            "no_defect_recall": 0.9314015375517445,
            "no_defect_f1": 0.8548168249660787,
            "no_defect_tp": 1575,
            "no_defect_fp": 419,
            "no_defect_tn": 1165,
            "no_defect_fn": 116,
            "no_defect_support": 1691,
            "defect_precision": 0.9094457455113193,
            "defect_recall": 0.735479797979798,
            "defect_f1": 0.8132635253054101,
            "defect_tp": 1165,
            "defect_fp": 116,
            "defect_tn": 1575,
            "defect_fn": 419,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9003757146828575,
            "recall_macro": 0.8968077433112915,
            "f1_macro": 0.8975655464382009,
            "precision_micro": 0.8980152671755726,
            "recall_micro": 0.8980152671755726,
            "f1_micro": 0.8980152671755726,
            "accuracy": 0.8980152671755726,
            "hamming_loss": 0.10198473282442748,
            "no_defect_precision": 0.8767351471404775,
            "no_defect_recall": 0.9337670017740982,
            "no_defect_f1": 0.9043528064146621,
            "no_defect_tp": 1579,
            "no_defect_fp": 222,
            "no_defect_tn": 1362,
            "no_defect_fn": 112,
            "no_defect_support": 1691,
            "defect_precision": 0.9240162822252375,
            "defect_recall": 0.8598484848484849,
            "defect_f1": 0.8907782864617397,
            "defect_tp": 1362,
            "defect_fp": 112,
            "defect_tn": 1579,
            "defect_fn": 222,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.929515331910592,
            "recall_macro": 0.9282895856853575,
            "f1_macro": 0.9286931695798516,
            "precision_micro": 0.9288549618320611,
            "recall_micro": 0.9288549618320611,
            "f1_micro": 0.9288549618320611,
            "accuracy": 0.9288549618320611,
            "hamming_loss": 0.07114503816793893,
            "no_defect_precision": 0.9189655172413793,
            "no_defect_recall": 0.9455943228858663,
            "no_defect_f1": 0.9320897697464297,
            "no_defect_tp": 1599,
            "no_defect_fp": 141,
            "no_defect_tn": 1443,
            "no_defect_fn": 92,
            "no_defect_support": 1691,
            "defect_precision": 0.9400651465798046,
            "defect_recall": 0.9109848484848485,
            "defect_f1": 0.9252965694132735,
            "defect_tp": 1443,
            "defect_fp": 92,
            "defect_tn": 1599,
            "defect_fn": 141,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9415454558345766,
            "recall_macro": 0.9417468968215568,
            "f1_macro": 0.9416313039288167,
            "precision_micro": 0.9416793893129771,
            "recall_micro": 0.9416793893129771,
            "f1_micro": 0.9416793893129771,
            "accuracy": 0.9416793893129771,
            "hamming_loss": 0.0583206106870229,
            "no_defect_precision": 0.9469606674612634,
            "no_defect_recall": 0.9396806623299823,
            "no_defect_f1": 0.9433066191748293,
            "no_defect_tp": 1589,
            "no_defect_fp": 89,
            "no_defect_tn": 1495,
            "no_defect_fn": 102,
            "no_defect_support": 1691,
            "defect_precision": 0.9361302442078898,
            "defect_recall": 0.9438131313131313,
            "defect_f1": 0.9399559886828042,
            "defect_tp": 1495,
            "defect_fp": 102,
            "defect_tn": 1589,
            "defect_fn": 89,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9468666468001012,
            "recall_macro": 0.946753534756196,
            "f1_macro": 0.9468069019129912,
            "precision_micro": 0.9468702290076336,
            "recall_micro": 0.9468702290076336,
            "f1_micro": 0.9468702290076336,
            "accuracy": 0.9468702290076336,
            "hamming_loss": 0.05312977099236641,
            "no_defect_precision": 0.9469652327637006,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.948642266824085,
            "no_defect_tp": 1607,
            "no_defect_fp": 90,
            "no_defect_tn": 1494,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9467680608365019,
            "defect_recall": 0.9431818181818182,
            "defect_f1": 0.9449715370018975,
            "defect_tp": 1494,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 90,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9480526269020276,
            "recall_macro": 0.9480161610188222,
            "f1_macro": 0.948034039267692,
            "precision_micro": 0.9480916030534351,
            "recall_micro": 0.9480916030534351,
            "f1_micro": 0.9480916030534351,
            "accuracy": 0.9480916030534351,
            "hamming_loss": 0.051908396946564885,
            "no_defect_precision": 0.9492025989367986,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9497635933806147,
            "no_defect_tp": 1607,
            "no_defect_fp": 86,
            "no_defect_tn": 1498,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9469026548672567,
            "defect_recall": 0.9457070707070707,
            "defect_f1": 0.9463044851547694,
            "defect_tp": 1498,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 86,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9516184701492538,
            "recall_macro": 0.9518639604202881,
            "f1_macro": 0.9517184481528259,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.9576119402985075,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9530600118835413,
            "no_defect_tp": 1604,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.945625,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.9503768844221105,
            "defect_tp": 1513,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537462749153509,
            "recall_macro": 0.954073556379884,
            "f1_macro": 0.9538627777644572,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9616306954436451,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9550461446859184,
            "no_defect_tp": 1604,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9458618543870566,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9526794108429959,
            "defect_tp": 1520,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9538358874806339,
            "recall_macro": 0.953853847463398,
            "f1_macro": 0.9538447782696708,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9556213017751479,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9553386572020113,
            "no_defect_tp": 1615,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9520504731861199,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9523508993373304,
            "defect_tp": 1509,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9534467374948431,
            "recall_macro": 0.9538377939656768,
            "f1_macro": 0.9535621159406013,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.963275135460566,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.954653937947494,
            "no_defect_tp": 1600,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9436183395291202,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9524702939337085,
            "defect_tp": 1523,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9547063152960286,
            "recall_macro": 0.9548407642360924,
            "f1_macro": 0.9547678274671179,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.958407605466429,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9561351511558981,
            "no_defect_tp": 1613,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9510050251256281,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9534005037783375,
            "defect_tp": 1514,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555929571137092,
            "recall_macro": 0.9558276810087869,
            "f1_macro": 0.9556902243047389,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.961217183770883,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9569349569349569,
            "no_defect_tp": 1611,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9499687304565353,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9544454916745209,
            "defect_tp": 1519,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.955307193767228,
            "recall_macro": 0.9554720773674056,
            "f1_macro": 0.9553807052788037,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9595478881618085,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9567022538552787,
            "no_defect_tp": 1613,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9510664993726474,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9540591567023285,
            "defect_tp": 1516,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9562522815889489,
            "recall_macro": 0.9563391529129258,
            "f1_macro": 0.9562934819543152,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9590747330960854,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9576547231270358,
            "no_defect_tp": 1617,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9534298300818125,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9549322407815947,
            "defect_tp": 1515,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556177330517805,
            "recall_macro": 0.9557677603951997,
            "f1_macro": 0.9556855105080515,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9595719381688466,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9570115624073525,
            "no_defect_tp": 1614,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9516635279347144,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9543594586087504,
            "defect_tp": 1516,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 68,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.962207273573201,
            "recall_macro": 0.9621156211562116,
            "f1_macro": 0.9621438686568633,
            "precision_micro": 0.9621489621489622,
            "recall_micro": 0.9621489621489622,
            "f1_micro": 0.9621489621489622,
            "accuracy": 0.9621489621489622,
            "hamming_loss": 0.03785103785103785,
            "no_defect_precision": 0.9585336538461539,
            "no_defect_recall": 0.9666666666666667,
            "no_defect_f1": 0.9625829812914907,
            "no_defect_tp": 1595,
            "no_defect_fp": 69,
            "no_defect_tn": 1557,
            "no_defect_fn": 55,
            "no_defect_support": 1650,
            "defect_precision": 0.9658808933002482,
            "defect_recall": 0.9575645756457565,
            "defect_f1": 0.9617047560222359,
            "defect_tp": 1557,
            "defect_fp": 55,
            "defect_tn": 1595,
            "defect_fn": 69,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.01_s50_20251207_192835",
    "lr": 0.001,
    "weight_decay": 0.01,
    "seed": 50,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9556886862286829,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.01_s50_20251207_192835",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s50_20251207_192835",
      "timestamp": "2025-12-07T19:30:28.744465",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 15,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.01_s50",
          "seed": 50,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s50_20251207_192835"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9555998546141715,
        "recall_macro": 0.9558077074709246,
        "f1_macro": 0.9556886862286829,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.9606674612634089,
        "no_defect_recall": 0.9532820816085157,
        "no_defect_f1": 0.9569605224102108,
        "no_defect_tp": 1612,
        "no_defect_fp": 66,
        "no_defect_tn": 1518,
        "no_defect_fn": 79,
        "no_defect_support": 1691,
        "defect_precision": 0.9505322479649343,
        "defect_recall": 0.9583333333333334,
        "defect_f1": 0.9544168500471549,
        "defect_tp": 1518,
        "defect_fp": 79,
        "defect_tn": 1612,
        "defect_fn": 66,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9609433709071391,
        "recall_macro": 0.9609124454880913,
        "f1_macro": 0.9609246840729844,
        "precision_micro": 0.960927960927961,
        "recall_micro": 0.960927960927961,
        "f1_micro": 0.960927960927961,
        "accuracy": 0.960927960927961,
        "hamming_loss": 0.03907203907203907,
        "no_defect_precision": 0.9595410628019324,
        "no_defect_recall": 0.963030303030303,
        "no_defect_f1": 0.9612825166364186,
        "no_defect_tp": 1589,
        "no_defect_fp": 67,
        "no_defect_tn": 1559,
        "no_defect_fn": 61,
        "no_defect_support": 1650,
        "defect_precision": 0.9623456790123457,
        "defect_recall": 0.9587945879458795,
        "defect_f1": 0.9605668515095502,
        "defect_tp": 1559,
        "defect_fp": 61,
        "defect_tn": 1589,
        "defect_fn": 67,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6095977472959702,
          0.40841123549010466,
          0.28943144589288466,
          0.24184702380431747,
          0.2156409580712538,
          0.20901924515119658,
          0.20010713967942792,
          0.1905668240710781,
          0.18865241581051917,
          0.1872871981380375,
          0.1868013868334403,
          0.18164328145930955,
          0.18084950215148127,
          0.17883842466515976,
          0.1824921771385181
        ],
        "val_loss": [
          0.5647531232008567,
          0.34718836213533694,
          0.250937358977703,
          0.2157327148776788,
          0.19031680604586235,
          0.17406116168086344,
          0.16419120491124117,
          0.15544235692001307,
          0.15187321789562702,
          0.14863612072972152,
          0.14708537937929997,
          0.1453596568451478,
          0.14425471826241568,
          0.14378868100734857,
          0.14368659272216833
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.857268352303109,
            "recall_macro": 0.8387429887282045,
            "f1_macro": 0.8393682597734027,
            "precision_micro": 0.8421374045801526,
            "recall_micro": 0.8421374045801526,
            "f1_micro": 0.8421374045801526,
            "accuracy": 0.8421374045801526,
            "hamming_loss": 0.15786259541984732,
            "no_defect_precision": 0.791459781529295,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.8604588394062078,
            "no_defect_tp": 1594,
            "no_defect_fp": 420,
            "no_defect_tn": 1164,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.9230769230769231,
            "defect_recall": 0.7348484848484849,
            "defect_f1": 0.8182776801405975,
            "defect_tp": 1164,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 420,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9044320910620758,
            "recall_macro": 0.8992691551828157,
            "f1_macro": 0.9002002698706596,
            "precision_micro": 0.9007633587786259,
            "recall_micro": 0.9007633587786259,
            "f1_micro": 0.9007633587786259,
            "accuracy": 0.9007633587786259,
            "hamming_loss": 0.09923664122137404,
            "no_defect_precision": 0.8732240437158469,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.9076966770803749,
            "no_defect_tp": 1598,
            "no_defect_fp": 232,
            "no_defect_tn": 1352,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.9356401384083045,
            "defect_recall": 0.8535353535353535,
            "defect_f1": 0.8927038626609443,
            "defect_tp": 1352,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 232,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9313234570151566,
            "recall_macro": 0.9311144412785454,
            "f1_macro": 0.9312084047155536,
            "precision_micro": 0.9312977099236641,
            "recall_micro": 0.9312977099236641,
            "f1_micro": 0.9312977099236641,
            "accuracy": 0.9312977099236641,
            "hamming_loss": 0.06870229007633588,
            "no_defect_precision": 0.9306698002350177,
            "no_defect_recall": 0.9367238320520402,
            "no_defect_f1": 0.9336870026525199,
            "no_defect_tp": 1584,
            "no_defect_fp": 118,
            "no_defect_tn": 1466,
            "no_defect_fn": 107,
            "no_defect_support": 1691,
            "defect_precision": 0.9319771137952956,
            "defect_recall": 0.9255050505050505,
            "defect_f1": 0.9287298067785873,
            "defect_tp": 1466,
            "defect_fp": 107,
            "defect_tn": 1584,
            "defect_fn": 118,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9394267270284644,
            "recall_macro": 0.9398568774677586,
            "f1_macro": 0.9395151360935089,
            "precision_micro": 0.9395419847328245,
            "recall_micro": 0.9395419847328245,
            "f1_micro": 0.9395419847328245,
            "accuracy": 0.9395419847328245,
            "hamming_loss": 0.06045801526717557,
            "no_defect_precision": 0.9516031457955233,
            "no_defect_recall": 0.9302188054405677,
            "no_defect_f1": 0.9407894736842105,
            "no_defect_tp": 1573,
            "no_defect_fp": 80,
            "no_defect_tn": 1504,
            "no_defect_fn": 118,
            "no_defect_support": 1691,
            "defect_precision": 0.9272503082614056,
            "defect_recall": 0.9494949494949495,
            "defect_f1": 0.9382407985028073,
            "defect_tp": 1504,
            "defect_fp": 118,
            "defect_tn": 1573,
            "defect_fn": 80,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9439834860988595,
            "recall_macro": 0.9442122287332222,
            "f1_macro": 0.9440780072259809,
            "precision_micro": 0.9441221374045802,
            "recall_micro": 0.9441221374045802,
            "f1_micro": 0.9441221374045802,
            "accuracy": 0.9441221374045802,
            "hamming_loss": 0.055877862595419846,
            "no_defect_precision": 0.9498806682577565,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9456489456489456,
            "no_defect_tp": 1592,
            "no_defect_fp": 84,
            "no_defect_tn": 1500,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.9380863039399625,
            "defect_recall": 0.946969696969697,
            "defect_f1": 0.942507068803016,
            "defect_tp": 1500,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 84,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9482914042125705,
            "recall_macro": 0.9478164256401986,
            "f1_macro": 0.948010941093945,
            "precision_micro": 0.9480916030534351,
            "recall_micro": 0.9480916030534351,
            "f1_micro": 0.9480916030534351,
            "accuracy": 0.9480916030534351,
            "hamming_loss": 0.051908396946564885,
            "no_defect_precision": 0.9439579684763573,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9500587544065805,
            "no_defect_tp": 1617,
            "no_defect_fp": 96,
            "no_defect_tn": 1488,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9526248399487837,
            "defect_recall": 0.9393939393939394,
            "defect_f1": 0.9459631277813096,
            "defect_tp": 1488,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 96,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9516505208753214,
            "recall_macro": 0.9517840662688386,
            "f1_macro": 0.9517115995932744,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.9554367201426025,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9531713100177831,
            "no_defect_tp": 1608,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9478643216080402,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9502518891687658,
            "defect_tp": 1509,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543514277579369,
            "recall_macro": 0.9539697686504309,
            "f1_macro": 0.9541316526610644,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9508484493856056,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9558823529411765,
            "no_defect_tp": 1625,
            "no_defect_fp": 84,
            "no_defect_tn": 1500,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9578544061302682,
            "defect_recall": 0.946969696969697,
            "defect_f1": 0.9523809523809523,
            "defect_tp": 1500,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 84,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954463537676465,
            "recall_macro": 0.9544452135189865,
            "f1_macro": 0.9544542863279043,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9556737588652482,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9559562518474727,
            "no_defect_tp": 1617,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9532533164876816,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9529523208083359,
            "defect_tp": 1509,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9535226078990455,
            "recall_macro": 0.9535581644356038,
            "f1_macro": 0.9535400294924683,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.955595026642984,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9550295857988166,
            "no_defect_tp": 1614,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9514501891551072,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9520504731861199,
            "defect_tp": 1509,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546652518912175,
            "recall_macro": 0.9549606054632667,
            "f1_macro": 0.9547772469186576,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9616995810891682,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9559785841760856,
            "no_defect_tp": 1607,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9476309226932669,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9535759096612296,
            "defect_tp": 1520,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540543091702223,
            "recall_macro": 0.9543492658698158,
            "f1_macro": 0.9541661286337746,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9611011370436864,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9553837001784652,
            "no_defect_tp": 1606,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9470074812967582,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9529485570890841,
            "defect_tp": 1519,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954981932323454,
            "recall_macro": 0.9552163414153361,
            "f1_macro": 0.9550790549848043,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9606205250596659,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9563409563409564,
            "no_defect_tp": 1610,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.949343339587242,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9538171536286523,
            "defect_tp": 1518,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552907144664282,
            "recall_macro": 0.9555120244431303,
            "f1_macro": 0.9553838694795995,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.960644007155635,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9566508313539193,
            "no_defect_tp": 1611,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9499374217772215,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9541169076052797,
            "defect_tp": 1518,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555998546141715,
            "recall_macro": 0.9558077074709246,
            "f1_macro": 0.9556886862286829,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9606674612634089,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9569605224102108,
            "no_defect_tp": 1612,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505322479649343,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9544168500471549,
            "defect_tp": 1518,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 66,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9609433709071391,
            "recall_macro": 0.9609124454880913,
            "f1_macro": 0.9609246840729844,
            "precision_micro": 0.960927960927961,
            "recall_micro": 0.960927960927961,
            "f1_micro": 0.960927960927961,
            "accuracy": 0.960927960927961,
            "hamming_loss": 0.03907203907203907,
            "no_defect_precision": 0.9595410628019324,
            "no_defect_recall": 0.963030303030303,
            "no_defect_f1": 0.9612825166364186,
            "no_defect_tp": 1589,
            "no_defect_fp": 67,
            "no_defect_tn": 1559,
            "no_defect_fn": 61,
            "no_defect_support": 1650,
            "defect_precision": 0.9623456790123457,
            "defect_recall": 0.9587945879458795,
            "defect_f1": 0.9605668515095502,
            "defect_tp": 1559,
            "defect_fp": 61,
            "defect_tn": 1589,
            "defect_fn": 67,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.01_s60_20251207_194216",
    "lr": 0.001,
    "weight_decay": 0.01,
    "seed": 60,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9556987562067221,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.01_s60_20251207_194216",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s60_20251207_194216",
      "timestamp": "2025-12-07T19:44:08.730405",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.01_s60",
          "seed": 60,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s60_20251207_194216"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9555801386501457,
        "recall_macro": 0.955947522235961,
        "f1_macro": 0.9556987562067221,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.9645432692307693,
        "no_defect_recall": 0.9491425192193969,
        "no_defect_f1": 0.9567809239940388,
        "no_defect_tp": 1605,
        "no_defect_fp": 59,
        "no_defect_tn": 1525,
        "no_defect_fn": 86,
        "no_defect_support": 1691,
        "defect_precision": 0.946617008069522,
        "defect_recall": 0.9627525252525253,
        "defect_f1": 0.9546165884194053,
        "defect_tp": 1525,
        "defect_fp": 86,
        "defect_tn": 1605,
        "defect_fn": 59,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9594015748031497,
        "recall_macro": 0.9593972939729397,
        "f1_macro": 0.9593993449781864,
        "precision_micro": 0.9594017094017094,
        "recall_micro": 0.9594017094017094,
        "f1_micro": 0.9594017094017094,
        "accuracy": 0.9594017094017094,
        "hamming_loss": 0.0405982905982906,
        "no_defect_precision": 0.9594185342216839,
        "no_defect_recall": 0.96,
        "no_defect_f1": 0.9597091790366555,
        "no_defect_tp": 1584,
        "no_defect_fp": 67,
        "no_defect_tn": 1559,
        "no_defect_fn": 66,
        "no_defect_support": 1650,
        "defect_precision": 0.9593846153846154,
        "defect_recall": 0.9587945879458795,
        "defect_f1": 0.9590895109197171,
        "defect_tp": 1559,
        "defect_fp": 66,
        "defect_tn": 1584,
        "defect_fn": 67,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.618413796235328,
          0.41740354022720366,
          0.29200150895567617,
          0.23866570133045628,
          0.21704914582947807,
          0.2029996085989924,
          0.19621865532388247,
          0.1908521722051389,
          0.18826673108164735,
          0.18523916960635445,
          0.18665466111574214,
          0.17966174839306076,
          0.18111531816765852,
          0.18134296024568908,
          0.1813874097548768
        ],
        "val_loss": [
          0.5696111103663077,
          0.3494804249360011,
          0.2514625515502233,
          0.21473151789261744,
          0.18964411031741363,
          0.17455845326185226,
          0.16366752752890953,
          0.15612453007354185,
          0.15191955090715334,
          0.1512500951783015,
          0.1473220199919664,
          0.14625018964020106,
          0.1445548853908594,
          0.14379751882874048,
          0.14395192351478797
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8483273819041021,
            "recall_macro": 0.8367209946896523,
            "f1_macro": 0.8374578795445555,
            "precision_micro": 0.8393893129770993,
            "recall_micro": 0.8393893129770993,
            "f1_micro": 0.8393893129770993,
            "accuracy": 0.8393893129770993,
            "hamming_loss": 0.16061068702290077,
            "no_defect_precision": 0.8001030396702731,
            "no_defect_recall": 0.9183914843287996,
            "no_defect_f1": 0.8551762114537445,
            "no_defect_tp": 1553,
            "no_defect_fp": 388,
            "no_defect_tn": 1196,
            "no_defect_fn": 138,
            "no_defect_support": 1691,
            "defect_precision": 0.896551724137931,
            "defect_recall": 0.7550505050505051,
            "defect_f1": 0.8197395476353667,
            "defect_tp": 1196,
            "defect_fp": 138,
            "defect_tn": 1553,
            "defect_fn": 388,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9035739401359192,
            "recall_macro": 0.9002200449199267,
            "f1_macro": 0.9009590306086288,
            "precision_micro": 0.9013740458015267,
            "recall_micro": 0.9013740458015267,
            "f1_micro": 0.9013740458015267,
            "accuracy": 0.9013740458015267,
            "hamming_loss": 0.09862595419847328,
            "no_defect_precision": 0.8808463251670379,
            "no_defect_recall": 0.9355410999408634,
            "no_defect_f1": 0.9073702322913679,
            "no_defect_tp": 1582,
            "no_defect_fp": 214,
            "no_defect_tn": 1370,
            "no_defect_fn": 109,
            "no_defect_support": 1691,
            "defect_precision": 0.9263015551048005,
            "defect_recall": 0.86489898989899,
            "defect_f1": 0.8945478289258897,
            "defect_tp": 1370,
            "defect_fp": 109,
            "defect_tn": 1582,
            "defect_fn": 214,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9342763185931218,
            "recall_macro": 0.9337156679151062,
            "f1_macro": 0.9339368483337965,
            "precision_micro": 0.9340458015267176,
            "recall_micro": 0.9340458015267176,
            "f1_micro": 0.9340458015267176,
            "accuracy": 0.9340458015267176,
            "hamming_loss": 0.06595419847328245,
            "no_defect_precision": 0.9295282469423413,
            "no_defect_recall": 0.9438202247191011,
            "no_defect_f1": 0.9366197183098591,
            "no_defect_tp": 1596,
            "no_defect_fp": 121,
            "no_defect_tn": 1463,
            "no_defect_fn": 95,
            "no_defect_support": 1691,
            "defect_precision": 0.9390243902439024,
            "defect_recall": 0.9236111111111112,
            "defect_f1": 0.9312539783577339,
            "defect_tp": 1463,
            "defect_fp": 95,
            "defect_tn": 1596,
            "defect_fn": 121,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9394175897952333,
            "recall_macro": 0.9398369039298962,
            "f1_macro": 0.9395135563510346,
            "precision_micro": 0.9395419847328245,
            "recall_micro": 0.9395419847328245,
            "f1_micro": 0.9395419847328245,
            "accuracy": 0.9395419847328245,
            "hamming_loss": 0.06045801526717557,
            "no_defect_precision": 0.9510574018126888,
            "no_defect_recall": 0.9308101714961561,
            "no_defect_f1": 0.9408248655110579,
            "no_defect_tp": 1574,
            "no_defect_fp": 81,
            "no_defect_tn": 1503,
            "no_defect_fn": 117,
            "no_defect_support": 1691,
            "defect_precision": 0.9277777777777778,
            "defect_recall": 0.9488636363636364,
            "defect_f1": 0.9382022471910112,
            "defect_tp": 1503,
            "defect_fp": 117,
            "defect_tn": 1574,
            "defect_fn": 81,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9471114180650702,
            "recall_macro": 0.9471291119354396,
            "f1_macro": 0.9471201764281658,
            "precision_micro": 0.947175572519084,
            "recall_micro": 0.947175572519084,
            "f1_micro": 0.947175572519084,
            "accuracy": 0.947175572519084,
            "hamming_loss": 0.05282442748091603,
            "no_defect_precision": 0.9491124260355029,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9488317065956817,
            "no_defect_tp": 1604,
            "no_defect_fp": 86,
            "no_defect_tn": 1498,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9451104100946373,
            "defect_recall": 0.9457070707070707,
            "defect_f1": 0.94540864626065,
            "defect_tp": 1498,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 86,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9504395050669056,
            "recall_macro": 0.9505414135440747,
            "f1_macro": 0.9504872602334729,
            "precision_micro": 0.9505343511450381,
            "recall_micro": 0.9505343511450381,
            "f1_micro": 0.9505343511450381,
            "accuracy": 0.9505343511450381,
            "hamming_loss": 0.04946564885496183,
            "no_defect_precision": 0.9537091988130564,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9520142180094787,
            "no_defect_tp": 1607,
            "no_defect_fp": 78,
            "no_defect_tn": 1506,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9471698113207547,
            "defect_recall": 0.9507575757575758,
            "defect_f1": 0.9489603024574669,
            "defect_tp": 1506,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 78,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.951584121570626,
            "recall_macro": 0.9512287272488337,
            "f1_macro": 0.9513806821858204,
            "precision_micro": 0.9514503816793893,
            "recall_micro": 0.9514503816793893,
            "f1_micro": 0.9514503816793893,
            "accuracy": 0.9514503816793893,
            "hamming_loss": 0.04854961832061069,
            "no_defect_precision": 0.9484777517564403,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9532215357458076,
            "no_defect_tp": 1620,
            "no_defect_fp": 88,
            "no_defect_tn": 1496,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9546904913848118,
            "defect_recall": 0.9444444444444444,
            "defect_f1": 0.9495398286258331,
            "defect_tp": 1496,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 88,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9535226078990455,
            "recall_macro": 0.9535581644356038,
            "f1_macro": 0.9535400294924683,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.955595026642984,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9550295857988166,
            "no_defect_tp": 1614,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9514501891551072,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9520504731861199,
            "defect_tp": 1509,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.953774817136886,
            "recall_macro": 0.9539537151527098,
            "f1_macro": 0.9538534783433518,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9583333333333334,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9552061702758825,
            "no_defect_tp": 1610,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9492163009404389,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.952500786410821,
            "defect_tp": 1514,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546650273281119,
            "recall_macro": 0.9550404996147162,
            "f1_macro": 0.9547828494622452,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9639206253758268,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9558735837805605,
            "no_defect_tp": 1603,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9454094292803971,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9536921151439299,
            "defect_tp": 1524,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552761946122128,
            "recall_macro": 0.9555719450567174,
            "f1_macro": 0.9553883652035406,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9622980251346499,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9565734681737061,
            "no_defect_tp": 1608,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9482543640897756,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9542032622333751,
            "defect_tp": 1521,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555801386501457,
            "recall_macro": 0.955947522235961,
            "f1_macro": 0.9556987562067221,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9645432692307693,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9567809239940388,
            "no_defect_tp": 1605,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.946617008069522,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9546165884194053,
            "defect_tp": 1525,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549722858157701,
            "recall_macro": 0.9552562884910608,
            "f1_macro": 0.9550820726596982,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9617224880382775,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9562890276538805,
            "no_defect_tp": 1608,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9482220835932627,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9538751176655161,
            "defect_tp": 1520,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552845149253731,
            "recall_macro": 0.9555319979809926,
            "f1_macro": 0.9553854014576746,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9611940298507463,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9566250742721331,
            "no_defect_tp": 1610,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.949375,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9541457286432161,
            "defect_tp": 1519,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552845149253731,
            "recall_macro": 0.9555319979809926,
            "f1_macro": 0.9553854014576746,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9611940298507463,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9566250742721331,
            "no_defect_tp": 1610,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.949375,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9541457286432161,
            "defect_tp": 1519,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 65,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9594015748031497,
            "recall_macro": 0.9593972939729397,
            "f1_macro": 0.9593993449781864,
            "precision_micro": 0.9594017094017094,
            "recall_micro": 0.9594017094017094,
            "f1_micro": 0.9594017094017094,
            "accuracy": 0.9594017094017094,
            "hamming_loss": 0.0405982905982906,
            "no_defect_precision": 0.9594185342216839,
            "no_defect_recall": 0.96,
            "no_defect_f1": 0.9597091790366555,
            "no_defect_tp": 1584,
            "no_defect_fp": 67,
            "no_defect_tn": 1559,
            "no_defect_fn": 66,
            "no_defect_support": 1650,
            "defect_precision": 0.9593846153846154,
            "defect_recall": 0.9587945879458795,
            "defect_f1": 0.9590895109197171,
            "defect_tp": 1559,
            "defect_fp": 66,
            "defect_tn": 1584,
            "defect_fn": 67,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.01_s70_20251207_142457",
    "lr": 0.001,
    "weight_decay": 0.01,
    "seed": 70,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9544561057098077,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.01_s70_20251207_142457",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s70_20251207_142457",
      "timestamp": "2025-12-07T14:26:50.947975",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 10,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.01_s70",
          "seed": 70,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s70_20251207_142457"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9544472028820488,
        "recall_macro": 0.9544651870568488,
        "f1_macro": 0.9544561057098077,
        "precision_micro": 0.9545038167938932,
        "recall_micro": 0.9545038167938932,
        "f1_micro": 0.9545038167938932,
        "accuracy": 0.9545038167938932,
        "hamming_loss": 0.04549618320610687,
        "no_defect_precision": 0.9562130177514793,
        "no_defect_recall": 0.9556475458308693,
        "no_defect_f1": 0.955930198166223,
        "no_defect_tp": 1616,
        "no_defect_fp": 74,
        "no_defect_tn": 1510,
        "no_defect_fn": 75,
        "no_defect_support": 1691,
        "defect_precision": 0.9526813880126183,
        "defect_recall": 0.9532828282828283,
        "defect_f1": 0.9529820132533923,
        "defect_tp": 1510,
        "defect_fp": 75,
        "defect_tn": 1616,
        "defect_fn": 74,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9606188847014991,
        "recall_macro": 0.9606228335010623,
        "f1_macro": 0.9606207695799163,
        "precision_micro": 0.9606227106227107,
        "recall_micro": 0.9606227106227107,
        "f1_micro": 0.9606227106227107,
        "accuracy": 0.9606227106227107,
        "hamming_loss": 0.039377289377289376,
        "no_defect_precision": 0.9611885991510006,
        "no_defect_recall": 0.9606060606060606,
        "no_defect_f1": 0.9608972415883601,
        "no_defect_tp": 1585,
        "no_defect_fp": 64,
        "no_defect_tn": 1562,
        "no_defect_fn": 65,
        "no_defect_support": 1650,
        "defect_precision": 0.9600491702519975,
        "defect_recall": 0.9606396063960639,
        "defect_f1": 0.9603442975714724,
        "defect_tp": 1562,
        "defect_fp": 65,
        "defect_tn": 1585,
        "defect_fn": 64,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6164162228795774,
          0.4083573452847772,
          0.2892805479435741,
          0.23797701031094315,
          0.21834101587159863,
          0.20555264686690214,
          0.1921176398211942,
          0.19091293499434842,
          0.194700113088516,
          0.18754486630526546,
          0.17983684442532114,
          0.18277557315811452,
          0.18500289024792954,
          0.17632911017624403,
          0.18006086199852214
        ],
        "val_loss": [
          0.5677281881754215,
          0.347818713921767,
          0.2515975801417461,
          0.21143098605366853,
          0.18959061772777483,
          0.17471898017594448,
          0.16679458964902621,
          0.15636602875131828,
          0.15460089823374382,
          0.14756337281029958,
          0.14560444223193023,
          0.14453149443635574,
          0.14462974323676184,
          0.14407836115704134,
          0.14392727656433216
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8476297494905909,
            "recall_macro": 0.8248341263014534,
            "f1_macro": 0.8250055790767336,
            "precision_micro": 0.8287022900763359,
            "recall_micro": 0.8287022900763359,
            "f1_micro": 0.8287022900763359,
            "accuracy": 0.8287022900763359,
            "hamming_loss": 0.1712977099236641,
            "no_defect_precision": 0.7742718446601942,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.8504398826979472,
            "no_defect_tp": 1595,
            "no_defect_fp": 465,
            "no_defect_tn": 1119,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9209876543209876,
            "defect_recall": 0.7064393939393939,
            "defect_f1": 0.7995712754555199,
            "defect_tp": 1119,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 465,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.8994071165816153,
            "recall_macro": 0.8914936622284346,
            "f1_macro": 0.8925929319340977,
            "precision_micro": 0.8934351145038167,
            "recall_micro": 0.8934351145038167,
            "f1_micro": 0.8934351145038167,
            "accuracy": 0.8934351145038167,
            "hamming_loss": 0.1065648854961832,
            "no_defect_precision": 0.8580576307363927,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9021037868162692,
            "no_defect_tp": 1608,
            "no_defect_fp": 266,
            "no_defect_tn": 1318,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.940756602426838,
            "defect_recall": 0.8320707070707071,
            "defect_f1": 0.8830820770519263,
            "defect_tp": 1318,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 266,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9274298713071135,
            "recall_macro": 0.9270708265385972,
            "f1_macro": 0.9272222222222222,
            "precision_micro": 0.9273282442748092,
            "recall_micro": 0.9273282442748092,
            "f1_micro": 0.9273282442748092,
            "accuracy": 0.9273282442748092,
            "hamming_loss": 0.07267175572519084,
            "no_defect_precision": 0.92510239906378,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.93,
            "no_defect_tp": 1581,
            "no_defect_fp": 128,
            "no_defect_tn": 1456,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.929757343550447,
            "defect_recall": 0.9191919191919192,
            "defect_f1": 0.9244444444444444,
            "defect_tp": 1456,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 128,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9398250699033303,
            "recall_macro": 0.9397331162004432,
            "f1_macro": 0.9397768951807608,
            "precision_micro": 0.9398473282442749,
            "recall_micro": 0.9398473282442749,
            "f1_micro": 0.9398473282442749,
            "accuracy": 0.9398473282442749,
            "hamming_loss": 0.06015267175572519,
            "no_defect_precision": 0.9404481132075472,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9418364334219073,
            "no_defect_tp": 1595,
            "no_defect_fp": 101,
            "no_defect_tn": 1483,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9392020265991133,
            "defect_recall": 0.9362373737373737,
            "defect_f1": 0.9377173569396143,
            "defect_tp": 1483,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 101,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9476729344270004,
            "recall_macro": 0.9478203456803398,
            "f1_macro": 0.9477394641163918,
            "precision_micro": 0.9477862595419847,
            "recall_micro": 0.9477862595419847,
            "f1_micro": 0.9477862595419847,
            "accuracy": 0.9477862595419847,
            "hamming_loss": 0.052213740458015266,
            "no_defect_precision": 0.9518430439952438,
            "no_defect_recall": 0.9467770549970431,
            "no_defect_f1": 0.9493032908390158,
            "no_defect_tp": 1601,
            "no_defect_fp": 81,
            "no_defect_tn": 1503,
            "no_defect_fn": 90,
            "no_defect_support": 1691,
            "defect_precision": 0.943502824858757,
            "defect_recall": 0.9488636363636364,
            "defect_f1": 0.9461756373937678,
            "defect_tp": 1503,
            "defect_fp": 90,
            "defect_tn": 1601,
            "defect_fn": 81,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9510134164425866,
            "recall_macro": 0.9512326472889749,
            "f1_macro": 0.9511056103886022,
            "precision_micro": 0.9511450381679389,
            "recall_micro": 0.9511450381679389,
            "f1_micro": 0.9511450381679389,
            "accuracy": 0.9511450381679389,
            "hamming_loss": 0.04885496183206107,
            "no_defect_precision": 0.9564698867024448,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9524940617577197,
            "no_defect_tp": 1604,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9455569461827285,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.9497171590194846,
            "defect_tp": 1511,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9506917801166659,
            "recall_macro": 0.9510168584126302,
            "f1_macro": 0.9508073325832954,
            "precision_micro": 0.9508396946564885,
            "recall_micro": 0.9508396946564885,
            "f1_micro": 0.9508396946564885,
            "accuracy": 0.9508396946564885,
            "hamming_loss": 0.04916030534351145,
            "no_defect_precision": 0.9586330935251799,
            "no_defect_recall": 0.9455943228858663,
            "no_defect_f1": 0.9520690681750521,
            "no_defect_tp": 1599,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 92,
            "no_defect_support": 1691,
            "defect_precision": 0.9427504667081519,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9495455969915387,
            "defect_tp": 1515,
            "defect_fp": 92,
            "defect_tn": 1599,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537843179845236,
            "recall_macro": 0.9539337416148475,
            "f1_macro": 0.9538518074945915,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9577883472057075,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9552327305069671,
            "no_defect_tp": 1611,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9497802887633396,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.952470884482216,
            "defect_tp": 1513,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.952835924671765,
            "recall_macro": 0.9532264543722261,
            "f1_macro": 0.952951091150346,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.962673088500903,
            "no_defect_recall": 0.9455943228858663,
            "no_defect_f1": 0.9540572792362768,
            "no_defect_tp": 1599,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 92,
            "no_defect_support": 1691,
            "defect_precision": 0.942998760842627,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9518449030644153,
            "defect_tp": 1522,
            "defect_fp": 92,
            "defect_tn": 1599,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9544472028820488,
            "recall_macro": 0.9544651870568488,
            "f1_macro": 0.9544561057098077,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9562130177514793,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.955930198166223,
            "no_defect_tp": 1616,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9526813880126183,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9529820132533923,
            "defect_tp": 1510,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9534839975277457,
            "recall_macro": 0.9536180850491909,
            "f1_macro": 0.9535453363175804,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9572192513368984,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9549496147006521,
            "no_defect_tp": 1611,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.949748743718593,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.9521410579345088,
            "defect_tp": 1512,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540686293167593,
            "recall_macro": 0.9542893452562288,
            "f1_macro": 0.9541615097393146,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9594514013118665,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9554631828978623,
            "no_defect_tp": 1609,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9486858573216521,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9528598365807668,
            "defect_tp": 1516,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9534467525276609,
            "recall_macro": 0.9537179527385027,
            "f1_macro": 0.9535534849628241,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9599521817095039,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9548156956004756,
            "no_defect_tp": 1606,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9469413233458177,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9522912743251726,
            "defect_tp": 1517,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540577267059331,
            "recall_macro": 0.9543292923319535,
            "f1_macro": 0.9541646233185764,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9605499103407054,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.955410225921522,
            "no_defect_tp": 1607,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.947565543071161,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9529190207156308,
            "defect_tp": 1518,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540577267059331,
            "recall_macro": 0.9543292923319535,
            "f1_macro": 0.9541646233185764,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9605499103407054,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.955410225921522,
            "no_defect_tp": 1607,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.947565543071161,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9529190207156308,
            "defect_tp": 1518,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 66,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9606188847014991,
            "recall_macro": 0.9606228335010623,
            "f1_macro": 0.9606207695799163,
            "precision_micro": 0.9606227106227107,
            "recall_micro": 0.9606227106227107,
            "f1_micro": 0.9606227106227107,
            "accuracy": 0.9606227106227107,
            "hamming_loss": 0.039377289377289376,
            "no_defect_precision": 0.9611885991510006,
            "no_defect_recall": 0.9606060606060606,
            "no_defect_f1": 0.9608972415883601,
            "no_defect_tp": 1585,
            "no_defect_fp": 64,
            "no_defect_tn": 1562,
            "no_defect_fn": 65,
            "no_defect_support": 1650,
            "defect_precision": 0.9600491702519975,
            "defect_recall": 0.9606396063960639,
            "defect_f1": 0.9603442975714724,
            "defect_tp": 1562,
            "defect_fp": 65,
            "defect_tn": 1585,
            "defect_fn": 64,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.01_s80_20251207_204927",
    "lr": 0.001,
    "weight_decay": 0.01,
    "seed": 80,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9547772469186576,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.01_s80_20251207_204927",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s80_20251207_204927",
      "timestamp": "2025-12-07T20:51:24.980968",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.01_s80",
          "seed": 80,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s80_20251207_204927"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9546652518912175,
        "recall_macro": 0.9549606054632667,
        "f1_macro": 0.9547772469186576,
        "precision_micro": 0.9548091603053435,
        "recall_micro": 0.9548091603053435,
        "f1_micro": 0.9548091603053435,
        "accuracy": 0.9548091603053435,
        "hamming_loss": 0.04519083969465649,
        "no_defect_precision": 0.9616995810891682,
        "no_defect_recall": 0.9503252513305737,
        "no_defect_f1": 0.9559785841760856,
        "no_defect_tp": 1607,
        "no_defect_fp": 64,
        "no_defect_tn": 1520,
        "no_defect_fn": 84,
        "no_defect_support": 1691,
        "defect_precision": 0.9476309226932669,
        "defect_recall": 0.9595959595959596,
        "defect_f1": 0.9535759096612296,
        "defect_tp": 1520,
        "defect_fp": 84,
        "defect_tn": 1607,
        "defect_fn": 64,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9603197795775236,
        "recall_macro": 0.9603108576540311,
        "f1_macro": 0.9603149606299213,
        "precision_micro": 0.9603174603174603,
        "recall_micro": 0.9603174603174603,
        "f1_micro": 0.9603174603174603,
        "accuracy": 0.9603174603174603,
        "hamming_loss": 0.03968253968253968,
        "no_defect_precision": 0.9600484261501211,
        "no_defect_recall": 0.9612121212121212,
        "no_defect_f1": 0.9606299212598425,
        "no_defect_tp": 1586,
        "no_defect_fp": 66,
        "no_defect_tn": 1560,
        "no_defect_fn": 64,
        "no_defect_support": 1650,
        "defect_precision": 0.9605911330049262,
        "defect_recall": 0.959409594095941,
        "defect_f1": 0.96,
        "defect_tp": 1560,
        "defect_fp": 64,
        "defect_tn": 1586,
        "defect_fn": 66,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.606587006706573,
          0.40437483812475805,
          0.28682107543845553,
          0.2430668897209806,
          0.22038361015554253,
          0.20579788730982457,
          0.19727166031319726,
          0.19071754329997626,
          0.1854819779802566,
          0.18474280369705734,
          0.1814954125918604,
          0.17716481499218042,
          0.18119261669439252,
          0.18103611500442776,
          0.1780287903971253
        ],
        "val_loss": [
          0.5643397535269077,
          0.34349960948412234,
          0.2512045092880726,
          0.21045870849719414,
          0.18928526141322577,
          0.1759262911688823,
          0.16415627114474773,
          0.16074326992608035,
          0.15363507617551547,
          0.14789710179544413,
          0.14649502732432806,
          0.14542681680848965,
          0.1440225330969462,
          0.14378592902078077,
          0.143547268727651
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8573778394847468,
            "recall_macro": 0.8459510092050009,
            "f1_macro": 0.8467897529847891,
            "precision_micro": 0.8485496183206107,
            "recall_micro": 0.8485496183206107,
            "f1_micro": 0.8485496183206107,
            "accuracy": 0.8485496183206107,
            "hamming_loss": 0.15145038167938932,
            "no_defect_precision": 0.8087855297157622,
            "no_defect_recall": 0.9254878769958604,
            "no_defect_f1": 0.8632101489244346,
            "no_defect_tp": 1565,
            "no_defect_fp": 370,
            "no_defect_tn": 1214,
            "no_defect_fn": 126,
            "no_defect_support": 1691,
            "defect_precision": 0.9059701492537313,
            "defect_recall": 0.7664141414141414,
            "defect_f1": 0.8303693570451436,
            "defect_tp": 1214,
            "defect_fp": 126,
            "defect_tn": 1565,
            "defect_fn": 370,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9037429222736966,
            "recall_macro": 0.901762300712626,
            "f1_macro": 0.9023002882666361,
            "precision_micro": 0.9025954198473283,
            "recall_micro": 0.9025954198473283,
            "f1_micro": 0.9025954198473283,
            "accuracy": 0.9025954198473283,
            "hamming_loss": 0.09740458015267175,
            "no_defect_precision": 0.8888888888888888,
            "no_defect_recall": 0.9272619751626257,
            "no_defect_f1": 0.9076700434153401,
            "no_defect_tp": 1568,
            "no_defect_fp": 196,
            "no_defect_tn": 1388,
            "no_defect_fn": 123,
            "no_defect_support": 1691,
            "defect_precision": 0.9185969556585043,
            "defect_recall": 0.8762626262626263,
            "defect_f1": 0.8969305331179321,
            "defect_tp": 1388,
            "defect_fp": 123,
            "defect_tn": 1568,
            "defect_fn": 196,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9326702889926706,
            "recall_macro": 0.9329723536369012,
            "f1_macro": 0.9327791461412152,
            "precision_micro": 0.932824427480916,
            "recall_micro": 0.932824427480916,
            "f1_micro": 0.932824427480916,
            "accuracy": 0.932824427480916,
            "hamming_loss": 0.06717557251908397,
            "no_defect_precision": 0.9406830437387658,
            "no_defect_recall": 0.9284447072738025,
            "no_defect_f1": 0.9345238095238095,
            "no_defect_tp": 1570,
            "no_defect_fp": 99,
            "no_defect_tn": 1485,
            "no_defect_fn": 121,
            "no_defect_support": 1691,
            "defect_precision": 0.9246575342465754,
            "defect_recall": 0.9375,
            "defect_f1": 0.9310344827586207,
            "defect_tp": 1485,
            "defect_fp": 121,
            "defect_tn": 1570,
            "defect_fn": 99,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9438976782412163,
            "recall_macro": 0.9436169426374926,
            "f1_macro": 0.9437399962505779,
            "precision_micro": 0.9438167938931298,
            "recall_micro": 0.9438167938931298,
            "f1_micro": 0.9438167938931298,
            "accuracy": 0.9438167938931298,
            "hamming_loss": 0.05618320610687023,
            "no_defect_precision": 0.9419354838709677,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9458186101295641,
            "no_defect_tp": 1606,
            "no_defect_fp": 99,
            "no_defect_tn": 1485,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.945859872611465,
            "defect_recall": 0.9375,
            "defect_f1": 0.9416613823715916,
            "defect_tp": 1485,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 99,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.947203548085901,
            "recall_macro": 0.9470292442461278,
            "f1_macro": 0.9471092175636886,
            "precision_micro": 0.947175572519084,
            "recall_micro": 0.947175572519084,
            "f1_micro": 0.947175572519084,
            "accuracy": 0.947175572519084,
            "hamming_loss": 0.05282442748091603,
            "no_defect_precision": 0.9464705882352941,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9489826010026541,
            "no_defect_tp": 1609,
            "no_defect_fp": 91,
            "no_defect_tn": 1493,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.947936507936508,
            "defect_recall": 0.9425505050505051,
            "defect_f1": 0.945235834124723,
            "defect_tp": 1493,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 91,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9491710477332969,
            "recall_macro": 0.9495584168115214,
            "f1_macro": 0.9492849424088146,
            "precision_micro": 0.9493129770992367,
            "recall_micro": 0.9493129770992367,
            "f1_micro": 0.9493129770992367,
            "accuracy": 0.9493129770992367,
            "hamming_loss": 0.05068702290076336,
            "no_defect_precision": 0.9590608067429259,
            "no_defect_recall": 0.9420461265523359,
            "no_defect_f1": 0.9504773269689738,
            "no_defect_tp": 1593,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 98,
            "no_defect_support": 1691,
            "defect_precision": 0.9392812887236679,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9480925578486554,
            "defect_tp": 1516,
            "defect_fp": 98,
            "defect_tn": 1593,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.953155611348155,
            "recall_macro": 0.9533623490971215,
            "f1_macro": 0.9532439240895757,
            "precision_micro": 0.9532824427480916,
            "recall_micro": 0.9532824427480916,
            "f1_micro": 0.9532824427480916,
            "accuracy": 0.9532824427480916,
            "hamming_loss": 0.0467175572519084,
            "no_defect_precision": 0.9582836710369488,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9545859305431879,
            "no_defect_tp": 1608,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9480275516593613,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9519019176359635,
            "defect_tp": 1514,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.953457556920373,
            "recall_macro": 0.9538777410414017,
            "f1_macro": 0.953564715004138,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9643934821967411,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.954599761051374,
            "no_defect_tp": 1598,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.9425216316440049,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9525296689569019,
            "defect_tp": 1525,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540622631431317,
            "recall_macro": 0.95446910709699,
            "f1_macro": 0.9541744402985075,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9644364074743822,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.9552238805970149,
            "no_defect_tp": 1600,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9436881188118812,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.953125,
            "defect_tp": 1525,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543859158083297,
            "recall_macro": 0.9545650547461606,
            "f1_macro": 0.9544646905507246,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9589285714285715,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9557994660338178,
            "no_defect_tp": 1611,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9498432601880877,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9531299150676313,
            "defect_tp": 1515,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537544485711962,
            "recall_macro": 0.9540136357662969,
            "f1_macro": 0.9538582835122849,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9599761051373955,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9551263001485885,
            "no_defect_tp": 1607,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9475327920049968,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9525902668759811,
            "defect_tp": 1517,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546652518912175,
            "recall_macro": 0.9549606054632667,
            "f1_macro": 0.9547772469186576,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9616995810891682,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9559785841760856,
            "no_defect_tp": 1607,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9476309226932669,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9535759096612296,
            "defect_tp": 1520,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954365439163247,
            "recall_macro": 0.9546249753597478,
            "f1_macro": 0.954469432075036,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9605734767025089,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9557206537890045,
            "no_defect_tp": 1608,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.948157401623985,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9532182103610675,
            "defect_tp": 1518,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546687008842056,
            "recall_macro": 0.9549406319254043,
            "f1_macro": 0.9547757616743288,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9611476389719068,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9560047562425684,
            "no_defect_tp": 1608,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9481897627965044,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9535467671060891,
            "defect_tp": 1519,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954365439163247,
            "recall_macro": 0.9546249753597478,
            "f1_macro": 0.954469432075036,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9605734767025089,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9557206537890045,
            "no_defect_tp": 1608,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.948157401623985,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9532182103610675,
            "defect_tp": 1518,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 66,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9603197795775236,
            "recall_macro": 0.9603108576540311,
            "f1_macro": 0.9603149606299213,
            "precision_micro": 0.9603174603174603,
            "recall_micro": 0.9603174603174603,
            "f1_micro": 0.9603174603174603,
            "accuracy": 0.9603174603174603,
            "hamming_loss": 0.03968253968253968,
            "no_defect_precision": 0.9600484261501211,
            "no_defect_recall": 0.9612121212121212,
            "no_defect_f1": 0.9606299212598425,
            "no_defect_tp": 1586,
            "no_defect_fp": 66,
            "no_defect_tn": 1560,
            "no_defect_fn": 64,
            "no_defect_support": 1650,
            "defect_precision": 0.9605911330049262,
            "defect_recall": 0.959409594095941,
            "defect_f1": 0.96,
            "defect_tp": 1560,
            "defect_fp": 64,
            "defect_tn": 1586,
            "defect_fn": 66,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.01_s90_20251207_133055",
    "lr": 0.001,
    "weight_decay": 0.01,
    "seed": 90,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9560022748950996,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.01_s90_20251207_133055",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s90_20251207_133055",
      "timestamp": "2025-12-07T13:32:47.575796",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.01_s90",
          "seed": 90,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s90_20251207_133055"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9558841962950693,
        "recall_macro": 0.956223231725893,
        "f1_macro": 0.9560022748950996,
        "precision_micro": 0.956030534351145,
        "recall_micro": 0.956030534351145,
        "f1_micro": 0.956030534351145,
        "accuracy": 0.956030534351145,
        "hamming_loss": 0.04396946564885496,
        "no_defect_precision": 0.9640071985602879,
        "no_defect_recall": 0.9503252513305737,
        "no_defect_f1": 0.9571173317450864,
        "no_defect_tp": 1607,
        "no_defect_fp": 60,
        "no_defect_tn": 1524,
        "no_defect_fn": 84,
        "no_defect_support": 1691,
        "defect_precision": 0.9477611940298507,
        "defect_recall": 0.9621212121212122,
        "defect_f1": 0.9548872180451128,
        "defect_tp": 1524,
        "defect_fp": 84,
        "defect_tn": 1607,
        "defect_fn": 60,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9606158212073788,
        "recall_macro": 0.9606362518170636,
        "f1_macro": 0.9606216502279609,
        "precision_micro": 0.9606227106227107,
        "recall_micro": 0.9606227106227107,
        "f1_micro": 0.9606227106227107,
        "accuracy": 0.9606227106227107,
        "hamming_loss": 0.039377289377289376,
        "no_defect_precision": 0.9628727936701157,
        "no_defect_recall": 0.9587878787878787,
        "no_defect_f1": 0.9608259945338598,
        "no_defect_tp": 1582,
        "no_defect_fp": 61,
        "no_defect_tn": 1565,
        "no_defect_fn": 68,
        "no_defect_support": 1650,
        "defect_precision": 0.9583588487446417,
        "defect_recall": 0.9624846248462484,
        "defect_f1": 0.960417305922062,
        "defect_tp": 1565,
        "defect_fp": 68,
        "defect_tn": 1582,
        "defect_fn": 61,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6188289193927493,
          0.4121310262001708,
          0.2908657064747112,
          0.24218813189652175,
          0.2198923280673047,
          0.20764288664737007,
          0.19693435089483421,
          0.18710019554802562,
          0.1878909434047703,
          0.18354136231803495,
          0.18049250103564443,
          0.18354189115338745,
          0.17867405213820883,
          0.18391011895370285,
          0.18138626358125
        ],
        "val_loss": [
          0.57655452306454,
          0.3493097613637264,
          0.25176381377073437,
          0.21418973087118223,
          0.18933925949610197,
          0.17934457771480083,
          0.1681635922823961,
          0.1579628917746819,
          0.15366098943811196,
          0.149972324187939,
          0.14610497854076898,
          0.14594525270737135,
          0.14351150020956993,
          0.14493977550703746,
          0.14468177909461352
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8662700050354251,
            "recall_macro": 0.855200997258212,
            "f1_macro": 0.856131838910646,
            "precision_micro": 0.8577099236641221,
            "recall_micro": 0.8577099236641221,
            "f1_micro": 0.8577099236641221,
            "accuracy": 0.8577099236641221,
            "hamming_loss": 0.14229007633587787,
            "no_defect_precision": 0.8178515827711469,
            "no_defect_recall": 0.9319929036073329,
            "no_defect_f1": 0.871199557766722,
            "no_defect_tp": 1576,
            "no_defect_fp": 351,
            "no_defect_tn": 1233,
            "no_defect_fn": 115,
            "no_defect_support": 1691,
            "defect_precision": 0.9146884272997032,
            "defect_recall": 0.7784090909090909,
            "defect_f1": 0.8410641200545702,
            "defect_tp": 1233,
            "defect_fp": 115,
            "defect_tn": 1576,
            "defect_fn": 351,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9010291771090637,
            "recall_macro": 0.8985857615181979,
            "f1_macro": 0.8991955194806956,
            "precision_micro": 0.8995419847328244,
            "recall_micro": 0.8995419847328244,
            "f1_micro": 0.8995419847328244,
            "accuracy": 0.8995419847328244,
            "hamming_loss": 0.10045801526717557,
            "no_defect_precision": 0.8834459459459459,
            "no_defect_recall": 0.9278533412182141,
            "no_defect_f1": 0.9051052783386213,
            "no_defect_tp": 1569,
            "no_defect_fp": 207,
            "no_defect_tn": 1377,
            "no_defect_fn": 122,
            "no_defect_support": 1691,
            "defect_precision": 0.9186124082721815,
            "defect_recall": 0.8693181818181818,
            "defect_f1": 0.89328576062277,
            "defect_tp": 1377,
            "defect_fp": 122,
            "defect_tn": 1569,
            "defect_fn": 207,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9303228387874102,
            "recall_macro": 0.9288210311273588,
            "f1_macro": 0.929288329482876,
            "precision_micro": 0.9294656488549619,
            "recall_micro": 0.9294656488549619,
            "f1_micro": 0.9294656488549619,
            "accuracy": 0.9294656488549619,
            "hamming_loss": 0.07053435114503817,
            "no_defect_precision": 0.9176201372997712,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9328293108461763,
            "no_defect_tp": 1604,
            "no_defect_fp": 144,
            "no_defect_tn": 1440,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9430255402750491,
            "defect_recall": 0.9090909090909091,
            "defect_f1": 0.9257473481195757,
            "defect_tp": 1440,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 144,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9403730547666616,
            "recall_macro": 0.9404243499453435,
            "f1_macro": 0.9403979109660284,
            "precision_micro": 0.9404580152671755,
            "recall_micro": 0.9404580152671755,
            "f1_micro": 0.9404580152671755,
            "accuracy": 0.9404580152671755,
            "hamming_loss": 0.059541984732824425,
            "no_defect_precision": 0.943127962085308,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9422906185261912,
            "no_defect_tp": 1592,
            "no_defect_fp": 96,
            "no_defect_tn": 1488,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.9376181474480151,
            "defect_recall": 0.9393939393939394,
            "defect_f1": 0.9385052034058656,
            "defect_tp": 1488,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 96,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9465919701213819,
            "recall_macro": 0.9464179046526771,
            "f1_macro": 0.9464977634314768,
            "precision_micro": 0.9465648854961832,
            "recall_micro": 0.9465648854961832,
            "f1_micro": 0.9465648854961832,
            "accuracy": 0.9465648854961832,
            "hamming_loss": 0.05343511450381679,
            "no_defect_precision": 0.9458823529411765,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9483928044824536,
            "no_defect_tp": 1608,
            "no_defect_fp": 92,
            "no_defect_tn": 1492,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9473015873015873,
            "defect_recall": 0.9419191919191919,
            "defect_f1": 0.9446027223805001,
            "defect_tp": 1492,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 92,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9492475805098178,
            "recall_macro": 0.9497182051144204,
            "f1_macro": 0.9492953863418288,
            "precision_micro": 0.9493129770992367,
            "recall_micro": 0.9493129770992367,
            "f1_micro": 0.9493129770992367,
            "accuracy": 0.9493129770992367,
            "hamming_loss": 0.05068702290076336,
            "no_defect_precision": 0.9635258358662614,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.9502398081534772,
            "no_defect_tp": 1585,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.9349693251533743,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9483509645301804,
            "defect_tp": 1524,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9498004550371115,
            "recall_macro": 0.9502296770185593,
            "f1_macro": 0.949900117381665,
            "precision_micro": 0.9499236641221374,
            "recall_micro": 0.9499236641221374,
            "f1_micro": 0.9499236641221374,
            "accuracy": 0.9499236641221374,
            "hamming_loss": 0.050076335877862595,
            "no_defect_precision": 0.9613293051359516,
            "no_defect_recall": 0.9408633944411591,
            "no_defect_f1": 0.9509862522414824,
            "no_defect_tp": 1591,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 100,
            "no_defect_support": 1691,
            "defect_precision": 0.9382716049382716,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9488139825218477,
            "defect_tp": 1520,
            "defect_fp": 100,
            "defect_tn": 1591,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537843179845236,
            "recall_macro": 0.9539337416148475,
            "f1_macro": 0.9538518074945915,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9577883472057075,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9552327305069671,
            "no_defect_tp": 1611,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9497802887633396,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.952470884482216,
            "defect_tp": 1513,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954365439163247,
            "recall_macro": 0.9546249753597478,
            "f1_macro": 0.954469432075036,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9605734767025089,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9557206537890045,
            "no_defect_tp": 1608,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.948157401623985,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9532182103610675,
            "defect_tp": 1518,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546735074626865,
            "recall_macro": 0.9549206583875419,
            "f1_macro": 0.9547742425735332,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9605970149253731,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9560308972073678,
            "no_defect_tp": 1609,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.94875,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9535175879396985,
            "defect_tp": 1518,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9559183120521109,
            "recall_macro": 0.9560834169608563,
            "f1_macro": 0.9559919284941625,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9601427721594289,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9572953736654805,
            "no_defect_tp": 1614,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.951693851944793,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9546884833228445,
            "defect_tp": 1517,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549722858157701,
            "recall_macro": 0.9552562884910608,
            "f1_macro": 0.9550820726596982,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9617224880382775,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9562890276538805,
            "no_defect_tp": 1608,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9482220835932627,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9538751176655161,
            "defect_tp": 1520,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.955909353490934,
            "recall_macro": 0.9561033904987187,
            "f1_macro": 0.955993505402833,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9606908874329958,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9572700296735905,
            "no_defect_tp": 1613,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9511278195488722,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9547169811320755,
            "defect_tp": 1518,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9558841962950693,
            "recall_macro": 0.956223231725893,
            "f1_macro": 0.9560022748950996,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9640071985602879,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9571173317450864,
            "no_defect_tp": 1607,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9477611940298507,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9548872180451128,
            "defect_tp": 1524,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9558849864237391,
            "recall_macro": 0.9562032581880305,
            "f1_macro": 0.9560008956560682,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.96345116836429,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9571428571428572,
            "no_defect_tp": 1608,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9483188044831881,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.954858934169279,
            "defect_tp": 1523,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 61,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9606158212073788,
            "recall_macro": 0.9606362518170636,
            "f1_macro": 0.9606216502279609,
            "precision_micro": 0.9606227106227107,
            "recall_micro": 0.9606227106227107,
            "f1_micro": 0.9606227106227107,
            "accuracy": 0.9606227106227107,
            "hamming_loss": 0.039377289377289376,
            "no_defect_precision": 0.9628727936701157,
            "no_defect_recall": 0.9587878787878787,
            "no_defect_f1": 0.9608259945338598,
            "no_defect_tp": 1582,
            "no_defect_fp": 61,
            "no_defect_tn": 1565,
            "no_defect_fn": 68,
            "no_defect_support": 1650,
            "defect_precision": 0.9583588487446417,
            "defect_recall": 0.9624846248462484,
            "defect_f1": 0.960417305922062,
            "defect_tp": 1565,
            "defect_fp": 68,
            "defect_tn": 1582,
            "defect_fn": 61,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.01_s100_20251207_183008",
    "lr": 0.001,
    "weight_decay": 0.01,
    "seed": 100,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9556886862286829,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.01_s100_20251207_183008",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s100_20251207_183008",
      "timestamp": "2025-12-07T18:32:10.076680",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.01_s100",
          "seed": 100,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s100_20251207_183008"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9555998546141715,
        "recall_macro": 0.9558077074709246,
        "f1_macro": 0.9556886862286829,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.9606674612634089,
        "no_defect_recall": 0.9532820816085157,
        "no_defect_f1": 0.9569605224102108,
        "no_defect_tp": 1612,
        "no_defect_fp": 66,
        "no_defect_tn": 1518,
        "no_defect_fn": 79,
        "no_defect_support": 1691,
        "defect_precision": 0.9505322479649343,
        "defect_recall": 0.9583333333333334,
        "defect_f1": 0.9544168500471549,
        "defect_tp": 1518,
        "defect_fp": 79,
        "defect_tn": 1612,
        "defect_fn": 66,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9603327965646806,
        "recall_macro": 0.9603019121100302,
        "f1_macro": 0.9603141322616249,
        "precision_micro": 0.9603174603174603,
        "recall_micro": 0.9603174603174603,
        "f1_micro": 0.9603174603174603,
        "accuracy": 0.9603174603174603,
        "hamming_loss": 0.03968253968253968,
        "no_defect_precision": 0.9589371980676329,
        "no_defect_recall": 0.9624242424242424,
        "no_defect_f1": 0.9606775559588627,
        "no_defect_tp": 1588,
        "no_defect_fp": 68,
        "no_defect_tn": 1558,
        "no_defect_fn": 62,
        "no_defect_support": 1650,
        "defect_precision": 0.9617283950617284,
        "defect_recall": 0.958179581795818,
        "defect_f1": 0.9599507085643869,
        "defect_tp": 1558,
        "defect_fp": 62,
        "defect_tn": 1588,
        "defect_fn": 68,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6180163691732176,
          0.41311791464374653,
          0.28814847387030534,
          0.23867037886106818,
          0.2209489202150241,
          0.20547190289866477,
          0.19512512965057685,
          0.19578812508278812,
          0.1908179394682581,
          0.1817921076796045,
          0.1848132391167984,
          0.1832648653490274,
          0.18634300866012293,
          0.1796167091969167,
          0.18042696647688933
        ],
        "val_loss": [
          0.5668640698377903,
          0.34478325282151884,
          0.2504770583831347,
          0.21314107512052244,
          0.19151254141559967,
          0.17450943402945995,
          0.1660732957892693,
          0.15763044815797073,
          0.15424490476456973,
          0.1487306569917844,
          0.146944729038156,
          0.1454745953759322,
          0.1447413176871263,
          0.14412313083616587,
          0.14405496919957492
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8545206060096056,
            "recall_macro": 0.8397338255410403,
            "f1_macro": 0.8404624269801979,
            "precision_micro": 0.8427480916030534,
            "recall_micro": 0.8427480916030534,
            "f1_micro": 0.8427480916030534,
            "accuracy": 0.8427480916030534,
            "hamming_loss": 0.15725190839694655,
            "no_defect_precision": 0.7975708502024291,
            "no_defect_recall": 0.9319929036073329,
            "no_defect_f1": 0.85955822197982,
            "no_defect_tp": 1576,
            "no_defect_fp": 400,
            "no_defect_tn": 1184,
            "no_defect_fn": 115,
            "no_defect_support": 1691,
            "defect_precision": 0.9114703618167821,
            "defect_recall": 0.7474747474747475,
            "defect_f1": 0.8213666319805758,
            "defect_tp": 1184,
            "defect_fp": 115,
            "defect_tn": 1576,
            "defect_fn": 400,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9063100207479591,
            "recall_macro": 0.9054742053891965,
            "f1_macro": 0.9057694822786466,
            "precision_micro": 0.9059541984732824,
            "recall_micro": 0.9059541984732824,
            "f1_micro": 0.9059541984732824,
            "accuracy": 0.9059541984732824,
            "hamming_loss": 0.09404580152671756,
            "no_defect_precision": 0.8999421631000578,
            "no_defect_recall": 0.9201655824955648,
            "no_defect_f1": 0.9099415204678363,
            "no_defect_tp": 1556,
            "no_defect_fp": 173,
            "no_defect_tn": 1411,
            "no_defect_fn": 135,
            "no_defect_support": 1691,
            "defect_precision": 0.9126778783958602,
            "defect_recall": 0.8907828282828283,
            "defect_f1": 0.9015974440894569,
            "defect_tp": 1411,
            "defect_fp": 135,
            "defect_tn": 1556,
            "defect_fn": 173,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9330511638325276,
            "recall_macro": 0.9330683012860719,
            "f1_macro": 0.9330596453050193,
            "precision_micro": 0.9331297709923664,
            "recall_micro": 0.9331297709923664,
            "f1_micro": 0.9331297709923664,
            "accuracy": 0.9331297709923664,
            "hamming_loss": 0.06687022900763359,
            "no_defect_precision": 0.9355029585798816,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.935226264418811,
            "no_defect_tp": 1581,
            "no_defect_fp": 109,
            "no_defect_tn": 1475,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9305993690851735,
            "defect_recall": 0.9311868686868687,
            "defect_f1": 0.9308930261912275,
            "defect_tp": 1475,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 109,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9393903329858746,
            "recall_macro": 0.9396970891648597,
            "f1_macro": 0.9395012315270936,
            "precision_micro": 0.9395419847328245,
            "recall_micro": 0.9395419847328245,
            "f1_micro": 0.9395419847328245,
            "accuracy": 0.9395419847328245,
            "hamming_loss": 0.06045801526717557,
            "no_defect_precision": 0.9472738166566806,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.9410714285714286,
            "no_defect_tp": 1581,
            "no_defect_fp": 88,
            "no_defect_tn": 1496,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9315068493150684,
            "defect_recall": 0.9444444444444444,
            "defect_f1": 0.9379310344827586,
            "defect_tp": 1496,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 88,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.944605015023886,
            "recall_macro": 0.9450233037052966,
            "f1_macro": 0.9447060993106533,
            "precision_micro": 0.944732824427481,
            "recall_micro": 0.944732824427481,
            "f1_micro": 0.944732824427481,
            "accuracy": 0.944732824427481,
            "hamming_loss": 0.05526717557251908,
            "no_defect_precision": 0.9559178743961353,
            "no_defect_recall": 0.9361324659964518,
            "no_defect_f1": 0.9459217209441291,
            "no_defect_tp": 1583,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 108,
            "no_defect_support": 1691,
            "defect_precision": 0.9332921556516368,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.9434904776771776,
            "defect_tp": 1511,
            "defect_fp": 108,
            "defect_tn": 1583,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9482614749454784,
            "recall_macro": 0.947836399178061,
            "f1_macro": 0.948013426588889,
            "precision_micro": 0.9480916030534351,
            "recall_micro": 0.9480916030534351,
            "f1_micro": 0.9480916030534351,
            "accuracy": 0.9480916030534351,
            "hamming_loss": 0.051908396946564885,
            "no_defect_precision": 0.9444769140853302,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9500293944738389,
            "no_defect_tp": 1616,
            "no_defect_fp": 95,
            "no_defect_tn": 1489,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9520460358056266,
            "defect_recall": 0.9400252525252525,
            "defect_f1": 0.945997458703939,
            "defect_tp": 1489,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 95,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9516327253739136,
            "recall_macro": 0.9520636957989117,
            "f1_macro": 0.9517330399164822,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.963141993957704,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.9527794381350867,
            "no_defect_tp": 1594,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.9401234567901234,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9506866416978776,
            "defect_tp": 1523,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9534575867419247,
            "recall_macro": 0.953678005662778,
            "f1_macro": 0.9535503298691721,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9588550983899821,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9548693586698337,
            "no_defect_tp": 1608,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9480600750938674,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9522313010685104,
            "defect_tp": 1515,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9534413340625739,
            "recall_macro": 0.9537578998142275,
            "f1_macro": 0.9535565009702941,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9610545236668664,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9547619047619048,
            "no_defect_tp": 1604,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9458281444582815,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9523510971786834,
            "defect_tp": 1519,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543954563402759,
            "recall_macro": 0.9545450812082983,
            "f1_macro": 0.9544630418324115,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9583828775267539,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9558256744737622,
            "no_defect_tp": 1612,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9504080351537979,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9531004091910608,
            "defect_tp": 1514,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.95531747418017,
            "recall_macro": 0.9554521038295432,
            "f1_macro": 0.9553790730418865,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9590017825311943,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9567279193835211,
            "no_defect_tp": 1614,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9516331658291457,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9540302267002518,
            "defect_tp": 1515,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9550065946960282,
            "recall_macro": 0.955156420801749,
            "f1_macro": 0.9550742761702316,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9589774078478003,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9564186184405574,
            "no_defect_tp": 1613,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9510357815442562,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9537299338999056,
            "defect_tp": 1515,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555998546141715,
            "recall_macro": 0.9558077074709246,
            "f1_macro": 0.9556886862286829,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9606674612634089,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9569605224102108,
            "no_defect_tp": 1612,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505322479649343,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9544168500471549,
            "defect_tp": 1518,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552982739755882,
            "recall_macro": 0.955492050905268,
            "f1_macro": 0.9553823040889835,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9600952948183442,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9566765578635015,
            "no_defect_tp": 1612,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505012531328321,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9540880503144654,
            "defect_tp": 1517,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552982739755882,
            "recall_macro": 0.955492050905268,
            "f1_macro": 0.9553823040889835,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9600952948183442,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9566765578635015,
            "no_defect_tp": 1612,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505012531328321,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9540880503144654,
            "defect_tp": 1517,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 67,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9603327965646806,
            "recall_macro": 0.9603019121100302,
            "f1_macro": 0.9603141322616249,
            "precision_micro": 0.9603174603174603,
            "recall_micro": 0.9603174603174603,
            "f1_micro": 0.9603174603174603,
            "accuracy": 0.9603174603174603,
            "hamming_loss": 0.03968253968253968,
            "no_defect_precision": 0.9589371980676329,
            "no_defect_recall": 0.9624242424242424,
            "no_defect_f1": 0.9606775559588627,
            "no_defect_tp": 1588,
            "no_defect_fp": 68,
            "no_defect_tn": 1558,
            "no_defect_fn": 62,
            "no_defect_support": 1650,
            "defect_precision": 0.9617283950617284,
            "defect_recall": 0.958179581795818,
            "defect_f1": 0.9599507085643869,
            "defect_tp": 1558,
            "defect_fp": 62,
            "defect_tn": 1588,
            "defect_fn": 68,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.01_s110_20251207_201641",
    "lr": 0.001,
    "weight_decay": 0.01,
    "seed": 110,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.955986999926085,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.01_s110_20251207_201641",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s110_20251207_201641",
      "timestamp": "2025-12-07T20:18:33.577067",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.01_s110",
          "seed": 110,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s110_20251207_201641"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9559533639223639,
        "recall_macro": 0.9560234963472692,
        "f1_macro": 0.955986999926085,
        "precision_micro": 0.956030534351145,
        "recall_micro": 0.956030534351145,
        "f1_micro": 0.956030534351145,
        "accuracy": 0.956030534351145,
        "hamming_loss": 0.04396946564885496,
        "no_defect_precision": 0.9585062240663901,
        "no_defect_recall": 0.9562389118864577,
        "no_defect_f1": 0.9573712255772646,
        "no_defect_tp": 1617,
        "no_defect_fp": 70,
        "no_defect_tn": 1514,
        "no_defect_fn": 74,
        "no_defect_support": 1691,
        "defect_precision": 0.9534005037783375,
        "defect_recall": 0.9558080808080808,
        "defect_f1": 0.9546027742749055,
        "defect_tp": 1514,
        "defect_fp": 74,
        "defect_tn": 1617,
        "defect_fn": 70,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9609433709071391,
        "recall_macro": 0.9609124454880913,
        "f1_macro": 0.9609246840729844,
        "precision_micro": 0.960927960927961,
        "recall_micro": 0.960927960927961,
        "f1_micro": 0.960927960927961,
        "accuracy": 0.960927960927961,
        "hamming_loss": 0.03907203907203907,
        "no_defect_precision": 0.9595410628019324,
        "no_defect_recall": 0.963030303030303,
        "no_defect_f1": 0.9612825166364186,
        "no_defect_tp": 1589,
        "no_defect_fp": 67,
        "no_defect_tn": 1559,
        "no_defect_fn": 61,
        "no_defect_support": 1650,
        "defect_precision": 0.9623456790123457,
        "defect_recall": 0.9587945879458795,
        "defect_f1": 0.9605668515095502,
        "defect_tp": 1559,
        "defect_fp": 61,
        "defect_tn": 1589,
        "defect_fn": 67,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.621791860797914,
          0.41582605105563686,
          0.29092936947255954,
          0.241341504903518,
          0.21738106002992166,
          0.20406267212150486,
          0.20035945452656206,
          0.19231757231711344,
          0.18641852219608537,
          0.18722951761349474,
          0.18123513167123914,
          0.18004138870593395,
          0.1793687040586352,
          0.18336023867254975,
          0.18566455021812328
        ],
        "val_loss": [
          0.5813523210011996,
          0.35026093228505206,
          0.25360554743271607,
          0.2151395374765763,
          0.19281884340139535,
          0.1757420007712566,
          0.16814122234399503,
          0.16509163895478615,
          0.1545078672755223,
          0.14979949894432837,
          0.1478963607492355,
          0.14653213852300093,
          0.14452365613900697,
          0.14425379080841175,
          0.1444525417800133
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8429348068880436,
            "recall_macro": 0.7980514787138087,
            "f1_macro": 0.7956644663677583,
            "precision_micro": 0.8036641221374046,
            "recall_micro": 0.8036641221374046,
            "f1_micro": 0.8036641221374046,
            "accuracy": 0.8036641221374046,
            "hamming_loss": 0.19633587786259543,
            "no_defect_precision": 0.7347670250896058,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.8360948253887331,
            "no_defect_tp": 1640,
            "no_defect_fp": 592,
            "no_defect_tn": 992,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.9511025886864813,
            "defect_recall": 0.6262626262626263,
            "defect_f1": 0.7552341073467834,
            "defect_tp": 992,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 592,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9006996245089545,
            "recall_macro": 0.896727849159842,
            "f1_macro": 0.8975316159250586,
            "precision_micro": 0.8980152671755726,
            "recall_micro": 0.8980152671755726,
            "f1_micro": 0.8980152671755726,
            "accuracy": 0.8980152671755726,
            "hamming_loss": 0.10198473282442748,
            "no_defect_precision": 0.875069098949696,
            "no_defect_recall": 0.9361324659964518,
            "no_defect_f1": 0.9045714285714286,
            "no_defect_tp": 1583,
            "no_defect_fp": 226,
            "no_defect_tn": 1358,
            "no_defect_fn": 108,
            "no_defect_support": 1691,
            "defect_precision": 0.9263301500682128,
            "defect_recall": 0.8573232323232324,
            "defect_f1": 0.8904918032786885,
            "defect_tp": 1358,
            "defect_fp": 108,
            "defect_tn": 1583,
            "defect_fn": 226,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9303456591639871,
            "recall_macro": 0.9297120002508825,
            "f1_macro": 0.9299555464401335,
            "precision_micro": 0.9300763358778626,
            "recall_micro": 0.9300763358778626,
            "f1_micro": 0.9300763358778626,
            "accuracy": 0.9300763358778626,
            "hamming_loss": 0.06992366412213741,
            "no_defect_precision": 0.925,
            "no_defect_recall": 0.9408633944411591,
            "no_defect_f1": 0.9328642626795661,
            "no_defect_tp": 1591,
            "no_defect_fp": 129,
            "no_defect_tn": 1455,
            "no_defect_fn": 100,
            "no_defect_support": 1691,
            "defect_precision": 0.9356913183279743,
            "defect_recall": 0.9185606060606061,
            "defect_f1": 0.9270468302007009,
            "defect_tp": 1455,
            "defect_fp": 100,
            "defect_tn": 1591,
            "defect_fn": 129,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9400741912097939,
            "recall_macro": 0.9401086933796869,
            "f1_macro": 0.9400910906613407,
            "precision_micro": 0.9401526717557251,
            "recall_micro": 0.9401526717557251,
            "f1_micro": 0.9401526717557251,
            "accuracy": 0.9401526717557251,
            "hamming_loss": 0.05984732824427481,
            "no_defect_precision": 0.9425695677915926,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9420118343195266,
            "no_defect_tp": 1592,
            "no_defect_fp": 97,
            "no_defect_tn": 1487,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.937578814627995,
            "defect_recall": 0.9387626262626263,
            "defect_f1": 0.9381703470031546,
            "defect_tp": 1487,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 97,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9451940502739318,
            "recall_macro": 0.9455347756094356,
            "f1_macro": 0.9453092252647917,
            "precision_micro": 0.9453435114503816,
            "recall_micro": 0.9453435114503816,
            "f1_micro": 0.9453435114503816,
            "accuracy": 0.9453435114503816,
            "hamming_loss": 0.05465648854961832,
            "no_defect_precision": 0.9537815126050421,
            "no_defect_recall": 0.9396806623299823,
            "no_defect_f1": 0.946678582067322,
            "no_defect_tp": 1589,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 102,
            "no_defect_support": 1691,
            "defect_precision": 0.9366065879428216,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.9439398684622612,
            "defect_tp": 1507,
            "defect_fp": 102,
            "defect_tn": 1589,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9491960109183979,
            "recall_macro": 0.9493586814328979,
            "f1_macro": 0.9492684731252151,
            "precision_micro": 0.9493129770992367,
            "recall_micro": 0.9493129770992367,
            "f1_micro": 0.9493129770992367,
            "accuracy": 0.9493129770992367,
            "hamming_loss": 0.05068702290076336,
            "no_defect_precision": 0.9535990481856038,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9507710557532622,
            "no_defect_tp": 1603,
            "no_defect_fp": 78,
            "no_defect_tn": 1506,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.944792973651192,
            "defect_recall": 0.9507575757575758,
            "defect_f1": 0.9477658904971681,
            "defect_tp": 1506,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 78,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9482626914127862,
            "recall_macro": 0.9486713677281389,
            "f1_macro": 0.9483705870132961,
            "precision_micro": 0.9483969465648855,
            "recall_micro": 0.9483969465648855,
            "f1_micro": 0.9483969465648855,
            "accuracy": 0.9483969465648855,
            "hamming_loss": 0.0516030534351145,
            "no_defect_precision": 0.9589867310012062,
            "no_defect_recall": 0.9402720283855707,
            "no_defect_f1": 0.9495371752762019,
            "no_defect_tp": 1590,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 101,
            "no_defect_support": 1691,
            "defect_precision": 0.9375386518243661,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9472039987503905,
            "defect_tp": 1516,
            "defect_fp": 101,
            "defect_tn": 1590,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9496133744759279,
            "recall_macro": 0.950093782293664,
            "f1_macro": 0.9496046195042689,
            "precision_micro": 0.9496183206106871,
            "recall_micro": 0.9496183206106871,
            "f1_micro": 0.9496183206106871,
            "accuracy": 0.9496183206106871,
            "hamming_loss": 0.050381679389312976,
            "no_defect_precision": 0.9658119658119658,
            "no_defect_recall": 0.9355410999408634,
            "no_defect_f1": 0.9504355662361069,
            "no_defect_tp": 1582,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 109,
            "no_defect_support": 1691,
            "defect_precision": 0.93341478313989,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.948773672772431,
            "defect_tp": 1528,
            "defect_fp": 109,
            "defect_tn": 1582,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9522195078819914,
            "recall_macro": 0.9525352206273259,
            "f1_macro": 0.9523343036274071,
            "precision_micro": 0.9523664122137404,
            "recall_micro": 0.9523664122137404,
            "f1_micro": 0.9523664122137404,
            "accuracy": 0.9523664122137404,
            "hamming_loss": 0.04763358778625954,
            "no_defect_precision": 0.9598562013181546,
            "no_defect_recall": 0.9473684210526315,
            "no_defect_f1": 0.9535714285714286,
            "no_defect_tp": 1602,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 89,
            "no_defect_support": 1691,
            "defect_precision": 0.9445828144458281,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9510971786833856,
            "defect_tp": 1517,
            "defect_fp": 89,
            "defect_tn": 1602,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9559677745698187,
            "recall_macro": 0.9560035228094068,
            "f1_macro": 0.9559852910981278,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9579632918886916,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9573964497041421,
            "no_defect_tp": 1618,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9539722572509458,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.9545741324921135,
            "defect_tp": 1513,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9547063152960286,
            "recall_macro": 0.9548407642360924,
            "f1_macro": 0.9547678274671179,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.958407605466429,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9561351511558981,
            "no_defect_tp": 1613,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9510050251256281,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9534005037783375,
            "defect_tp": 1514,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546796718915938,
            "recall_macro": 0.9549006848496795,
            "f1_macro": 0.954772689609457,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9600477042337507,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9560570071258907,
            "no_defect_tp": 1610,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9493116395494368,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9534883720930233,
            "defect_tp": 1517,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9559533639223639,
            "recall_macro": 0.9560234963472692,
            "f1_macro": 0.955986999926085,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9585062240663901,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9573712255772646,
            "no_defect_tp": 1617,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9534005037783375,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9546027742749055,
            "defect_tp": 1514,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556177330517805,
            "recall_macro": 0.9557677603951997,
            "f1_macro": 0.9556855105080515,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9595719381688466,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9570115624073525,
            "no_defect_tp": 1614,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9516635279347144,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9543594586087504,
            "defect_tp": 1516,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546871944602423,
            "recall_macro": 0.9548807113118172,
            "f1_macro": 0.9547711027751339,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9594997022036926,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9560830860534124,
            "no_defect_tp": 1611,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.949874686716792,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9534591194968554,
            "defect_tp": 1516,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 68,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9609433709071391,
            "recall_macro": 0.9609124454880913,
            "f1_macro": 0.9609246840729844,
            "precision_micro": 0.960927960927961,
            "recall_micro": 0.960927960927961,
            "f1_micro": 0.960927960927961,
            "accuracy": 0.960927960927961,
            "hamming_loss": 0.03907203907203907,
            "no_defect_precision": 0.9595410628019324,
            "no_defect_recall": 0.963030303030303,
            "no_defect_f1": 0.9612825166364186,
            "no_defect_tp": 1589,
            "no_defect_fp": 67,
            "no_defect_tn": 1559,
            "no_defect_fn": 61,
            "no_defect_support": 1650,
            "defect_precision": 0.9623456790123457,
            "defect_recall": 0.9587945879458795,
            "defect_f1": 0.9605668515095502,
            "defect_tp": 1559,
            "defect_fp": 61,
            "defect_tn": 1589,
            "defect_fn": 67,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.01_s120_20251207_205218",
    "lr": 0.001,
    "weight_decay": 0.01,
    "seed": 120,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9562998767634596,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.01_s120_20251207_205218",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s120_20251207_205218",
      "timestamp": "2025-12-07T20:54:14.420426",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 15,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.01_s120",
          "seed": 120,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s120_20251207_205218"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9562109154306757,
        "recall_macro": 0.9564190470643753,
        "f1_macro": 0.9562998767634596,
        "precision_micro": 0.9563358778625954,
        "recall_micro": 0.9563358778625954,
        "f1_micro": 0.9563358778625954,
        "accuracy": 0.9563358778625954,
        "hamming_loss": 0.04366412213740458,
        "no_defect_precision": 0.9612634088200238,
        "no_defect_recall": 0.9538734476641041,
        "no_defect_f1": 0.9575541703769664,
        "no_defect_tp": 1613,
        "no_defect_fp": 65,
        "no_defect_tn": 1519,
        "no_defect_fn": 78,
        "no_defect_support": 1691,
        "defect_precision": 0.9511584220413275,
        "defect_recall": 0.9589646464646465,
        "defect_f1": 0.9550455831499528,
        "defect_tp": 1519,
        "defect_fp": 78,
        "defect_tn": 1613,
        "defect_fn": 65,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9594210348371388,
        "recall_macro": 0.9593838756569384,
        "f1_macro": 0.9593980737502696,
        "precision_micro": 0.9594017094017094,
        "recall_micro": 0.9594017094017094,
        "f1_micro": 0.9594017094017094,
        "accuracy": 0.9594017094017094,
        "hamming_loss": 0.0405982905982906,
        "no_defect_precision": 0.9577549788774894,
        "no_defect_recall": 0.9618181818181818,
        "no_defect_f1": 0.9597822800120955,
        "no_defect_tp": 1587,
        "no_defect_fp": 70,
        "no_defect_tn": 1556,
        "no_defect_fn": 63,
        "no_defect_support": 1650,
        "defect_precision": 0.9610870907967881,
        "defect_recall": 0.956949569495695,
        "defect_f1": 0.9590138674884437,
        "defect_tp": 1556,
        "defect_fp": 63,
        "defect_tn": 1587,
        "defect_fn": 70,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6116762497933839,
          0.41093807439923785,
          0.2946581988903269,
          0.24554289983406227,
          0.22312818947696286,
          0.20547488076168124,
          0.20003690882332653,
          0.19037902355194092,
          0.1864343621616084,
          0.18677264841655308,
          0.18213782883463545,
          0.1794345925355556,
          0.18142074273283512,
          0.18246749891396846,
          0.18239766596251453
        ],
        "val_loss": [
          0.572719931602478,
          0.34926836077983564,
          0.25463383386914545,
          0.21198591675895911,
          0.18942366655056292,
          0.1760638336149546,
          0.1690042159305169,
          0.15658441228935352,
          0.1524396398319648,
          0.14923708814267928,
          0.14803918250478232,
          0.14546706111958393,
          0.14476001678177944,
          0.1439167302674972,
          0.14387760798518473
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8501598294046262,
            "recall_macro": 0.8149810120722303,
            "f1_macro": 0.814117364117364,
            "precision_micro": 0.8198473282442749,
            "recall_micro": 0.8198473282442749,
            "f1_micro": 0.8198473282442749,
            "accuracy": 0.8198473282442749,
            "hamming_loss": 0.1801526717557252,
            "no_defect_precision": 0.7549791570171376,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.8467532467532467,
            "no_defect_tp": 1630,
            "no_defect_fp": 529,
            "no_defect_tn": 1055,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9453405017921147,
            "defect_recall": 0.6660353535353535,
            "defect_f1": 0.7814814814814814,
            "defect_tp": 1055,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 529,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9031120527306968,
            "recall_macro": 0.8995687582507512,
            "f1_macro": 0.9003297977548207,
            "precision_micro": 0.9007633587786259,
            "recall_micro": 0.9007633587786259,
            "f1_micro": 0.9007633587786259,
            "accuracy": 0.9007633587786259,
            "hamming_loss": 0.09923664122137404,
            "no_defect_precision": 0.8794444444444445,
            "no_defect_recall": 0.9361324659964518,
            "no_defect_f1": 0.9069034660555715,
            "no_defect_tp": 1583,
            "no_defect_fp": 217,
            "no_defect_tn": 1367,
            "no_defect_fn": 108,
            "no_defect_support": 1691,
            "defect_precision": 0.9267796610169492,
            "defect_recall": 0.8630050505050505,
            "defect_f1": 0.8937561294540699,
            "defect_tp": 1367,
            "defect_fp": 108,
            "defect_tn": 1583,
            "defect_fn": 217,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9311721988216879,
            "recall_macro": 0.9313141766571689,
            "f1_macro": 0.9312361369952522,
            "precision_micro": 0.9312977099236641,
            "recall_micro": 0.9312977099236641,
            "f1_micro": 0.9312977099236641,
            "accuracy": 0.9312977099236641,
            "hamming_loss": 0.06870229007633588,
            "no_defect_precision": 0.9357907253269917,
            "no_defect_recall": 0.9308101714961561,
            "no_defect_f1": 0.933293803735547,
            "no_defect_tp": 1574,
            "no_defect_fp": 108,
            "no_defect_tn": 1476,
            "no_defect_fn": 117,
            "no_defect_support": 1691,
            "defect_precision": 0.9265536723163842,
            "defect_recall": 0.9318181818181818,
            "defect_f1": 0.9291784702549575,
            "defect_tp": 1476,
            "defect_fp": 117,
            "defect_tn": 1574,
            "defect_fn": 108,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9374854917817964,
            "recall_macro": 0.9362370004002174,
            "f1_macro": 0.9366501549486235,
            "precision_micro": 0.936793893129771,
            "recall_micro": 0.936793893129771,
            "f1_micro": 0.936793893129771,
            "accuracy": 0.936793893129771,
            "hamming_loss": 0.06320610687022901,
            "no_defect_precision": 0.9264367816091954,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9396677353541242,
            "no_defect_tp": 1612,
            "no_defect_fp": 128,
            "no_defect_tn": 1456,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9485342019543974,
            "defect_recall": 0.9191919191919192,
            "defect_f1": 0.9336325745431228,
            "defect_tp": 1456,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 128,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9457854779781294,
            "recall_macro": 0.9454110143421202,
            "f1_macro": 0.9455695611577964,
            "precision_micro": 0.945648854961832,
            "recall_micro": 0.945648854961832,
            "f1_micro": 0.945648854961832,
            "accuracy": 0.945648854961832,
            "hamming_loss": 0.05435114503816794,
            "no_defect_precision": 0.9426565242832066,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9476470588235294,
            "no_defect_tp": 1611,
            "no_defect_fp": 98,
            "no_defect_tn": 1486,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9489144316730523,
            "defect_recall": 0.9381313131313131,
            "defect_f1": 0.9434920634920635,
            "defect_tp": 1486,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 98,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9504023738677521,
            "recall_macro": 0.9506213076955241,
            "f1_macro": 0.9504944305184597,
            "precision_micro": 0.9505343511450381,
            "recall_micro": 0.9505343511450381,
            "f1_micro": 0.9505343511450381,
            "accuracy": 0.9505343511450381,
            "hamming_loss": 0.04946564885496183,
            "no_defect_precision": 0.9558735837805605,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9519002375296912,
            "no_defect_tp": 1603,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9449311639549437,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9490886235072281,
            "defect_tp": 1510,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9481398798979335,
            "recall_macro": 0.948615367154693,
            "f1_macro": 0.9480799804237979,
            "precision_micro": 0.9480916030534351,
            "recall_micro": 0.9480916030534351,
            "f1_micro": 0.9480916030534351,
            "accuracy": 0.9480916030534351,
            "hamming_loss": 0.051908396946564885,
            "no_defect_precision": 0.9657072872014697,
            "no_defect_recall": 0.9325842696629213,
            "no_defect_f1": 0.9488567990373045,
            "no_defect_tp": 1577,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 114,
            "no_defect_support": 1691,
            "defect_precision": 0.9305724725943971,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9473031618102914,
            "defect_tp": 1528,
            "defect_fp": 114,
            "defect_tn": 1577,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9499047832418506,
            "recall_macro": 0.9498302062613122,
            "f1_macro": 0.9498660730620544,
            "precision_micro": 0.9499236641221374,
            "recall_micro": 0.9499236641221374,
            "f1_micro": 0.9499236641221374,
            "accuracy": 0.9499236641221374,
            "hamming_loss": 0.050076335877862595,
            "no_defect_precision": 0.9504424778761061,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9515652687536916,
            "no_defect_tp": 1611,
            "no_defect_fp": 84,
            "no_defect_tn": 1500,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9493670886075949,
            "defect_recall": 0.946969696969697,
            "defect_f1": 0.9481668773704172,
            "defect_tp": 1500,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 84,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9516505208753214,
            "recall_macro": 0.9517840662688386,
            "f1_macro": 0.9517115995932744,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.9554367201426025,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9531713100177831,
            "no_defect_tp": 1608,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9478643216080402,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9502518891687658,
            "defect_tp": 1509,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537544485711962,
            "recall_macro": 0.9540136357662969,
            "f1_macro": 0.9538582835122849,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9599761051373955,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9551263001485885,
            "no_defect_tp": 1607,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9475327920049968,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9525902668759811,
            "defect_tp": 1517,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9534413340625739,
            "recall_macro": 0.9537578998142275,
            "f1_macro": 0.9535565009702941,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9610545236668664,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9547619047619048,
            "no_defect_tp": 1604,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9458281444582815,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9523510971786834,
            "defect_tp": 1519,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546687008842056,
            "recall_macro": 0.9549406319254043,
            "f1_macro": 0.9547757616743288,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9611476389719068,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9560047562425684,
            "no_defect_tp": 1608,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9481897627965044,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9535467671060891,
            "defect_tp": 1519,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546687008842056,
            "recall_macro": 0.9549406319254043,
            "f1_macro": 0.9547757616743288,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9611476389719068,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9560047562425684,
            "no_defect_tp": 1608,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9481897627965044,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9535467671060891,
            "defect_tp": 1519,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.955909353490934,
            "recall_macro": 0.9561033904987187,
            "f1_macro": 0.955993505402833,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9606908874329958,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9572700296735905,
            "no_defect_tp": 1613,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9511278195488722,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9547169811320755,
            "defect_tp": 1518,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9562109154306757,
            "recall_macro": 0.9564190470643753,
            "f1_macro": 0.9562998767634596,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9612634088200238,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9575541703769664,
            "no_defect_tp": 1613,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9511584220413275,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9550455831499528,
            "defect_tp": 1519,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 65,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9594210348371388,
            "recall_macro": 0.9593838756569384,
            "f1_macro": 0.9593980737502696,
            "precision_micro": 0.9594017094017094,
            "recall_micro": 0.9594017094017094,
            "f1_micro": 0.9594017094017094,
            "accuracy": 0.9594017094017094,
            "hamming_loss": 0.0405982905982906,
            "no_defect_precision": 0.9577549788774894,
            "no_defect_recall": 0.9618181818181818,
            "no_defect_f1": 0.9597822800120955,
            "no_defect_tp": 1587,
            "no_defect_fp": 70,
            "no_defect_tn": 1556,
            "no_defect_fn": 63,
            "no_defect_support": 1650,
            "defect_precision": 0.9610870907967881,
            "defect_recall": 0.956949569495695,
            "defect_f1": 0.9590138674884437,
            "defect_tp": 1556,
            "defect_fp": 63,
            "defect_tn": 1587,
            "defect_fn": 70,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.01_s130_20251207_203227",
    "lr": 0.001,
    "weight_decay": 0.01,
    "seed": 130,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9550790549848043,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.01_s130_20251207_203227",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s130_20251207_203227",
      "timestamp": "2025-12-07T20:34:22.531557",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.01_s130",
          "seed": 130,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s130_20251207_203227"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.954981932323454,
        "recall_macro": 0.9552163414153361,
        "f1_macro": 0.9550790549848043,
        "precision_micro": 0.9551145038167939,
        "recall_micro": 0.9551145038167939,
        "f1_micro": 0.9551145038167939,
        "accuracy": 0.9551145038167939,
        "hamming_loss": 0.04488549618320611,
        "no_defect_precision": 0.9606205250596659,
        "no_defect_recall": 0.9520993494973389,
        "no_defect_f1": 0.9563409563409564,
        "no_defect_tp": 1610,
        "no_defect_fp": 66,
        "no_defect_tn": 1518,
        "no_defect_fn": 81,
        "no_defect_support": 1691,
        "defect_precision": 0.949343339587242,
        "defect_recall": 0.9583333333333334,
        "defect_f1": 0.9538171536286523,
        "defect_tp": 1518,
        "defect_fp": 81,
        "defect_tn": 1610,
        "defect_fn": 66,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9597150427093009,
        "recall_macro": 0.9596958515039695,
        "f1_macro": 0.9597040160307255,
        "precision_micro": 0.9597069597069597,
        "recall_micro": 0.9597069597069597,
        "f1_micro": 0.9597069597069597,
        "accuracy": 0.9597069597069597,
        "hamming_loss": 0.040293040293040296,
        "no_defect_precision": 0.9588875453446191,
        "no_defect_recall": 0.9612121212121212,
        "no_defect_f1": 0.9600484261501211,
        "no_defect_tp": 1586,
        "no_defect_fp": 68,
        "no_defect_tn": 1558,
        "no_defect_fn": 64,
        "no_defect_support": 1650,
        "defect_precision": 0.9605425400739828,
        "defect_recall": 0.958179581795818,
        "defect_f1": 0.9593596059113301,
        "defect_tp": 1558,
        "defect_fp": 64,
        "defect_tn": 1586,
        "defect_fn": 68,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6103418708845163,
          0.41099588678970495,
          0.2892092804903765,
          0.2418495246431319,
          0.21669361416141358,
          0.2063475884341296,
          0.19280667668481252,
          0.19110039849161603,
          0.1901038019103485,
          0.18495623920128434,
          0.18414042562745106,
          0.18494597068017496,
          0.1848759427666664,
          0.18528122345772746,
          0.18202779604176597
        ],
        "val_loss": [
          0.5676983847067907,
          0.34533208264754367,
          0.25079426599236637,
          0.21334796112317306,
          0.19339300233584183,
          0.1750472905830695,
          0.16291538625955582,
          0.15966838297362512,
          0.15452414220915392,
          0.15095450915396214,
          0.14722185467298216,
          0.14508409296663907,
          0.145136810409335,
          0.14469272156174368,
          0.1445443034172058
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8592862426092729,
            "recall_macro": 0.8467381905990717,
            "f1_macro": 0.8475828057979847,
            "precision_micro": 0.8494656488549618,
            "recall_micro": 0.8494656488549618,
            "f1_micro": 0.8494656488549618,
            "accuracy": 0.8494656488549618,
            "hamming_loss": 0.15053435114503816,
            "no_defect_precision": 0.8074948665297741,
            "no_defect_recall": 0.9302188054405677,
            "no_defect_f1": 0.8645232206650179,
            "no_defect_tp": 1573,
            "no_defect_fp": 375,
            "no_defect_tn": 1209,
            "no_defect_fn": 118,
            "no_defect_support": 1691,
            "defect_precision": 0.9110776186887717,
            "defect_recall": 0.7632575757575758,
            "defect_f1": 0.8306423909309516,
            "defect_tp": 1209,
            "defect_fp": 118,
            "defect_tn": 1573,
            "defect_fn": 375,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9055859824626962,
            "recall_macro": 0.9035963194929783,
            "f1_macro": 0.904137900399552,
            "precision_micro": 0.9044274809160305,
            "recall_micro": 0.9044274809160305,
            "f1_micro": 0.9044274809160305,
            "accuracy": 0.9044274809160305,
            "hamming_loss": 0.09557251908396946,
            "no_defect_precision": 0.8905895691609977,
            "no_defect_recall": 0.9290360733293909,
            "no_defect_f1": 0.9094066570188133,
            "no_defect_tp": 1571,
            "no_defect_fp": 193,
            "no_defect_tn": 1391,
            "no_defect_fn": 120,
            "no_defect_support": 1691,
            "defect_precision": 0.9205823957643945,
            "defect_recall": 0.8781565656565656,
            "defect_f1": 0.8988691437802908,
            "defect_tp": 1391,
            "defect_fp": 120,
            "defect_tn": 1571,
            "defect_fn": 193,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9316757269482723,
            "recall_macro": 0.930874758824197,
            "f1_macro": 0.9311683074647603,
            "precision_micro": 0.9312977099236641,
            "recall_micro": 0.9312977099236641,
            "f1_micro": 0.9312977099236641,
            "accuracy": 0.9312977099236641,
            "hamming_loss": 0.06870229007633588,
            "no_defect_precision": 0.9246813441483198,
            "no_defect_recall": 0.9438202247191011,
            "no_defect_f1": 0.9341527655838455,
            "no_defect_tp": 1596,
            "no_defect_fp": 130,
            "no_defect_tn": 1454,
            "no_defect_fn": 95,
            "no_defect_support": 1691,
            "defect_precision": 0.9386701097482246,
            "defect_recall": 0.9179292929292929,
            "defect_f1": 0.9281838493456751,
            "defect_tp": 1454,
            "defect_fp": 95,
            "defect_tn": 1596,
            "defect_fn": 130,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9407927319829057,
            "recall_macro": 0.9406001917459634,
            "f1_macro": 0.9406876590748863,
            "precision_micro": 0.9407633587786259,
            "recall_micro": 0.9407633587786259,
            "f1_micro": 0.9407633587786259,
            "accuracy": 0.9407633587786259,
            "hamming_loss": 0.059236641221374044,
            "no_defect_precision": 0.9400352733686067,
            "no_defect_recall": 0.9455943228858663,
            "no_defect_f1": 0.9428066037735849,
            "no_defect_tp": 1599,
            "no_defect_fp": 102,
            "no_defect_tn": 1482,
            "no_defect_fn": 92,
            "no_defect_support": 1691,
            "defect_precision": 0.9415501905972046,
            "defect_recall": 0.9356060606060606,
            "defect_f1": 0.9385687143761875,
            "defect_tp": 1482,
            "defect_fp": 92,
            "defect_tn": 1599,
            "defect_fn": 102,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9445979949167955,
            "recall_macro": 0.9450033301674343,
            "f1_macro": 0.944704593191755,
            "precision_micro": 0.944732824427481,
            "recall_micro": 0.944732824427481,
            "f1_micro": 0.944732824427481,
            "accuracy": 0.944732824427481,
            "hamming_loss": 0.05526717557251908,
            "no_defect_precision": 0.9553679131483716,
            "no_defect_recall": 0.9367238320520402,
            "no_defect_f1": 0.9459540161242161,
            "no_defect_tp": 1584,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 107,
            "no_defect_support": 1691,
            "defect_precision": 0.9338280766852195,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9434551702592939,
            "defect_tp": 1510,
            "defect_fp": 107,
            "defect_tn": 1584,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9492171024392064,
            "recall_macro": 0.9493187343571732,
            "f1_macro": 0.9492647234491141,
            "precision_micro": 0.9493129770992367,
            "recall_micro": 0.9493129770992367,
            "f1_micro": 0.9493129770992367,
            "accuracy": 0.9493129770992367,
            "hamming_loss": 0.05068702290076336,
            "no_defect_precision": 0.9525222551928784,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9508293838862559,
            "no_defect_tp": 1605,
            "no_defect_fp": 80,
            "no_defect_tn": 1504,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9459119496855346,
            "defect_recall": 0.9494949494949495,
            "defect_f1": 0.9477000630119723,
            "defect_tp": 1504,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 80,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9506803064237337,
            "recall_macro": 0.9503017310897264,
            "f1_macro": 0.9504621848739496,
            "precision_micro": 0.9505343511450381,
            "recall_micro": 0.9505343511450381,
            "f1_micro": 0.9505343511450381,
            "accuracy": 0.9505343511450381,
            "hamming_loss": 0.04946564885496183,
            "no_defect_precision": 0.9473376243417203,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9523529411764706,
            "no_defect_tp": 1619,
            "no_defect_fp": 90,
            "no_defect_tn": 1494,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9540229885057471,
            "defect_recall": 0.9431818181818182,
            "defect_f1": 0.9485714285714286,
            "defect_tp": 1494,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 90,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.952840678507272,
            "recall_macro": 0.9532464279100885,
            "f1_macro": 0.9529524253731343,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.9632308619650392,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.9540298507462687,
            "no_defect_tp": 1598,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.942450495049505,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.951875,
            "defect_tp": 1523,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9534413340625739,
            "recall_macro": 0.9537578998142275,
            "f1_macro": 0.9535565009702941,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9610545236668664,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9547619047619048,
            "no_defect_tp": 1604,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9458281444582815,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9523510971786834,
            "defect_tp": 1519,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546687008842056,
            "recall_macro": 0.9549406319254043,
            "f1_macro": 0.9547757616743288,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9611476389719068,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9560047562425684,
            "no_defect_tp": 1608,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9481897627965044,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9535467671060891,
            "defect_tp": 1519,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543954563402759,
            "recall_macro": 0.9545450812082983,
            "f1_macro": 0.9544630418324115,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9583828775267539,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9558256744737622,
            "no_defect_tp": 1612,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9504080351537979,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9531004091910608,
            "defect_tp": 1514,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543954563402759,
            "recall_macro": 0.9545450812082983,
            "f1_macro": 0.9544630418324115,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9583828775267539,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9558256744737622,
            "no_defect_tp": 1612,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9504080351537979,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9531004091910608,
            "defect_tp": 1514,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546687008842056,
            "recall_macro": 0.9549406319254043,
            "f1_macro": 0.9547757616743288,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9611476389719068,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9560047562425684,
            "no_defect_tp": 1608,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9481897627965044,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9535467671060891,
            "defect_tp": 1519,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954981932323454,
            "recall_macro": 0.9552163414153361,
            "f1_macro": 0.9550790549848043,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9606205250596659,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9563409563409564,
            "no_defect_tp": 1610,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.949343339587242,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9538171536286523,
            "defect_tp": 1518,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954981932323454,
            "recall_macro": 0.9552163414153361,
            "f1_macro": 0.9550790549848043,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9606205250596659,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9563409563409564,
            "no_defect_tp": 1610,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.949343339587242,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9538171536286523,
            "defect_tp": 1518,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 66,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9597150427093009,
            "recall_macro": 0.9596958515039695,
            "f1_macro": 0.9597040160307255,
            "precision_micro": 0.9597069597069597,
            "recall_micro": 0.9597069597069597,
            "f1_micro": 0.9597069597069597,
            "accuracy": 0.9597069597069597,
            "hamming_loss": 0.040293040293040296,
            "no_defect_precision": 0.9588875453446191,
            "no_defect_recall": 0.9612121212121212,
            "no_defect_f1": 0.9600484261501211,
            "no_defect_tp": 1586,
            "no_defect_fp": 68,
            "no_defect_tn": 1558,
            "no_defect_fn": 64,
            "no_defect_support": 1650,
            "defect_precision": 0.9605425400739828,
            "defect_recall": 0.958179581795818,
            "defect_f1": 0.9593596059113301,
            "defect_tp": 1558,
            "defect_fp": 64,
            "defect_tn": 1586,
            "defect_fn": 68,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.01_s140_20251207_210923",
    "lr": 0.001,
    "weight_decay": 0.01,
    "seed": 140,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9566119943275115,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.01_s140_20251207_210923",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s140_20251207_210923",
      "timestamp": "2025-12-07T21:11:17.519113",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 15,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.01_s140",
          "seed": 140,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s140_20251207_210923"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9564958995140302,
        "recall_macro": 0.9568145977814813,
        "f1_macro": 0.9566119943275115,
        "precision_micro": 0.9566412213740458,
        "recall_micro": 0.9566412213740458,
        "f1_micro": 0.9566412213740458,
        "accuracy": 0.9566412213740458,
        "hamming_loss": 0.0433587786259542,
        "no_defect_precision": 0.9640503295386459,
        "no_defect_recall": 0.9515079834417505,
        "no_defect_f1": 0.9577380952380953,
        "no_defect_tp": 1609,
        "no_defect_fp": 60,
        "no_defect_tn": 1524,
        "no_defect_fn": 82,
        "no_defect_support": 1691,
        "defect_precision": 0.9489414694894147,
        "defect_recall": 0.9621212121212122,
        "defect_f1": 0.9554858934169279,
        "defect_tp": 1524,
        "defect_fp": 82,
        "defect_tn": 1609,
        "defect_fn": 60,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.960005971010409,
        "recall_macro": 0.9600167728950016,
        "f1_macro": 0.9600105667909242,
        "precision_micro": 0.96001221001221,
        "recall_micro": 0.96001221001221,
        "f1_micro": 0.96001221001221,
        "accuracy": 0.96001221001221,
        "hamming_loss": 0.039987789987789985,
        "no_defect_precision": 0.9611414693381907,
        "no_defect_recall": 0.9593939393939394,
        "no_defect_f1": 0.9602669093114953,
        "no_defect_tp": 1583,
        "no_defect_fp": 64,
        "no_defect_tn": 1562,
        "no_defect_fn": 67,
        "no_defect_support": 1650,
        "defect_precision": 0.9588704726826274,
        "defect_recall": 0.9606396063960639,
        "defect_f1": 0.9597542242703533,
        "defect_tp": 1562,
        "defect_fp": 67,
        "defect_tn": 1583,
        "defect_fn": 64,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6104933811530907,
          0.41046215500292915,
          0.2884388726874874,
          0.23840011363248945,
          0.2161484447670282,
          0.20704147858724434,
          0.1968538143582424,
          0.19108117739650496,
          0.18736685164054567,
          0.18373883079160705,
          0.17747057475554892,
          0.18283246177010956,
          0.17881761145267527,
          0.1800372226779431,
          0.1801401088988432
        ],
        "val_loss": [
          0.5680819234022727,
          0.34631133996523344,
          0.24916414830547112,
          0.21108854877261016,
          0.18954906698602897,
          0.1773885190486908,
          0.1657778719583383,
          0.1599023022617285,
          0.15704480143120655,
          0.1491788844936169,
          0.14639455423905298,
          0.14383111249368924,
          0.14486394793941423,
          0.14380732436592764,
          0.14350578446800893
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8605387517035121,
            "recall_macro": 0.8472696360410731,
            "f1_macro": 0.8481167095374518,
            "precision_micro": 0.8500763358778626,
            "recall_micro": 0.8500763358778626,
            "f1_micro": 0.8500763358778626,
            "accuracy": 0.8500763358778626,
            "hamming_loss": 0.1499236641221374,
            "no_defect_precision": 0.8067484662576687,
            "no_defect_recall": 0.9331756357185098,
            "no_defect_f1": 0.8653687962709076,
            "no_defect_tp": 1578,
            "no_defect_fp": 378,
            "no_defect_tn": 1206,
            "no_defect_fn": 113,
            "no_defect_support": 1691,
            "defect_precision": 0.9143290371493555,
            "defect_recall": 0.7613636363636364,
            "defect_f1": 0.8308646228039959,
            "defect_tp": 1206,
            "defect_fp": 113,
            "defect_tn": 1578,
            "defect_fn": 378,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9082013343433342,
            "recall_macro": 0.9055862065360882,
            "f1_macro": 0.9062324563045024,
            "precision_micro": 0.9065648854961832,
            "recall_micro": 0.9065648854961832,
            "f1_micro": 0.9065648854961832,
            "accuracy": 0.9065648854961832,
            "hamming_loss": 0.0934351145038168,
            "no_defect_precision": 0.8892636312535133,
            "no_defect_recall": 0.9355410999408634,
            "no_defect_f1": 0.9118155619596542,
            "no_defect_tp": 1582,
            "no_defect_fp": 197,
            "no_defect_tn": 1387,
            "no_defect_fn": 109,
            "no_defect_support": 1691,
            "defect_precision": 0.9271390374331551,
            "defect_recall": 0.8756313131313131,
            "defect_f1": 0.9006493506493507,
            "defect_tp": 1387,
            "defect_fp": 109,
            "defect_tn": 1582,
            "defect_fn": 197,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9325053450561875,
            "recall_macro": 0.931841702059029,
            "f1_macro": 0.9320949118957049,
            "precision_micro": 0.9322137404580153,
            "recall_micro": 0.9322137404580153,
            "f1_micro": 0.9322137404580153,
            "accuracy": 0.9322137404580153,
            "hamming_loss": 0.06778625954198474,
            "no_defect_precision": 0.926786751888437,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9349355216881594,
            "no_defect_tp": 1595,
            "no_defect_fp": 126,
            "no_defect_tn": 1458,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9382239382239382,
            "defect_recall": 0.9204545454545454,
            "defect_f1": 0.9292543021032504,
            "defect_tp": 1458,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 126,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9425059612774529,
            "recall_macro": 0.9425740252913524,
            "f1_macro": 0.9425385832368333,
            "precision_micro": 0.9425954198473282,
            "recall_micro": 0.9425954198473282,
            "f1_micro": 0.9425954198473282,
            "accuracy": 0.9425954198473282,
            "hamming_loss": 0.057404580152671754,
            "no_defect_precision": 0.945465323058684,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9443457667258733,
            "no_defect_tp": 1595,
            "no_defect_fp": 92,
            "no_defect_tn": 1492,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9395465994962217,
            "defect_recall": 0.9419191919191919,
            "defect_f1": 0.9407313997477932,
            "defect_tp": 1492,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 92,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9467361184187449,
            "recall_macro": 0.9469532701348196,
            "f1_macro": 0.9468273512976049,
            "precision_micro": 0.9468702290076336,
            "recall_micro": 0.9468702290076336,
            "f1_micro": 0.9468702290076336,
            "accuracy": 0.9468702290076336,
            "hamming_loss": 0.05312977099236641,
            "no_defect_precision": 0.9522957662492546,
            "no_defect_recall": 0.9444115907746895,
            "no_defect_f1": 0.9483372921615202,
            "no_defect_tp": 1597,
            "no_defect_fp": 80,
            "no_defect_tn": 1504,
            "no_defect_fn": 94,
            "no_defect_support": 1691,
            "defect_precision": 0.9411764705882353,
            "defect_recall": 0.9494949494949495,
            "defect_f1": 0.9453174104336896,
            "defect_tp": 1504,
            "defect_fp": 94,
            "defect_tn": 1597,
            "defect_fn": 80,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9473574279213756,
            "recall_macro": 0.9477843186447563,
            "f1_macro": 0.9474562206685755,
            "precision_micro": 0.9474809160305343,
            "recall_micro": 0.9474809160305343,
            "f1_micro": 0.9474809160305343,
            "accuracy": 0.9474809160305343,
            "hamming_loss": 0.05251908396946565,
            "no_defect_precision": 0.9589123867069487,
            "no_defect_recall": 0.9384979302188055,
            "no_defect_f1": 0.9485953377166766,
            "no_defect_tp": 1587,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 104,
            "no_defect_support": 1691,
            "defect_precision": 0.9358024691358025,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9463171036204744,
            "defect_tp": 1516,
            "defect_fp": 104,
            "defect_tn": 1587,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9510083015534827,
            "recall_macro": 0.9514124091297361,
            "f1_macro": 0.9511194029850746,
            "precision_micro": 0.9511450381679389,
            "recall_micro": 0.9511450381679389,
            "f1_micro": 0.9511450381679389,
            "accuracy": 0.9511450381679389,
            "hamming_loss": 0.04885496183206107,
            "no_defect_precision": 0.9614225437010248,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9522388059701492,
            "no_defect_tp": 1595,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9405940594059405,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.95,
            "defect_tp": 1520,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9528467832837131,
            "recall_macro": 0.9532664014479508,
            "f1_macro": 0.9529537244120871,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.963789981894991,
            "no_defect_recall": 0.9444115907746895,
            "no_defect_f1": 0.9540023894862605,
            "no_defect_tp": 1597,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 94,
            "no_defect_support": 1691,
            "defect_precision": 0.9419035846724351,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9519050593379138,
            "defect_tp": 1524,
            "defect_fp": 94,
            "defect_tn": 1597,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9505197650186246,
            "recall_macro": 0.951000804914909,
            "f1_macro": 0.9505203961725701,
            "precision_micro": 0.9505343511450381,
            "recall_micro": 0.9505343511450381,
            "f1_micro": 0.9505343511450381,
            "accuracy": 0.9505343511450381,
            "hamming_loss": 0.04946564885496183,
            "no_defect_precision": 0.9664429530201343,
            "no_defect_recall": 0.9367238320520402,
            "no_defect_f1": 0.9513513513513514,
            "no_defect_tp": 1584,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 107,
            "no_defect_support": 1691,
            "defect_precision": 0.934596577017115,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9496894409937888,
            "defect_tp": 1529,
            "defect_fp": 107,
            "defect_tn": 1584,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543585725744772,
            "recall_macro": 0.9546649224354724,
            "f1_macro": 0.9544724226362397,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9616766467065868,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9556679559654865,
            "no_defect_tp": 1606,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9470404984423676,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9532768893069928,
            "defect_tp": 1520,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555804279291884,
            "recall_macro": 0.955887601622374,
            "f1_macro": 0.9556946394782198,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.962874251497006,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9568580779529902,
            "no_defect_tp": 1608,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9482866043613707,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9545312010034493,
            "defect_tp": 1522,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9558955223880596,
            "recall_macro": 0.9561433375744435,
            "f1_macro": 0.9559965603418161,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9617910447761194,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9572192513368984,
            "no_defect_tp": 1611,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.95,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9547738693467337,
            "defect_tp": 1520,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549719375441565,
            "recall_macro": 0.9553561561803727,
            "f1_macro": 0.9550890285320985,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9645006016847172,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9561586638830898,
            "no_defect_tp": 1603,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9454432734035958,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9540193931811073,
            "defect_tp": 1525,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9561898707542988,
            "recall_macro": 0.9565189147536871,
            "f1_macro": 0.9563071339093866,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9640287769784173,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9574278058946115,
            "no_defect_tp": 1608,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9483509645301804,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9551864619241617,
            "defect_tp": 1524,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9564958995140302,
            "recall_macro": 0.9568145977814813,
            "f1_macro": 0.9566119943275115,
            "precision_micro": 0.9566412213740458,
            "recall_micro": 0.9566412213740458,
            "f1_micro": 0.9566412213740458,
            "accuracy": 0.9566412213740458,
            "hamming_loss": 0.0433587786259542,
            "no_defect_precision": 0.9640503295386459,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9577380952380953,
            "no_defect_tp": 1609,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9489414694894147,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9554858934169279,
            "defect_tp": 1524,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 60,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.960005971010409,
            "recall_macro": 0.9600167728950016,
            "f1_macro": 0.9600105667909242,
            "precision_micro": 0.96001221001221,
            "recall_micro": 0.96001221001221,
            "f1_micro": 0.96001221001221,
            "accuracy": 0.96001221001221,
            "hamming_loss": 0.039987789987789985,
            "no_defect_precision": 0.9611414693381907,
            "no_defect_recall": 0.9593939393939394,
            "no_defect_f1": 0.9602669093114953,
            "no_defect_tp": 1583,
            "no_defect_fp": 64,
            "no_defect_tn": 1562,
            "no_defect_fn": 67,
            "no_defect_support": 1650,
            "defect_precision": 0.9588704726826274,
            "defect_recall": 0.9606396063960639,
            "defect_f1": 0.9597542242703533,
            "defect_tp": 1562,
            "defect_fp": 67,
            "defect_tn": 1583,
            "defect_fn": 64,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.01_s150_20251207_203000",
    "lr": 0.001,
    "weight_decay": 0.01,
    "seed": 150,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9556974171139374,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.01_s150_20251207_203000",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s150_20251207_203000",
      "timestamp": "2025-12-07T20:31:53.541795",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 11,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.01_s150",
          "seed": 150,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.01_s150_20251207_203000"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9555788754283565,
        "recall_macro": 0.9559275486980987,
        "f1_macro": 0.9556974171139374,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.963985594237695,
        "no_defect_recall": 0.9497338852749853,
        "no_defect_f1": 0.956806672624367,
        "no_defect_tp": 1606,
        "no_defect_fp": 60,
        "no_defect_tn": 1524,
        "no_defect_fn": 85,
        "no_defect_support": 1691,
        "defect_precision": 0.947172156619018,
        "defect_recall": 0.9621212121212122,
        "defect_f1": 0.9545881616035077,
        "defect_tp": 1524,
        "defect_fp": 85,
        "defect_tn": 1606,
        "defect_fn": 60,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9597222222222223,
        "recall_macro": 0.9596913787319692,
        "f1_macro": 0.9597035804502652,
        "precision_micro": 0.9597069597069597,
        "recall_micro": 0.9597069597069597,
        "f1_micro": 0.9597069597069597,
        "accuracy": 0.9597069597069597,
        "hamming_loss": 0.040293040293040296,
        "no_defect_precision": 0.9583333333333334,
        "no_defect_recall": 0.9618181818181818,
        "no_defect_f1": 0.9600725952813067,
        "no_defect_tp": 1587,
        "no_defect_fp": 69,
        "no_defect_tn": 1557,
        "no_defect_fn": 63,
        "no_defect_support": 1650,
        "defect_precision": 0.9611111111111111,
        "defect_recall": 0.9575645756457565,
        "defect_f1": 0.9593345656192237,
        "defect_tp": 1557,
        "defect_fp": 63,
        "defect_tn": 1587,
        "defect_fn": 69,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6139020590602603,
          0.415448162969685,
          0.28775689074434496,
          0.23981770530156013,
          0.22120032250631802,
          0.20825895953876702,
          0.20078571044126814,
          0.19470417854925579,
          0.1878076718192719,
          0.18295966042010853,
          0.17937154294806046,
          0.18451759122530287,
          0.18382824439882733,
          0.18157783989252904,
          0.17885658958591677
        ],
        "val_loss": [
          0.570014198239033,
          0.35055807404793227,
          0.2530670638840932,
          0.21554093349438447,
          0.1896464632680783,
          0.17380836376777062,
          0.1660844682214352,
          0.15773677696975377,
          0.15387562261177942,
          0.14910066271057495,
          0.14762739808513567,
          0.1441163450766068,
          0.14408746404716602,
          0.143468226521061,
          0.1434380104048894
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8203164556962026,
            "recall_macro": 0.8070371440603552,
            "f1_macro": 0.8073300554709355,
            "precision_micro": 0.8100763358778625,
            "recall_micro": 0.8100763358778625,
            "f1_micro": 0.8100763358778625,
            "accuracy": 0.8100763358778625,
            "hamming_loss": 0.1899236641221374,
            "no_defect_precision": 0.7706329113924051,
            "no_defect_recall": 0.9000591366055588,
            "no_defect_f1": 0.8303327877795963,
            "no_defect_tp": 1522,
            "no_defect_fp": 453,
            "no_defect_tn": 1131,
            "no_defect_fn": 169,
            "no_defect_support": 1691,
            "defect_precision": 0.87,
            "defect_recall": 0.7140151515151515,
            "defect_f1": 0.7843273231622746,
            "defect_tp": 1131,
            "defect_fp": 169,
            "defect_tn": 1522,
            "defect_fn": 453,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9036507501376313,
            "recall_macro": 0.9002000713820644,
            "f1_macro": 0.900951129460968,
            "precision_micro": 0.9013740458015267,
            "recall_micro": 0.9013740458015267,
            "f1_micro": 0.9013740458015267,
            "accuracy": 0.9013740458015267,
            "hamming_loss": 0.09862595419847328,
            "no_defect_precision": 0.8804226918798665,
            "no_defect_recall": 0.9361324659964518,
            "no_defect_f1": 0.9074233304671826,
            "no_defect_tp": 1583,
            "no_defect_fp": 215,
            "no_defect_tn": 1369,
            "no_defect_fn": 108,
            "no_defect_support": 1691,
            "defect_precision": 0.926878808395396,
            "defect_recall": 0.8642676767676768,
            "defect_f1": 0.8944789284547533,
            "defect_tp": 1369,
            "defect_fp": 108,
            "defect_tn": 1583,
            "defect_fn": 215,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9246090754722224,
            "recall_macro": 0.9221522961728461,
            "f1_macro": 0.9227963132316248,
            "precision_micro": 0.9230534351145038,
            "recall_micro": 0.9230534351145038,
            "f1_micro": 0.9230534351145038,
            "accuracy": 0.9230534351145038,
            "hamming_loss": 0.07694656488549619,
            "no_defect_precision": 0.9058093626621545,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9272517321016166,
            "no_defect_tp": 1606,
            "no_defect_fp": 167,
            "no_defect_tn": 1417,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9434087882822902,
            "defect_recall": 0.8945707070707071,
            "defect_f1": 0.9183408943616331,
            "defect_tp": 1417,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 167,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9382706863938515,
            "recall_macro": 0.9387340659701688,
            "f1_macro": 0.9383005861514264,
            "precision_micro": 0.9383206106870229,
            "recall_micro": 0.9383206106870229,
            "f1_micro": 0.9383206106870229,
            "accuracy": 0.9383206106870229,
            "hamming_loss": 0.0616793893129771,
            "no_defect_precision": 0.953134510042605,
            "no_defect_recall": 0.9260792430514488,
            "no_defect_f1": 0.9394121175764847,
            "no_defect_tp": 1566,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 125,
            "no_defect_support": 1691,
            "defect_precision": 0.9234068627450981,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.9371890547263682,
            "defect_tp": 1507,
            "defect_fp": 125,
            "defect_tn": 1566,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9468666468001012,
            "recall_macro": 0.946753534756196,
            "f1_macro": 0.9468069019129912,
            "precision_micro": 0.9468702290076336,
            "recall_micro": 0.9468702290076336,
            "f1_micro": 0.9468702290076336,
            "accuracy": 0.9468702290076336,
            "hamming_loss": 0.05312977099236641,
            "no_defect_precision": 0.9469652327637006,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.948642266824085,
            "no_defect_tp": 1607,
            "no_defect_fp": 90,
            "no_defect_tn": 1494,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9467680608365019,
            "defect_recall": 0.9431818181818182,
            "defect_f1": 0.9449715370018975,
            "defect_tp": 1494,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 90,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9493332521668465,
            "recall_macro": 0.9491789195921366,
            "f1_macro": 0.9492504014039804,
            "precision_micro": 0.9493129770992367,
            "recall_micro": 0.9493129770992367,
            "f1_micro": 0.9493129770992367,
            "accuracy": 0.9493129770992367,
            "hamming_loss": 0.05068702290076336,
            "no_defect_precision": 0.9487934078869924,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9510324483775812,
            "no_defect_tp": 1612,
            "no_defect_fp": 87,
            "no_defect_tn": 1497,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9498730964467005,
            "defect_recall": 0.9450757575757576,
            "defect_f1": 0.9474683544303798,
            "defect_tp": 1497,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 87,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9516244590174212,
            "recall_macro": 0.9518439868824258,
            "f1_macro": 0.9517167902587447,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.9570661896243292,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9530878859857482,
            "no_defect_tp": 1605,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9461827284105131,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.950345694531741,
            "defect_tp": 1512,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9528728386436043,
            "recall_macro": 0.9530067454557402,
            "f1_macro": 0.9529340907428118,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.9566250742721331,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9543568464730291,
            "no_defect_tp": 1610,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9491206030150754,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.9515113350125944,
            "defect_tp": 1511,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543571738750878,
            "recall_macro": 0.9546848959733347,
            "f1_macro": 0.9544738668006896,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9622302158273381,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9556415599880917,
            "no_defect_tp": 1605,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9464841319228375,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9533061736132874,
            "defect_tp": 1521,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543859158083297,
            "recall_macro": 0.9545650547461606,
            "f1_macro": 0.9544646905507246,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9589285714285715,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9557994660338178,
            "no_defect_tp": 1611,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9498432601880877,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9531299150676313,
            "defect_tp": 1515,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555788754283565,
            "recall_macro": 0.9559275486980987,
            "f1_macro": 0.9556974171139374,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.963985594237695,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.956806672624367,
            "no_defect_tp": 1606,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.947172156619018,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9545881616035077,
            "defect_tp": 1524,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9550585182834637,
            "recall_macro": 0.9550765266502996,
            "f1_macro": 0.9550674331499445,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9568047337278106,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9565217391304348,
            "no_defect_tp": 1617,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9533123028391167,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.9536131271694541,
            "defect_tp": 1511,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546735074626865,
            "recall_macro": 0.9549206583875419,
            "f1_macro": 0.9547742425735332,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9605970149253731,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9560308972073678,
            "no_defect_tp": 1609,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.94875,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9535175879396985,
            "defect_tp": 1518,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552907144664282,
            "recall_macro": 0.9555120244431303,
            "f1_macro": 0.9553838694795995,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.960644007155635,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9566508313539193,
            "no_defect_tp": 1611,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9499374217772215,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9541169076052797,
            "defect_tp": 1518,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552907144664282,
            "recall_macro": 0.9555120244431303,
            "f1_macro": 0.9553838694795995,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.960644007155635,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9566508313539193,
            "no_defect_tp": 1611,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9499374217772215,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9541169076052797,
            "defect_tp": 1518,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 66,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9597222222222223,
            "recall_macro": 0.9596913787319692,
            "f1_macro": 0.9597035804502652,
            "precision_micro": 0.9597069597069597,
            "recall_micro": 0.9597069597069597,
            "f1_micro": 0.9597069597069597,
            "accuracy": 0.9597069597069597,
            "hamming_loss": 0.040293040293040296,
            "no_defect_precision": 0.9583333333333334,
            "no_defect_recall": 0.9618181818181818,
            "no_defect_f1": 0.9600725952813067,
            "no_defect_tp": 1587,
            "no_defect_fp": 69,
            "no_defect_tn": 1557,
            "no_defect_fn": 63,
            "no_defect_support": 1650,
            "defect_precision": 0.9611111111111111,
            "defect_recall": 0.9575645756457565,
            "defect_f1": 0.9593345656192237,
            "defect_tp": 1557,
            "defect_fp": 63,
            "defect_tn": 1587,
            "defect_fn": 69,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.1_s10_20251207_144557",
    "lr": 0.001,
    "weight_decay": 0.1,
    "seed": 10,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9556917292005385,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.1_s10_20251207_144557",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s10_20251207_144557",
      "timestamp": "2025-12-07T14:47:54.429349",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.1_s10",
          "seed": 10,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s10_20251207_144557"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9555874203473487,
        "recall_macro": 0.9558476545466492,
        "f1_macro": 0.9556917292005385,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.961768219832736,
        "no_defect_recall": 0.9520993494973389,
        "no_defect_f1": 0.9569093610698366,
        "no_defect_tp": 1610,
        "no_defect_fp": 64,
        "no_defect_tn": 1520,
        "no_defect_fn": 81,
        "no_defect_support": 1691,
        "defect_precision": 0.9494066208619613,
        "defect_recall": 0.9595959595959596,
        "defect_f1": 0.9544740973312402,
        "defect_tp": 1520,
        "defect_fp": 81,
        "defect_tn": 1610,
        "defect_fn": 64,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9612527831279357,
        "recall_macro": 0.9612154757911215,
        "f1_macro": 0.9612297395961222,
        "precision_micro": 0.9612332112332113,
        "recall_micro": 0.9612332112332113,
        "f1_micro": 0.9612332112332113,
        "accuracy": 0.9612332112332113,
        "hamming_loss": 0.03876678876678877,
        "no_defect_precision": 0.9595654797827399,
        "no_defect_recall": 0.9636363636363636,
        "no_defect_f1": 0.9615966132446326,
        "no_defect_tp": 1590,
        "no_defect_fp": 67,
        "no_defect_tn": 1559,
        "no_defect_fn": 60,
        "no_defect_support": 1650,
        "defect_precision": 0.9629400864731316,
        "defect_recall": 0.9587945879458795,
        "defect_f1": 0.9608628659476117,
        "defect_tp": 1559,
        "defect_fp": 60,
        "defect_tn": 1590,
        "defect_fn": 67,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6182374719795323,
          0.41642131204385635,
          0.29378238095898007,
          0.24598314959135015,
          0.22136394875942414,
          0.20854797850218776,
          0.2035033338426546,
          0.19883748109619986,
          0.19343405591020024,
          0.18596407633945033,
          0.18707224068906017,
          0.18567998978508068,
          0.17989370678882718,
          0.18106069768073668,
          0.1860620476087267
        ],
        "val_loss": [
          0.5709069657784241,
          0.350739309994074,
          0.2550041956397203,
          0.21622674482373092,
          0.19457510171028283,
          0.18054012724986443,
          0.17224430106580257,
          0.16442908848134372,
          0.160317188128829,
          0.15540996079261488,
          0.15364685769264513,
          0.1518887747079134,
          0.15025998480044878,
          0.14993623500833145,
          0.1497541508422448
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8465725117809524,
            "recall_macro": 0.8348670023714375,
            "f1_macro": 0.8355815710939134,
            "precision_micro": 0.8375572519083969,
            "recall_micro": 0.8375572519083969,
            "f1_micro": 0.8375572519083969,
            "accuracy": 0.8375572519083969,
            "hamming_loss": 0.16244274809160306,
            "no_defect_precision": 0.7982501286670097,
            "no_defect_recall": 0.9172087522176227,
            "no_defect_f1": 0.8536048431480462,
            "no_defect_tp": 1551,
            "no_defect_fp": 392,
            "no_defect_tn": 1192,
            "no_defect_fn": 140,
            "no_defect_support": 1691,
            "defect_precision": 0.8948948948948949,
            "defect_recall": 0.7525252525252525,
            "defect_f1": 0.8175582990397805,
            "defect_tp": 1192,
            "defect_fp": 140,
            "defect_tn": 1551,
            "defect_fn": 392,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9011583555672467,
            "recall_macro": 0.8985458144424732,
            "f1_macro": 0.8991808806209367,
            "precision_micro": 0.8995419847328244,
            "recall_micro": 0.8995419847328244,
            "f1_micro": 0.8995419847328244,
            "accuracy": 0.8995419847328244,
            "hamming_loss": 0.10045801526717557,
            "no_defect_precision": 0.8825842696629214,
            "no_defect_recall": 0.9290360733293909,
            "no_defect_f1": 0.9052146355517142,
            "no_defect_tp": 1571,
            "no_defect_fp": 209,
            "no_defect_tn": 1375,
            "no_defect_fn": 120,
            "no_defect_support": 1691,
            "defect_precision": 0.919732441471572,
            "defect_recall": 0.8680555555555556,
            "defect_f1": 0.8931471256901592,
            "defect_tp": 1375,
            "defect_fp": 120,
            "defect_tn": 1571,
            "defect_fn": 209,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9327526447204153,
            "recall_macro": 0.9327526447204153,
            "f1_macro": 0.9327526447204153,
            "precision_micro": 0.932824427480916,
            "recall_micro": 0.932824427480916,
            "f1_micro": 0.932824427480916,
            "accuracy": 0.932824427480916,
            "hamming_loss": 0.06717557251908397,
            "no_defect_precision": 0.934949733885275,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.934949733885275,
            "no_defect_tp": 1581,
            "no_defect_fp": 110,
            "no_defect_tn": 1474,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9305555555555556,
            "defect_recall": 0.9305555555555556,
            "defect_f1": 0.9305555555555556,
            "defect_tp": 1474,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 110,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9381464647258964,
            "recall_macro": 0.9368283664558059,
            "f1_macro": 0.9372585487943221,
            "precision_micro": 0.9374045801526718,
            "recall_micro": 0.9374045801526718,
            "f1_micro": 0.9374045801526718,
            "accuracy": 0.9374045801526718,
            "hamming_loss": 0.06259541984732825,
            "no_defect_precision": 0.9265212399540758,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9402854646082144,
            "no_defect_tp": 1614,
            "no_defect_fp": 128,
            "no_defect_tn": 1456,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9497716894977168,
            "defect_recall": 0.9191919191919192,
            "defect_f1": 0.9342316329804299,
            "defect_tp": 1456,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 128,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9458228815501055,
            "recall_macro": 0.9460262739757122,
            "f1_macro": 0.9459096376722542,
            "precision_micro": 0.9459541984732824,
            "recall_micro": 0.9459541984732824,
            "f1_micro": 0.9459541984732824,
            "accuracy": 0.9459541984732824,
            "hamming_loss": 0.054045801526717556,
            "no_defect_precision": 0.9511323003575686,
            "no_defect_recall": 0.9438202247191011,
            "no_defect_f1": 0.9474621549421193,
            "no_defect_tp": 1596,
            "no_defect_fp": 82,
            "no_defect_tn": 1502,
            "no_defect_fn": 95,
            "no_defect_support": 1691,
            "defect_precision": 0.9405134627426425,
            "defect_recall": 0.9482323232323232,
            "defect_f1": 0.9443571204023892,
            "defect_tp": 1502,
            "defect_fp": 95,
            "defect_tn": 1596,
            "defect_fn": 82,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9477082754728138,
            "recall_macro": 0.9477604250667527,
            "f1_macro": 0.9477335526932864,
            "precision_micro": 0.9477862595419847,
            "recall_micro": 0.9477862595419847,
            "f1_micro": 0.9477862595419847,
            "accuracy": 0.9477862595419847,
            "hamming_loss": 0.052213740458015266,
            "no_defect_precision": 0.9502369668246445,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.94939331163066,
            "no_defect_tp": 1604,
            "no_defect_fp": 84,
            "no_defect_tn": 1500,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.945179584120983,
            "defect_recall": 0.946969696969697,
            "defect_f1": 0.9460737937559129,
            "defect_tp": 1500,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 84,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9506955782668263,
            "recall_macro": 0.9509769113369053,
            "f1_macro": 0.9508041748177648,
            "precision_micro": 0.9508396946564885,
            "recall_micro": 0.9508396946564885,
            "f1_micro": 0.9508396946564885,
            "accuracy": 0.9508396946564885,
            "hamming_loss": 0.04916030534351145,
            "no_defect_precision": 0.9575358851674641,
            "no_defect_recall": 0.9467770549970431,
            "no_defect_f1": 0.952126077906631,
            "no_defect_tp": 1601,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 90,
            "no_defect_support": 1691,
            "defect_precision": 0.9438552713661884,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.9494822717288987,
            "defect_tp": 1513,
            "defect_fp": 90,
            "defect_tn": 1601,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.951674644898983,
            "recall_macro": 0.9517441191931139,
            "f1_macro": 0.9517079582522322,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.9543568464730291,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9532267613972765,
            "no_defect_tp": 1610,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.948992443324937,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.9501891551071879,
            "defect_tp": 1507,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.953443366449227,
            "recall_macro": 0.9537379262763651,
            "f1_macro": 0.9535550103488917,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9605026929982047,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9547888161808448,
            "no_defect_tp": 1605,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9463840399002493,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9523212045169385,
            "defect_tp": 1518,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549887937976673,
            "recall_macro": 0.9551963678774738,
            "f1_macro": 0.9550774956939061,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9600715137067938,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.956366874443455,
            "no_defect_tp": 1611,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.949906073888541,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9537881169443572,
            "defect_tp": 1517,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546631602431565,
            "recall_macro": 0.954980579001129,
            "f1_macro": 0.9547786983131811,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9622528460155781,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.955952380952381,
            "no_defect_tp": 1606,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9470734744707348,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9536050156739811,
            "defect_tp": 1521,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549695002518328,
            "recall_macro": 0.9552762620289232,
            "f1_macro": 0.9550835310572297,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9622754491017964,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9562630169592383,
            "no_defect_tp": 1607,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9476635514018692,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9539040451552211,
            "defect_tp": 1521,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555998546141715,
            "recall_macro": 0.9558077074709246,
            "f1_macro": 0.9556886862286829,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9606674612634089,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9569605224102108,
            "no_defect_tp": 1612,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505322479649343,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9544168500471549,
            "defect_tp": 1518,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555874203473487,
            "recall_macro": 0.9558476545466492,
            "f1_macro": 0.9556917292005385,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.961768219832736,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9569093610698366,
            "no_defect_tp": 1610,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9494066208619613,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9544740973312402,
            "defect_tp": 1520,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555874203473487,
            "recall_macro": 0.9558476545466492,
            "f1_macro": 0.9556917292005385,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.961768219832736,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9569093610698366,
            "no_defect_tp": 1610,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9494066208619613,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9544740973312402,
            "defect_tp": 1520,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 64,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9612527831279357,
            "recall_macro": 0.9612154757911215,
            "f1_macro": 0.9612297395961222,
            "precision_micro": 0.9612332112332113,
            "recall_micro": 0.9612332112332113,
            "f1_micro": 0.9612332112332113,
            "accuracy": 0.9612332112332113,
            "hamming_loss": 0.03876678876678877,
            "no_defect_precision": 0.9595654797827399,
            "no_defect_recall": 0.9636363636363636,
            "no_defect_f1": 0.9615966132446326,
            "no_defect_tp": 1590,
            "no_defect_fp": 67,
            "no_defect_tn": 1559,
            "no_defect_fn": 60,
            "no_defect_support": 1650,
            "defect_precision": 0.9629400864731316,
            "defect_recall": 0.9587945879458795,
            "defect_f1": 0.9608628659476117,
            "defect_tp": 1559,
            "defect_fp": 60,
            "defect_tn": 1590,
            "defect_fn": 67,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.1_s20_20251207_141623",
    "lr": 0.001,
    "weight_decay": 0.1,
    "seed": 20,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.955993505402833,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.1_s20_20251207_141623",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s20_20251207_141623",
      "timestamp": "2025-12-07T14:18:16.827093",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.1_s20",
          "seed": 20,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s20_20251207_141623"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.955909353490934,
        "recall_macro": 0.9561033904987187,
        "f1_macro": 0.955993505402833,
        "precision_micro": 0.956030534351145,
        "recall_micro": 0.956030534351145,
        "f1_micro": 0.956030534351145,
        "accuracy": 0.956030534351145,
        "hamming_loss": 0.04396946564885496,
        "no_defect_precision": 0.9606908874329958,
        "no_defect_recall": 0.9538734476641041,
        "no_defect_f1": 0.9572700296735905,
        "no_defect_tp": 1613,
        "no_defect_fp": 66,
        "no_defect_tn": 1518,
        "no_defect_fn": 78,
        "no_defect_support": 1691,
        "defect_precision": 0.9511278195488722,
        "defect_recall": 0.9583333333333334,
        "defect_f1": 0.9547169811320755,
        "defect_tp": 1518,
        "defect_fp": 78,
        "defect_tn": 1613,
        "defect_fn": 66,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9591201814329445,
        "recall_macro": 0.9590763725819076,
        "f1_macro": 0.9590925559529863,
        "precision_micro": 0.9590964590964591,
        "recall_micro": 0.9590964590964591,
        "f1_micro": 0.9590964590964591,
        "accuracy": 0.9590964590964591,
        "hamming_loss": 0.040903540903540904,
        "no_defect_precision": 0.9571773220747889,
        "no_defect_recall": 0.9618181818181818,
        "no_defect_f1": 0.9594921402660218,
        "no_defect_tp": 1587,
        "no_defect_fp": 71,
        "no_defect_tn": 1555,
        "no_defect_fn": 63,
        "no_defect_support": 1650,
        "defect_precision": 0.9610630407911002,
        "defect_recall": 0.9563345633456335,
        "defect_f1": 0.9586929716399507,
        "defect_tp": 1555,
        "defect_fp": 63,
        "defect_tn": 1587,
        "defect_fn": 71,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6242238652257242,
          0.4153349873411107,
          0.29124508760713635,
          0.24422635225321956,
          0.2196897032620019,
          0.20738409568699834,
          0.20074088101481793,
          0.1999250901044662,
          0.18837926733194535,
          0.18957710163239155,
          0.18472971760952323,
          0.18533138887154008,
          0.18362400450092978,
          0.18545647227365103,
          0.18568970453165565
        ],
        "val_loss": [
          0.5757260162096757,
          0.3501260418158311,
          0.25265169688142264,
          0.2144702569796489,
          0.19696015148208693,
          0.17805780126498297,
          0.16845107408097157,
          0.16534089712569347,
          0.15900266628998977,
          0.1552880953710813,
          0.15183656419125888,
          0.15012183814094618,
          0.15017963071855214,
          0.14984577965851015,
          0.14993701001199392
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8444569901762053,
            "recall_macro": 0.8170786068849345,
            "f1_macro": 0.8167906805015941,
            "precision_micro": 0.8213740458015267,
            "recall_micro": 0.8213740458015267,
            "f1_micro": 0.8213740458015267,
            "accuracy": 0.8213740458015267,
            "hamming_loss": 0.17862595419847327,
            "no_defect_precision": 0.7630827783063748,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.8457685209596625,
            "no_defect_tp": 1604,
            "no_defect_fp": 498,
            "no_defect_tn": 1086,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9258312020460358,
            "defect_recall": 0.6856060606060606,
            "defect_f1": 0.7878128400435256,
            "defect_tp": 1086,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 498,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9048839717341844,
            "recall_macro": 0.9014227505689658,
            "f1_macro": 0.9021777408608321,
            "precision_micro": 0.9025954198473283,
            "recall_micro": 0.9025954198473283,
            "f1_micro": 0.9025954198473283,
            "accuracy": 0.9025954198473283,
            "hamming_loss": 0.09740458015267175,
            "no_defect_precision": 0.8815350389321468,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.9085697907709945,
            "no_defect_tp": 1585,
            "no_defect_fp": 213,
            "no_defect_tn": 1371,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.9282329045362221,
            "defect_recall": 0.865530303030303,
            "defect_f1": 0.8957856909506697,
            "defect_tp": 1371,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 213,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9306685078038942,
            "recall_macro": 0.9300076832786768,
            "f1_macro": 0.9302596392442375,
            "precision_micro": 0.9303816793893129,
            "recall_micro": 0.9303816793893129,
            "f1_micro": 0.9303816793893129,
            "accuracy": 0.9303816793893129,
            "hamming_loss": 0.06961832061068703,
            "no_defect_precision": 0.9250435793143521,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9331770222743259,
            "no_defect_tp": 1592,
            "no_defect_fp": 129,
            "no_defect_tn": 1455,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.9362934362934363,
            "defect_recall": 0.9185606060606061,
            "defect_f1": 0.9273422562141491,
            "defect_tp": 1455,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 129,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9394273431924924,
            "recall_macro": 0.9395572743998232,
            "f1_macro": 0.9394866880979008,
            "precision_micro": 0.9395419847328245,
            "recall_micro": 0.9395419847328245,
            "f1_micro": 0.9395419847328245,
            "accuracy": 0.9395419847328245,
            "hamming_loss": 0.06045801526717557,
            "no_defect_precision": 0.9435531788472965,
            "no_defect_recall": 0.9390892962743939,
            "no_defect_f1": 0.941315945465323,
            "no_defect_tp": 1588,
            "no_defect_fp": 95,
            "no_defect_tn": 1489,
            "no_defect_fn": 103,
            "no_defect_support": 1691,
            "defect_precision": 0.9353015075376885,
            "defect_recall": 0.9400252525252525,
            "defect_f1": 0.9376574307304786,
            "defect_tp": 1489,
            "defect_fp": 103,
            "defect_tn": 1588,
            "defect_fn": 95,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9430104471088078,
            "recall_macro": 0.9434689144550173,
            "f1_macro": 0.9428904549544471,
            "precision_micro": 0.9429007633587786,
            "recall_micro": 0.9429007633587786,
            "f1_micro": 0.9429007633587786,
            "accuracy": 0.9429007633587786,
            "hamming_loss": 0.05709923664122137,
            "no_defect_precision": 0.961916461916462,
            "no_defect_recall": 0.9260792430514488,
            "no_defect_f1": 0.943657728231395,
            "no_defect_tp": 1566,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 125,
            "no_defect_support": 1691,
            "defect_precision": 0.9241044323011536,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9421231816774992,
            "defect_tp": 1522,
            "defect_fp": 125,
            "defect_tn": 1566,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9517041721173891,
            "recall_macro": 0.9517041721173891,
            "f1_macro": 0.9517041721173891,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.9532820816085157,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9532820816085157,
            "no_defect_tp": 1612,
            "no_defect_fp": 79,
            "no_defect_tn": 1505,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9501262626262627,
            "defect_recall": 0.9501262626262627,
            "defect_f1": 0.9501262626262627,
            "defect_tp": 1505,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 79,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9517390387621938,
            "recall_macro": 0.9511288595595219,
            "f1_macro": 0.9513689674195196,
            "precision_micro": 0.9514503816793893,
            "recall_micro": 0.9514503816793893,
            "f1_micro": 0.9514503816793893,
            "accuracy": 0.9514503816793893,
            "hamming_loss": 0.04854961832061069,
            "no_defect_precision": 0.9458672875436555,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9533587562334995,
            "no_defect_tp": 1625,
            "no_defect_fp": 93,
            "no_defect_tn": 1491,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9576107899807321,
            "defect_recall": 0.9412878787878788,
            "defect_f1": 0.9493791786055397,
            "defect_tp": 1491,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 93,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9525530988007314,
            "recall_macro": 0.952990691958019,
            "f1_macro": 0.9526501239421774,
            "precision_micro": 0.9526717557251908,
            "recall_micro": 0.9526717557251908,
            "f1_micro": 0.9526717557251908,
            "accuracy": 0.9526717557251908,
            "hamming_loss": 0.04732824427480916,
            "no_defect_precision": 0.964328899637243,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.953662182361734,
            "no_defect_tp": 1595,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9407772979642196,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9516380655226209,
            "defect_tp": 1525,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549722858157701,
            "recall_macro": 0.9552562884910608,
            "f1_macro": 0.9550820726596982,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9617224880382775,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9562890276538805,
            "no_defect_tp": 1608,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9482220835932627,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9538751176655161,
            "defect_tp": 1520,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555998546141715,
            "recall_macro": 0.9558077074709246,
            "f1_macro": 0.9556886862286829,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9606674612634089,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9569605224102108,
            "no_defect_tp": 1612,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505322479649343,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9544168500471549,
            "defect_tp": 1518,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556177330517805,
            "recall_macro": 0.9557677603951997,
            "f1_macro": 0.9556855105080515,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9595719381688466,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9570115624073525,
            "no_defect_tp": 1614,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9516635279347144,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9543594586087504,
            "defect_tp": 1516,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9559677745698187,
            "recall_macro": 0.9560035228094068,
            "f1_macro": 0.9559852910981278,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9579632918886916,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9573964497041421,
            "no_defect_tp": 1618,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9539722572509458,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.9545741324921135,
            "defect_tp": 1513,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.955909353490934,
            "recall_macro": 0.9561033904987187,
            "f1_macro": 0.955993505402833,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9606908874329958,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9572700296735905,
            "no_defect_tp": 1613,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9511278195488722,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9547169811320755,
            "defect_tp": 1518,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555998546141715,
            "recall_macro": 0.9558077074709246,
            "f1_macro": 0.9556886862286829,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9606674612634089,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9569605224102108,
            "no_defect_tp": 1612,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505322479649343,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9544168500471549,
            "defect_tp": 1518,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555998546141715,
            "recall_macro": 0.9558077074709246,
            "f1_macro": 0.9556886862286829,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9606674612634089,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9569605224102108,
            "no_defect_tp": 1612,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505322479649343,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9544168500471549,
            "defect_tp": 1518,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 66,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9591201814329445,
            "recall_macro": 0.9590763725819076,
            "f1_macro": 0.9590925559529863,
            "precision_micro": 0.9590964590964591,
            "recall_micro": 0.9590964590964591,
            "f1_micro": 0.9590964590964591,
            "accuracy": 0.9590964590964591,
            "hamming_loss": 0.040903540903540904,
            "no_defect_precision": 0.9571773220747889,
            "no_defect_recall": 0.9618181818181818,
            "no_defect_f1": 0.9594921402660218,
            "no_defect_tp": 1587,
            "no_defect_fp": 71,
            "no_defect_tn": 1555,
            "no_defect_fn": 63,
            "no_defect_support": 1650,
            "defect_precision": 0.9610630407911002,
            "defect_recall": 0.9563345633456335,
            "defect_f1": 0.9586929716399507,
            "defect_tp": 1555,
            "defect_fp": 63,
            "defect_tn": 1587,
            "defect_fn": 71,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.1_s30_20251207_145437",
    "lr": 0.001,
    "weight_decay": 0.1,
    "seed": 30,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9556871149654702,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.1_s30_20251207_145437",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s30_20251207_145437",
      "timestamp": "2025-12-07T14:56:29.220497",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 11,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.1_s30",
          "seed": 30,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s30_20251207_145437"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9556081131512166,
        "recall_macro": 0.9557877339330622,
        "f1_macro": 0.9556871149654702,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.9601190476190476,
        "no_defect_recall": 0.9538734476641041,
        "no_defect_f1": 0.9569860575496886,
        "no_defect_tp": 1613,
        "no_defect_fp": 67,
        "no_defect_tn": 1517,
        "no_defect_fn": 78,
        "no_defect_support": 1691,
        "defect_precision": 0.9510971786833856,
        "defect_recall": 0.9577020202020202,
        "defect_f1": 0.954388172381252,
        "defect_tp": 1517,
        "defect_fp": 78,
        "defect_tn": 1613,
        "defect_fn": 67,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9584837302918483,
        "recall_macro": 0.9584837302918483,
        "f1_macro": 0.9584837302918483,
        "precision_micro": 0.9584859584859585,
        "recall_micro": 0.9584859584859585,
        "f1_micro": 0.9584859584859585,
        "accuracy": 0.9584859584859585,
        "hamming_loss": 0.04151404151404151,
        "no_defect_precision": 0.9587878787878787,
        "no_defect_recall": 0.9587878787878787,
        "no_defect_f1": 0.9587878787878787,
        "no_defect_tp": 1582,
        "no_defect_fp": 68,
        "no_defect_tn": 1558,
        "no_defect_fn": 68,
        "no_defect_support": 1650,
        "defect_precision": 0.958179581795818,
        "defect_recall": 0.958179581795818,
        "defect_f1": 0.958179581795818,
        "defect_tp": 1558,
        "defect_fp": 68,
        "defect_tn": 1582,
        "defect_fn": 68,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6293610965357664,
          0.4150239780358191,
          0.29287354024633705,
          0.24317946350474737,
          0.2241135912959047,
          0.21015403132932456,
          0.1998599786077583,
          0.19498889968110927,
          0.19422834559838642,
          0.18810269807048421,
          0.19086679451510496,
          0.18542520340267085,
          0.18370902753400004,
          0.18147351025412772,
          0.18427834697223608
        ],
        "val_loss": [
          0.5766687725598996,
          0.3471039762863746,
          0.25399118346663624,
          0.21606289767302,
          0.19390671556958786,
          0.1812252736148926,
          0.16996982836952576,
          0.16221358311864045,
          0.15835025147176707,
          0.15551070281519339,
          0.15327866131869647,
          0.15176744071336892,
          0.15204224577889994,
          0.1511994919811304,
          0.151046477831327
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8657826465067088,
            "recall_macro": 0.8545696841268988,
            "f1_macro": 0.8554956347934305,
            "precision_micro": 0.8570992366412213,
            "recall_micro": 0.8570992366412213,
            "f1_micro": 0.8570992366412213,
            "accuracy": 0.8570992366412213,
            "hamming_loss": 0.14290076335877863,
            "no_defect_precision": 0.8170036288232244,
            "no_defect_recall": 0.9319929036073329,
            "no_defect_f1": 0.8707182320441988,
            "no_defect_tp": 1576,
            "no_defect_fp": 353,
            "no_defect_tn": 1231,
            "no_defect_fn": 115,
            "no_defect_support": 1691,
            "defect_precision": 0.9145616641901931,
            "defect_recall": 0.7771464646464646,
            "defect_f1": 0.8402730375426621,
            "defect_tp": 1231,
            "defect_fp": 115,
            "defect_tn": 1576,
            "defect_fn": 353,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9050848212181364,
            "recall_macro": 0.904251526202295,
            "f1_macro": 0.9045457093212264,
            "precision_micro": 0.9047328244274809,
            "recall_micro": 0.9047328244274809,
            "f1_micro": 0.9047328244274809,
            "accuracy": 0.9047328244274809,
            "hamming_loss": 0.09526717557251908,
            "no_defect_precision": 0.8987854251012146,
            "no_defect_recall": 0.918982850384388,
            "no_defect_f1": 0.9087719298245615,
            "no_defect_tp": 1554,
            "no_defect_fp": 175,
            "no_defect_tn": 1409,
            "no_defect_fn": 137,
            "no_defect_support": 1691,
            "defect_precision": 0.9113842173350583,
            "defect_recall": 0.889520202020202,
            "defect_f1": 0.9003194888178914,
            "defect_tp": 1409,
            "defect_fp": 137,
            "defect_tn": 1554,
            "defect_fn": 175,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9285066726730109,
            "recall_macro": 0.9261559638370698,
            "f1_macro": 0.9267867480295864,
            "precision_micro": 0.9270229007633588,
            "recall_micro": 0.9270229007633588,
            "f1_micro": 0.9270229007633588,
            "accuracy": 0.9270229007633588,
            "hamming_loss": 0.07297709923664122,
            "no_defect_precision": 0.9101694915254237,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.930944813637677,
            "no_defect_tp": 1611,
            "no_defect_fp": 159,
            "no_defect_tn": 1425,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.946843853820598,
            "defect_recall": 0.8996212121212122,
            "defect_f1": 0.9226286824214956,
            "defect_tp": 1425,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 159,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9402035623409669,
            "recall_macro": 0.9399688786146503,
            "f1_macro": 0.940073551103752,
            "precision_micro": 0.9401526717557251,
            "recall_micro": 0.9401526717557251,
            "f1_micro": 0.9401526717557251,
            "accuracy": 0.9401526717557251,
            "hamming_loss": 0.05984732824427481,
            "no_defect_precision": 0.9389312977099237,
            "no_defect_recall": 0.9455943228858663,
            "no_defect_f1": 0.9422510312315852,
            "no_defect_tp": 1599,
            "no_defect_fp": 104,
            "no_defect_tn": 1480,
            "no_defect_fn": 92,
            "no_defect_support": 1691,
            "defect_precision": 0.9414758269720102,
            "defect_recall": 0.9343434343434344,
            "defect_f1": 0.9378960709759189,
            "defect_tp": 1480,
            "defect_fp": 92,
            "defect_tn": 1599,
            "defect_fn": 104,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9438293053841764,
            "recall_macro": 0.9436768632510797,
            "f1_macro": 0.9437474328815205,
            "precision_micro": 0.9438167938931298,
            "recall_micro": 0.9438167938931298,
            "f1_micro": 0.9438167938931298,
            "accuracy": 0.9438167938931298,
            "hamming_loss": 0.05618320610687023,
            "no_defect_precision": 0.9434961742201294,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9457227138643067,
            "no_defect_tp": 1603,
            "no_defect_fp": 96,
            "no_defect_tn": 1488,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9441624365482234,
            "defect_recall": 0.9393939393939394,
            "defect_f1": 0.9417721518987342,
            "defect_tp": 1488,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 96,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.949164942430535,
            "recall_macro": 0.949478522660072,
            "f1_macro": 0.9492788102701896,
            "precision_micro": 0.9493129770992367,
            "recall_micro": 0.9493129770992367,
            "f1_micro": 0.9493129770992367,
            "accuracy": 0.9493129770992367,
            "hamming_loss": 0.05068702290076336,
            "no_defect_precision": 0.956860395446375,
            "no_defect_recall": 0.9444115907746895,
            "no_defect_f1": 0.950595238095238,
            "no_defect_tp": 1597,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 94,
            "no_defect_support": 1691,
            "defect_precision": 0.9414694894146949,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.9479623824451411,
            "defect_tp": 1512,
            "defect_fp": 94,
            "defect_tn": 1597,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9511095736665365,
            "recall_macro": 0.951072858986076,
            "f1_macro": 0.9510908604872396,
            "precision_micro": 0.9511450381679389,
            "recall_micro": 0.9511450381679389,
            "f1_micro": 0.9511450381679389,
            "accuracy": 0.9511450381679389,
            "hamming_loss": 0.04885496183206107,
            "no_defect_precision": 0.9521559362079149,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9527186761229315,
            "no_defect_tp": 1612,
            "no_defect_fp": 81,
            "no_defect_tn": 1503,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.950063211125158,
            "defect_recall": 0.9488636363636364,
            "defect_f1": 0.9494630448515476,
            "defect_tp": 1503,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 81,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9535930849415168,
            "recall_macro": 0.9534782702841544,
            "f1_macro": 0.9535324660389348,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9534472598703595,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9551357733175915,
            "no_defect_tp": 1618,
            "no_defect_fp": 79,
            "no_defect_tn": 1505,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9537389100126743,
            "defect_recall": 0.9501262626262627,
            "defect_f1": 0.9519291587602783,
            "defect_tp": 1505,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 79,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552982739755882,
            "recall_macro": 0.955492050905268,
            "f1_macro": 0.9553823040889835,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9600952948183442,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9566765578635015,
            "no_defect_tp": 1612,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505012531328321,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9540880503144654,
            "defect_tp": 1517,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954981932323454,
            "recall_macro": 0.9552163414153361,
            "f1_macro": 0.9550790549848043,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9606205250596659,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9563409563409564,
            "no_defect_tp": 1610,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.949343339587242,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9538171536286523,
            "defect_tp": 1518,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556081131512166,
            "recall_macro": 0.9557877339330622,
            "f1_macro": 0.9556871149654702,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9601190476190476,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9569860575496886,
            "no_defect_tp": 1613,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9510971786833856,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.954388172381252,
            "defect_tp": 1517,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537598827429434,
            "recall_macro": 0.9539936622284346,
            "f1_macro": 0.953856716344935,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9594272076372315,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9551529551529552,
            "no_defect_tp": 1608,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9480925578486554,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9525604775369149,
            "defect_tp": 1516,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546631602431565,
            "recall_macro": 0.954980579001129,
            "f1_macro": 0.9547786983131811,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9622528460155781,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.955952380952381,
            "no_defect_tp": 1606,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9470734744707348,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9536050156739811,
            "defect_tp": 1521,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540577267059331,
            "recall_macro": 0.9543292923319535,
            "f1_macro": 0.9541646233185764,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9605499103407054,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.955410225921522,
            "no_defect_tp": 1607,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.947565543071161,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9529190207156308,
            "defect_tp": 1518,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954365439163247,
            "recall_macro": 0.9546249753597478,
            "f1_macro": 0.954469432075036,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9605734767025089,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9557206537890045,
            "no_defect_tp": 1608,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.948157401623985,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9532182103610675,
            "defect_tp": 1518,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 66,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9584837302918483,
            "recall_macro": 0.9584837302918483,
            "f1_macro": 0.9584837302918483,
            "precision_micro": 0.9584859584859585,
            "recall_micro": 0.9584859584859585,
            "f1_micro": 0.9584859584859585,
            "accuracy": 0.9584859584859585,
            "hamming_loss": 0.04151404151404151,
            "no_defect_precision": 0.9587878787878787,
            "no_defect_recall": 0.9587878787878787,
            "no_defect_f1": 0.9587878787878787,
            "no_defect_tp": 1582,
            "no_defect_fp": 68,
            "no_defect_tn": 1558,
            "no_defect_fn": 68,
            "no_defect_support": 1650,
            "defect_precision": 0.958179581795818,
            "defect_recall": 0.958179581795818,
            "defect_f1": 0.958179581795818,
            "defect_tp": 1558,
            "defect_fp": 68,
            "defect_tn": 1582,
            "defect_fn": 68,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.1_s40_20251207_190131",
    "lr": 0.001,
    "weight_decay": 0.1,
    "seed": 40,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9562918013750875,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.1_s40_20251207_190131",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s40_20251207_190131",
      "timestamp": "2025-12-07T19:03:26.689140",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.1_s40",
          "seed": 40,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s40_20251207_190131"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9562660329633247,
        "recall_macro": 0.9563191793750634,
        "f1_macro": 0.9562918013750875,
        "precision_micro": 0.9563358778625954,
        "recall_micro": 0.9563358778625954,
        "f1_micro": 0.9563358778625954,
        "accuracy": 0.9563358778625954,
        "hamming_loss": 0.04366412213740458,
        "no_defect_precision": 0.9585308056872038,
        "no_defect_recall": 0.9568302779420461,
        "no_defect_f1": 0.9576797869192069,
        "no_defect_tp": 1618,
        "no_defect_fp": 70,
        "no_defect_tn": 1514,
        "no_defect_fn": 73,
        "no_defect_support": 1691,
        "defect_precision": 0.9540012602394455,
        "defect_recall": 0.9558080808080808,
        "defect_f1": 0.9549038158309682,
        "defect_tp": 1514,
        "defect_fp": 73,
        "defect_tn": 1618,
        "defect_fn": 70,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9594969656047184,
        "recall_macro": 0.9593570390249357,
        "f1_macro": 0.9593947136932546,
        "precision_micro": 0.9594017094017094,
        "recall_micro": 0.9594017094017094,
        "f1_micro": 0.9594017094017094,
        "accuracy": 0.9594017094017094,
        "hamming_loss": 0.0405982905982906,
        "no_defect_precision": 0.9544637507489515,
        "no_defect_recall": 0.9654545454545455,
        "no_defect_f1": 0.9599276890629708,
        "no_defect_tp": 1593,
        "no_defect_fp": 76,
        "no_defect_tn": 1550,
        "no_defect_fn": 57,
        "no_defect_support": 1650,
        "defect_precision": 0.9645301804604853,
        "defect_recall": 0.9532595325953259,
        "defect_f1": 0.9588617383235385,
        "defect_tp": 1550,
        "defect_fp": 57,
        "defect_tn": 1593,
        "defect_fn": 76,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6167333672236199,
          0.41308448915701035,
          0.29315147015838944,
          0.2447808328158686,
          0.2179828526834065,
          0.20911746596816194,
          0.19722702890385144,
          0.19372157104095156,
          0.19163507142076933,
          0.18435070277133248,
          0.18903005456699987,
          0.18190813591415414,
          0.18431311328291394,
          0.1856717327336886,
          0.18519660899080492
        ],
        "val_loss": [
          0.5667786151170731,
          0.3490054699090811,
          0.255484101577447,
          0.21740025281906128,
          0.1932093956722663,
          0.17911875978685343,
          0.17114768076974612,
          0.16462203960579175,
          0.15786545193539217,
          0.1578400653715317,
          0.15254307710207426,
          0.1511755301975287,
          0.1498857490145243,
          0.14938427049380082,
          0.14939350333924478
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8496576771688993,
            "recall_macro": 0.8334406677657713,
            "f1_macro": 0.8340401751357445,
            "precision_micro": 0.8366412213740458,
            "recall_micro": 0.8366412213740458,
            "f1_micro": 0.8366412213740458,
            "accuracy": 0.8366412213740458,
            "hamming_loss": 0.1633587786259542,
            "no_defect_precision": 0.7898696088264794,
            "no_defect_recall": 0.9314015375517445,
            "no_defect_f1": 0.8548168249660787,
            "no_defect_tp": 1575,
            "no_defect_fp": 419,
            "no_defect_tn": 1165,
            "no_defect_fn": 116,
            "no_defect_support": 1691,
            "defect_precision": 0.9094457455113193,
            "defect_recall": 0.735479797979798,
            "defect_f1": 0.8132635253054101,
            "defect_tp": 1165,
            "defect_fp": 116,
            "defect_tn": 1575,
            "defect_fn": 419,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9003757146828575,
            "recall_macro": 0.8968077433112915,
            "f1_macro": 0.8975655464382009,
            "precision_micro": 0.8980152671755726,
            "recall_micro": 0.8980152671755726,
            "f1_micro": 0.8980152671755726,
            "accuracy": 0.8980152671755726,
            "hamming_loss": 0.10198473282442748,
            "no_defect_precision": 0.8767351471404775,
            "no_defect_recall": 0.9337670017740982,
            "no_defect_f1": 0.9043528064146621,
            "no_defect_tp": 1579,
            "no_defect_fp": 222,
            "no_defect_tn": 1362,
            "no_defect_fn": 112,
            "no_defect_support": 1691,
            "defect_precision": 0.9240162822252375,
            "defect_recall": 0.8598484848484849,
            "defect_f1": 0.8907782864617397,
            "defect_tp": 1362,
            "defect_fp": 112,
            "defect_tn": 1579,
            "defect_fn": 222,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.928996458511856,
            "recall_macro": 0.9276382990161819,
            "f1_macro": 0.9280725979612197,
            "precision_micro": 0.9282442748091603,
            "recall_micro": 0.9282442748091603,
            "f1_micro": 0.9282442748091603,
            "accuracy": 0.9282442748091603,
            "hamming_loss": 0.0717557251908397,
            "no_defect_precision": 0.9174311926605505,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.9315866084425036,
            "no_defect_tp": 1600,
            "no_defect_fp": 144,
            "no_defect_tn": 1440,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9405617243631613,
            "defect_recall": 0.9090909090909091,
            "defect_f1": 0.9245585874799358,
            "defect_tp": 1440,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 144,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9412367352452342,
            "recall_macro": 0.9414512137937625,
            "f1_macro": 0.9413267324663226,
            "precision_micro": 0.9413740458015267,
            "recall_micro": 0.9413740458015267,
            "f1_micro": 0.9413740458015267,
            "accuracy": 0.9413740458015267,
            "hamming_loss": 0.05862595419847328,
            "no_defect_precision": 0.9469290399522957,
            "no_defect_recall": 0.9390892962743939,
            "no_defect_f1": 0.9429928741092637,
            "no_defect_tp": 1588,
            "no_defect_fp": 89,
            "no_defect_tn": 1495,
            "no_defect_fn": 103,
            "no_defect_support": 1691,
            "defect_precision": 0.9355444305381727,
            "defect_recall": 0.9438131313131313,
            "defect_f1": 0.9396605908233815,
            "defect_tp": 1495,
            "defect_fp": 103,
            "defect_tn": 1588,
            "defect_fn": 89,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9468870535967708,
            "recall_macro": 0.9467335612183336,
            "f1_macro": 0.9468046376162205,
            "precision_micro": 0.9468702290076336,
            "recall_micro": 0.9468702290076336,
            "f1_micro": 0.9468702290076336,
            "accuracy": 0.9468702290076336,
            "hamming_loss": 0.05312977099236641,
            "no_defect_precision": 0.9464390818128311,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9486725663716814,
            "no_defect_tp": 1608,
            "no_defect_fp": 91,
            "no_defect_tn": 1493,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9473350253807107,
            "defect_recall": 0.9425505050505051,
            "defect_f1": 0.9449367088607595,
            "defect_tp": 1493,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 91,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9480526269020276,
            "recall_macro": 0.9480161610188222,
            "f1_macro": 0.948034039267692,
            "precision_micro": 0.9480916030534351,
            "recall_micro": 0.9480916030534351,
            "f1_micro": 0.9480916030534351,
            "accuracy": 0.9480916030534351,
            "hamming_loss": 0.051908396946564885,
            "no_defect_precision": 0.9492025989367986,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9497635933806147,
            "no_defect_tp": 1607,
            "no_defect_fp": 86,
            "no_defect_tn": 1498,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9469026548672567,
            "defect_recall": 0.9457070707070707,
            "defect_f1": 0.9463044851547694,
            "defect_tp": 1498,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 86,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9507113680821385,
            "recall_macro": 0.9509169907233184,
            "f1_macro": 0.9507991619504685,
            "precision_micro": 0.9508396946564885,
            "recall_micro": 0.9508396946564885,
            "f1_micro": 0.9508396946564885,
            "accuracy": 0.9508396946564885,
            "hamming_loss": 0.04916030534351145,
            "no_defect_precision": 0.9558998808104887,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.952211338676165,
            "no_defect_tp": 1604,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9455228553537883,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.949386985224772,
            "defect_tp": 1510,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537476448971216,
            "recall_macro": 0.9540535828420217,
            "f1_macro": 0.9538613142152496,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9610778443113772,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9550728949717346,
            "no_defect_tp": 1605,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.946417445482866,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9526497334587645,
            "defect_tp": 1519,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9535381908977414,
            "recall_macro": 0.9535381908977414,
            "f1_macro": 0.9535381908977414,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9550561797752809,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9550561797752809,
            "no_defect_tp": 1615,
            "no_defect_fp": 76,
            "no_defect_tn": 1508,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.952020202020202,
            "defect_recall": 0.952020202020202,
            "defect_f1": 0.952020202020202,
            "defect_tp": 1508,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 76,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9528467832837131,
            "recall_macro": 0.9532664014479508,
            "f1_macro": 0.9529537244120871,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.963789981894991,
            "no_defect_recall": 0.9444115907746895,
            "no_defect_f1": 0.9540023894862605,
            "no_defect_tp": 1597,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 94,
            "no_defect_support": 1691,
            "defect_precision": 0.9419035846724351,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9519050593379138,
            "defect_tp": 1524,
            "defect_fp": 94,
            "defect_tn": 1597,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.955043496178966,
            "recall_macro": 0.955096500188162,
            "f1_macro": 0.9550691944205445,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.957345971563981,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9564960047351287,
            "no_defect_tp": 1616,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9527410207939508,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.9536423841059603,
            "defect_tp": 1512,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549970144797731,
            "recall_macro": 0.9551763943396114,
            "f1_macro": 0.9550759027580974,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9595238095238096,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9563927617917531,
            "no_defect_tp": 1612,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9504702194357367,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9537590437244416,
            "defect_tp": 1516,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9550175347971293,
            "recall_macro": 0.9551364472638866,
            "f1_macro": 0.9550726159230096,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9584323040380047,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9564444444444444,
            "no_defect_tp": 1614,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9516027655562539,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9537007874015748,
            "defect_tp": 1514,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9562660329633247,
            "recall_macro": 0.9563191793750634,
            "f1_macro": 0.9562918013750875,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9585308056872038,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9576797869192069,
            "no_defect_tp": 1618,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9540012602394455,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9549038158309682,
            "defect_tp": 1514,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556410583735901,
            "recall_macro": 0.9557278133194751,
            "f1_macro": 0.9556822019816483,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9584816132858838,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9570624814924489,
            "no_defect_tp": 1616,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9528005034612964,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9543019224708478,
            "defect_tp": 1514,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 70,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9594969656047184,
            "recall_macro": 0.9593570390249357,
            "f1_macro": 0.9593947136932546,
            "precision_micro": 0.9594017094017094,
            "recall_micro": 0.9594017094017094,
            "f1_micro": 0.9594017094017094,
            "accuracy": 0.9594017094017094,
            "hamming_loss": 0.0405982905982906,
            "no_defect_precision": 0.9544637507489515,
            "no_defect_recall": 0.9654545454545455,
            "no_defect_f1": 0.9599276890629708,
            "no_defect_tp": 1593,
            "no_defect_fp": 76,
            "no_defect_tn": 1550,
            "no_defect_fn": 57,
            "no_defect_support": 1650,
            "defect_precision": 0.9645301804604853,
            "defect_recall": 0.9532595325953259,
            "defect_f1": 0.9588617383235385,
            "defect_tp": 1550,
            "defect_fp": 57,
            "defect_tn": 1593,
            "defect_fn": 76,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.1_s50_20251207_155319",
    "lr": 0.001,
    "weight_decay": 0.1,
    "seed": 50,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9547772469186576,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.1_s50_20251207_155319",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s50_20251207_155319",
      "timestamp": "2025-12-07T15:55:15.887667",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 11,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.1_s50",
          "seed": 50,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s50_20251207_155319"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9546652518912175,
        "recall_macro": 0.9549606054632667,
        "f1_macro": 0.9547772469186576,
        "precision_micro": 0.9548091603053435,
        "recall_micro": 0.9548091603053435,
        "f1_micro": 0.9548091603053435,
        "accuracy": 0.9548091603053435,
        "hamming_loss": 0.04519083969465649,
        "no_defect_precision": 0.9616995810891682,
        "no_defect_recall": 0.9503252513305737,
        "no_defect_f1": 0.9559785841760856,
        "no_defect_tp": 1607,
        "no_defect_fp": 64,
        "no_defect_tn": 1520,
        "no_defect_fn": 84,
        "no_defect_support": 1691,
        "defect_precision": 0.9476309226932669,
        "defect_recall": 0.9595959595959596,
        "defect_f1": 0.9535759096612296,
        "defect_tp": 1520,
        "defect_fp": 84,
        "defect_tn": 1607,
        "defect_fn": 64,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9603256015756743,
        "recall_macro": 0.9603063848820306,
        "f1_macro": 0.9603145612423812,
        "precision_micro": 0.9603174603174603,
        "recall_micro": 0.9603174603174603,
        "f1_micro": 0.9603174603174603,
        "accuracy": 0.9603174603174603,
        "hamming_loss": 0.03968253968253968,
        "no_defect_precision": 0.9594921402660218,
        "no_defect_recall": 0.9618181818181818,
        "no_defect_f1": 0.9606537530266344,
        "no_defect_tp": 1587,
        "no_defect_fp": 67,
        "no_defect_tn": 1559,
        "no_defect_fn": 63,
        "no_defect_support": 1650,
        "defect_precision": 0.9611590628853267,
        "defect_recall": 0.9587945879458795,
        "defect_f1": 0.9599753694581281,
        "defect_tp": 1559,
        "defect_fp": 63,
        "defect_tn": 1587,
        "defect_fn": 67,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6096422011383408,
          0.40894270242507486,
          0.29075536605703284,
          0.24387545553211387,
          0.21818871269290915,
          0.21173607383437734,
          0.20313551015060816,
          0.1936475489927635,
          0.19174641464295247,
          0.19049415110793572,
          0.18996863731155836,
          0.18488929233665746,
          0.18418966944497,
          0.18217087798911658,
          0.18580484658354995
        ],
        "val_loss": [
          0.5648628943241559,
          0.3482869141376935,
          0.25323985946866184,
          0.21886305109812662,
          0.19415431612959275,
          0.17870169247572237,
          0.16918527077023798,
          0.16081036928181464,
          0.1575366758669798,
          0.15451451448293832,
          0.15308000376591316,
          0.15134968436681306,
          0.15033771441533014,
          0.14988100113203892,
          0.14978675730526447
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.857495416087035,
            "recall_macro": 0.8390586452938611,
            "f1_macro": 0.8396920235137337,
            "precision_micro": 0.842442748091603,
            "recall_micro": 0.842442748091603,
            "f1_micro": 0.842442748091603,
            "accuracy": 0.842442748091603,
            "hamming_loss": 0.15755725190839695,
            "no_defect_precision": 0.791852955787382,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.8606911447084233,
            "no_defect_tp": 1594,
            "no_defect_fp": 419,
            "no_defect_tn": 1165,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.9231378763866878,
            "defect_recall": 0.735479797979798,
            "defect_f1": 0.8186929023190442,
            "defect_tp": 1165,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 419,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9041713502906998,
            "recall_macro": 0.8989534986171592,
            "f1_macro": 0.8998885660768283,
            "precision_micro": 0.9004580152671756,
            "recall_micro": 0.9004580152671756,
            "f1_micro": 0.9004580152671756,
            "accuracy": 0.9004580152671756,
            "hamming_loss": 0.09954198473282443,
            "no_defect_precision": 0.8727471327143638,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.9074389551391255,
            "no_defect_tp": 1598,
            "no_defect_fp": 233,
            "no_defect_tn": 1351,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.935595567867036,
            "defect_recall": 0.8529040404040404,
            "defect_f1": 0.892338177014531,
            "defect_tp": 1351,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 233,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9313234570151566,
            "recall_macro": 0.9311144412785454,
            "f1_macro": 0.9312084047155536,
            "precision_micro": 0.9312977099236641,
            "recall_micro": 0.9312977099236641,
            "f1_micro": 0.9312977099236641,
            "accuracy": 0.9312977099236641,
            "hamming_loss": 0.06870229007633588,
            "no_defect_precision": 0.9306698002350177,
            "no_defect_recall": 0.9367238320520402,
            "no_defect_f1": 0.9336870026525199,
            "no_defect_tp": 1584,
            "no_defect_fp": 118,
            "no_defect_tn": 1466,
            "no_defect_fn": 107,
            "no_defect_support": 1691,
            "defect_precision": 0.9319771137952956,
            "defect_recall": 0.9255050505050505,
            "defect_f1": 0.9287298067785873,
            "defect_tp": 1466,
            "defect_fp": 107,
            "defect_tn": 1584,
            "defect_fn": 118,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9391166200570356,
            "recall_macro": 0.939541220902102,
            "f1_macro": 0.9392088688031826,
            "precision_micro": 0.9392366412213741,
            "recall_micro": 0.9392366412213741,
            "f1_micro": 0.9392366412213741,
            "accuracy": 0.9392366412213741,
            "hamming_loss": 0.06076335877862595,
            "no_defect_precision": 0.9510278113663845,
            "no_defect_recall": 0.9302188054405677,
            "no_defect_f1": 0.94050822122571,
            "no_defect_tp": 1573,
            "no_defect_fp": 81,
            "no_defect_tn": 1503,
            "no_defect_fn": 118,
            "no_defect_support": 1691,
            "defect_precision": 0.9272054287476866,
            "defect_recall": 0.9488636363636364,
            "defect_f1": 0.9379095163806552,
            "defect_tp": 1503,
            "defect_fp": 118,
            "defect_tn": 1573,
            "defect_fn": 81,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9439834860988595,
            "recall_macro": 0.9442122287332222,
            "f1_macro": 0.9440780072259809,
            "precision_micro": 0.9441221374045802,
            "recall_micro": 0.9441221374045802,
            "f1_micro": 0.9441221374045802,
            "accuracy": 0.9441221374045802,
            "hamming_loss": 0.055877862595419846,
            "no_defect_precision": 0.9498806682577565,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9456489456489456,
            "no_defect_tp": 1592,
            "no_defect_fp": 84,
            "no_defect_tn": 1500,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.9380863039399625,
            "defect_recall": 0.946969696969697,
            "defect_f1": 0.942507068803016,
            "defect_tp": 1500,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 84,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9480008626250862,
            "recall_macro": 0.9475007690745421,
            "f1_macro": 0.947703858302459,
            "precision_micro": 0.9477862595419847,
            "recall_micro": 0.9477862595419847,
            "f1_micro": 0.9477862595419847,
            "accuracy": 0.9477862595419847,
            "hamming_loss": 0.052213740458015266,
            "no_defect_precision": 0.9434072345390898,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9497797356828194,
            "no_defect_tp": 1617,
            "no_defect_fp": 97,
            "no_defect_tn": 1487,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9525944907110826,
            "defect_recall": 0.9387626262626263,
            "defect_f1": 0.9456279809220985,
            "defect_tp": 1487,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 97,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9507286262057619,
            "recall_macro": 0.9508770436475936,
            "f1_macro": 0.9507956358054916,
            "precision_micro": 0.9508396946564885,
            "recall_micro": 0.9508396946564885,
            "f1_micro": 0.9508396946564885,
            "accuracy": 0.9508396946564885,
            "hamming_loss": 0.04916030534351145,
            "no_defect_precision": 0.9548156956004756,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9522680106729914,
            "no_defect_tp": 1606,
            "no_defect_fp": 76,
            "no_defect_tn": 1508,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9466415568110483,
            "defect_recall": 0.952020202020202,
            "defect_f1": 0.9493232609379918,
            "defect_tp": 1508,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 76,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.952575320307986,
            "recall_macro": 0.9520958027943539,
            "f1_macro": 0.9522923930038555,
            "precision_micro": 0.9523664122137404,
            "recall_micro": 0.9523664122137404,
            "f1_micro": 0.9523664122137404,
            "accuracy": 0.9523664122137404,
            "hamming_loss": 0.04763358778625954,
            "no_defect_precision": 0.9480443666082895,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.954171562867215,
            "no_defect_tp": 1624,
            "no_defect_fp": 89,
            "no_defect_tn": 1495,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9571062740076824,
            "defect_recall": 0.9438131313131313,
            "defect_f1": 0.9504132231404959,
            "defect_tp": 1495,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 89,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954463537676465,
            "recall_macro": 0.9544452135189865,
            "f1_macro": 0.9544542863279043,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9556737588652482,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9559562518474727,
            "no_defect_tp": 1617,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9532533164876816,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9529523208083359,
            "defect_tp": 1509,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9538521734325555,
            "recall_macro": 0.9538338739255356,
            "f1_macro": 0.9538429344665339,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9550827423167849,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9553650605971031,
            "no_defect_tp": 1616,
            "no_defect_fp": 76,
            "no_defect_tn": 1508,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.952621604548326,
            "defect_recall": 0.952020202020202,
            "defect_f1": 0.9523208083359647,
            "defect_tp": 1508,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 76,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546652518912175,
            "recall_macro": 0.9549606054632667,
            "f1_macro": 0.9547772469186576,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9616995810891682,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9559785841760856,
            "no_defect_tp": 1607,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9476309226932669,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9535759096612296,
            "defect_tp": 1520,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543613275944924,
            "recall_macro": 0.9546449488976101,
            "f1_macro": 0.9544709443965649,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9611244019138756,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9556943205471305,
            "no_defect_tp": 1607,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9475982532751092,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9532475682459993,
            "defect_tp": 1519,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543709075331988,
            "recall_macro": 0.9546050018218853,
            "f1_macro": 0.9544678856648696,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9600238663484487,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9557469557469558,
            "no_defect_tp": 1609,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9487179487179487,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9531888155827836,
            "defect_tp": 1517,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543777329811634,
            "recall_macro": 0.9545850282840229,
            "f1_macro": 0.9544663051591293,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9594755661501788,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9557732264766993,
            "no_defect_tp": 1610,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9492798998121478,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9531593838415593,
            "defect_tp": 1516,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543777329811634,
            "recall_macro": 0.9545850282840229,
            "f1_macro": 0.9544663051591293,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9594755661501788,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9557732264766993,
            "no_defect_tp": 1610,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9492798998121478,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9531593838415593,
            "defect_tp": 1516,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 68,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9603256015756743,
            "recall_macro": 0.9603063848820306,
            "f1_macro": 0.9603145612423812,
            "precision_micro": 0.9603174603174603,
            "recall_micro": 0.9603174603174603,
            "f1_micro": 0.9603174603174603,
            "accuracy": 0.9603174603174603,
            "hamming_loss": 0.03968253968253968,
            "no_defect_precision": 0.9594921402660218,
            "no_defect_recall": 0.9618181818181818,
            "no_defect_f1": 0.9606537530266344,
            "no_defect_tp": 1587,
            "no_defect_fp": 67,
            "no_defect_tn": 1559,
            "no_defect_fn": 63,
            "no_defect_support": 1650,
            "defect_precision": 0.9611590628853267,
            "defect_recall": 0.9587945879458795,
            "defect_f1": 0.9599753694581281,
            "defect_tp": 1559,
            "defect_fp": 63,
            "defect_tn": 1587,
            "defect_fn": 67,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.1_s60_20251207_205508",
    "lr": 0.001,
    "weight_decay": 0.1,
    "seed": 60,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9550805806377872,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.1_s60_20251207_205508",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s60_20251207_205508",
      "timestamp": "2025-12-07T20:57:04.516782",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.1_s60",
          "seed": 60,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s60_20251207_205508"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9549764297552978,
        "recall_macro": 0.9552363149531985,
        "f1_macro": 0.9550805806377872,
        "precision_micro": 0.9551145038167939,
        "recall_micro": 0.9551145038167939,
        "f1_micro": 0.9551145038167939,
        "accuracy": 0.9551145038167939,
        "hamming_loss": 0.04488549618320611,
        "no_defect_precision": 0.9611708482676224,
        "no_defect_recall": 0.9515079834417505,
        "no_defect_f1": 0.9563150074294205,
        "no_defect_tp": 1609,
        "no_defect_fp": 65,
        "no_defect_tn": 1519,
        "no_defect_fn": 82,
        "no_defect_support": 1691,
        "defect_precision": 0.9487820112429731,
        "defect_recall": 0.9589646464646465,
        "defect_f1": 0.9538461538461539,
        "defect_tp": 1519,
        "defect_fp": 82,
        "defect_tn": 1609,
        "defect_fn": 65,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9590986891542123,
        "recall_macro": 0.959089790897909,
        "f1_macro": 0.9590938824954574,
        "precision_micro": 0.9590964590964591,
        "recall_micro": 0.9590964590964591,
        "f1_micro": 0.9590964590964591,
        "accuracy": 0.9590964590964591,
        "hamming_loss": 0.040903540903540904,
        "no_defect_precision": 0.9588377723970944,
        "no_defect_recall": 0.96,
        "no_defect_f1": 0.9594185342216839,
        "no_defect_tp": 1584,
        "no_defect_fp": 68,
        "no_defect_tn": 1558,
        "no_defect_fn": 66,
        "no_defect_support": 1650,
        "defect_precision": 0.9593596059113301,
        "defect_recall": 0.958179581795818,
        "defect_f1": 0.9587692307692308,
        "defect_tp": 1558,
        "defect_fp": 66,
        "defect_tn": 1584,
        "defect_fn": 68,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6184513925508475,
          0.41792203766531527,
          0.2933672379125611,
          0.24079777568454025,
          0.21959019792129805,
          0.2058618912886376,
          0.19923749556725992,
          0.19405747703802637,
          0.19129840739726023,
          0.18857711940130928,
          0.18980585163357866,
          0.1830431366939425,
          0.1842899580006819,
          0.18454487765184507,
          0.18462382680950803
        ],
        "val_loss": [
          0.5697138790900891,
          0.3505686607498389,
          0.2537716764670152,
          0.2179079488492929,
          0.1935913319197985,
          0.17910409532487392,
          0.16873021237552166,
          0.16132868296251848,
          0.15744980095097652,
          0.15704870424591577,
          0.153182355973583,
          0.1521542825951026,
          0.15053078947732082,
          0.14981081494345114,
          0.14996024436102465
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8483273819041021,
            "recall_macro": 0.8367209946896523,
            "f1_macro": 0.8374578795445555,
            "precision_micro": 0.8393893129770993,
            "recall_micro": 0.8393893129770993,
            "f1_micro": 0.8393893129770993,
            "accuracy": 0.8393893129770993,
            "hamming_loss": 0.16061068702290077,
            "no_defect_precision": 0.8001030396702731,
            "no_defect_recall": 0.9183914843287996,
            "no_defect_f1": 0.8551762114537445,
            "no_defect_tp": 1553,
            "no_defect_fp": 388,
            "no_defect_tn": 1196,
            "no_defect_fn": 138,
            "no_defect_support": 1691,
            "defect_precision": 0.896551724137931,
            "defect_recall": 0.7550505050505051,
            "defect_f1": 0.8197395476353667,
            "defect_tp": 1196,
            "defect_fp": 138,
            "defect_tn": 1553,
            "defect_fn": 388,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9033039203062088,
            "recall_macro": 0.8999043883542701,
            "f1_macro": 0.9006484488761318,
            "precision_micro": 0.9010687022900763,
            "recall_micro": 0.9010687022900763,
            "f1_micro": 0.9010687022900763,
            "accuracy": 0.9010687022900763,
            "hamming_loss": 0.09893129770992366,
            "no_defect_precision": 0.8803561491374513,
            "no_defect_recall": 0.9355410999408634,
            "no_defect_f1": 0.9071100917431193,
            "no_defect_tp": 1582,
            "no_defect_fp": 215,
            "no_defect_tn": 1369,
            "no_defect_fn": 109,
            "no_defect_support": 1691,
            "defect_precision": 0.9262516914749662,
            "defect_recall": 0.8642676767676768,
            "defect_f1": 0.8941868060091444,
            "defect_tp": 1369,
            "defect_fp": 109,
            "defect_tn": 1582,
            "defect_fn": 215,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9342763185931218,
            "recall_macro": 0.9337156679151062,
            "f1_macro": 0.9339368483337965,
            "precision_micro": 0.9340458015267176,
            "recall_micro": 0.9340458015267176,
            "f1_micro": 0.9340458015267176,
            "accuracy": 0.9340458015267176,
            "hamming_loss": 0.06595419847328245,
            "no_defect_precision": 0.9295282469423413,
            "no_defect_recall": 0.9438202247191011,
            "no_defect_f1": 0.9366197183098591,
            "no_defect_tp": 1596,
            "no_defect_fp": 121,
            "no_defect_tn": 1463,
            "no_defect_fn": 95,
            "no_defect_support": 1691,
            "defect_precision": 0.9390243902439024,
            "defect_recall": 0.9236111111111112,
            "defect_f1": 0.9312539783577339,
            "defect_tp": 1463,
            "defect_fp": 95,
            "defect_tn": 1596,
            "defect_fn": 121,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9403296601647704,
            "recall_macro": 0.9407439265511413,
            "f1_macro": 0.9404292230142398,
            "precision_micro": 0.9404580152671755,
            "recall_micro": 0.9404580152671755,
            "f1_micro": 0.9404580152671755,
            "accuracy": 0.9404580152671755,
            "hamming_loss": 0.059541984732824425,
            "no_defect_precision": 0.9516908212560387,
            "no_defect_recall": 0.9319929036073329,
            "no_defect_f1": 0.9417388706304153,
            "no_defect_tp": 1576,
            "no_defect_fp": 80,
            "no_defect_tn": 1504,
            "no_defect_fn": 115,
            "no_defect_support": 1691,
            "defect_precision": 0.9289684990735022,
            "defect_recall": 0.9494949494949495,
            "defect_f1": 0.9391195753980643,
            "defect_tp": 1504,
            "defect_fp": 115,
            "defect_tn": 1576,
            "defect_fn": 80,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9462021157763323,
            "recall_macro": 0.9462021157763323,
            "f1_macro": 0.9462021157763323,
            "precision_micro": 0.9462595419847328,
            "recall_micro": 0.9462595419847328,
            "f1_micro": 0.9462595419847328,
            "accuracy": 0.9462595419847328,
            "hamming_loss": 0.053740458015267174,
            "no_defect_precision": 0.94795978710822,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.94795978710822,
            "no_defect_tp": 1603,
            "no_defect_fp": 88,
            "no_defect_tn": 1496,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9444444444444444,
            "defect_recall": 0.9444444444444444,
            "defect_f1": 0.9444444444444444,
            "defect_tp": 1496,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 88,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9504521537494457,
            "recall_macro": 0.9505214400062123,
            "f1_macro": 0.9504853749168456,
            "precision_micro": 0.9505343511450381,
            "recall_micro": 0.9505343511450381,
            "f1_micro": 0.9505343511450381,
            "accuracy": 0.9505343511450381,
            "hamming_loss": 0.04946564885496183,
            "no_defect_precision": 0.9531713100177831,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9520426287744227,
            "no_defect_tp": 1608,
            "no_defect_fp": 79,
            "no_defect_tn": 1505,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9477329974811083,
            "defect_recall": 0.9501262626262627,
            "defect_f1": 0.9489281210592686,
            "defect_tp": 1505,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 79,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9507091543958828,
            "recall_macro": 0.9502817575518641,
            "f1_macro": 0.9504598535729412,
            "precision_micro": 0.9505343511450381,
            "recall_micro": 0.9505343511450381,
            "f1_micro": 0.9505343511450381,
            "accuracy": 0.9505343511450381,
            "hamming_loss": 0.04946564885496183,
            "no_defect_precision": 0.9468147282291058,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9523809523809523,
            "no_defect_tp": 1620,
            "no_defect_fp": 91,
            "no_defect_tn": 1493,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9546035805626598,
            "defect_recall": 0.9425505050505051,
            "defect_f1": 0.9485387547649301,
            "defect_tp": 1493,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 91,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.95233235237234,
            "recall_macro": 0.9522955381729776,
            "f1_macro": 0.9523135889750586,
            "precision_micro": 0.9523664122137404,
            "recall_micro": 0.9523664122137404,
            "f1_micro": 0.9523664122137404,
            "accuracy": 0.9523664122137404,
            "hamming_loss": 0.04763358778625954,
            "no_defect_precision": 0.9533372711163615,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9539007092198581,
            "no_defect_tp": 1614,
            "no_defect_fp": 79,
            "no_defect_tn": 1505,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9513274336283186,
            "defect_recall": 0.9501262626262627,
            "defect_f1": 0.950726468730259,
            "defect_tp": 1505,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 79,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9531731796287712,
            "recall_macro": 0.9533224020213967,
            "f1_macro": 0.9532405731567716,
            "precision_micro": 0.9532824427480916,
            "recall_micro": 0.9532824427480916,
            "f1_micro": 0.9532824427480916,
            "accuracy": 0.9532824427480916,
            "hamming_loss": 0.0467175572519084,
            "no_defect_precision": 0.9571938168846611,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.954639786540172,
            "no_defect_tp": 1610,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9491525423728814,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.9518413597733711,
            "defect_tp": 1512,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546650273281119,
            "recall_macro": 0.9550404996147162,
            "f1_macro": 0.9547828494622452,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9639206253758268,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9558735837805605,
            "no_defect_tp": 1603,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9454094292803971,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9536921151439299,
            "defect_tp": 1524,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546652518912175,
            "recall_macro": 0.9549606054632667,
            "f1_macro": 0.9547772469186576,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9616995810891682,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9559785841760856,
            "no_defect_tp": 1607,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9476309226932669,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9535759096612296,
            "defect_tp": 1520,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954663048141309,
            "recall_macro": 0.9550205260768537,
            "f1_macro": 0.9547814995786945,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9633633633633634,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9558998808104887,
            "no_defect_tp": 1604,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9459627329192547,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9536631183469004,
            "defect_tp": 1523,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549764297552978,
            "recall_macro": 0.9552363149531985,
            "f1_macro": 0.9550805806377872,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9611708482676224,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9563150074294205,
            "no_defect_tp": 1609,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9487820112429731,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9538461538461539,
            "defect_tp": 1519,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549764297552978,
            "recall_macro": 0.9552363149531985,
            "f1_macro": 0.9550805806377872,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9611708482676224,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9563150074294205,
            "no_defect_tp": 1609,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9487820112429731,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9538461538461539,
            "defect_tp": 1519,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549764297552978,
            "recall_macro": 0.9552363149531985,
            "f1_macro": 0.9550805806377872,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9611708482676224,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9563150074294205,
            "no_defect_tp": 1609,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9487820112429731,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9538461538461539,
            "defect_tp": 1519,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 65,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9590986891542123,
            "recall_macro": 0.959089790897909,
            "f1_macro": 0.9590938824954574,
            "precision_micro": 0.9590964590964591,
            "recall_micro": 0.9590964590964591,
            "f1_micro": 0.9590964590964591,
            "accuracy": 0.9590964590964591,
            "hamming_loss": 0.040903540903540904,
            "no_defect_precision": 0.9588377723970944,
            "no_defect_recall": 0.96,
            "no_defect_f1": 0.9594185342216839,
            "no_defect_tp": 1584,
            "no_defect_fp": 68,
            "no_defect_tn": 1558,
            "no_defect_fn": 66,
            "no_defect_support": 1650,
            "defect_precision": 0.9593596059113301,
            "defect_recall": 0.958179581795818,
            "defect_f1": 0.9587692307692308,
            "defect_tp": 1558,
            "defect_fp": 66,
            "defect_tn": 1584,
            "defect_fn": 68,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.1_s70_20251207_143348",
    "lr": 0.001,
    "weight_decay": 0.1,
    "seed": 70,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9544542863279043,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.1_s70_20251207_143348",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s70_20251207_143348",
      "timestamp": "2025-12-07T14:35:45.611957",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 10,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.1_s70",
          "seed": 70,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s70_20251207_143348"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.954463537676465,
        "recall_macro": 0.9544452135189865,
        "f1_macro": 0.9544542863279043,
        "precision_micro": 0.9545038167938932,
        "recall_micro": 0.9545038167938932,
        "f1_micro": 0.9545038167938932,
        "accuracy": 0.9545038167938932,
        "hamming_loss": 0.04549618320610687,
        "no_defect_precision": 0.9556737588652482,
        "no_defect_recall": 0.9562389118864577,
        "no_defect_f1": 0.9559562518474727,
        "no_defect_tp": 1617,
        "no_defect_fp": 75,
        "no_defect_tn": 1509,
        "no_defect_fn": 74,
        "no_defect_support": 1691,
        "defect_precision": 0.9532533164876816,
        "defect_recall": 0.9526515151515151,
        "defect_f1": 0.9529523208083359,
        "defect_tp": 1509,
        "defect_fp": 74,
        "defect_tn": 1617,
        "defect_fn": 75,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9597047970479704,
        "recall_macro": 0.9597047970479704,
        "f1_macro": 0.9597047970479704,
        "precision_micro": 0.9597069597069597,
        "recall_micro": 0.9597069597069597,
        "f1_micro": 0.9597069597069597,
        "accuracy": 0.9597069597069597,
        "hamming_loss": 0.040293040293040296,
        "no_defect_precision": 0.96,
        "no_defect_recall": 0.96,
        "no_defect_f1": 0.96,
        "no_defect_tp": 1584,
        "no_defect_fp": 66,
        "no_defect_tn": 1560,
        "no_defect_fn": 66,
        "no_defect_support": 1650,
        "defect_precision": 0.959409594095941,
        "defect_recall": 0.959409594095941,
        "defect_f1": 0.959409594095941,
        "defect_tp": 1560,
        "defect_fp": 66,
        "defect_tn": 1584,
        "defect_fn": 66,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6164532293834447,
          0.4088852955457057,
          0.2906260727963188,
          0.24006330892131916,
          0.22086211378105514,
          0.20832665043271237,
          0.19516766033910807,
          0.19400429214393744,
          0.19767426297255639,
          0.19074054863537704,
          0.18309727772509204,
          0.1859338246753525,
          0.18815992301852136,
          0.17985049198736205,
          0.1833351823388283
        ],
        "val_loss": [
          0.5678329318761826,
          0.3489027785567137,
          0.2539260055010135,
          0.2146139620588376,
          0.19339162970964724,
          0.17915577856967083,
          0.17166448241242996,
          0.1616715303120705,
          0.16013984468120795,
          0.15347250479345137,
          0.15152748101032698,
          0.1505251916555258,
          0.15065175008315307,
          0.1501143713696645,
          0.14996414273404157
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.847409368462871,
            "recall_macro": 0.8245184697357968,
            "f1_macro": 0.8246777320382668,
            "precision_micro": 0.8283969465648855,
            "recall_micro": 0.8283969465648855,
            "f1_micro": 0.8283969465648855,
            "accuracy": 0.8283969465648855,
            "hamming_loss": 0.1716030534351145,
            "no_defect_precision": 0.7738961669092673,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.8502132196162047,
            "no_defect_tp": 1595,
            "no_defect_fp": 466,
            "no_defect_tn": 1118,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9209225700164745,
            "defect_recall": 0.7058080808080808,
            "defect_f1": 0.7991422444603288,
            "defect_tp": 1118,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 466,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.8989073828244665,
            "recall_macro": 0.8908623490971215,
            "f1_macro": 0.8919656015430304,
            "precision_micro": 0.8928244274809161,
            "recall_micro": 0.8928244274809161,
            "f1_micro": 0.8928244274809161,
            "accuracy": 0.8928244274809161,
            "hamming_loss": 0.10717557251908397,
            "no_defect_precision": 0.8571428571428571,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9015979814970564,
            "no_defect_tp": 1608,
            "no_defect_fp": 268,
            "no_defect_tn": 1316,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9406719085060757,
            "defect_recall": 0.8308080808080808,
            "defect_f1": 0.8823332215890044,
            "defect_tp": 1316,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 268,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9268442797544398,
            "recall_macro": 0.926439513407284,
            "f1_macro": 0.9266071904784314,
            "precision_micro": 0.9267175572519084,
            "recall_micro": 0.9267175572519084,
            "f1_micro": 0.9267175572519084,
            "accuracy": 0.9267175572519084,
            "hamming_loss": 0.0732824427480916,
            "no_defect_precision": 0.9240210403272939,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.9294532627865961,
            "no_defect_tp": 1581,
            "no_defect_fp": 130,
            "no_defect_tn": 1454,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9296675191815856,
            "defect_recall": 0.9179292929292929,
            "defect_f1": 0.9237611181702668,
            "defect_tp": 1454,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 130,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9395287142821933,
            "recall_macro": 0.9394174596347866,
            "f1_macro": 0.9394699228665073,
            "precision_micro": 0.9395419847328245,
            "recall_micro": 0.9395419847328245,
            "f1_micro": 0.9395419847328245,
            "accuracy": 0.9395419847328245,
            "hamming_loss": 0.06045801526717557,
            "no_defect_precision": 0.9398939304655274,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9415584415584416,
            "no_defect_tp": 1595,
            "no_defect_fp": 102,
            "no_defect_tn": 1482,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9391634980988594,
            "defect_recall": 0.9356060606060606,
            "defect_f1": 0.937381404174573,
            "defect_tp": 1482,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 102,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9467612498021898,
            "recall_macro": 0.9468933495212324,
            "f1_macro": 0.946821634995125,
            "precision_micro": 0.9468702290076336,
            "recall_micro": 0.9468702290076336,
            "f1_micro": 0.9468702290076336,
            "accuracy": 0.9468702290076336,
            "hamming_loss": 0.05312977099236641,
            "no_defect_precision": 0.9506833036244801,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.948429164196799,
            "no_defect_tp": 1600,
            "no_defect_fp": 83,
            "no_defect_tn": 1501,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9428391959798995,
            "defect_recall": 0.94760101010101,
            "defect_f1": 0.9452141057934509,
            "defect_tp": 1501,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 83,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9510134164425866,
            "recall_macro": 0.9512326472889749,
            "f1_macro": 0.9511056103886022,
            "precision_micro": 0.9511450381679389,
            "recall_micro": 0.9511450381679389,
            "f1_micro": 0.9511450381679389,
            "accuracy": 0.9511450381679389,
            "hamming_loss": 0.04885496183206107,
            "no_defect_precision": 0.9564698867024448,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9524940617577197,
            "no_defect_tp": 1604,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9455569461827285,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.9497171590194846,
            "defect_tp": 1511,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9503862287244044,
            "recall_macro": 0.9507211753848359,
            "f1_macro": 0.950502559256987,
            "precision_micro": 0.9505343511450381,
            "recall_micro": 0.9505343511450381,
            "f1_micro": 0.9505343511450381,
            "accuracy": 0.9505343511450381,
            "hamming_loss": 0.04946564885496183,
            "no_defect_precision": 0.9586082783443312,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.9517569982132221,
            "no_defect_tp": 1598,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.9421641791044776,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9492481203007519,
            "defect_tp": 1515,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9531839951867019,
            "recall_macro": 0.9533024284835343,
            "f1_macro": 0.953238845144357,
            "precision_micro": 0.9532824427480916,
            "recall_micro": 0.9532824427480916,
            "f1_micro": 0.9532824427480916,
            "accuracy": 0.9532824427480916,
            "hamming_loss": 0.0467175572519084,
            "no_defect_precision": 0.9566508313539193,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9546666666666667,
            "no_defect_tp": 1611,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9497171590194846,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.9518110236220473,
            "defect_tp": 1511,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9522251118486871,
            "recall_macro": 0.9526151147787754,
            "f1_macro": 0.9523400663600907,
            "precision_micro": 0.9523664122137404,
            "recall_micro": 0.9523664122137404,
            "f1_micro": 0.9523664122137404,
            "accuracy": 0.9523664122137404,
            "hamming_loss": 0.04763358778625954,
            "no_defect_precision": 0.9620710415412402,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.9534606205250596,
            "no_defect_tp": 1598,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.9423791821561338,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9512195121951219,
            "defect_tp": 1521,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954463537676465,
            "recall_macro": 0.9544452135189865,
            "f1_macro": 0.9544542863279043,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9556737588652482,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9559562518474727,
            "no_defect_tp": 1617,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9532533164876816,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9529523208083359,
            "defect_tp": 1509,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9534955116361532,
            "recall_macro": 0.9535981115113286,
            "f1_macro": 0.9535436021943695,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9566765578635015,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9549763033175356,
            "no_defect_tp": 1612,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.950314465408805,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.9521109010712036,
            "defect_tp": 1511,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537666721646592,
            "recall_macro": 0.9539736886905722,
            "f1_macro": 0.9538551146243526,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9588796185935637,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9551795785099436,
            "no_defect_tp": 1609,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9486537257357546,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9525306507387614,
            "defect_tp": 1515,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537503693732147,
            "recall_macro": 0.9540336093041593,
            "f1_macro": 0.9538598161334316,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9605263157894737,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9550996134403806,
            "no_defect_tp": 1606,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9469744229569557,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9526200188264826,
            "defect_tp": 1518,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540577267059331,
            "recall_macro": 0.9543292923319535,
            "f1_macro": 0.9541646233185764,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9605499103407054,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.955410225921522,
            "no_defect_tp": 1607,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.947565543071161,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9529190207156308,
            "defect_tp": 1518,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540577267059331,
            "recall_macro": 0.9543292923319535,
            "f1_macro": 0.9541646233185764,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9605499103407054,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.955410225921522,
            "no_defect_tp": 1607,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.947565543071161,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9529190207156308,
            "defect_tp": 1518,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 66,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9597047970479704,
            "recall_macro": 0.9597047970479704,
            "f1_macro": 0.9597047970479704,
            "precision_micro": 0.9597069597069597,
            "recall_micro": 0.9597069597069597,
            "f1_micro": 0.9597069597069597,
            "accuracy": 0.9597069597069597,
            "hamming_loss": 0.040293040293040296,
            "no_defect_precision": 0.96,
            "no_defect_recall": 0.96,
            "no_defect_f1": 0.96,
            "no_defect_tp": 1584,
            "no_defect_fp": 66,
            "no_defect_tn": 1560,
            "no_defect_fn": 66,
            "no_defect_support": 1650,
            "defect_precision": 0.959409594095941,
            "defect_recall": 0.959409594095941,
            "defect_f1": 0.959409594095941,
            "defect_tp": 1560,
            "defect_fp": 66,
            "defect_tn": 1584,
            "defect_fn": 66,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.1_s80_20251207_183848",
    "lr": 0.001,
    "weight_decay": 0.1,
    "seed": 80,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.954469432075036,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.1_s80_20251207_183848",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s80_20251207_183848",
      "timestamp": "2025-12-07T18:40:47.403742",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.1_s80",
          "seed": 80,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s80_20251207_183848"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.954365439163247,
        "recall_macro": 0.9546249753597478,
        "f1_macro": 0.954469432075036,
        "precision_micro": 0.9545038167938932,
        "recall_micro": 0.9545038167938932,
        "f1_micro": 0.9545038167938932,
        "accuracy": 0.9545038167938932,
        "hamming_loss": 0.04549618320610687,
        "no_defect_precision": 0.9605734767025089,
        "no_defect_recall": 0.9509166173861621,
        "no_defect_f1": 0.9557206537890045,
        "no_defect_tp": 1608,
        "no_defect_fp": 66,
        "no_defect_tn": 1518,
        "no_defect_fn": 83,
        "no_defect_support": 1691,
        "defect_precision": 0.948157401623985,
        "defect_recall": 0.9583333333333334,
        "defect_f1": 0.9532182103610675,
        "defect_tp": 1518,
        "defect_fp": 83,
        "defect_tn": 1608,
        "defect_fn": 66,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9600172430566505,
        "recall_macro": 0.9600033545790003,
        "f1_macro": 0.9600094935939207,
        "precision_micro": 0.96001221001221,
        "recall_micro": 0.96001221001221,
        "f1_micro": 0.96001221001221,
        "accuracy": 0.96001221001221,
        "hamming_loss": 0.039987789987789985,
        "no_defect_precision": 0.9594676346037507,
        "no_defect_recall": 0.9612121212121212,
        "no_defect_f1": 0.9603390856796852,
        "no_defect_tp": 1586,
        "no_defect_fp": 67,
        "no_defect_tn": 1559,
        "no_defect_fn": 64,
        "no_defect_support": 1650,
        "defect_precision": 0.9605668515095502,
        "defect_recall": 0.9587945879458795,
        "defect_f1": 0.9596799015081564,
        "defect_tp": 1559,
        "defect_fp": 64,
        "defect_tn": 1586,
        "defect_fn": 67,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6066329097648046,
          0.4049137280825292,
          0.2881296138633744,
          0.24508400354924062,
          0.2228685042910496,
          0.2085403406906826,
          0.2002778387468729,
          0.1938463272098218,
          0.18883444082038672,
          0.18789286328534202,
          0.18460672457846639,
          0.18058108027135977,
          0.18444869399195435,
          0.18421755578353316,
          0.18146416339165994
        ],
        "val_loss": [
          0.5644483199486365,
          0.3445567184915909,
          0.25345800845668864,
          0.21369457903962868,
          0.19332923969397178,
          0.1804437036984242,
          0.16911620990588114,
          0.16584640440459436,
          0.15907398682947343,
          0.15363477184795415,
          0.15232876874506474,
          0.1512521617114544,
          0.14994405553891108,
          0.1497004126700071,
          0.14947871820857891
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8573778394847468,
            "recall_macro": 0.8459510092050009,
            "f1_macro": 0.8467897529847891,
            "precision_micro": 0.8485496183206107,
            "recall_micro": 0.8485496183206107,
            "f1_micro": 0.8485496183206107,
            "accuracy": 0.8485496183206107,
            "hamming_loss": 0.15145038167938932,
            "no_defect_precision": 0.8087855297157622,
            "no_defect_recall": 0.9254878769958604,
            "no_defect_f1": 0.8632101489244346,
            "no_defect_tp": 1565,
            "no_defect_fp": 370,
            "no_defect_tn": 1214,
            "no_defect_fn": 126,
            "no_defect_support": 1691,
            "defect_precision": 0.9059701492537313,
            "defect_recall": 0.7664141414141414,
            "defect_f1": 0.8303693570451436,
            "defect_tp": 1214,
            "defect_fp": 126,
            "defect_tn": 1565,
            "defect_fn": 370,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9044145845951096,
            "recall_macro": 0.9023536667682144,
            "f1_macro": 0.9029062517740236,
            "precision_micro": 0.903206106870229,
            "recall_micro": 0.903206106870229,
            "f1_micro": 0.903206106870229,
            "accuracy": 0.903206106870229,
            "hamming_loss": 0.09679389312977099,
            "no_defect_precision": 0.8890147225368064,
            "no_defect_recall": 0.9284447072738025,
            "no_defect_f1": 0.9083019959502459,
            "no_defect_tp": 1570,
            "no_defect_fp": 196,
            "no_defect_tn": 1388,
            "no_defect_fn": 121,
            "no_defect_support": 1691,
            "defect_precision": 0.9198144466534128,
            "defect_recall": 0.8762626262626263,
            "defect_f1": 0.8975105075978015,
            "defect_tp": 1388,
            "defect_fp": 121,
            "defect_tn": 1570,
            "defect_fn": 196,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9326702889926706,
            "recall_macro": 0.9329723536369012,
            "f1_macro": 0.9327791461412152,
            "precision_micro": 0.932824427480916,
            "recall_micro": 0.932824427480916,
            "f1_micro": 0.932824427480916,
            "accuracy": 0.932824427480916,
            "hamming_loss": 0.06717557251908397,
            "no_defect_precision": 0.9406830437387658,
            "no_defect_recall": 0.9284447072738025,
            "no_defect_f1": 0.9345238095238095,
            "no_defect_tp": 1570,
            "no_defect_fp": 99,
            "no_defect_tn": 1485,
            "no_defect_fn": 121,
            "no_defect_support": 1691,
            "defect_precision": 0.9246575342465754,
            "defect_recall": 0.9375,
            "defect_f1": 0.9310344827586207,
            "defect_tp": 1485,
            "defect_fp": 121,
            "defect_tn": 1570,
            "defect_fn": 99,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9439231316428153,
            "recall_macro": 0.9435969690996302,
            "f1_macro": 0.9437374328882622,
            "precision_micro": 0.9438167938931298,
            "recall_micro": 0.9438167938931298,
            "f1_micro": 0.9438167938931298,
            "accuracy": 0.9438167938931298,
            "hamming_loss": 0.05618320610687023,
            "no_defect_precision": 0.9414176918570591,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9458505002942907,
            "no_defect_tp": 1607,
            "no_defect_fp": 100,
            "no_defect_tn": 1484,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9464285714285714,
            "defect_recall": 0.9368686868686869,
            "defect_f1": 0.9416243654822335,
            "defect_tp": 1484,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 100,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.946614356693408,
            "recall_macro": 0.9463979311148146,
            "f1_macro": 0.946495425889875,
            "precision_micro": 0.9465648854961832,
            "recall_micro": 0.9465648854961832,
            "f1_micro": 0.9465648854961832,
            "accuracy": 0.9465648854961832,
            "hamming_loss": 0.05343511450381679,
            "no_defect_precision": 0.945358401880141,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9484232242852932,
            "no_defect_tp": 1609,
            "no_defect_fp": 93,
            "no_defect_tn": 1491,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9478703115066751,
            "defect_recall": 0.9412878787878788,
            "defect_f1": 0.9445676274944568,
            "defect_tp": 1491,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 93,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9491710477332969,
            "recall_macro": 0.9495584168115214,
            "f1_macro": 0.9492849424088146,
            "precision_micro": 0.9493129770992367,
            "recall_micro": 0.9493129770992367,
            "f1_micro": 0.9493129770992367,
            "accuracy": 0.9493129770992367,
            "hamming_loss": 0.05068702290076336,
            "no_defect_precision": 0.9590608067429259,
            "no_defect_recall": 0.9420461265523359,
            "no_defect_f1": 0.9504773269689738,
            "no_defect_tp": 1593,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 98,
            "no_defect_support": 1691,
            "defect_precision": 0.9392812887236679,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9480925578486554,
            "defect_tp": 1516,
            "defect_fp": 98,
            "defect_tn": 1593,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9531488579526881,
            "recall_macro": 0.9533823226349838,
            "f1_macro": 0.9532455470250003,
            "precision_micro": 0.9532824427480916,
            "recall_micro": 0.9532824427480916,
            "f1_micro": 0.9532824427480916,
            "accuracy": 0.9532824427480916,
            "hamming_loss": 0.0467175572519084,
            "no_defect_precision": 0.9588305489260143,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9545589545589546,
            "no_defect_tp": 1607,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9474671669793621,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9519321394910462,
            "defect_tp": 1515,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9531557247421173,
            "recall_macro": 0.9535820580136074,
            "f1_macro": 0.9532598519034805,
            "precision_micro": 0.9532824427480916,
            "recall_micro": 0.9532824427480916,
            "f1_micro": 0.9532824427480916,
            "accuracy": 0.9532824427480916,
            "hamming_loss": 0.0467175572519084,
            "no_defect_precision": 0.9643719806763285,
            "no_defect_recall": 0.9444115907746895,
            "no_defect_f1": 0.9542874215715567,
            "no_defect_tp": 1597,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 94,
            "no_defect_support": 1691,
            "defect_precision": 0.9419394688079061,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9522322822354043,
            "defect_tp": 1525,
            "defect_fp": 94,
            "defect_tn": 1597,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537543362303704,
            "recall_macro": 0.9541534505313334,
            "f1_macro": 0.953868286764114,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.963855421686747,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.9549388242315726,
            "no_defect_tp": 1600,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9436532507739938,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9527977492966552,
            "defect_tp": 1524,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543954563402759,
            "recall_macro": 0.9545450812082983,
            "f1_macro": 0.9544630418324115,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9583828775267539,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9558256744737622,
            "no_defect_tp": 1612,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9504080351537979,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9531004091910608,
            "defect_tp": 1514,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9534514925373134,
            "recall_macro": 0.9536979792006404,
            "f1_macro": 0.9535519248052502,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9594029850746268,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9548425430778372,
            "no_defect_tp": 1607,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9475,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9522613065326633,
            "defect_tp": 1516,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540543091702223,
            "recall_macro": 0.9543492658698158,
            "f1_macro": 0.9541661286337746,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9611011370436864,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9553837001784652,
            "no_defect_tp": 1606,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9470074812967582,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9529485570890841,
            "defect_tp": 1519,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954365439163247,
            "recall_macro": 0.9546249753597478,
            "f1_macro": 0.954469432075036,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9605734767025089,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9557206537890045,
            "no_defect_tp": 1608,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.948157401623985,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9532182103610675,
            "defect_tp": 1518,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954365439163247,
            "recall_macro": 0.9546249753597478,
            "f1_macro": 0.954469432075036,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9605734767025089,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9557206537890045,
            "no_defect_tp": 1608,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.948157401623985,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9532182103610675,
            "defect_tp": 1518,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540625,
            "recall_macro": 0.9543093187940912,
            "f1_macro": 0.9541630836893917,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.96,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9554367201426025,
            "no_defect_tp": 1608,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.948125,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9528894472361809,
            "defect_tp": 1517,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 67,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9600172430566505,
            "recall_macro": 0.9600033545790003,
            "f1_macro": 0.9600094935939207,
            "precision_micro": 0.96001221001221,
            "recall_micro": 0.96001221001221,
            "f1_micro": 0.96001221001221,
            "accuracy": 0.96001221001221,
            "hamming_loss": 0.039987789987789985,
            "no_defect_precision": 0.9594676346037507,
            "no_defect_recall": 0.9612121212121212,
            "no_defect_f1": 0.9603390856796852,
            "no_defect_tp": 1586,
            "no_defect_fp": 67,
            "no_defect_tn": 1559,
            "no_defect_fn": 64,
            "no_defect_support": 1650,
            "defect_precision": 0.9605668515095502,
            "defect_recall": 0.9587945879458795,
            "defect_f1": 0.9596799015081564,
            "defect_tp": 1559,
            "defect_fp": 64,
            "defect_tn": 1586,
            "defect_fn": 67,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.1_s90_20251207_160140",
    "lr": 0.001,
    "weight_decay": 0.1,
    "seed": 90,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9556960448731542,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.1_s90_20251207_160140",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s90_20251207_160140",
      "timestamp": "2025-12-07T16:03:31.733893",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.1_s90",
          "seed": 90,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s90_20251207_160140"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9555789717945619,
        "recall_macro": 0.9559075751602364,
        "f1_macro": 0.9556960448731542,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.9634292565947242,
        "no_defect_recall": 0.9503252513305737,
        "no_defect_f1": 0.9568323905924382,
        "no_defect_tp": 1607,
        "no_defect_fp": 61,
        "no_defect_tn": 1523,
        "no_defect_fn": 84,
        "no_defect_support": 1691,
        "defect_precision": 0.9477286869943995,
        "defect_recall": 0.961489898989899,
        "defect_f1": 0.9545596991538703,
        "defect_tp": 1523,
        "defect_fp": 84,
        "defect_tn": 1607,
        "defect_fn": 61,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9593944453865922,
        "recall_macro": 0.959410712288941,
        "f1_macro": 0.9594003437442782,
        "precision_micro": 0.9594017094017094,
        "recall_micro": 0.9594017094017094,
        "f1_micro": 0.9594017094017094,
        "accuracy": 0.9594017094017094,
        "hamming_loss": 0.0405982905982906,
        "no_defect_precision": 0.9610942249240122,
        "no_defect_recall": 0.9581818181818181,
        "no_defect_f1": 0.9596358118361153,
        "no_defect_tp": 1581,
        "no_defect_fp": 64,
        "no_defect_tn": 1562,
        "no_defect_fn": 69,
        "no_defect_support": 1650,
        "defect_precision": 0.9576946658491723,
        "defect_recall": 0.9606396063960639,
        "defect_f1": 0.9591648756524409,
        "defect_tp": 1562,
        "defect_fp": 69,
        "defect_tn": 1581,
        "defect_fn": 64,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6188642123254273,
          0.41264333061593345,
          0.2922121429792508,
          0.24425279052935883,
          0.22238026559352875,
          0.21047096802350368,
          0.19997282809418115,
          0.19033713479795217,
          0.19101389301122482,
          0.18671689107702366,
          0.18381961893337043,
          0.18676329921603702,
          0.18190335815920491,
          0.18696711838993568,
          0.1844253219258835
        ],
        "val_loss": [
          0.5766448699511014,
          0.3503749674329391,
          0.2540998811332079,
          0.21736965643671843,
          0.19325936041199243,
          0.1836970169097185,
          0.17300633470026347,
          0.16316148008291537,
          0.15900609742563504,
          0.15559413169439024,
          0.15185893756838945,
          0.1517854330058281,
          0.1493594292551279,
          0.15077556297183037,
          0.15052203504511943
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8665139440237644,
            "recall_macro": 0.8555166538238685,
            "f1_macro": 0.856449838485743,
            "precision_micro": 0.8580152671755725,
            "recall_micro": 0.8580152671755725,
            "f1_micro": 0.8580152671755725,
            "accuracy": 0.8580152671755725,
            "hamming_loss": 0.14198473282442747,
            "no_defect_precision": 0.818276220145379,
            "no_defect_recall": 0.9319929036073329,
            "no_defect_f1": 0.8714404202377661,
            "no_defect_tp": 1576,
            "no_defect_fp": 350,
            "no_defect_tn": 1234,
            "no_defect_fn": 115,
            "no_defect_support": 1691,
            "defect_precision": 0.9147516679021498,
            "defect_recall": 0.7790404040404041,
            "defect_f1": 0.8414592567337198,
            "defect_tp": 1234,
            "defect_fp": 115,
            "defect_tn": 1576,
            "defect_fn": 350,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9010291771090637,
            "recall_macro": 0.8985857615181979,
            "f1_macro": 0.8991955194806956,
            "precision_micro": 0.8995419847328244,
            "recall_micro": 0.8995419847328244,
            "f1_micro": 0.8995419847328244,
            "accuracy": 0.8995419847328244,
            "hamming_loss": 0.10045801526717557,
            "no_defect_precision": 0.8834459459459459,
            "no_defect_recall": 0.9278533412182141,
            "no_defect_f1": 0.9051052783386213,
            "no_defect_tp": 1569,
            "no_defect_fp": 207,
            "no_defect_tn": 1377,
            "no_defect_fn": 122,
            "no_defect_support": 1691,
            "defect_precision": 0.9186124082721815,
            "defect_recall": 0.8693181818181818,
            "defect_f1": 0.89328576062277,
            "defect_tp": 1377,
            "defect_fp": 122,
            "defect_tn": 1569,
            "defect_fn": 207,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9294806792069323,
            "recall_macro": 0.9278740614303891,
            "f1_macro": 0.9283633471605581,
            "precision_micro": 0.9285496183206107,
            "recall_micro": 0.9285496183206107,
            "f1_micro": 0.9285496183206107,
            "accuracy": 0.9285496183206107,
            "hamming_loss": 0.07145038167938932,
            "no_defect_precision": 0.9160479725870931,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9320162696106915,
            "no_defect_tp": 1604,
            "no_defect_fp": 147,
            "no_defect_tn": 1437,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9429133858267716,
            "defect_recall": 0.9071969696969697,
            "defect_f1": 0.9247104247104247,
            "defect_tp": 1437,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 147,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9397756332480913,
            "recall_macro": 0.9397930368140304,
            "f1_macro": 0.9397842471465242,
            "precision_micro": 0.9398473282442749,
            "recall_micro": 0.9398473282442749,
            "f1_micro": 0.9398473282442749,
            "accuracy": 0.9398473282442749,
            "hamming_loss": 0.06015267175572519,
            "no_defect_precision": 0.9420118343195266,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9417332150251405,
            "no_defect_tp": 1592,
            "no_defect_fp": 98,
            "no_defect_tn": 1486,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.9375394321766561,
            "defect_recall": 0.9381313131313131,
            "defect_f1": 0.9378352792679079,
            "defect_tp": 1486,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 98,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9463202192209825,
            "recall_macro": 0.946082274549158,
            "f1_macro": 0.9461884948686753,
            "precision_micro": 0.9462595419847328,
            "recall_micro": 0.9462595419847328,
            "f1_micro": 0.9462595419847328,
            "accuracy": 0.9462595419847328,
            "hamming_loss": 0.053740458015267174,
            "no_defect_precision": 0.9448032883147387,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9481437831467295,
            "no_defect_tp": 1609,
            "no_defect_fp": 94,
            "no_defect_tn": 1490,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9478371501272265,
            "defect_recall": 0.9406565656565656,
            "defect_f1": 0.944233206590621,
            "defect_tp": 1490,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 94,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9492475805098178,
            "recall_macro": 0.9497182051144204,
            "f1_macro": 0.9492953863418288,
            "precision_micro": 0.9493129770992367,
            "recall_micro": 0.9493129770992367,
            "f1_micro": 0.9493129770992367,
            "accuracy": 0.9493129770992367,
            "hamming_loss": 0.05068702290076336,
            "no_defect_precision": 0.9635258358662614,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.9502398081534772,
            "no_defect_tp": 1585,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.9349693251533743,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9483509645301804,
            "defect_tp": 1524,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9501018998427491,
            "recall_macro": 0.9505253600463535,
            "f1_macro": 0.9502049402631851,
            "precision_micro": 0.9502290076335878,
            "recall_micro": 0.9502290076335878,
            "f1_micro": 0.9502290076335878,
            "accuracy": 0.9502290076335878,
            "hamming_loss": 0.04977099236641221,
            "no_defect_precision": 0.961352657004831,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9512996713474754,
            "no_defect_tp": 1592,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.938851142680667,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9491102091788948,
            "defect_tp": 1520,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9528843103223037,
            "recall_macro": 0.9529867719178777,
            "f1_macro": 0.9529323338021902,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.9560830860534124,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9543838862559242,
            "no_defect_tp": 1611,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.949685534591195,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9514807813484563,
            "defect_tp": 1510,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540577267059331,
            "recall_macro": 0.9543292923319535,
            "f1_macro": 0.9541646233185764,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9605499103407054,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.955410225921522,
            "no_defect_tp": 1607,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.947565543071161,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9529190207156308,
            "defect_tp": 1518,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540577267059331,
            "recall_macro": 0.9543292923319535,
            "f1_macro": 0.9541646233185764,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9605499103407054,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.955410225921522,
            "no_defect_tp": 1607,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.947565543071161,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9529190207156308,
            "defect_tp": 1518,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.95531747418017,
            "recall_macro": 0.9554521038295432,
            "f1_macro": 0.9553790730418865,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9590017825311943,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9567279193835211,
            "no_defect_tp": 1614,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9516331658291457,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9540302267002518,
            "defect_tp": 1515,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543613275944924,
            "recall_macro": 0.9546449488976101,
            "f1_macro": 0.9544709443965649,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9611244019138756,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9556943205471305,
            "no_defect_tp": 1607,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9475982532751092,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9532475682459993,
            "defect_tp": 1519,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552982739755882,
            "recall_macro": 0.955492050905268,
            "f1_macro": 0.9553823040889835,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9600952948183442,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9566765578635015,
            "no_defect_tp": 1612,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505012531328321,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9540880503144654,
            "defect_tp": 1517,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555789717945619,
            "recall_macro": 0.9559075751602364,
            "f1_macro": 0.9556960448731542,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9634292565947242,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9568323905924382,
            "no_defect_tp": 1607,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9477286869943995,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9545596991538703,
            "defect_tp": 1523,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555789717945619,
            "recall_macro": 0.9559075751602364,
            "f1_macro": 0.9556960448731542,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9634292565947242,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9568323905924382,
            "no_defect_tp": 1607,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9477286869943995,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9545596991538703,
            "defect_tp": 1523,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 61,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9593944453865922,
            "recall_macro": 0.959410712288941,
            "f1_macro": 0.9594003437442782,
            "precision_micro": 0.9594017094017094,
            "recall_micro": 0.9594017094017094,
            "f1_micro": 0.9594017094017094,
            "accuracy": 0.9594017094017094,
            "hamming_loss": 0.0405982905982906,
            "no_defect_precision": 0.9610942249240122,
            "no_defect_recall": 0.9581818181818181,
            "no_defect_f1": 0.9596358118361153,
            "no_defect_tp": 1581,
            "no_defect_fp": 64,
            "no_defect_tn": 1562,
            "no_defect_fn": 69,
            "no_defect_support": 1650,
            "defect_precision": 0.9576946658491723,
            "defect_recall": 0.9606396063960639,
            "defect_f1": 0.9591648756524409,
            "defect_tp": 1562,
            "defect_fp": 69,
            "defect_tn": 1581,
            "defect_fn": 64,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.1_s100_20251207_144257",
    "lr": 0.001,
    "weight_decay": 0.1,
    "seed": 100,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9556855105080515,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.1_s100_20251207_144257",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s100_20251207_144257",
      "timestamp": "2025-12-07T14:44:55.607555",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.1_s100",
          "seed": 100,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s100_20251207_144257"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9556177330517805,
        "recall_macro": 0.9557677603951997,
        "f1_macro": 0.9556855105080515,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.9595719381688466,
        "no_defect_recall": 0.9544648137196925,
        "no_defect_f1": 0.9570115624073525,
        "no_defect_tp": 1614,
        "no_defect_fp": 68,
        "no_defect_tn": 1516,
        "no_defect_fn": 77,
        "no_defect_support": 1691,
        "defect_precision": 0.9516635279347144,
        "defect_recall": 0.9570707070707071,
        "defect_f1": 0.9543594586087504,
        "defect_tp": 1516,
        "defect_fp": 77,
        "defect_tn": 1614,
        "defect_fn": 68,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9597222222222223,
        "recall_macro": 0.9596913787319692,
        "f1_macro": 0.9597035804502652,
        "precision_micro": 0.9597069597069597,
        "recall_micro": 0.9597069597069597,
        "f1_micro": 0.9597069597069597,
        "accuracy": 0.9597069597069597,
        "hamming_loss": 0.040293040293040296,
        "no_defect_precision": 0.9583333333333334,
        "no_defect_recall": 0.9618181818181818,
        "no_defect_f1": 0.9600725952813067,
        "no_defect_tp": 1587,
        "no_defect_fp": 69,
        "no_defect_tn": 1557,
        "no_defect_fn": 63,
        "no_defect_support": 1650,
        "defect_precision": 0.9611111111111111,
        "defect_recall": 0.9575645756457565,
        "defect_f1": 0.9593345656192237,
        "defect_tp": 1557,
        "defect_fp": 63,
        "defect_tn": 1587,
        "defect_fn": 69,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6180537153487425,
          0.41364587974348827,
          0.2894914852276008,
          0.24074357872727525,
          0.2234596593235327,
          0.20835072263514148,
          0.1982333853716132,
          0.19873457165068661,
          0.19389314157693455,
          0.18513867654935087,
          0.18802637351232593,
          0.18646428453498307,
          0.1894660480164584,
          0.18308238993753448,
          0.1837764934765245
        ],
        "val_loss": [
          0.5669720826240686,
          0.34586323167269045,
          0.25279763169013536,
          0.2163042053580284,
          0.19528117489356261,
          0.17917744242227995,
          0.1709284968674183,
          0.16294567831433737,
          0.15987596832788908,
          0.1545191928744316,
          0.15285178503164878,
          0.1514535850057235,
          0.15075320922411406,
          0.1501708345917555,
          0.15011104224966124
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8545206060096056,
            "recall_macro": 0.8397338255410403,
            "f1_macro": 0.8404624269801979,
            "precision_micro": 0.8427480916030534,
            "recall_micro": 0.8427480916030534,
            "f1_micro": 0.8427480916030534,
            "accuracy": 0.8427480916030534,
            "hamming_loss": 0.15725190839694655,
            "no_defect_precision": 0.7975708502024291,
            "no_defect_recall": 0.9319929036073329,
            "no_defect_f1": 0.85955822197982,
            "no_defect_tp": 1576,
            "no_defect_fp": 400,
            "no_defect_tn": 1184,
            "no_defect_fn": 115,
            "no_defect_support": 1691,
            "defect_precision": 0.9114703618167821,
            "defect_recall": 0.7474747474747475,
            "defect_f1": 0.8213666319805758,
            "defect_tp": 1184,
            "defect_fp": 115,
            "defect_tn": 1576,
            "defect_fn": 400,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9066343042071198,
            "recall_macro": 0.9057698884169907,
            "f1_macro": 0.9060728721489635,
            "precision_micro": 0.9062595419847328,
            "recall_micro": 0.9062595419847328,
            "f1_micro": 0.9062595419847328,
            "accuracy": 0.9062595419847328,
            "hamming_loss": 0.09374045801526718,
            "no_defect_precision": 0.9,
            "no_defect_recall": 0.9207569485511532,
            "no_defect_f1": 0.9102601578485823,
            "no_defect_tp": 1557,
            "no_defect_fp": 173,
            "no_defect_tn": 1411,
            "no_defect_fn": 134,
            "no_defect_support": 1691,
            "defect_precision": 0.9132686084142395,
            "defect_recall": 0.8907828282828283,
            "defect_f1": 0.9018855864493448,
            "defect_tp": 1411,
            "defect_fp": 134,
            "defect_tn": 1557,
            "defect_fn": 173,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9324265656683302,
            "recall_macro": 0.9324769352304835,
            "f1_macro": 0.9324509657614988,
            "precision_micro": 0.9325190839694657,
            "recall_micro": 0.9325190839694657,
            "f1_micro": 0.9325190839694657,
            "accuracy": 0.9325190839694657,
            "hamming_loss": 0.06748091603053435,
            "no_defect_precision": 0.9354265402843602,
            "no_defect_recall": 0.9337670017740982,
            "no_defect_f1": 0.9345960343296833,
            "no_defect_tp": 1579,
            "no_defect_fp": 109,
            "no_defect_tn": 1475,
            "no_defect_fn": 112,
            "no_defect_support": 1691,
            "defect_precision": 0.9294265910523,
            "defect_recall": 0.9311868686868687,
            "defect_f1": 0.9303058971933144,
            "defect_tp": 1475,
            "defect_fp": 112,
            "defect_tn": 1579,
            "defect_fn": 109,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.939085380640588,
            "recall_macro": 0.9393814325992031,
            "f1_macro": 0.9391947121114879,
            "precision_micro": 0.9392366412213741,
            "recall_micro": 0.9392366412213741,
            "f1_micro": 0.9392366412213741,
            "accuracy": 0.9392366412213741,
            "hamming_loss": 0.06076335877862595,
            "no_defect_precision": 0.9467065868263473,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.94079143112169,
            "no_defect_tp": 1581,
            "no_defect_fp": 89,
            "no_defect_tn": 1495,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9314641744548287,
            "defect_recall": 0.9438131313131313,
            "defect_f1": 0.9375979931012857,
            "defect_tp": 1495,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 89,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9445923010929165,
            "recall_macro": 0.9449833566295719,
            "f1_macro": 0.9447030457238716,
            "precision_micro": 0.944732824427481,
            "recall_micro": 0.944732824427481,
            "f1_micro": 0.944732824427481,
            "accuracy": 0.944732824427481,
            "hamming_loss": 0.05526717557251908,
            "no_defect_precision": 0.9548192771084337,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.9459862727544017,
            "no_defect_tp": 1585,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.9343653250773993,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9434198186933417,
            "defect_tp": 1509,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9477106227106227,
            "recall_macro": 0.9471851125088855,
            "f1_macro": 0.9473967508318654,
            "precision_micro": 0.9474809160305343,
            "recall_micro": 0.9474809160305343,
            "f1_micro": 0.9474809160305343,
            "accuracy": 0.9474809160305343,
            "hamming_loss": 0.05251908396946565,
            "no_defect_precision": 0.9428571428571428,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9495008807985907,
            "no_defect_tp": 1617,
            "no_defect_fp": 98,
            "no_defect_tn": 1486,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9525641025641025,
            "defect_recall": 0.9381313131313131,
            "defect_f1": 0.94529262086514,
            "defect_tp": 1486,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 98,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.952236009647053,
            "recall_macro": 0.9526550618545,
            "f1_macro": 0.9523427338200363,
            "precision_micro": 0.9523664122137404,
            "recall_micro": 0.9523664122137404,
            "f1_micro": 0.9523664122137404,
            "accuracy": 0.9523664122137404,
            "hamming_loss": 0.04763358778625954,
            "no_defect_precision": 0.9631864815932408,
            "no_defect_recall": 0.9438202247191011,
            "no_defect_f1": 0.953405017921147,
            "no_defect_tp": 1596,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 95,
            "no_defect_support": 1691,
            "defect_precision": 0.9412855377008653,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9512804497189257,
            "defect_tp": 1523,
            "defect_fp": 95,
            "defect_tn": 1596,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9528539559142049,
            "recall_macro": 0.9530466925314649,
            "f1_macro": 0.9529374988335853,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.957712924359738,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9543026706231454,
            "no_defect_tp": 1608,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9479949874686717,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.9515723270440252,
            "defect_tp": 1513,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537476448971216,
            "recall_macro": 0.9540535828420217,
            "f1_macro": 0.9538613142152496,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9610778443113772,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9550728949717346,
            "no_defect_tp": 1605,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.946417445482866,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9526497334587645,
            "defect_tp": 1519,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543954563402759,
            "recall_macro": 0.9545450812082983,
            "f1_macro": 0.9544630418324115,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9583828775267539,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9558256744737622,
            "no_defect_tp": 1612,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9504080351537979,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9531004091910608,
            "defect_tp": 1514,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9547063152960286,
            "recall_macro": 0.9548407642360924,
            "f1_macro": 0.9547678274671179,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.958407605466429,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9561351511558981,
            "no_defect_tp": 1613,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9510050251256281,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9534005037783375,
            "defect_tp": 1514,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.955307193767228,
            "recall_macro": 0.9554720773674056,
            "f1_macro": 0.9553807052788037,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9595478881618085,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9567022538552787,
            "no_defect_tp": 1613,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9510664993726474,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9540591567023285,
            "defect_tp": 1516,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549887937976673,
            "recall_macro": 0.9551963678774738,
            "f1_macro": 0.9550774956939061,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9600715137067938,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.956366874443455,
            "no_defect_tp": 1611,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.949906073888541,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9537881169443572,
            "defect_tp": 1517,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556177330517805,
            "recall_macro": 0.9557677603951997,
            "f1_macro": 0.9556855105080515,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9595719381688466,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9570115624073525,
            "no_defect_tp": 1614,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9516635279347144,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9543594586087504,
            "defect_tp": 1516,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.955307193767228,
            "recall_macro": 0.9554720773674056,
            "f1_macro": 0.9553807052788037,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9595478881618085,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9567022538552787,
            "no_defect_tp": 1613,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9510664993726474,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9540591567023285,
            "defect_tp": 1516,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 68,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9597222222222223,
            "recall_macro": 0.9596913787319692,
            "f1_macro": 0.9597035804502652,
            "precision_micro": 0.9597069597069597,
            "recall_micro": 0.9597069597069597,
            "f1_micro": 0.9597069597069597,
            "accuracy": 0.9597069597069597,
            "hamming_loss": 0.040293040293040296,
            "no_defect_precision": 0.9583333333333334,
            "no_defect_recall": 0.9618181818181818,
            "no_defect_f1": 0.9600725952813067,
            "no_defect_tp": 1587,
            "no_defect_fp": 69,
            "no_defect_tn": 1557,
            "no_defect_fn": 63,
            "no_defect_support": 1650,
            "defect_precision": 0.9611111111111111,
            "defect_recall": 0.9575645756457565,
            "defect_f1": 0.9593345656192237,
            "defect_tp": 1557,
            "defect_fp": 63,
            "defect_tn": 1587,
            "defect_fn": 69,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.1_s110_20251207_155850",
    "lr": 0.001,
    "weight_decay": 0.1,
    "seed": 110,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9556855105080515,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.1_s110_20251207_155850",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s110_20251207_155850",
      "timestamp": "2025-12-07T16:00:43.790035",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 15,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.1_s110",
          "seed": 110,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s110_20251207_155850"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9556177330517805,
        "recall_macro": 0.9557677603951997,
        "f1_macro": 0.9556855105080515,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.9595719381688466,
        "no_defect_recall": 0.9544648137196925,
        "no_defect_f1": 0.9570115624073525,
        "no_defect_tp": 1614,
        "no_defect_fp": 68,
        "no_defect_tn": 1516,
        "no_defect_fn": 77,
        "no_defect_support": 1691,
        "defect_precision": 0.9516635279347144,
        "defect_recall": 0.9570707070707071,
        "defect_f1": 0.9543594586087504,
        "defect_tp": 1516,
        "defect_fp": 77,
        "defect_tn": 1614,
        "defect_fn": 68,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.96096191697483,
        "recall_macro": 0.9609034999440904,
        "f1_macro": 0.9609237518893823,
        "precision_micro": 0.960927960927961,
        "recall_micro": 0.960927960927961,
        "f1_micro": 0.960927960927961,
        "accuracy": 0.960927960927961,
        "hamming_loss": 0.03907203907203907,
        "no_defect_precision": 0.958433734939759,
        "no_defect_recall": 0.9642424242424242,
        "no_defect_f1": 0.9613293051359516,
        "no_defect_tp": 1591,
        "no_defect_fp": 69,
        "no_defect_tn": 1557,
        "no_defect_fn": 59,
        "no_defect_support": 1650,
        "defect_precision": 0.963490099009901,
        "defect_recall": 0.9575645756457565,
        "defect_f1": 0.9605181986428131,
        "defect_tp": 1557,
        "defect_fp": 59,
        "defect_tn": 1591,
        "defect_fn": 69,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6218236839422122,
          0.41634913954774705,
          0.2922658592337844,
          0.24342749227290372,
          0.21991059592453505,
          0.20690554982074633,
          0.203348169547494,
          0.19538336041457482,
          0.1896343745260059,
          0.19036872853295075,
          0.18459369603809453,
          0.18325264892194063,
          0.18272265377279107,
          0.18644590463847796,
          0.18874171332584763
        ],
        "val_loss": [
          0.5814310472745162,
          0.3513081715657161,
          0.2559400094816318,
          0.21828927586858088,
          0.1965840605015938,
          0.1801987013851221,
          0.17301248902311692,
          0.1702661611712896,
          0.15994831489828917,
          0.15550892943373093,
          0.153691447698153,
          0.15238758405813804,
          0.1504216709962258,
          0.15018693042489198,
          0.15038333689937225
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8431228973142295,
            "recall_macro": 0.7983671352794652,
            "f1_macro": 0.7960078843382022,
            "precision_micro": 0.803969465648855,
            "recall_micro": 0.803969465648855,
            "f1_micro": 0.803969465648855,
            "accuracy": 0.803969465648855,
            "hamming_loss": 0.19603053435114504,
            "no_defect_precision": 0.7350963693411027,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.8363080061193269,
            "no_defect_tp": 1640,
            "no_defect_fp": 591,
            "no_defect_tn": 993,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.9511494252873564,
            "defect_recall": 0.6268939393939394,
            "defect_f1": 0.7557077625570776,
            "defect_tp": 993,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 591,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9006996245089545,
            "recall_macro": 0.896727849159842,
            "f1_macro": 0.8975316159250586,
            "precision_micro": 0.8980152671755726,
            "recall_micro": 0.8980152671755726,
            "f1_micro": 0.8980152671755726,
            "accuracy": 0.8980152671755726,
            "hamming_loss": 0.10198473282442748,
            "no_defect_precision": 0.875069098949696,
            "no_defect_recall": 0.9361324659964518,
            "no_defect_f1": 0.9045714285714286,
            "no_defect_tp": 1583,
            "no_defect_fp": 226,
            "no_defect_tn": 1358,
            "no_defect_fn": 108,
            "no_defect_support": 1691,
            "defect_precision": 0.9263301500682128,
            "defect_recall": 0.8573232323232324,
            "defect_f1": 0.8904918032786885,
            "defect_tp": 1358,
            "defect_fp": 108,
            "defect_tn": 1583,
            "defect_fn": 226,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9294782236688586,
            "recall_macro": 0.9287650305539128,
            "f1_macro": 0.929032465358727,
            "precision_micro": 0.9291603053435115,
            "recall_micro": 0.9291603053435115,
            "f1_micro": 0.9291603053435115,
            "accuracy": 0.9291603053435115,
            "hamming_loss": 0.07083969465648855,
            "no_defect_precision": 0.9233894370284388,
            "no_defect_recall": 0.9408633944411591,
            "no_defect_f1": 0.9320445225541887,
            "no_defect_tp": 1591,
            "no_defect_fp": 132,
            "no_defect_tn": 1452,
            "no_defect_fn": 100,
            "no_defect_support": 1691,
            "defect_precision": 0.9355670103092784,
            "defect_recall": 0.9166666666666666,
            "defect_f1": 0.9260204081632653,
            "defect_tp": 1452,
            "defect_fp": 100,
            "defect_tn": 1591,
            "defect_fn": 132,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9400741912097939,
            "recall_macro": 0.9401086933796869,
            "f1_macro": 0.9400910906613407,
            "precision_micro": 0.9401526717557251,
            "recall_micro": 0.9401526717557251,
            "f1_micro": 0.9401526717557251,
            "accuracy": 0.9401526717557251,
            "hamming_loss": 0.05984732824427481,
            "no_defect_precision": 0.9425695677915926,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9420118343195266,
            "no_defect_tp": 1592,
            "no_defect_fp": 97,
            "no_defect_tn": 1487,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.937578814627995,
            "defect_recall": 0.9387626262626263,
            "defect_f1": 0.9381703470031546,
            "defect_tp": 1487,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 97,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9454991464393688,
            "recall_macro": 0.9458304586372297,
            "f1_macro": 0.9456139231342203,
            "precision_micro": 0.945648854961832,
            "recall_micro": 0.945648854961832,
            "f1_micro": 0.945648854961832,
            "accuracy": 0.945648854961832,
            "hamming_loss": 0.05435114503816794,
            "no_defect_precision": 0.9538092381523695,
            "no_defect_recall": 0.9402720283855707,
            "no_defect_f1": 0.9469922572960096,
            "no_defect_tp": 1590,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 101,
            "no_defect_support": 1691,
            "defect_precision": 0.9371890547263682,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.9442355889724311,
            "defect_tp": 1507,
            "defect_fp": 101,
            "defect_tn": 1590,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9492058853387555,
            "recall_macro": 0.9493387078950355,
            "f1_macro": 0.9492666172941997,
            "precision_micro": 0.9493129770992367,
            "recall_micro": 0.9493129770992367,
            "f1_micro": 0.9493129770992367,
            "accuracy": 0.9493129770992367,
            "hamming_loss": 0.05068702290076336,
            "no_defect_precision": 0.9530600118835413,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.950800237107291,
            "no_defect_tp": 1604,
            "no_defect_fp": 79,
            "no_defect_tn": 1505,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9453517587939698,
            "defect_recall": 0.9501262626262627,
            "defect_f1": 0.9477329974811083,
            "defect_tp": 1505,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 79,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9479543399638337,
            "recall_macro": 0.9483557111624823,
            "f1_macro": 0.9480643656716419,
            "precision_micro": 0.9480916030534351,
            "recall_micro": 0.9480916030534351,
            "f1_micro": 0.9480916030534351,
            "accuracy": 0.9480916030534351,
            "hamming_loss": 0.051908396946564885,
            "no_defect_precision": 0.9584086799276673,
            "no_defect_recall": 0.9402720283855707,
            "no_defect_f1": 0.9492537313432836,
            "no_defect_tp": 1590,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 101,
            "no_defect_support": 1691,
            "defect_precision": 0.9375,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.946875,
            "defect_tp": 1515,
            "defect_fp": 101,
            "defect_tn": 1590,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9484122869959171,
            "recall_macro": 0.9488910766446248,
            "f1_macro": 0.9483839338180333,
            "precision_micro": 0.9483969465648855,
            "recall_micro": 0.9483969465648855,
            "f1_micro": 0.9483969465648855,
            "accuracy": 0.9483969465648855,
            "hamming_loss": 0.0516030534351145,
            "no_defect_precision": 0.965158924205379,
            "no_defect_recall": 0.9337670017740982,
            "no_defect_f1": 0.9492034866245868,
            "no_defect_tp": 1579,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 112,
            "no_defect_support": 1691,
            "defect_precision": 0.9316656497864552,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.94756438101148,
            "defect_tp": 1527,
            "defect_fp": 112,
            "defect_tn": 1579,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9522248041711161,
            "recall_macro": 0.9524952735516012,
            "f1_macro": 0.9523312082513196,
            "precision_micro": 0.9523664122137404,
            "recall_micro": 0.9523664122137404,
            "f1_micro": 0.9523664122137404,
            "accuracy": 0.9523664122137404,
            "hamming_loss": 0.04763358778625954,
            "no_defect_precision": 0.958756724447101,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9536266349583828,
            "no_defect_tp": 1604,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9456928838951311,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9510357815442562,
            "defect_tp": 1515,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954760870084643,
            "recall_macro": 0.954760870084643,
            "f1_macro": 0.954760870084643,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9562389118864577,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9562389118864577,
            "no_defect_tp": 1617,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9532828282828283,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9532828282828283,
            "defect_tp": 1510,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9550298351582311,
            "recall_macro": 0.9551164737260243,
            "f1_macro": 0.9550709220089815,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9578884934756821,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9564702398578621,
            "no_defect_tp": 1615,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9521711768407803,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.9536716041601009,
            "defect_tp": 1513,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546796718915938,
            "recall_macro": 0.9549006848496795,
            "f1_macro": 0.954772689609457,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9600477042337507,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9560570071258907,
            "no_defect_tp": 1610,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9493116395494368,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9534883720930233,
            "defect_tp": 1517,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556410583735901,
            "recall_macro": 0.9557278133194751,
            "f1_macro": 0.9556822019816483,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9584816132858838,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9570624814924489,
            "no_defect_tp": 1616,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9528005034612964,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9543019224708478,
            "defect_tp": 1514,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556410583735901,
            "recall_macro": 0.9557278133194751,
            "f1_macro": 0.9556822019816483,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9584816132858838,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9570624814924489,
            "no_defect_tp": 1616,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9528005034612964,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9543019224708478,
            "defect_tp": 1514,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556177330517805,
            "recall_macro": 0.9557677603951997,
            "f1_macro": 0.9556855105080515,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9595719381688466,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9570115624073525,
            "no_defect_tp": 1614,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9516635279347144,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9543594586087504,
            "defect_tp": 1516,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 68,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.96096191697483,
            "recall_macro": 0.9609034999440904,
            "f1_macro": 0.9609237518893823,
            "precision_micro": 0.960927960927961,
            "recall_micro": 0.960927960927961,
            "f1_micro": 0.960927960927961,
            "accuracy": 0.960927960927961,
            "hamming_loss": 0.03907203907203907,
            "no_defect_precision": 0.958433734939759,
            "no_defect_recall": 0.9642424242424242,
            "no_defect_f1": 0.9613293051359516,
            "no_defect_tp": 1591,
            "no_defect_fp": 69,
            "no_defect_tn": 1557,
            "no_defect_fn": 59,
            "no_defect_support": 1650,
            "defect_precision": 0.963490099009901,
            "defect_recall": 0.9575645756457565,
            "defect_f1": 0.9605181986428131,
            "defect_tp": 1557,
            "defect_fp": 59,
            "defect_tn": 1591,
            "defect_fn": 69,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.1_s120_20251207_160714",
    "lr": 0.001,
    "weight_decay": 0.1,
    "seed": 120,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.954469432075036,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.1_s120_20251207_160714",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s120_20251207_160714",
      "timestamp": "2025-12-07T16:09:10.660117",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.1_s120",
          "seed": 120,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s120_20251207_160714"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.954365439163247,
        "recall_macro": 0.9546249753597478,
        "f1_macro": 0.954469432075036,
        "precision_micro": 0.9545038167938932,
        "recall_micro": 0.9545038167938932,
        "f1_micro": 0.9545038167938932,
        "accuracy": 0.9545038167938932,
        "hamming_loss": 0.04549618320610687,
        "no_defect_precision": 0.9605734767025089,
        "no_defect_recall": 0.9509166173861621,
        "no_defect_f1": 0.9557206537890045,
        "no_defect_tp": 1608,
        "no_defect_fp": 66,
        "no_defect_tn": 1518,
        "no_defect_fn": 83,
        "no_defect_support": 1691,
        "defect_precision": 0.948157401623985,
        "defect_recall": 0.9583333333333334,
        "defect_f1": 0.9532182103610675,
        "defect_tp": 1518,
        "defect_fp": 83,
        "defect_tn": 1608,
        "defect_fn": 66,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9588302395326773,
        "recall_macro": 0.9587643967348765,
        "f1_macro": 0.9587865045698187,
        "precision_micro": 0.9587912087912088,
        "recall_micro": 0.9587912087912088,
        "f1_micro": 0.9587912087912088,
        "accuracy": 0.9587912087912088,
        "hamming_loss": 0.04120879120879121,
        "no_defect_precision": 0.9560505719446116,
        "no_defect_recall": 0.9624242424242424,
        "no_defect_f1": 0.959226819691936,
        "no_defect_tp": 1588,
        "no_defect_fp": 73,
        "no_defect_tn": 1553,
        "no_defect_fn": 62,
        "no_defect_support": 1650,
        "defect_precision": 0.961609907120743,
        "defect_recall": 0.9551045510455105,
        "defect_f1": 0.9583461894477013,
        "defect_tp": 1553,
        "defect_fp": 62,
        "defect_tn": 1588,
        "defect_fn": 73,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6117182314146513,
          0.41146116688161716,
          0.29596608147710934,
          0.2476137569135203,
          0.22556186925666602,
          0.20830409303619274,
          0.20297676041161167,
          0.19358041202922247,
          0.18968002688311134,
          0.18992930466784594,
          0.18548586696511032,
          0.18277284655735582,
          0.18462500041623495,
          0.18562291338104583,
          0.18572958190944902
        ],
        "val_loss": [
          0.5728142731464826,
          0.35035599710849613,
          0.25695020590837186,
          0.21526047415458238,
          0.19340371598417944,
          0.18054983421013907,
          0.173788009927823,
          0.1619011162278744,
          0.15806813538074493,
          0.1549701153372343,
          0.15391105957902396,
          0.1513886795594142,
          0.15067648959274477,
          0.14989904357263675,
          0.1498677974136976
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8501598294046262,
            "recall_macro": 0.8149810120722303,
            "f1_macro": 0.814117364117364,
            "precision_micro": 0.8198473282442749,
            "recall_micro": 0.8198473282442749,
            "f1_micro": 0.8198473282442749,
            "accuracy": 0.8198473282442749,
            "hamming_loss": 0.1801526717557252,
            "no_defect_precision": 0.7549791570171376,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.8467532467532467,
            "no_defect_tp": 1630,
            "no_defect_fp": 529,
            "no_defect_tn": 1055,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9453405017921147,
            "defect_recall": 0.6660353535353535,
            "defect_f1": 0.7814814814814814,
            "defect_tp": 1055,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 529,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9025743064393263,
            "recall_macro": 0.8989374451194381,
            "f1_macro": 0.8997082908281164,
            "precision_micro": 0.9001526717557252,
            "recall_micro": 0.9001526717557252,
            "f1_micro": 0.9001526717557252,
            "accuracy": 0.9001526717557252,
            "hamming_loss": 0.09984732824427481,
            "no_defect_precision": 0.8784683684794673,
            "no_defect_recall": 0.9361324659964518,
            "no_defect_f1": 0.9063841969653593,
            "no_defect_tp": 1583,
            "no_defect_fp": 219,
            "no_defect_tn": 1365,
            "no_defect_fn": 108,
            "no_defect_support": 1691,
            "defect_precision": 0.9266802443991853,
            "defect_recall": 0.8617424242424242,
            "defect_f1": 0.8930323846908734,
            "defect_tp": 1365,
            "defect_fp": 108,
            "defect_tn": 1583,
            "defect_fn": 219,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9311721988216879,
            "recall_macro": 0.9313141766571689,
            "f1_macro": 0.9312361369952522,
            "precision_micro": 0.9312977099236641,
            "recall_micro": 0.9312977099236641,
            "f1_micro": 0.9312977099236641,
            "accuracy": 0.9312977099236641,
            "hamming_loss": 0.06870229007633588,
            "no_defect_precision": 0.9357907253269917,
            "no_defect_recall": 0.9308101714961561,
            "no_defect_f1": 0.933293803735547,
            "no_defect_tp": 1574,
            "no_defect_fp": 108,
            "no_defect_tn": 1476,
            "no_defect_fn": 117,
            "no_defect_support": 1691,
            "defect_precision": 0.9265536723163842,
            "defect_recall": 0.9318181818181818,
            "defect_f1": 0.9291784702549575,
            "defect_tp": 1476,
            "defect_fp": 117,
            "defect_tn": 1574,
            "defect_fn": 108,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9372026521945231,
            "recall_macro": 0.9359213438345608,
            "f1_macro": 0.9363422551363539,
            "precision_micro": 0.9364885496183206,
            "recall_micro": 0.9364885496183206,
            "f1_micro": 0.9364885496183206,
            "accuracy": 0.9364885496183206,
            "hamming_loss": 0.0635114503816794,
            "no_defect_precision": 0.925904652498564,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9393939393939394,
            "no_defect_tp": 1612,
            "no_defect_fp": 129,
            "no_defect_tn": 1455,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9485006518904824,
            "defect_recall": 0.9185606060606061,
            "defect_f1": 0.9332905708787684,
            "defect_tp": 1455,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 129,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.944328725938628,
            "recall_macro": 0.9438327315138374,
            "f1_macro": 0.9440339536219298,
            "precision_micro": 0.9441221374045802,
            "recall_micro": 0.9441221374045802,
            "f1_micro": 0.9441221374045802,
            "accuracy": 0.9441221374045802,
            "hamming_loss": 0.055877862595419846,
            "no_defect_precision": 0.9399066511085181,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9462555066079296,
            "no_defect_tp": 1611,
            "no_defect_fp": 103,
            "no_defect_tn": 1481,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.948750800768738,
            "defect_recall": 0.9349747474747475,
            "defect_f1": 0.9418124006359301,
            "defect_tp": 1481,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 103,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9497913312929176,
            "recall_macro": 0.9500099681020733,
            "f1_macro": 0.9498832506483172,
            "precision_micro": 0.9499236641221374,
            "recall_micro": 0.9499236641221374,
            "f1_micro": 0.9499236641221374,
            "accuracy": 0.9499236641221374,
            "hamming_loss": 0.050076335877862595,
            "no_defect_precision": 0.9552772808586762,
            "no_defect_recall": 0.9473684210526315,
            "no_defect_f1": 0.9513064133016627,
            "no_defect_tp": 1602,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 89,
            "no_defect_support": 1691,
            "defect_precision": 0.9443053817271589,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9484600879949717,
            "defect_tp": 1509,
            "defect_fp": 89,
            "defect_tn": 1602,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9487073199657194,
            "recall_macro": 0.9491867596724191,
            "f1_macro": 0.9486888518836842,
            "precision_micro": 0.9487022900763359,
            "recall_micro": 0.9487022900763359,
            "f1_micro": 0.9487022900763359,
            "accuracy": 0.9487022900763359,
            "hamming_loss": 0.05129770992366412,
            "no_defect_precision": 0.9651802076970067,
            "no_defect_recall": 0.9343583678296866,
            "no_defect_f1": 0.9495192307692307,
            "no_defect_tp": 1580,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 111,
            "no_defect_support": 1691,
            "defect_precision": 0.9322344322344323,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9478584729981379,
            "defect_tp": 1527,
            "defect_fp": 111,
            "defect_tn": 1580,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9499448018093652,
            "recall_macro": 0.9497902591855873,
            "f1_macro": 0.9498618423509204,
            "precision_micro": 0.9499236641221374,
            "recall_micro": 0.9499236641221374,
            "f1_micro": 0.9499236641221374,
            "accuracy": 0.9499236641221374,
            "hamming_loss": 0.050076335877862595,
            "no_defect_precision": 0.9493819894055326,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9516224188790561,
            "no_defect_tp": 1613,
            "no_defect_fp": 86,
            "no_defect_tn": 1498,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.950507614213198,
            "defect_recall": 0.9457070707070707,
            "defect_f1": 0.9481012658227848,
            "defect_tp": 1498,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 86,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9513504555762744,
            "recall_macro": 0.951468409703182,
            "f1_macro": 0.9514050743657043,
            "precision_micro": 0.9514503816793893,
            "recall_micro": 0.9514503816793893,
            "f1_micro": 0.9514503816793893,
            "accuracy": 0.9514503816793893,
            "hamming_loss": 0.04854961832061069,
            "no_defect_precision": 0.9548693586698337,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9528888888888889,
            "no_defect_tp": 1608,
            "no_defect_fp": 76,
            "no_defect_tn": 1508,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9478315524827152,
            "defect_recall": 0.952020202020202,
            "defect_f1": 0.9499212598425197,
            "defect_tp": 1508,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 76,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9534514925373134,
            "recall_macro": 0.9536979792006404,
            "f1_macro": 0.9535519248052502,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9594029850746268,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9548425430778372,
            "no_defect_tp": 1607,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9475,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9522613065326633,
            "defect_tp": 1516,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537476448971216,
            "recall_macro": 0.9540535828420217,
            "f1_macro": 0.9538613142152496,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9610778443113772,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9550728949717346,
            "no_defect_tp": 1605,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.946417445482866,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9526497334587645,
            "defect_tp": 1519,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9534514925373134,
            "recall_macro": 0.9536979792006404,
            "f1_macro": 0.9535519248052502,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9594029850746268,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9548425430778372,
            "no_defect_tp": 1607,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9475,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9522613065326633,
            "defect_tp": 1516,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954365439163247,
            "recall_macro": 0.9546249753597478,
            "f1_macro": 0.954469432075036,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9605734767025089,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9557206537890045,
            "no_defect_tp": 1608,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.948157401623985,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9532182103610675,
            "defect_tp": 1518,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540849571974619,
            "recall_macro": 0.954249398180504,
            "f1_macro": 0.9541582588480859,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9583581201665675,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9555160142348754,
            "no_defect_tp": 1611,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9498117942283564,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9528005034612964,
            "defect_tp": 1514,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.953774817136886,
            "recall_macro": 0.9539537151527098,
            "f1_macro": 0.9538534783433518,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9583333333333334,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9552061702758825,
            "no_defect_tp": 1610,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9492163009404389,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.952500786410821,
            "defect_tp": 1514,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 70,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9588302395326773,
            "recall_macro": 0.9587643967348765,
            "f1_macro": 0.9587865045698187,
            "precision_micro": 0.9587912087912088,
            "recall_micro": 0.9587912087912088,
            "f1_micro": 0.9587912087912088,
            "accuracy": 0.9587912087912088,
            "hamming_loss": 0.04120879120879121,
            "no_defect_precision": 0.9560505719446116,
            "no_defect_recall": 0.9624242424242424,
            "no_defect_f1": 0.959226819691936,
            "no_defect_tp": 1588,
            "no_defect_fp": 73,
            "no_defect_tn": 1553,
            "no_defect_fn": 62,
            "no_defect_support": 1650,
            "defect_precision": 0.961609907120743,
            "defect_recall": 0.9551045510455105,
            "defect_f1": 0.9583461894477013,
            "defect_tp": 1553,
            "defect_fp": 62,
            "defect_tn": 1588,
            "defect_fn": 73,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.1_s130_20251207_161827",
    "lr": 0.001,
    "weight_decay": 0.1,
    "seed": 130,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9553774073709076,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.1_s130_20251207_161827",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s130_20251207_161827",
      "timestamp": "2025-12-07T16:20:25.688510",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.1_s130",
          "seed": 130,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s130_20251207_161827"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.955329115577702,
        "recall_macro": 0.9554321302916808,
        "f1_macro": 0.9553774073709076,
        "precision_micro": 0.9554198473282443,
        "recall_micro": 0.9554198473282443,
        "f1_micro": 0.9554198473282443,
        "accuracy": 0.9554198473282443,
        "hamming_loss": 0.044580152671755725,
        "no_defect_precision": 0.9584569732937686,
        "no_defect_recall": 0.9550561797752809,
        "no_defect_f1": 0.9567535545023697,
        "no_defect_tp": 1615,
        "no_defect_fp": 70,
        "no_defect_tn": 1514,
        "no_defect_fn": 76,
        "no_defect_support": 1691,
        "defect_precision": 0.9522012578616352,
        "defect_recall": 0.9558080808080808,
        "defect_f1": 0.9540012602394455,
        "defect_tp": 1514,
        "defect_fp": 76,
        "defect_tn": 1615,
        "defect_fn": 70,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9591116478797639,
        "recall_macro": 0.9590808453539081,
        "f1_macro": 0.9590930286389056,
        "precision_micro": 0.9590964590964591,
        "recall_micro": 0.9590964590964591,
        "f1_micro": 0.9590964590964591,
        "accuracy": 0.9590964590964591,
        "hamming_loss": 0.040903540903540904,
        "no_defect_precision": 0.9577294685990339,
        "no_defect_recall": 0.9612121212121212,
        "no_defect_f1": 0.9594676346037507,
        "no_defect_tp": 1586,
        "no_defect_fp": 70,
        "no_defect_tn": 1556,
        "no_defect_fn": 64,
        "no_defect_support": 1650,
        "defect_precision": 0.9604938271604938,
        "defect_recall": 0.956949569495695,
        "defect_f1": 0.9587184226740604,
        "defect_tp": 1556,
        "defect_fp": 64,
        "defect_tn": 1586,
        "defect_fn": 70,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6103858401585822,
          0.41152360736076804,
          0.29056385140788105,
          0.2438880592335218,
          0.21924982232404056,
          0.20914588404125747,
          0.19585428695549026,
          0.19421223317230096,
          0.19315676902377954,
          0.18821223578941873,
          0.18742349322994384,
          0.18809213916377543,
          0.18795921341769367,
          0.18842631600267218,
          0.18526987319960256
        ],
        "val_loss": [
          0.5678067321960742,
          0.3464201402205687,
          0.2531108907782115,
          0.21660833519238692,
          0.19724979853400817,
          0.1796034434093879,
          0.16796721604007941,
          0.16480123308988717,
          0.16006230247708467,
          0.15659856223143065,
          0.1530751524349818,
          0.15105897130874488,
          0.15111771025336707,
          0.15070079138072637,
          0.15056148601266053
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8596791718226542,
            "recall_macro": 0.8470338736268659,
            "f1_macro": 0.8478814999433557,
            "precision_micro": 0.8497709923664122,
            "recall_micro": 0.8497709923664122,
            "f1_micro": 0.8497709923664122,
            "accuracy": 0.8497709923664122,
            "hamming_loss": 0.1502290076335878,
            "no_defect_precision": 0.8075936377629553,
            "no_defect_recall": 0.9308101714961561,
            "no_defect_f1": 0.8648351648351649,
            "no_defect_tp": 1574,
            "no_defect_fp": 375,
            "no_defect_tn": 1209,
            "no_defect_fn": 117,
            "no_defect_support": 1691,
            "defect_precision": 0.9117647058823529,
            "defect_recall": 0.7632575757575758,
            "defect_f1": 0.8309278350515464,
            "defect_tp": 1209,
            "defect_fp": 117,
            "defect_tn": 1574,
            "defect_fn": 375,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9053073935800987,
            "recall_macro": 0.9032806629273217,
            "f1_macro": 0.9038283849864732,
            "precision_micro": 0.9041221374045801,
            "recall_micro": 0.9041221374045801,
            "f1_micro": 0.9041221374045801,
            "accuracy": 0.9041221374045801,
            "hamming_loss": 0.09587786259541985,
            "no_defect_precision": 0.8900849858356941,
            "no_defect_recall": 0.9290360733293909,
            "no_defect_f1": 0.9091435185185185,
            "no_defect_tp": 1571,
            "no_defect_fp": 194,
            "no_defect_tn": 1390,
            "no_defect_fn": 120,
            "no_defect_support": 1691,
            "defect_precision": 0.9205298013245033,
            "defect_recall": 0.8775252525252525,
            "defect_f1": 0.898513251454428,
            "defect_tp": 1390,
            "defect_fp": 120,
            "defect_tn": 1571,
            "defect_fn": 194,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9302409506020959,
            "recall_macro": 0.9292964759959141,
            "f1_macro": 0.9296292158008732,
            "precision_micro": 0.9297709923664123,
            "recall_micro": 0.9297709923664123,
            "f1_micro": 0.9297709923664123,
            "accuracy": 0.9297709923664123,
            "hamming_loss": 0.07022900763358779,
            "no_defect_precision": 0.9220103986135182,
            "no_defect_recall": 0.9438202247191011,
            "no_defect_f1": 0.9327878433664524,
            "no_defect_tp": 1596,
            "no_defect_fp": 135,
            "no_defect_tn": 1449,
            "no_defect_fn": 95,
            "no_defect_support": 1691,
            "defect_precision": 0.9384715025906736,
            "defect_recall": 0.9147727272727273,
            "defect_f1": 0.9264705882352942,
            "defect_tp": 1449,
            "defect_fp": 95,
            "defect_tn": 1596,
            "defect_fn": 135,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9404761904761905,
            "recall_macro": 0.9403045087181692,
            "f1_macro": 0.9403832221093599,
            "precision_micro": 0.9404580152671755,
            "recall_micro": 0.9404580152671755,
            "f1_micro": 0.9404580152671755,
            "accuracy": 0.9404580152671755,
            "hamming_loss": 0.059541984732824425,
            "no_defect_precision": 0.94,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.9424948392804482,
            "no_defect_tp": 1598,
            "no_defect_fp": 102,
            "no_defect_tn": 1482,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.940952380952381,
            "defect_recall": 0.9356060606060606,
            "defect_f1": 0.9382716049382716,
            "defect_tp": 1482,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 102,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9449003783741847,
            "recall_macro": 0.9452990131952285,
            "f1_macro": 0.9450093283582089,
            "precision_micro": 0.9450381679389313,
            "recall_micro": 0.9450381679389313,
            "f1_micro": 0.9450381679389313,
            "accuracy": 0.9450381679389313,
            "hamming_loss": 0.0549618320610687,
            "no_defect_precision": 0.9553948161543099,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.9462686567164179,
            "no_defect_tp": 1585,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.9344059405940595,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.94375,
            "defect_tp": 1510,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9486184170251396,
            "recall_macro": 0.94868742122586,
            "f1_macro": 0.9486514999137658,
            "precision_micro": 0.9487022900763359,
            "recall_micro": 0.9487022900763359,
            "f1_micro": 0.9487022900763359,
            "accuracy": 0.9487022900763359,
            "hamming_loss": 0.05129770992366412,
            "no_defect_precision": 0.951393005334914,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9502664298401421,
            "no_defect_tp": 1605,
            "no_defect_fp": 82,
            "no_defect_tn": 1502,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9458438287153652,
            "defect_recall": 0.9482323232323232,
            "defect_f1": 0.9470365699873896,
            "defect_tp": 1502,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 82,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9504181091957116,
            "recall_macro": 0.9499661009862075,
            "f1_macro": 0.950152863307493,
            "precision_micro": 0.9502290076335878,
            "recall_micro": 0.9502290076335878,
            "f1_micro": 0.9502290076335878,
            "accuracy": 0.9502290076335878,
            "hamming_loss": 0.04977099236641221,
            "no_defect_precision": 0.9462616822429907,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.952101087275933,
            "no_defect_tp": 1620,
            "no_defect_fp": 92,
            "no_defect_tn": 1492,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9545745361484325,
            "defect_recall": 0.9419191919191919,
            "defect_f1": 0.9482046393390531,
            "defect_tp": 1492,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 92,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9522298861893422,
            "recall_macro": 0.9526350883166377,
            "f1_macro": 0.9523414179104478,
            "precision_micro": 0.9523664122137404,
            "recall_micro": 0.9523664122137404,
            "f1_micro": 0.9523664122137404,
            "accuracy": 0.9523664122137404,
            "hamming_loss": 0.04763358778625954,
            "no_defect_precision": 0.9626280892103677,
            "no_defect_recall": 0.9444115907746895,
            "no_defect_f1": 0.9534328358208956,
            "no_defect_tp": 1597,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 94,
            "no_defect_support": 1691,
            "defect_precision": 0.9418316831683168,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.95125,
            "defect_tp": 1522,
            "defect_fp": 94,
            "defect_tn": 1597,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.953443366449227,
            "recall_macro": 0.9537379262763651,
            "f1_macro": 0.9535550103488917,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9605026929982047,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9547888161808448,
            "no_defect_tp": 1605,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9463840399002493,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9523212045169385,
            "defect_tp": 1518,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537598827429434,
            "recall_macro": 0.9539936622284346,
            "f1_macro": 0.953856716344935,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9594272076372315,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9551529551529552,
            "no_defect_tp": 1608,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9480925578486554,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9525604775369149,
            "defect_tp": 1516,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546960754823449,
            "recall_macro": 0.9548607377739549,
            "f1_macro": 0.9547694820634448,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9589530041641879,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9561091340450771,
            "no_defect_tp": 1612,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9504391468005019,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9534298300818125,
            "defect_tp": 1515,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.955329115577702,
            "recall_macro": 0.9554321302916808,
            "f1_macro": 0.9553774073709076,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9584569732937686,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9567535545023697,
            "no_defect_tp": 1615,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9522012578616352,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9540012602394455,
            "defect_tp": 1514,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540625,
            "recall_macro": 0.9543093187940912,
            "f1_macro": 0.9541630836893917,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.96,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9554367201426025,
            "no_defect_tp": 1608,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.948125,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9528894472361809,
            "defect_tp": 1517,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543709075331988,
            "recall_macro": 0.9546050018218853,
            "f1_macro": 0.9544678856648696,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9600238663484487,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9557469557469558,
            "no_defect_tp": 1609,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9487179487179487,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9531888155827836,
            "defect_tp": 1517,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540686293167593,
            "recall_macro": 0.9542893452562288,
            "f1_macro": 0.9541615097393146,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9594514013118665,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9554631828978623,
            "no_defect_tp": 1609,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9486858573216521,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9528598365807668,
            "defect_tp": 1516,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 68,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9591116478797639,
            "recall_macro": 0.9590808453539081,
            "f1_macro": 0.9590930286389056,
            "precision_micro": 0.9590964590964591,
            "recall_micro": 0.9590964590964591,
            "f1_micro": 0.9590964590964591,
            "accuracy": 0.9590964590964591,
            "hamming_loss": 0.040903540903540904,
            "no_defect_precision": 0.9577294685990339,
            "no_defect_recall": 0.9612121212121212,
            "no_defect_f1": 0.9594676346037507,
            "no_defect_tp": 1586,
            "no_defect_fp": 70,
            "no_defect_tn": 1556,
            "no_defect_fn": 64,
            "no_defect_support": 1650,
            "defect_precision": 0.9604938271604938,
            "defect_recall": 0.956949569495695,
            "defect_f1": 0.9587184226740604,
            "defect_tp": 1556,
            "defect_fp": 64,
            "defect_tn": 1586,
            "defect_fn": 70,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.1_s140_20251207_193401",
    "lr": 0.001,
    "weight_decay": 0.1,
    "seed": 140,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9566133544104454,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.1_s140_20251207_193401",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s140_20251207_193401",
      "timestamp": "2025-12-07T19:35:54.625193",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 15,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.1_s140",
          "seed": 140,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s140_20251207_193401"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9564950815806987,
        "recall_macro": 0.9568345713193437,
        "f1_macro": 0.9566133544104454,
        "precision_micro": 0.9566412213740458,
        "recall_micro": 0.9566412213740458,
        "f1_micro": 0.9566412213740458,
        "accuracy": 0.9566412213740458,
        "hamming_loss": 0.0433587786259542,
        "no_defect_precision": 0.9646070785842832,
        "no_defect_recall": 0.9509166173861621,
        "no_defect_f1": 0.957712924359738,
        "no_defect_tp": 1608,
        "no_defect_fp": 59,
        "no_defect_tn": 1525,
        "no_defect_fn": 83,
        "no_defect_support": 1691,
        "defect_precision": 0.9483830845771144,
        "defect_recall": 0.9627525252525253,
        "defect_f1": 0.9555137844611529,
        "defect_tp": 1525,
        "defect_fp": 83,
        "defect_tn": 1608,
        "defect_fn": 59,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9603122540015744,
        "recall_macro": 0.960319803198032,
        "f1_macro": 0.9603156706323663,
        "precision_micro": 0.9603174603174603,
        "recall_micro": 0.9603174603174603,
        "f1_micro": 0.9603174603174603,
        "accuracy": 0.9603174603174603,
        "hamming_loss": 0.03968253968253968,
        "no_defect_precision": 0.9611650485436893,
        "no_defect_recall": 0.96,
        "no_defect_f1": 0.960582171012735,
        "no_defect_tp": 1584,
        "no_defect_fp": 64,
        "no_defect_tn": 1562,
        "no_defect_fn": 66,
        "no_defect_support": 1650,
        "defect_precision": 0.9594594594594594,
        "defect_recall": 0.9606396063960639,
        "defect_f1": 0.9600491702519975,
        "defect_tp": 1562,
        "defect_fp": 66,
        "defect_tn": 1584,
        "defect_fn": 64,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6105358921084942,
          0.41099706204865266,
          0.28981988923818996,
          0.2404936238437517,
          0.21866530538478157,
          0.20981871679612282,
          0.19997669260746265,
          0.1941396707832564,
          0.1905593550043126,
          0.18694627855487447,
          0.18100487537463839,
          0.18623654662814598,
          0.18204851937967365,
          0.18322869963850436,
          0.18335363175330302
        ],
        "val_loss": [
          0.5681899992319254,
          0.3474001597899657,
          0.25149191027650464,
          0.21434184192464903,
          0.19349520137676826,
          0.18172546877310827,
          0.1706921370843282,
          0.165185236873535,
          0.16241783720369524,
          0.1548961392388894,
          0.15221215827533832,
          0.14976209230147874,
          0.1507467024314862,
          0.14972235935811812,
          0.14942818192335275
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8605387517035121,
            "recall_macro": 0.8472696360410731,
            "f1_macro": 0.8481167095374518,
            "precision_micro": 0.8500763358778626,
            "recall_micro": 0.8500763358778626,
            "f1_micro": 0.8500763358778626,
            "accuracy": 0.8500763358778626,
            "hamming_loss": 0.1499236641221374,
            "no_defect_precision": 0.8067484662576687,
            "no_defect_recall": 0.9331756357185098,
            "no_defect_f1": 0.8653687962709076,
            "no_defect_tp": 1578,
            "no_defect_fp": 378,
            "no_defect_tn": 1206,
            "no_defect_fn": 113,
            "no_defect_support": 1691,
            "defect_precision": 0.9143290371493555,
            "defect_recall": 0.7613636363636364,
            "defect_f1": 0.8308646228039959,
            "defect_tp": 1206,
            "defect_fp": 113,
            "defect_tn": 1578,
            "defect_fn": 378,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9082013343433342,
            "recall_macro": 0.9055862065360882,
            "f1_macro": 0.9062324563045024,
            "precision_micro": 0.9065648854961832,
            "recall_micro": 0.9065648854961832,
            "f1_micro": 0.9065648854961832,
            "accuracy": 0.9065648854961832,
            "hamming_loss": 0.0934351145038168,
            "no_defect_precision": 0.8892636312535133,
            "no_defect_recall": 0.9355410999408634,
            "no_defect_f1": 0.9118155619596542,
            "no_defect_tp": 1582,
            "no_defect_fp": 197,
            "no_defect_tn": 1387,
            "no_defect_fn": 109,
            "no_defect_support": 1691,
            "defect_precision": 0.9271390374331551,
            "defect_recall": 0.8756313131313131,
            "defect_f1": 0.9006493506493507,
            "defect_tp": 1387,
            "defect_fp": 109,
            "defect_tn": 1582,
            "defect_fn": 197,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9319276495683027,
            "recall_macro": 0.9312103889277159,
            "f1_macro": 0.9314796217256675,
            "precision_micro": 0.9316030534351145,
            "recall_micro": 0.9316030534351145,
            "f1_micro": 0.9316030534351145,
            "accuracy": 0.9316030534351145,
            "hamming_loss": 0.0683969465648855,
            "no_defect_precision": 0.9257109692396982,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9343878148799063,
            "no_defect_tp": 1595,
            "no_defect_fp": 128,
            "no_defect_tn": 1456,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9381443298969072,
            "defect_recall": 0.9191919191919192,
            "defect_f1": 0.9285714285714286,
            "defect_tp": 1456,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 128,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9418826866730119,
            "recall_macro": 0.9419826592357639,
            "f1_macro": 0.9419295027429619,
            "precision_micro": 0.9419847328244275,
            "recall_micro": 0.9419847328244275,
            "f1_micro": 0.9419847328244275,
            "accuracy": 0.9419847328244275,
            "hamming_loss": 0.05801526717557252,
            "no_defect_precision": 0.94540059347181,
            "no_defect_recall": 0.9420461265523359,
            "no_defect_f1": 0.9437203791469194,
            "no_defect_tp": 1593,
            "no_defect_fp": 92,
            "no_defect_tn": 1492,
            "no_defect_fn": 98,
            "no_defect_support": 1691,
            "defect_precision": 0.9383647798742139,
            "defect_recall": 0.9419191919191919,
            "defect_f1": 0.9401386263390044,
            "defect_tp": 1492,
            "defect_fp": 98,
            "defect_tn": 1593,
            "defect_fn": 92,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9467431607607464,
            "recall_macro": 0.9469332965969571,
            "f1_macro": 0.9468254856950898,
            "precision_micro": 0.9468702290076336,
            "recall_micro": 0.9468702290076336,
            "f1_micro": 0.9468702290076336,
            "accuracy": 0.9468702290076336,
            "hamming_loss": 0.05312977099236641,
            "no_defect_precision": 0.9517569982132221,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.9483679525222551,
            "no_defect_tp": 1598,
            "no_defect_fp": 81,
            "no_defect_tn": 1503,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.9417293233082706,
            "defect_recall": 0.9488636363636364,
            "defect_f1": 0.9452830188679245,
            "defect_tp": 1503,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 81,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9476588399232544,
            "recall_macro": 0.9480800016725505,
            "f1_macro": 0.9477610109509488,
            "precision_micro": 0.9477862595419847,
            "recall_micro": 0.9477862595419847,
            "f1_micro": 0.9477862595419847,
            "accuracy": 0.9477862595419847,
            "hamming_loss": 0.052213740458015266,
            "no_defect_precision": 0.9589371980676329,
            "no_defect_recall": 0.9390892962743939,
            "no_defect_f1": 0.9489094711682103,
            "no_defect_tp": 1588,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 103,
            "no_defect_support": 1691,
            "defect_precision": 0.9363804817788759,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9466125507336872,
            "defect_tp": 1516,
            "defect_fp": 103,
            "defect_tn": 1588,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9507003245178858,
            "recall_macro": 0.9510967525640797,
            "f1_macro": 0.9508132064173664,
            "precision_micro": 0.9508396946564885,
            "recall_micro": 0.9508396946564885,
            "f1_micro": 0.9508396946564885,
            "accuracy": 0.9508396946564885,
            "hamming_loss": 0.04916030534351145,
            "no_defect_precision": 0.9608433734939759,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.951954640405849,
            "no_defect_tp": 1595,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9405572755417957,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.949671772428884,
            "defect_tp": 1519,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9528542389317818,
            "recall_macro": 0.9532863749858131,
            "f1_macro": 0.9529549882730269,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.9643504531722055,
            "no_defect_recall": 0.9438202247191011,
            "no_defect_f1": 0.9539748953974896,
            "no_defect_tp": 1596,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 95,
            "no_defect_support": 1691,
            "defect_precision": 0.941358024691358,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9519350811485643,
            "defect_tp": 1525,
            "defect_fp": 95,
            "defect_tn": 1596,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9508158051764004,
            "recall_macro": 0.9512964879427033,
            "f1_macro": 0.950825316771134,
            "precision_micro": 0.9508396946564885,
            "recall_micro": 0.9508396946564885,
            "f1_micro": 0.9508396946564885,
            "accuracy": 0.9508396946564885,
            "hamming_loss": 0.04916030534351145,
            "no_defect_precision": 0.9664634146341463,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.9516661663164215,
            "no_defect_tp": 1585,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.9351681957186544,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9499844672258465,
            "defect_tp": 1529,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537503693732147,
            "recall_macro": 0.9540336093041593,
            "f1_macro": 0.9538598161334316,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9605263157894737,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9550996134403806,
            "no_defect_tp": 1606,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9469744229569557,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9526200188264826,
            "defect_tp": 1518,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549680033604493,
            "recall_macro": 0.9553162091046479,
            "f1_macro": 0.955086347005164,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9633853541416567,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9562109025915997,
            "no_defect_tp": 1605,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9465506525792418,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9539617914187285,
            "defect_tp": 1523,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552907144664282,
            "recall_macro": 0.9555120244431303,
            "f1_macro": 0.9553838694795995,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.960644007155635,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9566508313539193,
            "no_defect_tp": 1611,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9499374217772215,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9541169076052797,
            "defect_tp": 1518,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549759409153642,
            "recall_macro": 0.9553761297182349,
            "f1_macro": 0.9550903189028129,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9650602409638555,
            "no_defect_recall": 0.9473684210526315,
            "no_defect_f1": 0.9561324977618622,
            "no_defect_tp": 1602,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 89,
            "no_defect_support": 1691,
            "defect_precision": 0.944891640866873,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9540481400437637,
            "defect_tp": 1526,
            "defect_fp": 89,
            "defect_tn": 1602,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555801386501457,
            "recall_macro": 0.955947522235961,
            "f1_macro": 0.9556987562067221,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9645432692307693,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9567809239940388,
            "no_defect_tp": 1605,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.946617008069522,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9546165884194053,
            "defect_tp": 1525,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9564950815806987,
            "recall_macro": 0.9568345713193437,
            "f1_macro": 0.9566133544104454,
            "precision_micro": 0.9566412213740458,
            "recall_micro": 0.9566412213740458,
            "f1_micro": 0.9566412213740458,
            "accuracy": 0.9566412213740458,
            "hamming_loss": 0.0433587786259542,
            "no_defect_precision": 0.9646070785842832,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.957712924359738,
            "no_defect_tp": 1608,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9483830845771144,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9555137844611529,
            "defect_tp": 1525,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 59,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9603122540015744,
            "recall_macro": 0.960319803198032,
            "f1_macro": 0.9603156706323663,
            "precision_micro": 0.9603174603174603,
            "recall_micro": 0.9603174603174603,
            "f1_micro": 0.9603174603174603,
            "accuracy": 0.9603174603174603,
            "hamming_loss": 0.03968253968253968,
            "no_defect_precision": 0.9611650485436893,
            "no_defect_recall": 0.96,
            "no_defect_f1": 0.960582171012735,
            "no_defect_tp": 1584,
            "no_defect_fp": 64,
            "no_defect_tn": 1562,
            "no_defect_fn": 66,
            "no_defect_support": 1650,
            "defect_precision": 0.9594594594594594,
            "defect_recall": 0.9606396063960639,
            "defect_f1": 0.9600491702519975,
            "defect_tp": 1562,
            "defect_fp": 66,
            "defect_tn": 1584,
            "defect_fn": 64,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.001_wd0.1_s150_20251207_190708",
    "lr": 0.001,
    "weight_decay": 0.1,
    "seed": 150,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9559919284941625,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.001_wd0.1_s150_20251207_190708",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s150_20251207_190708",
      "timestamp": "2025-12-07T19:09:02.819475",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.001,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.001,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.001_wd0.1_s150",
          "seed": 150,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s150_20251207_190708"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9559183120521109,
        "recall_macro": 0.9560834169608563,
        "f1_macro": 0.9559919284941625,
        "precision_micro": 0.956030534351145,
        "recall_micro": 0.956030534351145,
        "f1_micro": 0.956030534351145,
        "accuracy": 0.956030534351145,
        "hamming_loss": 0.04396946564885496,
        "no_defect_precision": 0.9601427721594289,
        "no_defect_recall": 0.9544648137196925,
        "no_defect_f1": 0.9572953736654805,
        "no_defect_tp": 1614,
        "no_defect_fp": 67,
        "no_defect_tn": 1517,
        "no_defect_fn": 77,
        "no_defect_support": 1691,
        "defect_precision": 0.951693851944793,
        "defect_recall": 0.9577020202020202,
        "defect_f1": 0.9546884833228445,
        "defect_tp": 1517,
        "defect_fp": 77,
        "defect_tn": 1614,
        "defect_fn": 67,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9588196613513069,
        "recall_macro": 0.9587688695068769,
        "f1_macro": 0.9587870268873973,
        "precision_micro": 0.9587912087912088,
        "recall_micro": 0.9587912087912088,
        "f1_micro": 0.9587912087912088,
        "accuracy": 0.9587912087912088,
        "hamming_loss": 0.04120879120879121,
        "no_defect_precision": 0.9566003616636528,
        "no_defect_recall": 0.9618181818181818,
        "no_defect_f1": 0.9592021758839528,
        "no_defect_tp": 1587,
        "no_defect_fp": 72,
        "no_defect_tn": 1554,
        "no_defect_fn": 63,
        "no_defect_support": 1650,
        "defect_precision": 0.961038961038961,
        "defect_recall": 0.955719557195572,
        "defect_f1": 0.9583718778908418,
        "defect_tp": 1554,
        "defect_fp": 63,
        "defect_tn": 1587,
        "defect_fn": 72,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.6139407257654677,
          0.4159615652082355,
          0.2891257072342988,
          0.2418728644753101,
          0.22365860856103098,
          0.2110956198376093,
          0.20367159089658052,
          0.1977335108935085,
          0.19101781192309686,
          0.18621045235684727,
          0.18276344445460013,
          0.18774110247151124,
          0.18698980743416183,
          0.1848067264364853,
          0.18226393362094168
        ],
        "val_loss": [
          0.5701114615568748,
          0.35160747514321256,
          0.25538213121203274,
          0.21863251609297898,
          0.19362773488347346,
          0.17829727839965087,
          0.17103679650104964,
          0.1631238333021219,
          0.15943598016523397,
          0.15490092193851104,
          0.1534369309934286,
          0.1500978398208435,
          0.15007279684337285,
          0.14946804482203263,
          0.14944404621536916
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8203164556962026,
            "recall_macro": 0.8070371440603552,
            "f1_macro": 0.8073300554709355,
            "precision_micro": 0.8100763358778625,
            "recall_micro": 0.8100763358778625,
            "f1_micro": 0.8100763358778625,
            "accuracy": 0.8100763358778625,
            "hamming_loss": 0.1899236641221374,
            "no_defect_precision": 0.7706329113924051,
            "no_defect_recall": 0.9000591366055588,
            "no_defect_f1": 0.8303327877795963,
            "no_defect_tp": 1522,
            "no_defect_fp": 453,
            "no_defect_tn": 1131,
            "no_defect_fn": 169,
            "no_defect_support": 1691,
            "defect_precision": 0.87,
            "defect_recall": 0.7140151515151515,
            "defect_f1": 0.7843273231622746,
            "defect_tp": 1131,
            "defect_fp": 169,
            "defect_tn": 1522,
            "defect_fn": 453,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9033812822841958,
            "recall_macro": 0.8998844148164078,
            "f1_macro": 0.9006404854205292,
            "precision_micro": 0.9010687022900763,
            "recall_micro": 0.9010687022900763,
            "f1_micro": 0.9010687022900763,
            "accuracy": 0.9010687022900763,
            "hamming_loss": 0.09893129770992366,
            "no_defect_precision": 0.8799332962757087,
            "no_defect_recall": 0.9361324659964518,
            "no_defect_f1": 0.907163323782235,
            "no_defect_tp": 1583,
            "no_defect_fp": 216,
            "no_defect_tn": 1368,
            "no_defect_fn": 108,
            "no_defect_support": 1691,
            "defect_precision": 0.926829268292683,
            "defect_recall": 0.8636363636363636,
            "defect_f1": 0.8941176470588236,
            "defect_tp": 1368,
            "defect_fp": 108,
            "defect_tn": 1583,
            "defect_fn": 216,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9243349229037088,
            "recall_macro": 0.9218366396071895,
            "f1_macro": 0.9224872012554346,
            "precision_micro": 0.9227480916030535,
            "recall_micro": 0.9227480916030535,
            "f1_micro": 0.9227480916030535,
            "accuracy": 0.9227480916030535,
            "hamming_loss": 0.07725190839694657,
            "no_defect_precision": 0.9052987598647125,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.926984126984127,
            "no_defect_tp": 1606,
            "no_defect_fp": 168,
            "no_defect_tn": 1416,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9433710859427049,
            "defect_recall": 0.8939393939393939,
            "defect_f1": 0.9179902755267423,
            "defect_tp": 1416,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 168,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.938254983497119,
            "recall_macro": 0.9387140924323065,
            "f1_macro": 0.9382992050665628,
            "precision_micro": 0.9383206106870229,
            "recall_micro": 0.9383206106870229,
            "f1_micro": 0.9383206106870229,
            "accuracy": 0.9383206106870229,
            "hamming_loss": 0.0616793893129771,
            "no_defect_precision": 0.9525835866261398,
            "no_defect_recall": 0.9266706091070372,
            "no_defect_f1": 0.9394484412470024,
            "no_defect_tp": 1567,
            "no_defect_fp": 78,
            "no_defect_tn": 1506,
            "no_defect_fn": 124,
            "no_defect_support": 1691,
            "defect_precision": 0.9239263803680982,
            "defect_recall": 0.9507575757575758,
            "defect_f1": 0.9371499688861232,
            "defect_tp": 1506,
            "defect_fp": 124,
            "defect_tn": 1567,
            "defect_fn": 78,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.946275503954252,
            "recall_macro": 0.9461222216248828,
            "f1_macro": 0.9461931966692805,
            "precision_micro": 0.9462595419847328,
            "recall_micro": 0.9462595419847328,
            "f1_micro": 0.9462595419847328,
            "accuracy": 0.9462595419847328,
            "hamming_loss": 0.053740458015267174,
            "no_defect_precision": 0.9458505002942907,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9480825958702065,
            "no_defect_tp": 1607,
            "no_defect_fp": 92,
            "no_defect_tn": 1492,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9467005076142132,
            "defect_recall": 0.9419191919191919,
            "defect_f1": 0.9443037974683545,
            "defect_tp": 1492,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 92,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9496725366290584,
            "recall_macro": 0.9494546290820685,
            "f1_macro": 0.9495528301247393,
            "precision_micro": 0.9496183206106871,
            "recall_micro": 0.9496183206106871,
            "f1_micro": 0.9496183206106871,
            "accuracy": 0.9496183206106871,
            "hamming_loss": 0.050381679389312976,
            "no_defect_precision": 0.9482961222091657,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9513704686118479,
            "no_defect_tp": 1614,
            "no_defect_fp": 88,
            "no_defect_tn": 1496,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.951048951048951,
            "defect_recall": 0.9444444444444444,
            "defect_f1": 0.9477351916376306,
            "defect_tp": 1496,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 88,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9516317968835131,
            "recall_macro": 0.9518240133445633,
            "f1_macro": 0.9517150962058862,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.9565217391304348,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9531157270029673,
            "no_defect_tp": 1606,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9467418546365914,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.950314465408805,
            "defect_tp": 1511,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9525728153165594,
            "recall_macro": 0.9526910888900836,
            "f1_macro": 0.9526275882181394,
            "precision_micro": 0.9526717557251908,
            "recall_micro": 0.9526717557251908,
            "f1_micro": 0.9526717557251908,
            "accuracy": 0.9526717557251908,
            "hamming_loss": 0.04732824427480916,
            "no_defect_precision": 0.9560570071258907,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9540740740740741,
            "no_defect_tp": 1610,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9490886235072281,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9511811023622048,
            "defect_tp": 1510,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9528324237282317,
            "recall_macro": 0.9531265866829144,
            "f1_macro": 0.9529438920640085,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.959904248952723,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9541939321832242,
            "no_defect_tp": 1604,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9457605985037406,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.951693851944793,
            "defect_tp": 1517,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9537843179845236,
            "recall_macro": 0.9539337416148475,
            "f1_macro": 0.9538518074945915,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9577883472057075,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9552327305069671,
            "no_defect_tp": 1611,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9497802887633396,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.952470884482216,
            "defect_tp": 1513,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549722858157701,
            "recall_macro": 0.9552562884910608,
            "f1_macro": 0.9550820726596982,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9617224880382775,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9562890276538805,
            "no_defect_tp": 1608,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9482220835932627,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9538751176655161,
            "defect_tp": 1520,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9541495304911922,
            "recall_macro": 0.9541495304911922,
            "f1_macro": 0.9541495304911922,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9556475458308693,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9556475458308693,
            "no_defect_tp": 1616,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9526515151515151,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9526515151515151,
            "defect_tp": 1509,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552982739755882,
            "recall_macro": 0.955492050905268,
            "f1_macro": 0.9553823040889835,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9600952948183442,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9566765578635015,
            "no_defect_tp": 1612,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505012531328321,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9540880503144654,
            "defect_tp": 1517,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9559183120521109,
            "recall_macro": 0.9560834169608563,
            "f1_macro": 0.9559919284941625,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9601427721594289,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9572953736654805,
            "no_defect_tp": 1614,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.951693851944793,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9546884833228445,
            "defect_tp": 1517,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556081131512166,
            "recall_macro": 0.9557877339330622,
            "f1_macro": 0.9556871149654702,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9601190476190476,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9569860575496886,
            "no_defect_tp": 1613,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9510971786833856,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.954388172381252,
            "defect_tp": 1517,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 67,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9588196613513069,
            "recall_macro": 0.9587688695068769,
            "f1_macro": 0.9587870268873973,
            "precision_micro": 0.9587912087912088,
            "recall_micro": 0.9587912087912088,
            "f1_micro": 0.9587912087912088,
            "accuracy": 0.9587912087912088,
            "hamming_loss": 0.04120879120879121,
            "no_defect_precision": 0.9566003616636528,
            "no_defect_recall": 0.9618181818181818,
            "no_defect_f1": 0.9592021758839528,
            "no_defect_tp": 1587,
            "no_defect_fp": 72,
            "no_defect_tn": 1554,
            "no_defect_fn": 63,
            "no_defect_support": 1650,
            "defect_precision": 0.961038961038961,
            "defect_recall": 0.955719557195572,
            "defect_f1": 0.9583718778908418,
            "defect_tp": 1554,
            "defect_fp": 63,
            "defect_tn": 1587,
            "defect_fn": 72,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.001_s10_20251207_190955",
    "lr": 0.005,
    "weight_decay": 0.001,
    "seed": 10,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9642555599430551,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.001_s10_20251207_190955",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s10_20251207_190955",
      "timestamp": "2025-12-07T19:11:52.211079",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.001_s10",
          "seed": 10,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s10_20251207_190955"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9641379760528181,
        "recall_macro": 0.9645462236199965,
        "f1_macro": 0.9642555599430551,
        "precision_micro": 0.9642748091603054,
        "recall_micro": 0.9642748091603054,
        "f1_micro": 0.9642748091603054,
        "accuracy": 0.9642748091603054,
        "hamming_loss": 0.03572519083969466,
        "no_defect_precision": 0.9740963855421687,
        "no_defect_recall": 0.9562389118864577,
        "no_defect_f1": 0.9650850492390332,
        "no_defect_tp": 1617,
        "no_defect_fp": 43,
        "no_defect_tn": 1541,
        "no_defect_fn": 74,
        "no_defect_support": 1691,
        "defect_precision": 0.9541795665634675,
        "defect_recall": 0.9728535353535354,
        "defect_f1": 0.9634260706470772,
        "defect_tp": 1541,
        "defect_fp": 74,
        "defect_tn": 1617,
        "defect_fn": 43,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9676523079721544,
        "recall_macro": 0.9676327854187633,
        "f1_macro": 0.9676411037822493,
        "precision_micro": 0.9676434676434676,
        "recall_micro": 0.9676434676434676,
        "f1_micro": 0.9676434676434676,
        "accuracy": 0.9676434676434676,
        "hamming_loss": 0.03235653235653236,
        "no_defect_precision": 0.9667472793228536,
        "no_defect_recall": 0.9690909090909091,
        "no_defect_f1": 0.9679176755447942,
        "no_defect_tp": 1599,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 51,
        "no_defect_support": 1650,
        "defect_precision": 0.968557336621455,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.9673645320197044,
        "defect_tp": 1571,
        "defect_fp": 51,
        "defect_tn": 1599,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4668640379626382,
          0.25945640420813937,
          0.19883920935033256,
          0.1845811375389538,
          0.17548896983328224,
          0.1719051254406634,
          0.17831472192099904,
          0.17769428769664286,
          0.1714576255514532,
          0.1671752463480668,
          0.1660558543787591,
          0.1674277015092732,
          0.16047521415614682,
          0.16142481658997396,
          0.16820562916133694
        ],
        "val_loss": [
          0.37121706914443237,
          0.19552504586485717,
          0.15479401198144144,
          0.12351591440920646,
          0.11581372641600095,
          0.11313776134584959,
          0.11319169423614557,
          0.10745332332757804,
          0.10948786207546408,
          0.10444449318143037,
          0.10404944491501038,
          0.10483827348798513,
          0.10129871419989146,
          0.10166612718827449,
          0.10137956216931343
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8914824445872028,
            "recall_macro": 0.8899510330985789,
            "f1_macro": 0.8903951588959362,
            "precision_micro": 0.8906870229007634,
            "recall_micro": 0.8906870229007634,
            "f1_micro": 0.8906870229007634,
            "accuracy": 0.8906870229007634,
            "hamming_loss": 0.10931297709923664,
            "no_defect_precision": 0.8802053622361665,
            "no_defect_recall": 0.9124778237729154,
            "no_defect_f1": 0.8960511033681765,
            "no_defect_tp": 1543,
            "no_defect_fp": 210,
            "no_defect_tn": 1374,
            "no_defect_fn": 148,
            "no_defect_support": 1691,
            "defect_precision": 0.9027595269382391,
            "defect_recall": 0.8674242424242424,
            "defect_f1": 0.8847392144236961,
            "defect_tp": 1374,
            "defect_fp": 148,
            "defect_tn": 1543,
            "defect_fn": 210,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.944462372458984,
            "recall_macro": 0.9442682293066682,
            "f1_macro": 0.9443564636681923,
            "precision_micro": 0.9444274809160306,
            "recall_micro": 0.9444274809160306,
            "f1_micro": 0.9444274809160306,
            "accuracy": 0.9444274809160306,
            "hamming_loss": 0.055572519083969464,
            "no_defect_precision": 0.9435626102292769,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9463443396226415,
            "no_defect_tp": 1605,
            "no_defect_fp": 96,
            "no_defect_tn": 1488,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9453621346886912,
            "defect_recall": 0.9393939393939394,
            "defect_f1": 0.9423685877137429,
            "defect_tp": 1488,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 96,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9490115259800813,
            "recall_macro": 0.949406468588905,
            "f1_macro": 0.9486976934662008,
            "precision_micro": 0.9487022900763359,
            "recall_micro": 0.9487022900763359,
            "f1_micro": 0.9487022900763359,
            "accuracy": 0.9487022900763359,
            "hamming_loss": 0.05129770992366412,
            "no_defect_precision": 0.9715170278637771,
            "no_defect_recall": 0.9278533412182141,
            "no_defect_f1": 0.9491833030852994,
            "no_defect_tp": 1569,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 122,
            "no_defect_support": 1691,
            "defect_precision": 0.9265060240963855,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9482120838471023,
            "defect_tp": 1538,
            "defect_fp": 122,
            "defect_tn": 1569,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9584462459013577,
            "recall_macro": 0.9584089341074853,
            "f1_macro": 0.9584272314141536,
            "precision_micro": 0.9584732824427481,
            "recall_micro": 0.9584732824427481,
            "f1_micro": 0.9584732824427481,
            "accuracy": 0.9584732824427481,
            "hamming_loss": 0.04152671755725191,
            "no_defect_precision": 0.9592439456585942,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9598108747044918,
            "no_defect_tp": 1624,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9576485461441213,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9570435881238155,
            "defect_tp": 1515,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9634468584850264,
            "recall_macro": 0.9631997831657797,
            "f1_macro": 0.9633103374104603,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9612448620082208,
            "no_defect_recall": 0.9680662329982259,
            "no_defect_f1": 0.9646434885091337,
            "no_defect_tp": 1637,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 54,
            "no_defect_support": 1691,
            "defect_precision": 0.9656488549618321,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9619771863117871,
            "defect_tp": 1518,
            "defect_fp": 54,
            "defect_tn": 1637,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.959337726093368,
            "recall_macro": 0.959355903804455,
            "f1_macro": 0.959346725230902,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9609467455621302,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9606625258799172,
            "no_defect_tp": 1624,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9577287066246056,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.958030924581887,
            "defect_tp": 1518,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9601656785487013,
            "recall_macro": 0.9605625294936353,
            "f1_macro": 0.960283388633409,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9698976520168573,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.961217183770883,
            "no_defect_tp": 1611,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9504337050805453,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.959349593495935,
            "defect_tp": 1534,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9611561801007594,
            "recall_macro": 0.9612098961226696,
            "f1_macro": 0.9611822291932595,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9632701421800948,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9624149156555194,
            "no_defect_tp": 1626,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9590422180214241,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9599495427309996,
            "defect_tp": 1522,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962002563276219,
            "recall_macro": 0.96241652181185,
            "f1_macro": 0.9621175373134329,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9722724532851115,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9629850746268657,
            "no_defect_tp": 1613,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9517326732673267,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.96125,
            "defect_tp": 1538,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635322601460805,
            "recall_macro": 0.9639548575644081,
            "f1_macro": 0.9636455612697175,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.974065138721351,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9644670050761421,
            "no_defect_tp": 1615,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9529993815708101,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9628241174632928,
            "defect_tp": 1541,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9622984681753373,
            "recall_macro": 0.9626522842260572,
            "f1_macro": 0.9624191883104434,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9705882352941176,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9633601429848079,
            "no_defect_tp": 1617,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9540087010565569,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9614782336360789,
            "defect_tp": 1535,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9641379760528181,
            "recall_macro": 0.9645462236199965,
            "f1_macro": 0.9642555599430551,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.9740963855421687,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9650850492390332,
            "no_defect_tp": 1617,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9541795665634675,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9634260706470772,
            "defect_tp": 1541,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629325844122211,
            "recall_macro": 0.9631437825923337,
            "f1_macro": 0.9630229726460042,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9678188319427891,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9640842980112793,
            "no_defect_tp": 1624,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9580463368816531,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9619616472807293,
            "defect_tp": 1530,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635302980440092,
            "recall_macro": 0.9637950692615092,
            "f1_macro": 0.9636366605163039,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9695340501792115,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9646359583952452,
            "no_defect_tp": 1623,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.957526545908807,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9626373626373627,
            "defect_tp": 1533,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635302980440092,
            "recall_macro": 0.9637950692615092,
            "f1_macro": 0.9636366605163039,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9695340501792115,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9646359583952452,
            "no_defect_tp": 1623,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.957526545908807,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9626373626373627,
            "defect_tp": 1533,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 51,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9676523079721544,
            "recall_macro": 0.9676327854187633,
            "f1_macro": 0.9676411037822493,
            "precision_micro": 0.9676434676434676,
            "recall_micro": 0.9676434676434676,
            "f1_micro": 0.9676434676434676,
            "accuracy": 0.9676434676434676,
            "hamming_loss": 0.03235653235653236,
            "no_defect_precision": 0.9667472793228536,
            "no_defect_recall": 0.9690909090909091,
            "no_defect_f1": 0.9679176755447942,
            "no_defect_tp": 1599,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 51,
            "no_defect_support": 1650,
            "defect_precision": 0.968557336621455,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.9673645320197044,
            "defect_tp": 1571,
            "defect_fp": 51,
            "defect_tn": 1599,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.001_s20_20251207_183552",
    "lr": 0.005,
    "weight_decay": 0.001,
    "seed": 20,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.964241469816273,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.001_s20_20251207_183552",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s20_20251207_183552",
      "timestamp": "2025-12-07T18:37:46.304861",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 11,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.001_s20",
          "seed": 20,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s20_20251207_183552"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9641852328492664,
        "recall_macro": 0.9643065411656482,
        "f1_macro": 0.964241469816273,
        "precision_micro": 0.9642748091603054,
        "recall_micro": 0.9642748091603054,
        "f1_micro": 0.9642748091603054,
        "accuracy": 0.9642748091603054,
        "hamming_loss": 0.03572519083969466,
        "no_defect_precision": 0.9673396674584323,
        "no_defect_recall": 0.9633353045535187,
        "no_defect_f1": 0.9653333333333334,
        "no_defect_tp": 1629,
        "no_defect_fp": 55,
        "no_defect_tn": 1529,
        "no_defect_fn": 62,
        "no_defect_support": 1691,
        "defect_precision": 0.9610307982401005,
        "defect_recall": 0.9652777777777778,
        "defect_f1": 0.9631496062992126,
        "defect_tp": 1529,
        "defect_fp": 62,
        "defect_tn": 1629,
        "defect_fn": 55,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9679416100290906,
        "recall_macro": 0.9679581795817958,
        "f1_macro": 0.9679476397981144,
        "precision_micro": 0.967948717948718,
        "recall_micro": 0.967948717948718,
        "f1_micro": 0.967948717948718,
        "accuracy": 0.967948717948718,
        "hamming_loss": 0.03205128205128205,
        "no_defect_precision": 0.9696048632218845,
        "no_defect_recall": 0.9666666666666667,
        "no_defect_f1": 0.9681335356600911,
        "no_defect_tp": 1595,
        "no_defect_fp": 50,
        "no_defect_tn": 1576,
        "no_defect_fn": 55,
        "no_defect_support": 1650,
        "defect_precision": 0.9662783568362967,
        "defect_recall": 0.9692496924969249,
        "defect_f1": 0.9677617439361376,
        "defect_tp": 1576,
        "defect_fp": 55,
        "defect_tn": 1595,
        "defect_fn": 50,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.469284090038124,
          0.2566882851358238,
          0.19737828164419868,
          0.18125801374473333,
          0.17376686068384217,
          0.1742339391713362,
          0.17214105791065484,
          0.17838953956026413,
          0.16712595745297656,
          0.16981002901949643,
          0.1665593274093572,
          0.16743493253154734,
          0.1658099798727235,
          0.16733682272511546,
          0.1684547921011388
        ],
        "val_loss": [
          0.36979097643723857,
          0.19190323897279227,
          0.14248019786408314,
          0.1201287518040492,
          0.13133080432621333,
          0.11118706502020359,
          0.10629366696454011,
          0.11063861632003234,
          0.1096274318316808,
          0.10375318618921134,
          0.10120137616132314,
          0.10422107104498607,
          0.10296686924993992,
          0.10385795568044369,
          0.10443540727003263
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8965500231336581,
            "recall_macro": 0.8916573705714747,
            "f1_macro": 0.8925381490742672,
            "precision_micro": 0.8931297709923665,
            "recall_micro": 0.8931297709923665,
            "f1_micro": 0.8931297709923665,
            "accuracy": 0.8931297709923665,
            "hamming_loss": 0.10687022900763359,
            "no_defect_precision": 0.8669950738916257,
            "no_defect_recall": 0.9367238320520402,
            "no_defect_f1": 0.900511654349062,
            "no_defect_tp": 1584,
            "no_defect_fp": 243,
            "no_defect_tn": 1341,
            "no_defect_fn": 107,
            "no_defect_support": 1691,
            "defect_precision": 0.9261049723756906,
            "defect_recall": 0.8465909090909091,
            "defect_f1": 0.8845646437994723,
            "defect_tp": 1341,
            "defect_fp": 107,
            "defect_tn": 1584,
            "defect_fn": 243,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9445617708667284,
            "recall_macro": 0.9441883351552187,
            "f1_macro": 0.9443464052287581,
            "precision_micro": 0.9444274809160306,
            "recall_micro": 0.9444274809160306,
            "f1_micro": 0.9444274809160306,
            "accuracy": 0.9444274809160306,
            "hamming_loss": 0.055572519083969464,
            "no_defect_precision": 0.9414862492685782,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9464705882352941,
            "no_defect_tp": 1609,
            "no_defect_fp": 100,
            "no_defect_tn": 1484,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9476372924648787,
            "defect_recall": 0.9368686868686869,
            "defect_f1": 0.9422222222222222,
            "defect_tp": 1484,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 100,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9504101500625728,
            "recall_macro": 0.9490551583248212,
            "f1_macro": 0.9495007831759178,
            "precision_micro": 0.9496183206106871,
            "recall_micro": 0.9496183206106871,
            "f1_micro": 0.9496183206106871,
            "accuracy": 0.9496183206106871,
            "hamming_loss": 0.050381679389312976,
            "no_defect_precision": 0.9380022962112514,
            "no_defect_recall": 0.9662921348314607,
            "no_defect_f1": 0.9519370812700262,
            "no_defect_tp": 1634,
            "no_defect_fp": 108,
            "no_defect_tn": 1476,
            "no_defect_fn": 57,
            "no_defect_support": 1691,
            "defect_precision": 0.9628180039138943,
            "defect_recall": 0.9318181818181818,
            "defect_f1": 0.9470644850818094,
            "defect_tp": 1476,
            "defect_fp": 57,
            "defect_tn": 1634,
            "defect_fn": 108,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9630226370911981,
            "recall_macro": 0.9630039678272972,
            "f1_macro": 0.96301321238709,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9639479905437353,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9642329293526456,
            "no_defect_tp": 1631,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9620972836386608,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9617934954215346,
            "defect_tp": 1523,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9542955999477738,
            "recall_macro": 0.9546527889778924,
            "f1_macro": 0.9538902236271707,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9782608695652174,
            "no_defect_recall": 0.9314015375517445,
            "no_defect_f1": 0.9542562859739473,
            "no_defect_tp": 1575,
            "no_defect_fp": 35,
            "no_defect_tn": 1549,
            "no_defect_fn": 116,
            "no_defect_support": 1691,
            "defect_precision": 0.9303303303303303,
            "defect_recall": 0.9779040404040404,
            "defect_f1": 0.953524161280394,
            "defect_tp": 1549,
            "defect_fp": 116,
            "defect_tn": 1575,
            "defect_fn": 35,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635206582711429,
            "recall_macro": 0.9638549898750963,
            "f1_macro": 0.9636402023441748,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9712230215827338,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9645727895206907,
            "no_defect_tp": 1620,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.955818294959552,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.962707615167659,
            "defect_tp": 1536,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.963269137053713,
            "recall_macro": 0.9628042324486736,
            "f1_macro": 0.9629969107988139,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9585280373831776,
            "no_defect_recall": 0.9704316972205795,
            "no_defect_f1": 0.9644431384072877,
            "no_defect_tp": 1641,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 50,
            "no_defect_support": 1691,
            "defect_precision": 0.9680102367242482,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.96155068319034,
            "defect_tp": 1513,
            "defect_fp": 50,
            "defect_tn": 1641,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.961759706176105,
            "recall_macro": 0.96224068001123,
            "f1_macro": 0.9618183770028506,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9756986634264885,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9625412046748577,
            "no_defect_tp": 1606,
            "no_defect_fp": 40,
            "no_defect_tn": 1544,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9478207489257213,
            "defect_recall": 0.9747474747474747,
            "defect_f1": 0.9610955493308434,
            "defect_tp": 1544,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 40,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962325083341601,
            "recall_macro": 0.9627721254532313,
            "f1_macro": 0.9624255822250827,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9740024183796856,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9632286995515695,
            "no_defect_tp": 1611,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9506477483035164,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9616224648985959,
            "defect_tp": 1541,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635362793870275,
            "recall_macro": 0.9637750957236468,
            "f1_macro": 0.9636354254638893,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9689737470167065,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9646569646569647,
            "no_defect_tp": 1624,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9580988117573483,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9626138862708137,
            "defect_tp": 1532,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9641852328492664,
            "recall_macro": 0.9643065411656482,
            "f1_macro": 0.964241469816273,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.9673396674584323,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9653333333333334,
            "no_defect_tp": 1629,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9610307982401005,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9631496062992126,
            "defect_tp": 1529,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9632184499851508,
            "recall_macro": 0.9635193597715774,
            "f1_macro": 0.9633329029070197,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9700777977259126,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9643069601427722,
            "no_defect_tp": 1621,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.956359102244389,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9623588456712673,
            "defect_tp": 1534,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626312281597382,
            "recall_macro": 0.9628281260266771,
            "f1_macro": 0.9627167198551779,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9672424061941632,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9637982195845697,
            "no_defect_tp": 1624,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9580200501253133,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9616352201257862,
            "defect_tp": 1529,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623006323800996,
            "recall_macro": 0.9626123371503323,
            "f1_macro": 0.9624168321091106,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9694610778443113,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9634037488842606,
            "no_defect_tp": 1619,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9551401869158879,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9614299153339605,
            "defect_tp": 1533,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9622988603516689,
            "recall_macro": 0.9626323106881948,
            "f1_macro": 0.9624180242717102,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9700239808153477,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9633819589163441,
            "no_defect_tp": 1618,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.95457373988799,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9614540896270761,
            "defect_tp": 1534,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 50,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9679416100290906,
            "recall_macro": 0.9679581795817958,
            "f1_macro": 0.9679476397981144,
            "precision_micro": 0.967948717948718,
            "recall_micro": 0.967948717948718,
            "f1_micro": 0.967948717948718,
            "accuracy": 0.967948717948718,
            "hamming_loss": 0.03205128205128205,
            "no_defect_precision": 0.9696048632218845,
            "no_defect_recall": 0.9666666666666667,
            "no_defect_f1": 0.9681335356600911,
            "no_defect_tp": 1595,
            "no_defect_fp": 50,
            "no_defect_tn": 1576,
            "no_defect_fn": 55,
            "no_defect_support": 1650,
            "defect_precision": 0.9662783568362967,
            "defect_recall": 0.9692496924969249,
            "defect_f1": 0.9677617439361376,
            "defect_tp": 1576,
            "defect_fp": 55,
            "defect_tn": 1595,
            "defect_fn": 50,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.001_s30_20251207_162716",
    "lr": 0.005,
    "weight_decay": 0.001,
    "seed": 30,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9636378683435654,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.001_s30_20251207_162716",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s30_20251207_162716",
      "timestamp": "2025-12-07T16:29:10.863131",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 7,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.001_s30",
          "seed": 30,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s30_20251207_162716"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9635257009136577,
        "recall_macro": 0.9638150427993716,
        "f1_macro": 0.9636378683435654,
        "precision_micro": 0.9636641221374046,
        "recall_micro": 0.9636641221374046,
        "f1_micro": 0.9636641221374046,
        "accuracy": 0.9636641221374046,
        "hamming_loss": 0.03633587786259542,
        "no_defect_precision": 0.9700956937799043,
        "no_defect_recall": 0.9591957421643997,
        "no_defect_f1": 0.9646149271483794,
        "no_defect_tp": 1622,
        "no_defect_fp": 50,
        "no_defect_tn": 1534,
        "no_defect_fn": 69,
        "no_defect_support": 1691,
        "defect_precision": 0.9569557080474111,
        "defect_recall": 0.9684343434343434,
        "defect_f1": 0.9626608095387512,
        "defect_tp": 1534,
        "defect_fp": 69,
        "defect_tn": 1622,
        "defect_fn": 50,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9664157019433615,
        "recall_macro": 0.966429609750643,
        "f1_macro": 0.9664212149042246,
        "precision_micro": 0.9664224664224664,
        "recall_micro": 0.9664224664224664,
        "f1_micro": 0.9664224664224664,
        "accuracy": 0.9664224664224664,
        "hamming_loss": 0.033577533577533576,
        "no_defect_precision": 0.9678007290400972,
        "no_defect_recall": 0.9654545454545455,
        "no_defect_f1": 0.966626213592233,
        "no_defect_tp": 1593,
        "no_defect_fp": 53,
        "no_defect_tn": 1573,
        "no_defect_fn": 57,
        "no_defect_support": 1650,
        "defect_precision": 0.9650306748466257,
        "defect_recall": 0.9674046740467405,
        "defect_f1": 0.9662162162162162,
        "defect_tp": 1573,
        "defect_fp": 57,
        "defect_tn": 1593,
        "defect_fn": 53,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.47147083581740884,
          0.25388529469652654,
          0.19670818412528376,
          0.18322389198771083,
          0.18075090450347717,
          0.17887340521899725,
          0.1721810552615002,
          0.17330601303273166,
          0.17389427892333792,
          0.16932574678290338,
          0.17450153812080246,
          0.16680612458718871,
          0.16450852461190404,
          0.16089952975573898,
          0.16551576724673414
        ],
        "val_loss": [
          0.3681010145407457,
          0.19211632543458387,
          0.13869380105573398,
          0.12914230932409948,
          0.1168495645889869,
          0.1145245460793376,
          0.1086136528219168,
          0.10548442236792582,
          0.10633864647780474,
          0.10948609489087875,
          0.10866530612111092,
          0.10337889878652416,
          0.10698517526571567,
          0.10421580176513928,
          0.10437933599146512
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9009664357545928,
            "recall_macro": 0.8986057350560603,
            "f1_macro": 0.8992027241622056,
            "precision_micro": 0.8995419847328244,
            "recall_micro": 0.8995419847328244,
            "f1_micro": 0.8995419847328244,
            "accuracy": 0.8995419847328244,
            "hamming_loss": 0.10045801526717557,
            "no_defect_precision": 0.8838782412626832,
            "no_defect_recall": 0.9272619751626257,
            "no_defect_f1": 0.9050505050505051,
            "no_defect_tp": 1568,
            "no_defect_fp": 206,
            "no_defect_tn": 1378,
            "no_defect_fn": 123,
            "no_defect_support": 1691,
            "defect_precision": 0.9180546302465024,
            "defect_recall": 0.8699494949494949,
            "defect_f1": 0.893354943273906,
            "defect_tp": 1378,
            "defect_fp": 123,
            "defect_tn": 1568,
            "defect_fn": 206,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9452031034354135,
            "recall_macro": 0.9455946962230226,
            "f1_macro": 0.9453140617932212,
            "precision_micro": 0.9453435114503816,
            "recall_micro": 0.9453435114503816,
            "f1_micro": 0.9453435114503816,
            "accuracy": 0.9453435114503816,
            "hamming_loss": 0.05465648854961832,
            "no_defect_precision": 0.9554216867469879,
            "no_defect_recall": 0.937906564163217,
            "no_defect_f1": 0.9465831095195464,
            "no_defect_tp": 1586,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 105,
            "no_defect_support": 1691,
            "defect_precision": 0.934984520123839,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9440450140668959,
            "defect_tp": 1510,
            "defect_fp": 105,
            "defect_tn": 1586,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9573556605711937,
            "recall_macro": 0.9570664136934095,
            "f1_macro": 0.9571934754080484,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9548387096774194,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9587750294464076,
            "no_defect_tp": 1628,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.9598726114649682,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.9556119213696893,
            "defect_tp": 1507,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.95894860168657,
            "recall_macro": 0.9593598238445962,
            "f1_macro": 0.9590624999999999,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.969258589511754,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.96,
            "no_defect_tp": 1608,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9486386138613861,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.958125,
            "defect_tp": 1533,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9600703484102694,
            "recall_macro": 0.9598474021707315,
            "f1_macro": 0.9599480045232779,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9582843713278496,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9613910993221338,
            "no_defect_tp": 1631,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9618563254926892,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.9585049097244219,
            "defect_tp": 1513,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629103026667623,
            "recall_macro": 0.9632835973573703,
            "f1_macro": 0.9630313758690576,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9717548076923077,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9639344262295082,
            "no_defect_tp": 1617,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9540657976412167,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9621283255086072,
            "defect_tp": 1537,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635257009136577,
            "recall_macro": 0.9638150427993716,
            "f1_macro": 0.9636378683435654,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9700956937799043,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9646149271483794,
            "no_defect_tp": 1622,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9569557080474111,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9626608095387512,
            "defect_tp": 1534,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9639823681103701,
            "recall_macro": 0.9633556514285373,
            "f1_macro": 0.9636031894523449,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9575087310826542,
            "no_defect_recall": 0.9727971614429332,
            "no_defect_f1": 0.9650924024640657,
            "no_defect_tp": 1645,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 46,
            "no_defect_support": 1691,
            "defect_precision": 0.970456005138086,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.962113976440624,
            "defect_tp": 1511,
            "defect_fp": 46,
            "defect_tn": 1645,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626406131858241,
            "recall_macro": 0.9628081524888148,
            "f1_macro": 0.9627153838631098,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.966686496133254,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9638196915776986,
            "no_defect_tp": 1625,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.958594730238394,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.961611076148521,
            "defect_tp": 1528,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623055690253273,
            "recall_macro": 0.9627122048396441,
            "f1_macro": 0.9624225117350067,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9722891566265061,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.963294538943599,
            "no_defect_tp": 1614,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9523219814241486,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9615504845264145,
            "defect_tp": 1538,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610839643403335,
            "recall_macro": 0.9614895256527427,
            "f1_macro": 0.9612004795963077,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9710843373493976,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9621008654133094,
            "no_defect_tp": 1612,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9510835913312693,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.960300093779306,
            "defect_tp": 1536,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.963274732657746,
            "recall_macro": 0.9633795450065409,
            "f1_macro": 0.9633238964692391,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9661721068249258,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9644549763033176,
            "no_defect_tp": 1628,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.960377358490566,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9621928166351607,
            "defect_tp": 1527,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623018226607968,
            "recall_macro": 0.9626922313017818,
            "f1_macro": 0.9624214320370621,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9717208182912154,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9633164330450343,
            "no_defect_tp": 1615,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9528828270303782,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9615264310290897,
            "defect_tp": 1537,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9632423076750841,
            "recall_macro": 0.9634394656201279,
            "f1_macro": 0.9633279211690275,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9678379988088148,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9643916913946587,
            "no_defect_tp": 1625,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9586466165413534,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9622641509433962,
            "defect_tp": 1530,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626232253644427,
            "recall_macro": 0.9628480995645395,
            "f1_macro": 0.9627180279213092,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9677996422182469,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9637767220902613,
            "no_defect_tp": 1623,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9574468085106383,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.961659333752357,
            "defect_tp": 1530,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 54,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9664157019433615,
            "recall_macro": 0.966429609750643,
            "f1_macro": 0.9664212149042246,
            "precision_micro": 0.9664224664224664,
            "recall_micro": 0.9664224664224664,
            "f1_micro": 0.9664224664224664,
            "accuracy": 0.9664224664224664,
            "hamming_loss": 0.033577533577533576,
            "no_defect_precision": 0.9678007290400972,
            "no_defect_recall": 0.9654545454545455,
            "no_defect_f1": 0.966626213592233,
            "no_defect_tp": 1593,
            "no_defect_fp": 53,
            "no_defect_tn": 1573,
            "no_defect_fn": 57,
            "no_defect_support": 1650,
            "defect_precision": 0.9650306748466257,
            "defect_recall": 0.9674046740467405,
            "defect_f1": 0.9662162162162162,
            "defect_tp": 1573,
            "defect_fp": 57,
            "defect_tn": 1593,
            "defect_fn": 53,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.001_s40_20251207_191527",
    "lr": 0.005,
    "weight_decay": 0.001,
    "seed": 40,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9648514015716522,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.001_s40_20251207_191527",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s40_20251207_191527",
      "timestamp": "2025-12-07T19:17:22.139102",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.001_s40",
          "seed": 40,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s40_20251207_191527"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.964809406603973,
        "recall_macro": 0.9648979072212367,
        "f1_macro": 0.9648514015716522,
        "precision_micro": 0.9648854961832061,
        "recall_micro": 0.9648854961832061,
        "f1_micro": 0.9648854961832061,
        "accuracy": 0.9648854961832061,
        "hamming_loss": 0.035114503816793895,
        "no_defect_precision": 0.9673784104389087,
        "no_defect_recall": 0.9645180366646955,
        "no_defect_f1": 0.9659461060112526,
        "no_defect_tp": 1631,
        "no_defect_fp": 55,
        "no_defect_tn": 1529,
        "no_defect_fn": 60,
        "no_defect_support": 1691,
        "defect_precision": 0.9622404027690371,
        "defect_recall": 0.9652777777777778,
        "defect_f1": 0.9637566971320517,
        "defect_tp": 1529,
        "defect_fp": 60,
        "defect_tn": 1631,
        "defect_fn": 55,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9682702630166398,
        "recall_macro": 0.9682388460248239,
        "f1_macro": 0.9682513058092999,
        "precision_micro": 0.9682539682539683,
        "recall_micro": 0.9682539682539683,
        "f1_micro": 0.9682539682539683,
        "accuracy": 0.9682539682539683,
        "hamming_loss": 0.031746031746031744,
        "no_defect_precision": 0.9667874396135265,
        "no_defect_recall": 0.9703030303030303,
        "no_defect_f1": 0.9685420447670902,
        "no_defect_tp": 1601,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 49,
        "no_defect_support": 1650,
        "defect_precision": 0.9697530864197531,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.9679605668515096,
        "defect_tp": 1571,
        "defect_fp": 49,
        "defect_tn": 1601,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4627812372590707,
          0.2576836611935284,
          0.19874934125769586,
          0.1843535819998845,
          0.17160354707405656,
          0.17498730391139267,
          0.17026151640332893,
          0.17074534113062975,
          0.1703784746979071,
          0.1647751195722544,
          0.17009042580631487,
          0.16082368594707305,
          0.16432075838414195,
          0.16814155653742566,
          0.16659504192331845
        ],
        "val_loss": [
          0.36869116585988265,
          0.19669274240732193,
          0.1409916373399588,
          0.12587855154505143,
          0.12427089270204306,
          0.10853507577513273,
          0.11408065689297822,
          0.10711873243921079,
          0.10471450164914131,
          0.11090021995970836,
          0.10227634521344534,
          0.10350189107255293,
          0.10161288691541323,
          0.10144493291870905,
          0.10202209780422541
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8948058773742025,
            "recall_macro": 0.8886966202533915,
            "f1_macro": 0.8896647115422784,
            "precision_micro": 0.890381679389313,
            "recall_micro": 0.890381679389313,
            "f1_micro": 0.890381679389313,
            "accuracy": 0.890381679389313,
            "hamming_loss": 0.10961832061068702,
            "no_defect_precision": 0.8603896103896104,
            "no_defect_recall": 0.9402720283855707,
            "no_defect_f1": 0.8985589149477253,
            "no_defect_tp": 1590,
            "no_defect_fp": 258,
            "no_defect_tn": 1326,
            "no_defect_fn": 101,
            "no_defect_support": 1691,
            "defect_precision": 0.9292221443587947,
            "defect_recall": 0.8371212121212122,
            "defect_f1": 0.8807705081368317,
            "defect_tp": 1326,
            "defect_fp": 101,
            "defect_tn": 1590,
            "defect_fn": 258,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.944691290250639,
            "recall_macro": 0.9451631184703331,
            "f1_macro": 0.944715484914982,
            "precision_micro": 0.944732824427481,
            "recall_micro": 0.944732824427481,
            "f1_micro": 0.944732824427481,
            "accuracy": 0.944732824427481,
            "hamming_loss": 0.05526717557251908,
            "no_defect_precision": 0.9598051157125457,
            "no_defect_recall": 0.9319929036073329,
            "no_defect_f1": 0.9456945694569457,
            "no_defect_tp": 1576,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 115,
            "no_defect_support": 1691,
            "defect_precision": 0.9295774647887324,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9437364003730183,
            "defect_tp": 1518,
            "defect_fp": 115,
            "defect_tn": 1576,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9545002882765543,
            "recall_macro": 0.9544052664432616,
            "f1_macro": 0.9544505450859562,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9545990566037735,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9560082669028639,
            "no_defect_tp": 1619,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.954401519949335,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.9528928232690483,
            "defect_tp": 1507,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9565016234190227,
            "recall_macro": 0.9567746507057566,
            "f1_macro": 0.9566091767415856,
            "precision_micro": 0.9566412213740458,
            "recall_micro": 0.9566412213740458,
            "f1_micro": 0.9566412213740458,
            "accuracy": 0.9566412213740458,
            "hamming_loss": 0.0433587786259542,
            "no_defect_precision": 0.962940824865511,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9577883472057075,
            "no_defect_tp": 1611,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9500624219725343,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9554300062774639,
            "defect_tp": 1522,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9560788711509645,
            "recall_macro": 0.956562781869553,
            "f1_macro": 0.9560206893001583,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9736680955296999,
            "no_defect_recall": 0.9402720283855707,
            "no_defect_f1": 0.9566787003610109,
            "no_defect_tp": 1590,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 101,
            "no_defect_support": 1691,
            "defect_precision": 0.938489646772229,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9553626782393057,
            "defect_tp": 1541,
            "defect_fp": 101,
            "defect_tn": 1590,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9624929971988796,
            "recall_macro": 0.962312734082397,
            "f1_macro": 0.9623955708689809,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9611764705882353,
            "no_defect_recall": 0.9662921348314607,
            "no_defect_f1": 0.9637275140076673,
            "no_defect_tp": 1634,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 57,
            "no_defect_support": 1691,
            "defect_precision": 0.9638095238095238,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9610636277302944,
            "defect_tp": 1518,
            "defect_fp": 57,
            "defect_tn": 1634,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9611355851797041,
            "recall_macro": 0.9616093668799168,
            "f1_macro": 0.9612065592510173,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9745145631067961,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9619646600778676,
            "no_defect_tp": 1606,
            "no_defect_fp": 42,
            "no_defect_tn": 1542,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9477566072526121,
            "defect_recall": 0.9734848484848485,
            "defect_f1": 0.9604484584241669,
            "defect_tp": 1542,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 42,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9641334154121664,
            "recall_macro": 0.9644463559306847,
            "f1_macro": 0.9642501573720808,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.9712574850299401,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9651889318655162,
            "no_defect_tp": 1622,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9570093457943926,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9633113828786454,
            "defect_tp": 1536,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635362793870275,
            "recall_macro": 0.9637750957236468,
            "f1_macro": 0.9636354254638893,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9689737470167065,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9646569646569647,
            "no_defect_tp": 1624,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9580988117573483,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9626138862708137,
            "defect_tp": 1532,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9611235431235432,
            "recall_macro": 0.9615893933420545,
            "f1_macro": 0.9612056184766934,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.973939393939394,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.961987428913499,
            "no_defect_tp": 1607,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9483076923076923,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9604238080398878,
            "defect_tp": 1541,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644620069876502,
            "recall_macro": 0.9640468851734375,
            "f1_macro": 0.9642218505774505,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.960233918128655,
            "no_defect_recall": 0.9710230632761679,
            "no_defect_f1": 0.9655983534254631,
            "no_defect_tp": 1642,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 49,
            "no_defect_support": 1691,
            "defect_precision": 0.9686900958466453,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9628453477294379,
            "defect_tp": 1516,
            "defect_fp": 49,
            "defect_tn": 1642,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635257009136577,
            "recall_macro": 0.9638150427993716,
            "f1_macro": 0.9636378683435654,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9700956937799043,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9646149271483794,
            "no_defect_tp": 1622,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9569557080474111,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9626608095387512,
            "defect_tp": 1534,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.964809406603973,
            "recall_macro": 0.9648979072212367,
            "f1_macro": 0.9648514015716522,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9673784104389087,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9659461060112526,
            "no_defect_tp": 1631,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9622404027690371,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9637566971320517,
            "defect_tp": 1529,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9639145662498311,
            "recall_macro": 0.963950937524267,
            "f1_macro": 0.9639323913165214,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9656601539372409,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9650887573964497,
            "no_defect_tp": 1631,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9621689785624212,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9627760252365931,
            "defect_tp": 1526,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644848574422917,
            "recall_macro": 0.9646221977313048,
            "f1_macro": 0.9645477566634166,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9679144385026738,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.965619442797866,
            "no_defect_tp": 1629,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9610552763819096,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9634760705289672,
            "defect_tp": 1530,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 54,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9682702630166398,
            "recall_macro": 0.9682388460248239,
            "f1_macro": 0.9682513058092999,
            "precision_micro": 0.9682539682539683,
            "recall_micro": 0.9682539682539683,
            "f1_micro": 0.9682539682539683,
            "accuracy": 0.9682539682539683,
            "hamming_loss": 0.031746031746031744,
            "no_defect_precision": 0.9667874396135265,
            "no_defect_recall": 0.9703030303030303,
            "no_defect_f1": 0.9685420447670902,
            "no_defect_tp": 1601,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 49,
            "no_defect_support": 1650,
            "defect_precision": 0.9697530864197531,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.9679605668515096,
            "defect_tp": 1571,
            "defect_fp": 49,
            "defect_tn": 1601,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.001_s50_20251207_145156",
    "lr": 0.005,
    "weight_decay": 0.001,
    "seed": 50,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9639440211919027,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.001_s50_20251207_145156",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s50_20251207_145156",
      "timestamp": "2025-12-07T14:53:48.415226",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.001_s50",
          "seed": 50,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s50_20251207_145156"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9638293927061461,
        "recall_macro": 0.9641306993650282,
        "f1_macro": 0.9639440211919027,
        "precision_micro": 0.963969465648855,
        "recall_micro": 0.963969465648855,
        "f1_micro": 0.963969465648855,
        "accuracy": 0.963969465648855,
        "hamming_loss": 0.03603053435114504,
        "no_defect_precision": 0.9706762417713943,
        "no_defect_recall": 0.9591957421643997,
        "no_defect_f1": 0.9649018441403926,
        "no_defect_tp": 1622,
        "no_defect_fp": 49,
        "no_defect_tn": 1535,
        "no_defect_fn": 69,
        "no_defect_support": 1691,
        "defect_precision": 0.9569825436408977,
        "defect_recall": 0.9690656565656566,
        "defect_f1": 0.9629861982434128,
        "defect_tp": 1535,
        "defect_fp": 69,
        "defect_tn": 1622,
        "defect_fn": 49,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9679544166043256,
        "recall_macro": 0.967940288493794,
        "f1_macro": 0.967946540666883,
        "precision_micro": 0.967948717948718,
        "recall_micro": 0.967948717948718,
        "f1_micro": 0.967948717948718,
        "accuracy": 0.967948717948718,
        "hamming_loss": 0.03205128205128205,
        "no_defect_precision": 0.9673321234119783,
        "no_defect_recall": 0.9690909090909091,
        "no_defect_f1": 0.9682107175295186,
        "no_defect_tp": 1599,
        "no_defect_fp": 54,
        "no_defect_tn": 1572,
        "no_defect_fn": 51,
        "no_defect_support": 1650,
        "defect_precision": 0.9685767097966729,
        "defect_recall": 0.966789667896679,
        "defect_f1": 0.9676823638042474,
        "defect_tp": 1572,
        "defect_fp": 51,
        "defect_tn": 1599,
        "defect_fn": 54,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4610718383948673,
          0.2543906718492508,
          0.1990664576386807,
          0.18515664039795368,
          0.1734187862676058,
          0.17721811822268754,
          0.1762847242619702,
          0.16918977664853738,
          0.1727218765095188,
          0.17273259755208403,
          0.17283405653477713,
          0.16685794524567896,
          0.16490015735124944,
          0.1633753315954777,
          0.16721127369289118
        ],
        "val_loss": [
          0.3641009989839334,
          0.19272703505479372,
          0.1508951446471306,
          0.13680657902016088,
          0.11679583415389061,
          0.11588226509495424,
          0.10985278531622428,
          0.10412260782546721,
          0.10758842764279017,
          0.10274777590082242,
          0.11199414608283685,
          0.10363317109071292,
          0.10396385114066876,
          0.10240345347959262,
          0.10225702553557661
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8991075742706486,
            "recall_macro": 0.8971872405306764,
            "f1_macro": 0.8977096920920058,
            "precision_micro": 0.8980152671755726,
            "recall_micro": 0.8980152671755726,
            "f1_micro": 0.8980152671755726,
            "accuracy": 0.8980152671755726,
            "hamming_loss": 0.10198473282442748,
            "no_defect_precision": 0.8848553601815088,
            "no_defect_recall": 0.9225310467179184,
            "no_defect_f1": 0.903300521134916,
            "no_defect_tp": 1560,
            "no_defect_fp": 203,
            "no_defect_tn": 1381,
            "no_defect_fn": 131,
            "no_defect_support": 1691,
            "defect_precision": 0.9133597883597884,
            "defect_recall": 0.8718434343434344,
            "defect_f1": 0.8921188630490956,
            "defect_tp": 1381,
            "defect_fp": 131,
            "defect_tn": 1560,
            "defect_fn": 203,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9440910387134585,
            "recall_macro": 0.943021656541763,
            "f1_macro": 0.943392700729927,
            "precision_micro": 0.9435114503816794,
            "recall_micro": 0.9435114503816794,
            "f1_micro": 0.9435114503816794,
            "accuracy": 0.9435114503816794,
            "hamming_loss": 0.05648854961832061,
            "no_defect_precision": 0.9342560553633218,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.945985401459854,
            "no_defect_tp": 1620,
            "no_defect_fp": 114,
            "no_defect_tn": 1470,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9539260220635951,
            "defect_recall": 0.928030303030303,
            "defect_f1": 0.9408,
            "defect_tp": 1470,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 114,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9518040297070247,
            "recall_macro": 0.9522834047153976,
            "f1_macro": 0.951744922982118,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.9693815064298836,
            "no_defect_recall": 0.9361324659964518,
            "no_defect_f1": 0.9524669073405535,
            "no_defect_tp": 1583,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 108,
            "no_defect_support": 1691,
            "defect_precision": 0.9342265529841657,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9510229386236826,
            "defect_tp": 1534,
            "defect_fp": 108,
            "defect_tn": 1583,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9511319520288376,
            "recall_macro": 0.9515361703970515,
            "f1_macro": 0.9508350007613338,
            "precision_micro": 0.9508396946564885,
            "recall_micro": 0.9508396946564885,
            "f1_micro": 0.9508396946564885,
            "accuracy": 0.9508396946564885,
            "hamming_loss": 0.04916030534351145,
            "no_defect_precision": 0.9733910891089109,
            "no_defect_recall": 0.9302188054405677,
            "no_defect_f1": 0.9513153915935894,
            "no_defect_tp": 1573,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 118,
            "no_defect_support": 1691,
            "defect_precision": 0.9288728149487643,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.950354609929078,
            "defect_tp": 1541,
            "defect_fp": 118,
            "defect_tn": 1573,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9580121964082535,
            "recall_macro": 0.9571623613425801,
            "f1_macro": 0.9574773099448963,
            "precision_micro": 0.9575572519083969,
            "recall_micro": 0.9575572519083969,
            "f1_micro": 0.9575572519083969,
            "accuracy": 0.9575572519083969,
            "hamming_loss": 0.042442748091603054,
            "no_defect_precision": 0.9495944380069525,
            "no_defect_recall": 0.9692489651094027,
            "no_defect_f1": 0.9593210418495757,
            "no_defect_tp": 1639,
            "no_defect_fp": 87,
            "no_defect_tn": 1497,
            "no_defect_fn": 52,
            "no_defect_support": 1691,
            "defect_precision": 0.9664299548095545,
            "defect_recall": 0.9450757575757576,
            "defect_f1": 0.9556335780402171,
            "defect_tp": 1497,
            "defect_fp": 52,
            "defect_tn": 1639,
            "defect_fn": 87,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9614474757917381,
            "recall_macro": 0.9619250234455734,
            "f1_macro": 0.9615124753116495,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9751062537947783,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9622528460155781,
            "no_defect_tp": 1606,
            "no_defect_fp": 41,
            "no_defect_tn": 1543,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9477886977886978,
            "defect_recall": 0.9741161616161617,
            "defect_f1": 0.960772104607721,
            "defect_tp": 1543,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 41,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9607746791011699,
            "recall_macro": 0.9610740013977743,
            "f1_macro": 0.9608884297674877,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9676840215439856,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9619274241522903,
            "no_defect_tp": 1617,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9538653366583542,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9598494353826851,
            "defect_tp": 1530,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638810907612367,
            "recall_macro": 0.9634155720421244,
            "f1_macro": 0.9636085321079244,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9591121495327103,
            "no_defect_recall": 0.9710230632761679,
            "no_defect_f1": 0.9650308551278284,
            "no_defect_tp": 1642,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 49,
            "no_defect_support": 1691,
            "defect_precision": 0.9686500319897633,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9621862090880203,
            "defect_tp": 1514,
            "defect_fp": 49,
            "defect_tn": 1642,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626058843102469,
            "recall_macro": 0.9629879143295761,
            "f1_macro": 0.962726402935094,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9717378232110644,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9636255217650567,
            "no_defect_tp": 1616,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9534739454094293,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9618272841051314,
            "defect_tp": 1537,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9637401643330497,
            "recall_macro": 0.9635154397314363,
            "f1_macro": 0.9636168896051149,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9618096357226792,
            "no_defect_recall": 0.9680662329982259,
            "no_defect_f1": 0.9649277925139994,
            "no_defect_tp": 1637,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 54,
            "no_defect_support": 1691,
            "defect_precision": 0.9656706929434202,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9623059866962306,
            "defect_tp": 1519,
            "defect_fp": 54,
            "defect_tn": 1637,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9587371978521555,
            "recall_macro": 0.9592239291197009,
            "f1_macro": 0.958765693168633,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.9738124238733252,
            "no_defect_recall": 0.9455943228858663,
            "no_defect_f1": 0.9594959495949595,
            "no_defect_tp": 1599,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 92,
            "no_defect_support": 1691,
            "defect_precision": 0.9436619718309859,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9580354367423065,
            "defect_tp": 1541,
            "defect_fp": 92,
            "defect_tn": 1599,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635206582711429,
            "recall_macro": 0.9638549898750963,
            "f1_macro": 0.9636402023441748,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9712230215827338,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9645727895206907,
            "no_defect_tp": 1620,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.955818294959552,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.962707615167659,
            "defect_tp": 1536,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638293927061461,
            "recall_macro": 0.9641306993650282,
            "f1_macro": 0.9639440211919027,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9706762417713943,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9649018441403926,
            "no_defect_tp": 1622,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9569825436408977,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9629861982434128,
            "defect_tp": 1535,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629325844122211,
            "recall_macro": 0.9631437825923337,
            "f1_macro": 0.9630229726460042,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9678188319427891,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9640842980112793,
            "no_defect_tp": 1624,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9580463368816531,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9619616472807293,
            "defect_tp": 1530,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629412972085386,
            "recall_macro": 0.9631238090544714,
            "f1_macro": 0.9630216614539442,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9672619047619048,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9641056066449125,
            "no_defect_tp": 1625,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9586206896551724,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9619377162629758,
            "defect_tp": 1529,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 55,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9679544166043256,
            "recall_macro": 0.967940288493794,
            "f1_macro": 0.967946540666883,
            "precision_micro": 0.967948717948718,
            "recall_micro": 0.967948717948718,
            "f1_micro": 0.967948717948718,
            "accuracy": 0.967948717948718,
            "hamming_loss": 0.03205128205128205,
            "no_defect_precision": 0.9673321234119783,
            "no_defect_recall": 0.9690909090909091,
            "no_defect_f1": 0.9682107175295186,
            "no_defect_tp": 1599,
            "no_defect_fp": 54,
            "no_defect_tn": 1572,
            "no_defect_fn": 51,
            "no_defect_support": 1650,
            "defect_precision": 0.9685767097966729,
            "defect_recall": 0.966789667896679,
            "defect_f1": 0.9676823638042474,
            "defect_tp": 1572,
            "defect_fp": 51,
            "defect_tn": 1599,
            "defect_fn": 54,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.001_s60_20251207_142203",
    "lr": 0.005,
    "weight_decay": 0.001,
    "seed": 60,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9666986674149574,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.001_s60_20251207_142203",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s60_20251207_142203",
      "timestamp": "2025-12-07T14:23:59.200388",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.001_s60",
          "seed": 60,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s60_20251207_142203"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9665775889788369,
        "recall_macro": 0.9669716084559372,
        "f1_macro": 0.9666986674149574,
        "precision_micro": 0.9667175572519084,
        "recall_micro": 0.9667175572519084,
        "f1_micro": 0.9667175572519084,
        "accuracy": 0.9667175572519084,
        "hamming_loss": 0.033282442748091605,
        "no_defect_precision": 0.9759326113116726,
        "no_defect_recall": 0.9591957421643997,
        "no_defect_f1": 0.967491798389502,
        "no_defect_tp": 1622,
        "no_defect_fp": 40,
        "no_defect_tn": 1544,
        "no_defect_fn": 69,
        "no_defect_support": 1691,
        "defect_precision": 0.9572225666460012,
        "defect_recall": 0.9747474747474747,
        "defect_f1": 0.9659055364404129,
        "defect_tp": 1544,
        "defect_fp": 69,
        "defect_tn": 1622,
        "defect_fn": 40,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9664157019433615,
        "recall_macro": 0.966429609750643,
        "f1_macro": 0.9664212149042246,
        "precision_micro": 0.9664224664224664,
        "recall_micro": 0.9664224664224664,
        "f1_micro": 0.9664224664224664,
        "accuracy": 0.9664224664224664,
        "hamming_loss": 0.033577533577533576,
        "no_defect_precision": 0.9678007290400972,
        "no_defect_recall": 0.9654545454545455,
        "no_defect_f1": 0.966626213592233,
        "no_defect_tp": 1593,
        "no_defect_fp": 53,
        "no_defect_tn": 1573,
        "no_defect_fn": 57,
        "no_defect_support": 1650,
        "defect_precision": 0.9650306748466257,
        "defect_recall": 0.9674046740467405,
        "defect_f1": 0.9662162162162162,
        "defect_tp": 1573,
        "defect_fp": 57,
        "defect_tn": 1593,
        "defect_fn": 53,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.46703052408525636,
          0.261895531578044,
          0.19480051826607733,
          0.17744555816864868,
          0.17432884597628684,
          0.17314047924394887,
          0.1718272101991346,
          0.16880582486548185,
          0.17288766051623114,
          0.16922296244635493,
          0.17426725785602584,
          0.16444252049511446,
          0.16693546785096244,
          0.1675234157981733,
          0.16683869135554366
        ],
        "val_loss": [
          0.3689696565270424,
          0.1948561229957984,
          0.14241358666465834,
          0.12830353105584016,
          0.12053604244899291,
          0.11105994686770898,
          0.10472993903721754,
          0.10462933406233788,
          0.10414837257793316,
          0.10747610877912778,
          0.1040282749499266,
          0.1048056363271406,
          0.1029861685103522,
          0.10234970667471106,
          0.10314224753528833
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8990374749982524,
            "recall_macro": 0.8963961390964643,
            "f1_macro": 0.8970320065396467,
            "precision_micro": 0.8974045801526718,
            "recall_micro": 0.8974045801526718,
            "f1_micro": 0.8974045801526718,
            "accuracy": 0.8974045801526718,
            "hamming_loss": 0.10259541984732824,
            "no_defect_precision": 0.8804042672655812,
            "no_defect_recall": 0.9272619751626257,
            "no_defect_f1": 0.9032258064516129,
            "no_defect_tp": 1568,
            "no_defect_fp": 213,
            "no_defect_tn": 1371,
            "no_defect_fn": 123,
            "no_defect_support": 1691,
            "defect_precision": 0.9176706827309237,
            "defect_recall": 0.865530303030303,
            "defect_f1": 0.8908382066276803,
            "defect_tp": 1371,
            "defect_fp": 123,
            "defect_tn": 1568,
            "defect_fn": 213,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9445895896904339,
            "recall_macro": 0.9448435418645353,
            "f1_macro": 0.9446910550710168,
            "precision_micro": 0.944732824427481,
            "recall_micro": 0.944732824427481,
            "f1_micro": 0.944732824427481,
            "accuracy": 0.944732824427481,
            "hamming_loss": 0.05526717557251908,
            "no_defect_precision": 0.951015531660693,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9462109955423477,
            "no_defect_tp": 1592,
            "no_defect_fp": 82,
            "no_defect_tn": 1502,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.9381636477201749,
            "defect_recall": 0.9482323232323232,
            "defect_f1": 0.9431711145996861,
            "defect_tp": 1502,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 82,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555929571137092,
            "recall_macro": 0.9558276810087869,
            "f1_macro": 0.9556902243047389,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.961217183770883,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9569349569349569,
            "no_defect_tp": 1611,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9499687304565353,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9544454916745209,
            "defect_tp": 1519,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.957106485367355,
            "recall_macro": 0.9574658844506567,
            "f1_macro": 0.9572257428447111,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9657657657657658,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9582836710369488,
            "no_defect_tp": 1608,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9484472049689441,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9561678146524734,
            "defect_tp": 1527,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9605021415815926,
            "recall_macro": 0.9609580802107414,
            "f1_macro": 0.9605936982936575,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9727602905569007,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.961411905474125,
            "no_defect_tp": 1607,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9482439926062847,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9597754911131899,
            "defect_tp": 1539,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.959770643608377,
            "recall_macro": 0.9590363271986572,
            "f1_macro": 0.9593170779728841,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9523809523809523,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.9610313507178435,
            "no_defect_tp": 1640,
            "no_defect_fp": 82,
            "no_defect_tn": 1502,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.9671603348358017,
            "defect_recall": 0.9482323232323232,
            "defect_f1": 0.9576028052279247,
            "defect_tp": 1502,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 82,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9648952346242547,
            "recall_macro": 0.9647980395319249,
            "f1_macro": 0.9648443804354695,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.964622641509434,
            "no_defect_recall": 0.9674748669426375,
            "no_defect_f1": 0.9660466489518749,
            "no_defect_tp": 1636,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 55,
            "no_defect_support": 1691,
            "defect_precision": 0.9651678277390754,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9636421119190641,
            "defect_tp": 1524,
            "defect_fp": 55,
            "defect_tn": 1636,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.963251731470707,
            "recall_macro": 0.9634194920822656,
            "f1_macro": 0.9633266070784687,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9672813801308745,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9644128113879004,
            "no_defect_tp": 1626,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9592220828105396,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9622404027690371,
            "defect_tp": 1529,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962758664304644,
            "recall_macro": 0.9616775009109426,
            "f1_macro": 0.9620588701335199,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9521061742642816,
            "no_defect_recall": 0.9757539917208752,
            "no_defect_f1": 0.9637850467289719,
            "no_defect_tp": 1650,
            "no_defect_fp": 83,
            "no_defect_tn": 1501,
            "no_defect_fn": 41,
            "no_defect_support": 1691,
            "defect_precision": 0.9734111543450065,
            "defect_recall": 0.94760101010101,
            "defect_f1": 0.9603326935380678,
            "defect_tp": 1501,
            "defect_fp": 41,
            "defect_tn": 1650,
            "defect_fn": 83,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9650778802953641,
            "recall_macro": 0.965533140392691,
            "f1_macro": 0.9651753813871717,
            "precision_micro": 0.9651908396946565,
            "recall_micro": 0.9651908396946565,
            "f1_micro": 0.9651908396946565,
            "accuracy": 0.9651908396946565,
            "hamming_loss": 0.03480916030534351,
            "no_defect_precision": 0.9770114942528736,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9659090909090909,
            "no_defect_tp": 1615,
            "no_defect_fp": 38,
            "no_defect_tn": 1546,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9531442663378545,
            "defect_recall": 0.976010101010101,
            "defect_f1": 0.9644416718652526,
            "defect_tp": 1546,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 38,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9650476563520042,
            "recall_macro": 0.9654132991655168,
            "f1_macro": 0.9651695334592647,
            "precision_micro": 0.9651908396946565,
            "recall_micro": 0.9651908396946565,
            "f1_micro": 0.9651908396946565,
            "accuracy": 0.9651908396946565,
            "hamming_loss": 0.03480916030534351,
            "no_defect_precision": 0.9735735735735735,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.966030989272944,
            "no_defect_tp": 1621,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9565217391304348,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9643080776455855,
            "defect_tp": 1540,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9665775889788369,
            "recall_macro": 0.9669716084559372,
            "f1_macro": 0.9666986674149574,
            "precision_micro": 0.9667175572519084,
            "recall_micro": 0.9667175572519084,
            "f1_micro": 0.9667175572519084,
            "accuracy": 0.9667175572519084,
            "hamming_loss": 0.033282442748091605,
            "no_defect_precision": 0.9759326113116726,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.967491798389502,
            "no_defect_tp": 1622,
            "no_defect_fp": 40,
            "no_defect_tn": 1544,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9572225666460012,
            "defect_recall": 0.9747474747474747,
            "defect_f1": 0.9659055364404129,
            "defect_tp": 1544,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 40,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644442877365635,
            "recall_macro": 0.9647220654206166,
            "f1_macro": 0.9645539753663658,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9707112970711297,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9655172413793104,
            "no_defect_tp": 1624,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9581772784019975,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9635907093534212,
            "defect_tp": 1535,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9653693537577931,
            "recall_macro": 0.9656091145039991,
            "f1_macro": 0.965468933423693,
            "precision_micro": 0.9654961832061069,
            "recall_micro": 0.9654961832061069,
            "f1_micro": 0.9654961832061069,
            "accuracy": 0.9654961832061069,
            "hamming_loss": 0.03450381679389313,
            "no_defect_precision": 0.970763723150358,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9664389664389664,
            "no_defect_tp": 1627,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.9599749843652282,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9644989004084197,
            "defect_tp": 1535,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9647522792281109,
            "recall_macro": 0.9650177484484108,
            "f1_macro": 0.9648589576418063,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9707287933094385,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9658246656760773,
            "no_defect_tp": 1625,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9587757651467833,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9638932496075353,
            "defect_tp": 1535,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 49,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9664157019433615,
            "recall_macro": 0.966429609750643,
            "f1_macro": 0.9664212149042246,
            "precision_micro": 0.9664224664224664,
            "recall_micro": 0.9664224664224664,
            "f1_micro": 0.9664224664224664,
            "accuracy": 0.9664224664224664,
            "hamming_loss": 0.033577533577533576,
            "no_defect_precision": 0.9678007290400972,
            "no_defect_recall": 0.9654545454545455,
            "no_defect_f1": 0.966626213592233,
            "no_defect_tp": 1593,
            "no_defect_fp": 53,
            "no_defect_tn": 1573,
            "no_defect_fn": 57,
            "no_defect_support": 1650,
            "defect_precision": 0.9650306748466257,
            "defect_recall": 0.9674046740467405,
            "defect_f1": 0.9662162162162162,
            "defect_tp": 1573,
            "defect_fp": 57,
            "defect_tn": 1593,
            "defect_fn": 53,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.001_s70_20251207_143957",
    "lr": 0.005,
    "weight_decay": 0.001,
    "seed": 70,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9648514015716522,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.001_s70_20251207_143957",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s70_20251207_143957",
      "timestamp": "2025-12-07T14:41:54.640308",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.001_s70",
          "seed": 70,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s70_20251207_143957"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.964809406603973,
        "recall_macro": 0.9648979072212367,
        "f1_macro": 0.9648514015716522,
        "precision_micro": 0.9648854961832061,
        "recall_micro": 0.9648854961832061,
        "f1_micro": 0.9648854961832061,
        "accuracy": 0.9648854961832061,
        "hamming_loss": 0.035114503816793895,
        "no_defect_precision": 0.9673784104389087,
        "no_defect_recall": 0.9645180366646955,
        "no_defect_f1": 0.9659461060112526,
        "no_defect_tp": 1631,
        "no_defect_fp": 55,
        "no_defect_tn": 1529,
        "no_defect_fn": 60,
        "no_defect_support": 1691,
        "defect_precision": 0.9622404027690371,
        "defect_recall": 0.9652777777777778,
        "defect_f1": 0.9637566971320517,
        "defect_tp": 1529,
        "defect_fp": 60,
        "defect_tn": 1631,
        "defect_fn": 55,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9667205865087337,
        "recall_macro": 0.9667371128256737,
        "f1_macro": 0.9667265975047091,
        "precision_micro": 0.9667277167277167,
        "recall_micro": 0.9667277167277167,
        "f1_micro": 0.9667277167277167,
        "accuracy": 0.9667277167277167,
        "hamming_loss": 0.03327228327228327,
        "no_defect_precision": 0.9683890577507599,
        "no_defect_recall": 0.9654545454545455,
        "no_defect_f1": 0.9669195751138088,
        "no_defect_tp": 1593,
        "no_defect_fp": 52,
        "no_defect_tn": 1574,
        "no_defect_fn": 57,
        "no_defect_support": 1650,
        "defect_precision": 0.9650521152667075,
        "defect_recall": 0.968019680196802,
        "defect_f1": 0.9665336198956095,
        "defect_tp": 1574,
        "defect_fp": 57,
        "defect_tn": 1593,
        "defect_fn": 52,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.46526128889127755,
          0.25167515627634574,
          0.19842500046332012,
          0.1785122563587073,
          0.1752212945699193,
          0.17794718135101525,
          0.16806771395782547,
          0.1717527523387426,
          0.1787748033625062,
          0.1724659946735434,
          0.16493395600608204,
          0.16870935052383892,
          0.17106010596497787,
          0.1599645029488468,
          0.16537009519388488
        ],
        "val_loss": [
          0.3688775948607005,
          0.19148127706005022,
          0.15004106439076936,
          0.12504625413566828,
          0.11798613102963337,
          0.11184178536327985,
          0.10945010034797284,
          0.10697426510831484,
          0.11532312717575294,
          0.10347250469315511,
          0.10130669301948868,
          0.10163683250833017,
          0.1037450534506486,
          0.10340836619098599,
          0.10356460880631438
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8945480653123625,
            "recall_macro": 0.8869385755843473,
            "f1_macro": 0.8879948015907915,
            "precision_micro": 0.888854961832061,
            "recall_micro": 0.888854961832061,
            "f1_micro": 0.888854961832061,
            "accuracy": 0.888854961832061,
            "hamming_loss": 0.11114503816793893,
            "no_defect_precision": 0.8546231961517905,
            "no_defect_recall": 0.9455943228858663,
            "no_defect_f1": 0.8978102189781022,
            "no_defect_tp": 1599,
            "no_defect_fp": 272,
            "no_defect_tn": 1312,
            "no_defect_fn": 92,
            "no_defect_support": 1691,
            "defect_precision": 0.9344729344729344,
            "defect_recall": 0.8282828282828283,
            "defect_f1": 0.8781793842034806,
            "defect_tp": 1312,
            "defect_fp": 92,
            "defect_tn": 1599,
            "defect_fn": 272,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9460495558672277,
            "recall_macro": 0.9452512260392213,
            "f1_macro": 0.9455479226852426,
            "precision_micro": 0.945648854961832,
            "recall_micro": 0.945648854961832,
            "f1_micro": 0.945648854961832,
            "accuracy": 0.945648854961832,
            "hamming_loss": 0.05435114503816794,
            "no_defect_precision": 0.9385507246376812,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9478922716627635,
            "no_defect_tp": 1619,
            "no_defect_fp": 106,
            "no_defect_tn": 1478,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9535483870967741,
            "defect_recall": 0.9330808080808081,
            "defect_f1": 0.9432035737077218,
            "defect_tp": 1478,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 106,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9525734265734266,
            "recall_macro": 0.9530306390337437,
            "f1_macro": 0.9526525264873029,
            "precision_micro": 0.9526717557251908,
            "recall_micro": 0.9526717557251908,
            "f1_micro": 0.9526717557251908,
            "accuracy": 0.9526717557251908,
            "hamming_loss": 0.04732824427480916,
            "no_defect_precision": 0.9654545454545455,
            "no_defect_recall": 0.9420461265523359,
            "no_defect_f1": 0.9536067045794673,
            "no_defect_tp": 1593,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 98,
            "no_defect_support": 1691,
            "defect_precision": 0.9396923076923077,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9516983483951387,
            "defect_tp": 1527,
            "defect_fp": 98,
            "defect_tn": 1593,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9586971744503843,
            "recall_macro": 0.9587845112867289,
            "f1_macro": 0.9587386018449829,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.961447212336892,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9600236896653834,
            "no_defect_tp": 1621,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9559471365638766,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9574535140245825,
            "defect_tp": 1519,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9568230205332396,
            "recall_macro": 0.9554842108249855,
            "f1_macro": 0.9559292535559374,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9442848937392303,
            "no_defect_recall": 0.9722057953873448,
            "no_defect_f1": 0.958041958041958,
            "no_defect_tp": 1644,
            "no_defect_fp": 97,
            "no_defect_tn": 1487,
            "no_defect_fn": 47,
            "no_defect_support": 1691,
            "defect_precision": 0.969361147327249,
            "defect_recall": 0.9387626262626263,
            "defect_f1": 0.9538165490699166,
            "defect_tp": 1487,
            "defect_fp": 47,
            "defect_tn": 1644,
            "defect_fn": 97,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604811554357511,
            "recall_macro": 0.960718397756393,
            "f1_macro": 0.960579578864216,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9659904534606205,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9616869616869617,
            "no_defect_tp": 1619,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9549718574108818,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9594721960414703,
            "defect_tp": 1527,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9575383072450521,
            "recall_macro": 0.9574819379483779,
            "f1_macro": 0.9575093164948045,
            "precision_micro": 0.9575572519083969,
            "recall_micro": 0.9575572519083969,
            "f1_micro": 0.9575572519083969,
            "accuracy": 0.9575572519083969,
            "hamming_loss": 0.042442748091603054,
            "no_defect_precision": 0.9580873671782763,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9589364844903988,
            "no_defect_tp": 1623,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.956989247311828,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.9560821484992101,
            "defect_tp": 1513,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9613825005129353,
            "recall_macro": 0.9617452616048121,
            "f1_macro": 0.96150316856024,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.96996996996997,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9624553039332538,
            "no_defect_tp": 1615,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9527950310559006,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.960551033187226,
            "defect_tp": 1534,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9587736806734974,
            "recall_macro": 0.9592638761954255,
            "f1_macro": 0.9587674159580382,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.974969474969475,
            "no_defect_recall": 0.9444115907746895,
            "no_defect_f1": 0.9594472814659056,
            "no_defect_tp": 1597,
            "no_defect_fp": 41,
            "no_defect_tn": 1543,
            "no_defect_fn": 94,
            "no_defect_support": 1691,
            "defect_precision": 0.9425778863775198,
            "defect_recall": 0.9741161616161617,
            "defect_f1": 0.9580875504501708,
            "defect_tp": 1543,
            "defect_fp": 94,
            "defect_tn": 1597,
            "defect_fn": 41,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604883411462046,
            "recall_macro": 0.9606984242185306,
            "f1_macro": 0.9605782105068972,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.965435041716329,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9617097061442564,
            "no_defect_tp": 1620,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9555416405760802,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9594467148695379,
            "defect_tp": 1526,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9636241309710698,
            "recall_macro": 0.9630799419386055,
            "f1_macro": 0.9633000587199061,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9580174927113703,
            "no_defect_recall": 0.9716144293317563,
            "no_defect_f1": 0.9647680563711099,
            "no_defect_tp": 1643,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 48,
            "no_defect_support": 1691,
            "defect_precision": 0.9692307692307692,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.9618320610687023,
            "defect_tp": 1512,
            "defect_fp": 48,
            "defect_tn": 1643,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.964809406603973,
            "recall_macro": 0.9648979072212367,
            "f1_macro": 0.9648514015716522,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9673784104389087,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9659461060112526,
            "no_defect_tp": 1631,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9622404027690371,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9637566971320517,
            "defect_tp": 1529,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629252545967721,
            "recall_macro": 0.9631637561301961,
            "f1_macro": 0.9630242561439546,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9683770883054893,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9640629640629641,
            "no_defect_tp": 1623,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.957473420888055,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.961985548224945,
            "defect_tp": 1531,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626166044776119,
            "recall_macro": 0.962868073102402,
            "f1_macro": 0.9627193080673719,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9683582089552238,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9637551990493167,
            "no_defect_tp": 1622,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.956875,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9616834170854272,
            "defect_tp": 1531,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629193074519584,
            "recall_macro": 0.9631837296680584,
            "f1_macro": 0.9630255119535527,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9689366786140979,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9640416047548291,
            "no_defect_tp": 1622,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9569019362898189,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9620094191522763,
            "defect_tp": 1532,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 52,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9667205865087337,
            "recall_macro": 0.9667371128256737,
            "f1_macro": 0.9667265975047091,
            "precision_micro": 0.9667277167277167,
            "recall_micro": 0.9667277167277167,
            "f1_micro": 0.9667277167277167,
            "accuracy": 0.9667277167277167,
            "hamming_loss": 0.03327228327228327,
            "no_defect_precision": 0.9683890577507599,
            "no_defect_recall": 0.9654545454545455,
            "no_defect_f1": 0.9669195751138088,
            "no_defect_tp": 1593,
            "no_defect_fp": 52,
            "no_defect_tn": 1574,
            "no_defect_fn": 57,
            "no_defect_support": 1650,
            "defect_precision": 0.9650521152667075,
            "defect_recall": 0.968019680196802,
            "defect_f1": 0.9665336198956095,
            "defect_tp": 1574,
            "defect_fp": 57,
            "defect_tn": 1593,
            "defect_fn": 52,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.001_s80_20251207_154501",
    "lr": 0.005,
    "weight_decay": 0.001,
    "seed": 80,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.964556277056277,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.001_s80_20251207_154501",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s80_20251207_154501",
      "timestamp": "2025-12-07T15:46:53.077569",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.001_s80",
          "seed": 80,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s80_20251207_154501"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9644377696878169,
        "recall_macro": 0.9647620124963413,
        "f1_macro": 0.964556277056277,
        "precision_micro": 0.9645801526717557,
        "recall_micro": 0.9645801526717557,
        "f1_micro": 0.9645801526717557,
        "accuracy": 0.9645801526717557,
        "hamming_loss": 0.035419847328244276,
        "no_defect_precision": 0.9718394248052726,
        "no_defect_recall": 0.9591957421643997,
        "no_defect_f1": 0.9654761904761905,
        "no_defect_tp": 1622,
        "no_defect_fp": 47,
        "no_defect_tn": 1537,
        "no_defect_fn": 69,
        "no_defect_support": 1691,
        "defect_precision": 0.9570361145703612,
        "defect_recall": 0.9703282828282829,
        "defect_f1": 0.9636363636363636,
        "defect_tp": 1537,
        "defect_fp": 69,
        "defect_tn": 1622,
        "defect_fn": 47,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9685557505750257,
        "recall_macro": 0.9685597674158559,
        "f1_macro": 0.9685576687343518,
        "precision_micro": 0.9685592185592186,
        "recall_micro": 0.9685592185592186,
        "f1_micro": 0.9685592185592186,
        "accuracy": 0.9685592185592186,
        "hamming_loss": 0.03144078144078144,
        "no_defect_precision": 0.9690721649484536,
        "no_defect_recall": 0.9684848484848485,
        "no_defect_f1": 0.9687784177023341,
        "no_defect_tp": 1598,
        "no_defect_fp": 51,
        "no_defect_tn": 1575,
        "no_defect_fn": 52,
        "no_defect_support": 1650,
        "defect_precision": 0.968039336201598,
        "defect_recall": 0.9686346863468634,
        "defect_f1": 0.9683369197663695,
        "defect_tp": 1575,
        "defect_fp": 52,
        "defect_tn": 1598,
        "defect_fn": 51,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4596787755958206,
          0.25000282941253615,
          0.19623034681236395,
          0.18575428750475081,
          0.18005123162431697,
          0.17507586844857767,
          0.1719760276595419,
          0.17072351632257884,
          0.16683373260448167,
          0.17034959080765436,
          0.16620571040022322,
          0.161973953667919,
          0.1663068693645579,
          0.1665176615493068,
          0.16179274473043168
        ],
        "val_loss": [
          0.3647124899121431,
          0.19150071476514524,
          0.14400778008768192,
          0.12210177014080378,
          0.12123422038096648,
          0.11444449911896999,
          0.11442803082844386,
          0.11252245801286055,
          0.10731578213520922,
          0.1010795238499458,
          0.10331801550749403,
          0.1052899522563586,
          0.10391264261964422,
          0.10228930044775972,
          0.1023410319780501
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8968844110675837,
            "recall_macro": 0.8964638997903338,
            "f1_macro": 0.8966335181750202,
            "precision_micro": 0.896793893129771,
            "recall_micro": 0.896793893129771,
            "f1_micro": 0.896793893129771,
            "accuracy": 0.896793893129771,
            "hamming_loss": 0.103206106870229,
            "no_defect_precision": 0.8949211908931699,
            "no_defect_recall": 0.9065641632170314,
            "no_defect_f1": 0.900705052878966,
            "no_defect_tp": 1533,
            "no_defect_fp": 180,
            "no_defect_tn": 1404,
            "no_defect_fn": 158,
            "no_defect_support": 1691,
            "defect_precision": 0.8988476312419974,
            "defect_recall": 0.8863636363636364,
            "defect_f1": 0.8925619834710744,
            "defect_tp": 1404,
            "defect_fp": 158,
            "defect_tn": 1533,
            "defect_fn": 180,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9467212900693699,
            "recall_macro": 0.9470331642862689,
            "f1_macro": 0.9468344155844155,
            "precision_micro": 0.9468702290076336,
            "recall_micro": 0.9468702290076336,
            "f1_micro": 0.9468702290076336,
            "accuracy": 0.9468702290076336,
            "hamming_loss": 0.05312977099236641,
            "no_defect_precision": 0.9544637507489515,
            "no_defect_recall": 0.9420461265523359,
            "no_defect_f1": 0.9482142857142857,
            "no_defect_tp": 1593,
            "no_defect_fp": 76,
            "no_defect_tn": 1508,
            "no_defect_fn": 98,
            "no_defect_support": 1691,
            "defect_precision": 0.9389788293897883,
            "defect_recall": 0.952020202020202,
            "defect_f1": 0.9454545454545454,
            "defect_tp": 1508,
            "defect_fp": 98,
            "defect_tn": 1593,
            "defect_fn": 76,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9561975456003581,
            "recall_macro": 0.9565988089051365,
            "f1_macro": 0.9563123510415119,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9662650602409638,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9573261712921516,
            "no_defect_tp": 1604,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9461300309597523,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9552985307908721,
            "defect_tp": 1528,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.961129333498554,
            "recall_macro": 0.9612498431983943,
            "f1_macro": 0.9611851851851851,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9643705463182898,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9623703703703703,
            "no_defect_tp": 1624,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9578881206788183,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.96,
            "defect_tp": 1524,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9599020979020979,
            "recall_macro": 0.960366714155153,
            "f1_macro": 0.9599837481924948,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9727272727272728,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9607901825800659,
            "no_defect_tp": 1605,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.947076923076923,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9591773138049237,
            "defect_tp": 1539,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9613821638657343,
            "recall_macro": 0.9617252880669498,
            "f1_macro": 0.9615019905332121,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9694061187762447,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9624776652769506,
            "no_defect_tp": 1616,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9533582089552238,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9605263157894737,
            "defect_tp": 1533,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9608240336496755,
            "recall_macro": 0.9612937103142603,
            "f1_macro": 0.9609006286492436,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9739235900545785,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9616766467065868,
            "no_defect_tp": 1606,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9477244772447725,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9601246105919004,
            "defect_tp": 1541,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9608508773565554,
            "recall_macro": 0.9613336573899851,
            "f1_macro": 0.9609024665768319,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9750759878419453,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9616306954436451,
            "no_defect_tp": 1604,
            "no_defect_fp": 41,
            "no_defect_tn": 1543,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9466257668711656,
            "defect_recall": 0.9741161616161617,
            "defect_f1": 0.9601742377100186,
            "defect_tp": 1543,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 41,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962325083341601,
            "recall_macro": 0.9627721254532313,
            "f1_macro": 0.9624255822250827,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9740024183796856,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9632286995515695,
            "no_defect_tp": 1611,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9506477483035164,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9616224648985959,
            "defect_tp": 1541,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962708284799503,
            "recall_macro": 0.962708284799503,
            "f1_macro": 0.962708284799503,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9639266706091071,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.9639266706091071,
            "no_defect_tp": 1630,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.961489898989899,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.961489898989899,
            "defect_tp": 1523,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9641547060452293,
            "recall_macro": 0.9643664617792352,
            "f1_macro": 0.964245353715558,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.9690107270560191,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9652715939447908,
            "no_defect_tp": 1626,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9592986850344396,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.963219113486325,
            "defect_tp": 1532,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626058843102469,
            "recall_macro": 0.9629879143295761,
            "f1_macro": 0.962726402935094,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9717378232110644,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9636255217650567,
            "no_defect_tp": 1616,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9534739454094293,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9618272841051314,
            "defect_tp": 1537,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644377696878169,
            "recall_macro": 0.9647620124963413,
            "f1_macro": 0.964556277056277,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9718394248052726,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9654761904761905,
            "no_defect_tp": 1622,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9570361145703612,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9636363636363636,
            "defect_tp": 1537,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629252545967721,
            "recall_macro": 0.9631637561301961,
            "f1_macro": 0.9630242561439546,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9683770883054893,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9640629640629641,
            "no_defect_tp": 1623,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.957473420888055,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.961985548224945,
            "defect_tp": 1531,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629252545967721,
            "recall_macro": 0.9631637561301961,
            "f1_macro": 0.9630242561439546,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9683770883054893,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9640629640629641,
            "no_defect_tp": 1623,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.957473420888055,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.961985548224945,
            "defect_tp": 1531,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 53,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9685557505750257,
            "recall_macro": 0.9685597674158559,
            "f1_macro": 0.9685576687343518,
            "precision_micro": 0.9685592185592186,
            "recall_micro": 0.9685592185592186,
            "f1_micro": 0.9685592185592186,
            "accuracy": 0.9685592185592186,
            "hamming_loss": 0.03144078144078144,
            "no_defect_precision": 0.9690721649484536,
            "no_defect_recall": 0.9684848484848485,
            "no_defect_f1": 0.9687784177023341,
            "no_defect_tp": 1598,
            "no_defect_fp": 51,
            "no_defect_tn": 1575,
            "no_defect_fn": 52,
            "no_defect_support": 1650,
            "defect_precision": 0.968039336201598,
            "defect_recall": 0.9686346863468634,
            "defect_f1": 0.9683369197663695,
            "defect_tp": 1575,
            "defect_fp": 52,
            "defect_tn": 1598,
            "defect_fn": 51,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.001_s90_20251207_200344",
    "lr": 0.005,
    "weight_decay": 0.001,
    "seed": 90,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9630086134785402,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.001_s90_20251207_200344",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s90_20251207_200344",
      "timestamp": "2025-12-07T20:05:35.993339",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.001_s90",
          "seed": 90,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s90_20251207_200344"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9630820100188741,
        "recall_macro": 0.9629440472137101,
        "f1_macro": 0.9630086134785402,
        "precision_micro": 0.9630534351145038,
        "recall_micro": 0.9630534351145038,
        "f1_micro": 0.9630534351145038,
        "accuracy": 0.9630534351145038,
        "hamming_loss": 0.036946564885496185,
        "no_defect_precision": 0.9623085983510011,
        "no_defect_recall": 0.9662921348314607,
        "no_defect_f1": 0.9642962525818826,
        "no_defect_tp": 1634,
        "no_defect_fp": 64,
        "no_defect_tn": 1520,
        "no_defect_fn": 57,
        "no_defect_support": 1691,
        "defect_precision": 0.963855421686747,
        "defect_recall": 0.9595959595959596,
        "defect_f1": 0.9617209743751978,
        "defect_tp": 1520,
        "defect_fp": 57,
        "defect_tn": 1634,
        "defect_fn": 64,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9670291907686803,
        "recall_macro": 0.9670535614447053,
        "f1_macro": 0.9670323649503634,
        "precision_micro": 0.967032967032967,
        "recall_micro": 0.967032967032967,
        "f1_micro": 0.967032967032967,
        "accuracy": 0.967032967032967,
        "hamming_loss": 0.03296703296703297,
        "no_defect_precision": 0.9701219512195122,
        "no_defect_recall": 0.9642424242424242,
        "no_defect_f1": 0.9671732522796352,
        "no_defect_tp": 1591,
        "no_defect_fp": 49,
        "no_defect_tn": 1577,
        "no_defect_fn": 59,
        "no_defect_support": 1650,
        "defect_precision": 0.9639364303178484,
        "defect_recall": 0.9698646986469864,
        "defect_f1": 0.9668914776210914,
        "defect_tp": 1577,
        "defect_fp": 59,
        "defect_tn": 1591,
        "defect_fn": 49,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.46895135434102814,
          0.2565414519614256,
          0.19918579848241608,
          0.1842145224308369,
          0.17775069261320464,
          0.17796567771349991,
          0.17395294817733464,
          0.1658878615554656,
          0.16995696483421524,
          0.1688609809057483,
          0.16491368827585395,
          0.17075228666161893,
          0.163526137472446,
          0.16843933705630162,
          0.16807677606159674
        ],
        "val_loss": [
          0.3702800732392531,
          0.19633974765355772,
          0.1414085212521828,
          0.13218780642805192,
          0.1175837483113775,
          0.127694403537764,
          0.11822347493412402,
          0.11097871505010587,
          0.10498160503518122,
          0.10729678713071805,
          0.10199675766321328,
          0.10517149801867512,
          0.10170132910402921,
          0.10747094903714381,
          0.10552526000314034
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8982143984986151,
            "recall_macro": 0.8954491693994946,
            "f1_macro": 0.8961010703632216,
            "precision_micro": 0.8964885496183206,
            "recall_micro": 0.8964885496183206,
            "f1_micro": 0.8964885496183206,
            "accuracy": 0.8964885496183206,
            "hamming_loss": 0.10351145038167939,
            "no_defect_precision": 0.8789237668161435,
            "no_defect_recall": 0.9272619751626257,
            "no_defect_f1": 0.9024460431654676,
            "no_defect_tp": 1568,
            "no_defect_fp": 216,
            "no_defect_tn": 1368,
            "no_defect_fn": 123,
            "no_defect_support": 1691,
            "defect_precision": 0.9175050301810865,
            "defect_recall": 0.8636363636363636,
            "defect_f1": 0.8897560975609756,
            "defect_tp": 1368,
            "defect_fp": 123,
            "defect_tn": 1568,
            "defect_fn": 216,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9434435256565807,
            "recall_macro": 0.9434610743747349,
            "f1_macro": 0.943452211787345,
            "precision_micro": 0.9435114503816794,
            "recall_micro": 0.9435114503816794,
            "f1_micro": 0.9435114503816794,
            "accuracy": 0.9435114503816794,
            "hamming_loss": 0.05648854961832061,
            "no_defect_precision": 0.9455621301775148,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.9452824608104111,
            "no_defect_tp": 1598,
            "no_defect_fp": 92,
            "no_defect_tn": 1492,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.9413249211356467,
            "defect_recall": 0.9419191919191919,
            "defect_f1": 0.9416219627642789,
            "defect_tp": 1492,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 92,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556673768408462,
            "recall_macro": 0.9551325272237454,
            "f1_macro": 0.9553484047758858,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9504373177842566,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.9571344685848503,
            "no_defect_tp": 1630,
            "no_defect_fp": 85,
            "no_defect_tn": 1499,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9608974358974359,
            "defect_recall": 0.9463383838383839,
            "defect_f1": 0.9535623409669212,
            "defect_tp": 1499,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 85,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9568006195641712,
            "recall_macro": 0.9571502278850001,
            "f1_macro": 0.9569195573314839,
            "precision_micro": 0.9569465648854962,
            "recall_micro": 0.9569465648854962,
            "f1_micro": 0.9569465648854962,
            "accuracy": 0.9569465648854962,
            "hamming_loss": 0.04305343511450382,
            "no_defect_precision": 0.9651860744297719,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9579982126899017,
            "no_defect_tp": 1608,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9484151646985706,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.955840901973066,
            "defect_tp": 1526,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9595758305830091,
            "recall_macro": 0.9597714280594234,
            "f1_macro": 0.9596607132859303,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9642644431209053,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9608308605341246,
            "no_defect_tp": 1619,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9548872180451128,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9584905660377359,
            "defect_tp": 1524,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9528088140190074,
            "recall_macro": 0.953270321488092,
            "f1_macro": 0.9526639705606031,
            "precision_micro": 0.9526717557251908,
            "recall_micro": 0.9526717557251908,
            "f1_micro": 0.9526717557251908,
            "accuracy": 0.9526717557251908,
            "hamming_loss": 0.04732824427480916,
            "no_defect_precision": 0.9723247232472325,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.9532710280373832,
            "no_defect_tp": 1581,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9332929047907823,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9520569130838231,
            "defect_tp": 1539,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9565490136405306,
            "recall_macro": 0.9570143331601049,
            "f1_macro": 0.9566241349077546,
            "precision_micro": 0.9566412213740458,
            "recall_micro": 0.9566412213740458,
            "f1_micro": 0.9566412213740458,
            "accuracy": 0.9566412213740458,
            "hamming_loss": 0.0433587786259542,
            "no_defect_precision": 0.9696785930867192,
            "no_defect_recall": 0.9455943228858663,
            "no_defect_f1": 0.9574850299401197,
            "no_defect_tp": 1599,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 92,
            "no_defect_support": 1691,
            "defect_precision": 0.9434194341943419,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9557632398753894,
            "defect_tp": 1534,
            "defect_fp": 92,
            "defect_tn": 1599,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9607868405602931,
            "recall_macro": 0.9612138161628109,
            "f1_macro": 0.9608966021087477,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.971635485817743,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.961768219832736,
            "no_defect_tp": 1610,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9499381953028431,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9600249843847595,
            "defect_tp": 1537,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9609526953747054,
            "recall_macro": 0.9607943718677012,
            "f1_macro": 0.9608677793958403,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9599764567392584,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9622418879056047,
            "no_defect_tp": 1631,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9619289340101523,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.959493670886076,
            "defect_tp": 1516,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9613825005129353,
            "recall_macro": 0.9617452616048121,
            "f1_macro": 0.96150316856024,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.96996996996997,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9624553039332538,
            "no_defect_tp": 1615,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9527950310559006,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.960551033187226,
            "defect_tp": 1534,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9632382340302299,
            "recall_macro": 0.962824205986536,
            "f1_macro": 0.9629986659818077,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9590643274853801,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.9644222287562482,
            "no_defect_tp": 1640,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.9674121405750798,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9615751032073674,
            "defect_tp": 1514,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9622984681753373,
            "recall_macro": 0.9626522842260572,
            "f1_macro": 0.9624191883104434,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9705882352941176,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9633601429848079,
            "no_defect_tp": 1617,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9540087010565569,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9614782336360789,
            "defect_tp": 1535,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9630820100188741,
            "recall_macro": 0.9629440472137101,
            "f1_macro": 0.9630086134785402,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9623085983510011,
            "no_defect_recall": 0.9662921348314607,
            "no_defect_f1": 0.9642962525818826,
            "no_defect_tp": 1634,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 57,
            "no_defect_support": 1691,
            "defect_precision": 0.963855421686747,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9617209743751978,
            "defect_tp": 1520,
            "defect_fp": 57,
            "defect_tn": 1634,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962002563276219,
            "recall_macro": 0.96241652181185,
            "f1_macro": 0.9621175373134329,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9722724532851115,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9629850746268657,
            "no_defect_tp": 1613,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9517326732673267,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.96125,
            "defect_tp": 1538,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626039344369932,
            "recall_macro": 0.9629479672538513,
            "f1_macro": 0.9627241495639038,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9706058788242351,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9636688505062537,
            "no_defect_tp": 1618,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9546019900497512,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9617794486215538,
            "defect_tp": 1535,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 49,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9670291907686803,
            "recall_macro": 0.9670535614447053,
            "f1_macro": 0.9670323649503634,
            "precision_micro": 0.967032967032967,
            "recall_micro": 0.967032967032967,
            "f1_micro": 0.967032967032967,
            "accuracy": 0.967032967032967,
            "hamming_loss": 0.03296703296703297,
            "no_defect_precision": 0.9701219512195122,
            "no_defect_recall": 0.9642424242424242,
            "no_defect_f1": 0.9671732522796352,
            "no_defect_tp": 1591,
            "no_defect_fp": 49,
            "no_defect_tn": 1577,
            "no_defect_fn": 59,
            "no_defect_support": 1650,
            "defect_precision": 0.9639364303178484,
            "defect_recall": 0.9698646986469864,
            "defect_f1": 0.9668914776210914,
            "defect_tp": 1577,
            "defect_fp": 59,
            "defect_tn": 1591,
            "defect_fn": 49,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.001_s100_20251207_204342",
    "lr": 0.005,
    "weight_decay": 0.001,
    "seed": 100,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9630203225618912,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.001_s100_20251207_204342",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s100_20251207_204342",
      "timestamp": "2025-12-07T20:45:37.432932",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 15,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.001_s100",
          "seed": 100,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s100_20251207_204342"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9629513933208083,
        "recall_macro": 0.963103835516609,
        "f1_macro": 0.9630203225618912,
        "precision_micro": 0.9630534351145038,
        "recall_micro": 0.9630534351145038,
        "f1_micro": 0.9630534351145038,
        "accuracy": 0.9630534351145038,
        "hamming_loss": 0.036946564885496185,
        "no_defect_precision": 0.9667063020214031,
        "no_defect_recall": 0.9615612063867534,
        "no_defect_f1": 0.9641268900088942,
        "no_defect_tp": 1626,
        "no_defect_fp": 56,
        "no_defect_tn": 1528,
        "no_defect_fn": 65,
        "no_defect_support": 1691,
        "defect_precision": 0.9591964846202135,
        "defect_recall": 0.9646464646464646,
        "defect_f1": 0.9619137551148883,
        "defect_tp": 1528,
        "defect_fp": 65,
        "defect_tn": 1626,
        "defect_fn": 56,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.967041749105781,
        "recall_macro": 0.9670222520407022,
        "f1_macro": 0.9670305585705936,
        "precision_micro": 0.967032967032967,
        "recall_micro": 0.967032967032967,
        "f1_micro": 0.967032967032967,
        "accuracy": 0.967032967032967,
        "hamming_loss": 0.03296703296703297,
        "no_defect_precision": 0.966142684401451,
        "no_defect_recall": 0.9684848484848485,
        "no_defect_f1": 0.9673123486682809,
        "no_defect_tp": 1598,
        "no_defect_fp": 56,
        "no_defect_tn": 1570,
        "no_defect_fn": 52,
        "no_defect_support": 1650,
        "defect_precision": 0.967940813810111,
        "defect_recall": 0.965559655596556,
        "defect_f1": 0.9667487684729064,
        "defect_tp": 1570,
        "defect_fp": 52,
        "defect_tn": 1598,
        "defect_fn": 56,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.46614507763455604,
          0.25824157313821705,
          0.1943794263207264,
          0.17959535449244488,
          0.17751297293908924,
          0.17460778207522057,
          0.16979464498897975,
          0.1751284849319498,
          0.17462500957889038,
          0.16522589439689864,
          0.17021414327384538,
          0.16772226375141902,
          0.17197201951215957,
          0.1629655915760595,
          0.16327151250889113
        ],
        "val_loss": [
          0.3665712194947096,
          0.19777690676542428,
          0.14345429809047625,
          0.1313071483029769,
          0.11838087231780474,
          0.11582749988883734,
          0.11594055822262397,
          0.10431442596018314,
          0.11059022257820918,
          0.10436795780865046,
          0.10847025339563306,
          0.1059271081064183,
          0.1067750259804038,
          0.1030631335452199,
          0.10349901450368074
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8978659572059323,
            "recall_macro": 0.8936112305790012,
            "f1_macro": 0.8944366443708663,
            "precision_micro": 0.8949618320610687,
            "recall_micro": 0.8949618320610687,
            "f1_micro": 0.8949618320610687,
            "accuracy": 0.8949618320610687,
            "hamming_loss": 0.1050381679389313,
            "no_defect_precision": 0.8710743801652893,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.9018824871648602,
            "no_defect_tp": 1581,
            "no_defect_fp": 234,
            "no_defect_tn": 1350,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9246575342465754,
            "defect_recall": 0.8522727272727273,
            "defect_f1": 0.8869908015768725,
            "defect_tp": 1350,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 234,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9418696940062644,
            "recall_macro": 0.9423022358415616,
            "f1_macro": 0.9419589689786196,
            "precision_micro": 0.9419847328244275,
            "recall_micro": 0.9419847328244275,
            "f1_micro": 0.9419847328244275,
            "accuracy": 0.9419847328244275,
            "hamming_loss": 0.05801526717557252,
            "no_defect_precision": 0.9540229885057471,
            "no_defect_recall": 0.9325842696629213,
            "no_defect_f1": 0.9431818181818182,
            "no_defect_tp": 1577,
            "no_defect_fp": 76,
            "no_defect_tn": 1508,
            "no_defect_fn": 114,
            "no_defect_support": 1691,
            "defect_precision": 0.9297163995067818,
            "defect_recall": 0.952020202020202,
            "defect_f1": 0.940736119775421,
            "defect_tp": 1508,
            "defect_fp": 114,
            "defect_tn": 1577,
            "defect_fn": 76,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540686293167593,
            "recall_macro": 0.9542893452562288,
            "f1_macro": 0.9541615097393146,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9594514013118665,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9554631828978623,
            "no_defect_tp": 1609,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9486858573216521,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9528598365807668,
            "defect_tp": 1516,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9562269972057247,
            "recall_macro": 0.956678703056586,
            "f1_macro": 0.9563170453952947,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9685230024213075,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.9572240502542626,
            "no_defect_tp": 1600,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9439309919901417,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9554100405363268,
            "defect_tp": 1532,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598772803297004,
            "recall_macro": 0.96008708462508,
            "f1_macro": 0.9599670199721204,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9648390941597139,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9611160581775008,
            "no_defect_tp": 1619,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.954915466499687,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.95881798176674,
            "defect_tp": 1525,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9574622542776992,
            "recall_macro": 0.9575818056376897,
            "f1_macro": 0.9575176436278798,
            "precision_micro": 0.9575572519083969,
            "recall_micro": 0.9575572519083969,
            "f1_micro": 0.9575572519083969,
            "accuracy": 0.9575572519083969,
            "hamming_loss": 0.042442748091603054,
            "no_defect_precision": 0.9608076009501187,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9588148148148148,
            "no_defect_tp": 1618,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9541169076052797,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9562204724409449,
            "defect_tp": 1518,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9581103125125869,
            "recall_macro": 0.9585926159883877,
            "f1_macro": 0.9581538935042587,
            "precision_micro": 0.9581679389312977,
            "recall_micro": 0.9581679389312977,
            "f1_micro": 0.9581679389312977,
            "accuracy": 0.9581679389312977,
            "hamming_loss": 0.04183206106870229,
            "no_defect_precision": 0.9726277372262774,
            "no_defect_recall": 0.9455943228858663,
            "no_defect_f1": 0.9589205397301349,
            "no_defect_tp": 1599,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 92,
            "no_defect_support": 1691,
            "defect_precision": 0.9435928877988964,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9573872472783825,
            "defect_tp": 1539,
            "defect_fp": 92,
            "defect_tn": 1599,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9627259713716703,
            "recall_macro": 0.9626883112616407,
            "f1_macro": 0.9627067811215202,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9633786178381571,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9639479905437353,
            "no_defect_tp": 1631,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9620733249051833,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9614655716993051,
            "defect_tp": 1522,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9611035852739923,
            "recall_macro": 0.9615494462663298,
            "f1_macro": 0.9612036499397196,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9727932285368803,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9620328849028401,
            "no_defect_tp": 1609,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9494139420111043,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.960374414976599,
            "defect_tp": 1539,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962449364895384,
            "recall_macro": 0.9623526811581218,
            "f1_macro": 0.962398772117937,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9622641509433962,
            "no_defect_recall": 0.9651094027202839,
            "no_defect_f1": 0.9636846767050488,
            "no_defect_tp": 1632,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 59,
            "no_defect_support": 1691,
            "defect_precision": 0.9626345788473718,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9611128675308251,
            "defect_tp": 1520,
            "defect_fp": 59,
            "defect_tn": 1632,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9601603932944754,
            "recall_macro": 0.9605026088800483,
            "f1_macro": 0.9602798315025205,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9682063587282543,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9612864800476474,
            "no_defect_tp": 1614,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9521144278606966,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9592731829573935,
            "defect_tp": 1531,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9601607818999123,
            "recall_macro": 0.9605225824179107,
            "f1_macro": 0.9602810469272317,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9687687687687687,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9612634088200238,
            "no_defect_tp": 1613,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9515527950310559,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9592986850344396,
            "defect_tp": 1532,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962002563276219,
            "recall_macro": 0.96241652181185,
            "f1_macro": 0.9621175373134329,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9722724532851115,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9629850746268657,
            "no_defect_tp": 1613,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9517326732673267,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.96125,
            "defect_tp": 1538,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626770652448193,
            "recall_macro": 0.9627482318752278,
            "f1_macro": 0.962711208270711,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.965026674570243,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9638839550029603,
            "no_defect_tp": 1628,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.9603274559193955,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9615384615384616,
            "defect_tp": 1525,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629513933208083,
            "recall_macro": 0.963103835516609,
            "f1_macro": 0.9630203225618912,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9667063020214031,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9641268900088942,
            "no_defect_tp": 1626,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9591964846202135,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9619137551148883,
            "defect_tp": 1528,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 56,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.967041749105781,
            "recall_macro": 0.9670222520407022,
            "f1_macro": 0.9670305585705936,
            "precision_micro": 0.967032967032967,
            "recall_micro": 0.967032967032967,
            "f1_micro": 0.967032967032967,
            "accuracy": 0.967032967032967,
            "hamming_loss": 0.03296703296703297,
            "no_defect_precision": 0.966142684401451,
            "no_defect_recall": 0.9684848484848485,
            "no_defect_f1": 0.9673123486682809,
            "no_defect_tp": 1598,
            "no_defect_fp": 56,
            "no_defect_tn": 1570,
            "no_defect_fn": 52,
            "no_defect_support": 1650,
            "defect_precision": 0.967940813810111,
            "defect_recall": 0.965559655596556,
            "defect_f1": 0.9667487684729064,
            "defect_tp": 1570,
            "defect_fp": 52,
            "defect_tn": 1598,
            "defect_fn": 56,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.001_s110_20251207_150532",
    "lr": 0.005,
    "weight_decay": 0.001,
    "seed": 110,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9645539753663658,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.001_s110_20251207_150532",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s110_20251207_150532",
      "timestamp": "2025-12-07T15:07:25.418596",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.001_s110",
          "seed": 110,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s110_20251207_150532"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9644442877365635,
        "recall_macro": 0.9647220654206166,
        "f1_macro": 0.9645539753663658,
        "precision_micro": 0.9645801526717557,
        "recall_micro": 0.9645801526717557,
        "f1_micro": 0.9645801526717557,
        "accuracy": 0.9645801526717557,
        "hamming_loss": 0.035419847328244276,
        "no_defect_precision": 0.9707112970711297,
        "no_defect_recall": 0.9603784742755765,
        "no_defect_f1": 0.9655172413793104,
        "no_defect_tp": 1624,
        "no_defect_fp": 49,
        "no_defect_tn": 1535,
        "no_defect_fn": 67,
        "no_defect_support": 1691,
        "defect_precision": 0.9581772784019975,
        "defect_recall": 0.9690656565656566,
        "defect_f1": 0.9635907093534212,
        "defect_tp": 1535,
        "defect_fp": 67,
        "defect_tn": 1624,
        "defect_fn": 49,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9673313904970483,
        "recall_macro": 0.9673521189757353,
        "f1_macro": 0.9673373377859831,
        "precision_micro": 0.9673382173382173,
        "recall_micro": 0.9673382173382173,
        "f1_micro": 0.9673382173382173,
        "accuracy": 0.9673382173382173,
        "hamming_loss": 0.032661782661782664,
        "no_defect_precision": 0.9695678636640293,
        "no_defect_recall": 0.9654545454545455,
        "no_defect_f1": 0.967506832675372,
        "no_defect_tp": 1593,
        "no_defect_fp": 50,
        "no_defect_tn": 1576,
        "no_defect_fn": 57,
        "no_defect_support": 1650,
        "defect_precision": 0.9650949173300674,
        "defect_recall": 0.9692496924969249,
        "defect_f1": 0.9671678428965941,
        "defect_tp": 1576,
        "defect_fp": 57,
        "defect_tn": 1593,
        "defect_fn": 50,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.47101359449669905,
          0.25744467256707626,
          0.19657311245612022,
          0.1823144319104849,
          0.1753184030993713,
          0.17200361005182546,
          0.17752733606860727,
          0.17056065043395532,
          0.16759685621787812,
          0.1712937646985802,
          0.16556023888944582,
          0.1649471419906267,
          0.16256906818520575,
          0.16985683099495316,
          0.17116194065644652
        ],
        "val_loss": [
          0.372373691545083,
          0.19600193517712447,
          0.1415003753052308,
          0.12764319634208313,
          0.12634221808268473,
          0.12160564593684214,
          0.11421902570873499,
          0.11497544722918135,
          0.11008644512353036,
          0.10749227560770053,
          0.10560172366408202,
          0.10618232319561335,
          0.10152350072390758,
          0.10343018654160775,
          0.10393769014626741
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8999073652033317,
            "recall_macro": 0.895029725104385,
            "f1_macro": 0.8959202539481119,
            "precision_micro": 0.8964885496183206,
            "recall_micro": 0.8964885496183206,
            "f1_micro": 0.8964885496183206,
            "accuracy": 0.8964885496183206,
            "hamming_loss": 0.10351145038167939,
            "no_defect_precision": 0.8702081051478642,
            "no_defect_recall": 0.9396806623299823,
            "no_defect_f1": 0.903611032129656,
            "no_defect_tp": 1589,
            "no_defect_fp": 237,
            "no_defect_tn": 1347,
            "no_defect_fn": 102,
            "no_defect_support": 1691,
            "defect_precision": 0.9296066252587992,
            "defect_recall": 0.8503787878787878,
            "defect_f1": 0.8882294757665677,
            "defect_tp": 1347,
            "defect_fp": 102,
            "defect_tn": 1589,
            "defect_fn": 237,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9418350027045679,
            "recall_macro": 0.9421823946143875,
            "f1_macro": 0.9419492224321079,
            "precision_micro": 0.9419847328244275,
            "recall_micro": 0.9419847328244275,
            "f1_micro": 0.9419847328244275,
            "accuracy": 0.9419847328244275,
            "hamming_loss": 0.05801526717557252,
            "no_defect_precision": 0.9507507507507508,
            "no_defect_recall": 0.9361324659964518,
            "no_defect_f1": 0.9433849821215733,
            "no_defect_tp": 1583,
            "no_defect_fp": 82,
            "no_defect_tn": 1502,
            "no_defect_fn": 108,
            "no_defect_support": 1691,
            "defect_precision": 0.9329192546583851,
            "defect_recall": 0.9482323232323232,
            "defect_f1": 0.9405134627426425,
            "defect_tp": 1502,
            "defect_fp": 108,
            "defect_tn": 1583,
            "defect_fn": 82,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9550553188308291,
            "recall_macro": 0.9545211876302947,
            "f1_macro": 0.9547367390878841,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9498542274052478,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9565472695243687,
            "no_defect_tp": 1629,
            "no_defect_fp": 86,
            "no_defect_tn": 1498,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9602564102564103,
            "defect_recall": 0.9457070707070707,
            "defect_f1": 0.9529262086513995,
            "defect_tp": 1498,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 86,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.956877301355504,
            "recall_macro": 0.9569305189685142,
            "f1_macro": 0.9569031048523591,
            "precision_micro": 0.9569465648854962,
            "recall_micro": 0.9569465648854962,
            "f1_micro": 0.9569465648854962,
            "accuracy": 0.9569465648854962,
            "hamming_loss": 0.04305343511450382,
            "no_defect_precision": 0.9591232227488151,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9582716780112459,
            "no_defect_tp": 1619,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9546313799621928,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9555345316934721,
            "defect_tp": 1515,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9566266403719843,
            "recall_macro": 0.9571142008494167,
            "f1_macro": 0.9566289892376849,
            "precision_micro": 0.9566412213740458,
            "recall_micro": 0.9566412213740458,
            "f1_micro": 0.9566412213740458,
            "accuracy": 0.9566412213740458,
            "hamming_loss": 0.0433587786259542,
            "no_defect_precision": 0.9725442342892008,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.9573573573573574,
            "no_defect_tp": 1594,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.9407090464547677,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9559006211180124,
            "defect_tp": 1539,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9575942588071726,
            "recall_macro": 0.9580811440842487,
            "f1_macro": 0.957547356764003,
            "precision_micro": 0.9575572519083969,
            "recall_micro": 0.9575572519083969,
            "f1_micro": 0.9575572519083969,
            "accuracy": 0.9575572519083969,
            "hamming_loss": 0.042442748091603054,
            "no_defect_precision": 0.9749082007343941,
            "no_defect_recall": 0.9420461265523359,
            "no_defect_f1": 0.9581954887218045,
            "no_defect_tp": 1593,
            "no_defect_fp": 41,
            "no_defect_tn": 1543,
            "no_defect_fn": 98,
            "no_defect_support": 1691,
            "defect_precision": 0.9402803168799513,
            "defect_recall": 0.9741161616161617,
            "defect_f1": 0.9568992248062016,
            "defect_tp": 1543,
            "defect_fp": 98,
            "defect_tn": 1593,
            "defect_fn": 41,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9601607818999123,
            "recall_macro": 0.9605225824179107,
            "f1_macro": 0.9602810469272317,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9687687687687687,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9612634088200238,
            "no_defect_tp": 1613,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9515527950310559,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9592986850344396,
            "defect_tp": 1532,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.960213316505512,
            "recall_macro": 0.9606823707208095,
            "f1_macro": 0.960289700971888,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9733171619163129,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9610778443113772,
            "no_defect_tp": 1605,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.947109471094711,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9595015576323987,
            "defect_tp": 1540,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9616909989010768,
            "recall_macro": 0.9620808917083311,
            "f1_macro": 0.9618103984116484,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9711191335740073,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.962719952281539,
            "no_defect_tp": 1614,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9522628642281463,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.960900844541758,
            "defect_tp": 1536,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623006323800996,
            "recall_macro": 0.9626123371503323,
            "f1_macro": 0.9624168321091106,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9694610778443113,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9634037488842606,
            "no_defect_tp": 1619,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9551401869158879,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9614299153339605,
            "defect_tp": 1533,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629412972085386,
            "recall_macro": 0.9631238090544714,
            "f1_macro": 0.9630216614539442,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9672619047619048,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9641056066449125,
            "no_defect_tp": 1625,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9586206896551724,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9619377162629758,
            "defect_tp": 1529,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9622994556653774,
            "recall_macro": 0.9626722577639195,
            "f1_macro": 0.9624203242305297,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9711538461538461,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.963338301043219,
            "no_defect_tp": 1616,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9534450651769087,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9615023474178404,
            "defect_tp": 1536,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9645999837183787,
            "recall_macro": 0.9644823829662683,
            "f1_macro": 0.9645379346086609,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9640542133176193,
            "no_defect_recall": 0.9674748669426375,
            "no_defect_f1": 0.9657615112160567,
            "no_defect_tp": 1636,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 55,
            "no_defect_support": 1691,
            "defect_precision": 0.9651457541191382,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.963314358001265,
            "defect_tp": 1523,
            "defect_fp": 55,
            "defect_tn": 1636,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644442877365635,
            "recall_macro": 0.9647220654206166,
            "f1_macro": 0.9645539753663658,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9707112970711297,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9655172413793104,
            "no_defect_tp": 1624,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9581772784019975,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9635907093534212,
            "defect_tp": 1535,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644442877365635,
            "recall_macro": 0.9647220654206166,
            "f1_macro": 0.9645539753663658,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9707112970711297,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9655172413793104,
            "no_defect_tp": 1624,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9581772784019975,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9635907093534212,
            "defect_tp": 1535,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 49,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9673313904970483,
            "recall_macro": 0.9673521189757353,
            "f1_macro": 0.9673373377859831,
            "precision_micro": 0.9673382173382173,
            "recall_micro": 0.9673382173382173,
            "f1_micro": 0.9673382173382173,
            "accuracy": 0.9673382173382173,
            "hamming_loss": 0.032661782661782664,
            "no_defect_precision": 0.9695678636640293,
            "no_defect_recall": 0.9654545454545455,
            "no_defect_f1": 0.967506832675372,
            "no_defect_tp": 1593,
            "no_defect_fp": 50,
            "no_defect_tn": 1576,
            "no_defect_fn": 57,
            "no_defect_support": 1650,
            "defect_precision": 0.9650949173300674,
            "defect_recall": 0.9692496924969249,
            "defect_f1": 0.9671678428965941,
            "defect_tp": 1576,
            "defect_fp": 57,
            "defect_tn": 1593,
            "defect_fn": 50,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.001_s120_20251207_151353",
    "lr": 0.005,
    "weight_decay": 0.001,
    "seed": 120,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9642329783560863,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.001_s120_20251207_151353",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s120_20251207_151353",
      "timestamp": "2025-12-07T15:15:47.041304",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.001_s120",
          "seed": 120,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s120_20251207_151353"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.964283767192037,
        "recall_macro": 0.9641866999384741,
        "f1_macro": 0.9642329783560863,
        "precision_micro": 0.9642748091603054,
        "recall_micro": 0.9642748091603054,
        "f1_micro": 0.9642748091603054,
        "accuracy": 0.9642748091603054,
        "hamming_loss": 0.03572519083969466,
        "no_defect_precision": 0.9640330188679245,
        "no_defect_recall": 0.9668835008870491,
        "no_defect_f1": 0.9654561558901683,
        "no_defect_tp": 1635,
        "no_defect_fp": 61,
        "no_defect_tn": 1523,
        "no_defect_fn": 56,
        "no_defect_support": 1691,
        "defect_precision": 0.9645345155161494,
        "defect_recall": 0.961489898989899,
        "defect_f1": 0.9630098008220044,
        "defect_tp": 1523,
        "defect_fp": 56,
        "defect_tn": 1635,
        "defect_fn": 61,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9667480280003264,
        "recall_macro": 0.966710276193671,
        "f1_macro": 0.9667247371336796,
        "precision_micro": 0.9667277167277167,
        "recall_micro": 0.9667277167277167,
        "f1_micro": 0.9667277167277167,
        "accuracy": 0.9667277167277167,
        "hamming_loss": 0.03327228327228327,
        "no_defect_precision": 0.9649969824984912,
        "no_defect_recall": 0.9690909090909091,
        "no_defect_f1": 0.9670396129422437,
        "no_defect_tp": 1599,
        "no_defect_fp": 58,
        "no_defect_tn": 1568,
        "no_defect_fn": 51,
        "no_defect_support": 1650,
        "defect_precision": 0.9684990735021618,
        "defect_recall": 0.964329643296433,
        "defect_f1": 0.9664098613251155,
        "defect_tp": 1568,
        "defect_fp": 51,
        "defect_tn": 1599,
        "defect_fn": 58,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4635505312157475,
          0.2563084428779251,
          0.20467911744840972,
          0.18501234565818658,
          0.18447959937435812,
          0.1750727991522855,
          0.17738262221030113,
          0.16903428532276693,
          0.16823710962568866,
          0.16997866226539451,
          0.1665007662667141,
          0.16390417728214582,
          0.16847353353784672,
          0.16842919525741035,
          0.16475762073028535
        ],
        "val_loss": [
          0.3688076568337587,
          0.19105306611611292,
          0.14523968573373097,
          0.13122529536485672,
          0.11609061298748621,
          0.11450640993336073,
          0.10648650740488218,
          0.10366117209196091,
          0.1079154579828565,
          0.10373420519037889,
          0.11036698684956019,
          0.10486903707855023,
          0.1040836232714355,
          0.10230183049749869,
          0.10272091243845913
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8984885175600962,
            "recall_macro": 0.8957648259651512,
            "f1_macro": 0.8964114248667232,
            "precision_micro": 0.896793893129771,
            "recall_micro": 0.896793893129771,
            "f1_micro": 0.896793893129771,
            "accuracy": 0.896793893129771,
            "hamming_loss": 0.103206106870229,
            "no_defect_precision": 0.8794167134043747,
            "no_defect_recall": 0.9272619751626257,
            "no_defect_f1": 0.9027058146229131,
            "no_defect_tp": 1568,
            "no_defect_fp": 215,
            "no_defect_tn": 1369,
            "no_defect_fn": 123,
            "no_defect_support": 1691,
            "defect_precision": 0.9175603217158177,
            "defect_recall": 0.8642676767676768,
            "defect_f1": 0.8901170351105332,
            "defect_tp": 1369,
            "defect_fp": 123,
            "defect_tn": 1568,
            "defect_fn": 215,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9450052076206967,
            "recall_macro": 0.9444041240315635,
            "f1_macro": 0.9446401453014657,
            "precision_micro": 0.944732824427481,
            "recall_micro": 0.944732824427481,
            "f1_micro": 0.944732824427481,
            "accuracy": 0.944732824427481,
            "hamming_loss": 0.05526717557251908,
            "no_defect_precision": 0.9394644935972061,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9469052508066882,
            "no_defect_tp": 1614,
            "no_defect_fp": 104,
            "no_defect_tn": 1480,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9505459216441875,
            "defect_recall": 0.9343434343434344,
            "defect_f1": 0.9423750397962433,
            "defect_tp": 1480,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 104,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.953099968018842,
            "recall_macro": 0.9527670630013918,
            "f1_macro": 0.9529106775260454,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.9502050380785003,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9546792230723955,
            "no_defect_tp": 1622,
            "no_defect_fp": 85,
            "no_defect_tn": 1499,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9559948979591837,
            "defect_recall": 0.9463383838383839,
            "defect_f1": 0.9511421319796954,
            "defect_tp": 1499,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 85,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9554248778439371,
            "recall_macro": 0.9559114952003775,
            "f1_macro": 0.9554081688989161,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9718998167379352,
            "no_defect_recall": 0.9408633944411591,
            "no_defect_f1": 0.9561298076923077,
            "no_defect_tp": 1591,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 100,
            "no_defect_support": 1691,
            "defect_precision": 0.938949938949939,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9546865301055245,
            "defect_tp": 1538,
            "defect_fp": 100,
            "defect_tn": 1591,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610260193884603,
            "recall_macro": 0.9607344512541142,
            "f1_macro": 0.9608626060873585,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9583577712609971,
            "no_defect_recall": 0.9662921348314607,
            "no_defect_f1": 0.9623085983510011,
            "no_defect_tp": 1634,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 57,
            "no_defect_support": 1691,
            "defect_precision": 0.9636942675159236,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.9594166138237159,
            "defect_tp": 1513,
            "defect_fp": 57,
            "defect_tn": 1634,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9586334665932469,
            "recall_macro": 0.9589642731274901,
            "f1_macro": 0.9587514900543159,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.9664268585131894,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9598094671033045,
            "no_defect_tp": 1612,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9508400746733043,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9576935130053275,
            "defect_tp": 1528,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635257009136577,
            "recall_macro": 0.9638150427993716,
            "f1_macro": 0.9636378683435654,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9700956937799043,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9646149271483794,
            "no_defect_tp": 1622,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9569557080474111,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9626608095387512,
            "defect_tp": 1534,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9624296266093748,
            "recall_macro": 0.9623726546959841,
            "f1_macro": 0.9624003304234601,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9628099173553719,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9636632200886263,
            "no_defect_tp": 1631,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9620493358633776,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9611374407582939,
            "defect_tp": 1521,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610801751413567,
            "recall_macro": 0.9614695521148804,
            "f1_macro": 0.9611993647862348,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.970517448856799,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9621234715180436,
            "no_defect_tp": 1613,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9516429014259145,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.960275258054426,
            "defect_tp": 1535,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638736985581502,
            "recall_macro": 0.964010858137854,
            "f1_macro": 0.963936511088648,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9673202614379085,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.965026674570243,
            "no_defect_tp": 1628,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.960427135678392,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9628463476070529,
            "defect_tp": 1529,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9589804880159211,
            "recall_macro": 0.9594397179960457,
            "f1_macro": 0.9590668376933191,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9715324046032707,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.959904248952723,
            "no_defect_tp": 1604,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9464285714285714,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9582294264339152,
            "defect_tp": 1537,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9619941173266517,
            "recall_macro": 0.9623166541225382,
            "f1_macro": 0.962111882370503,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.969442780107849,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9630952380952381,
            "no_defect_tp": 1618,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9545454545454546,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.961128526645768,
            "defect_tp": 1533,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9632184499851508,
            "recall_macro": 0.9635193597715774,
            "f1_macro": 0.9633329029070197,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9700777977259126,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9643069601427722,
            "no_defect_tp": 1621,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.956359102244389,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9623588456712673,
            "defect_tp": 1534,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.964283767192037,
            "recall_macro": 0.9641866999384741,
            "f1_macro": 0.9642329783560863,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.9640330188679245,
            "no_defect_recall": 0.9668835008870491,
            "no_defect_f1": 0.9654561558901683,
            "no_defect_tp": 1635,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 56,
            "no_defect_support": 1691,
            "defect_precision": 0.9645345155161494,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9630098008220044,
            "defect_tp": 1523,
            "defect_fp": 56,
            "defect_tn": 1635,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9639309639864047,
            "recall_macro": 0.9639309639864047,
            "f1_macro": 0.9639309639864047,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9651094027202839,
            "no_defect_recall": 0.9651094027202839,
            "no_defect_f1": 0.9651094027202839,
            "no_defect_tp": 1632,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 59,
            "no_defect_support": 1691,
            "defect_precision": 0.9627525252525253,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9627525252525253,
            "defect_tp": 1525,
            "defect_fp": 59,
            "defect_tn": 1632,
            "defect_fn": 59,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9667480280003264,
            "recall_macro": 0.966710276193671,
            "f1_macro": 0.9667247371336796,
            "precision_micro": 0.9667277167277167,
            "recall_micro": 0.9667277167277167,
            "f1_micro": 0.9667277167277167,
            "accuracy": 0.9667277167277167,
            "hamming_loss": 0.03327228327228327,
            "no_defect_precision": 0.9649969824984912,
            "no_defect_recall": 0.9690909090909091,
            "no_defect_f1": 0.9670396129422437,
            "no_defect_tp": 1599,
            "no_defect_fp": 58,
            "no_defect_tn": 1568,
            "no_defect_fn": 51,
            "no_defect_support": 1650,
            "defect_precision": 0.9684990735021618,
            "defect_recall": 0.964329643296433,
            "defect_f1": 0.9664098613251155,
            "defect_tp": 1568,
            "defect_fp": 51,
            "defect_tn": 1599,
            "defect_fn": 58,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.001_s130_20251207_205800",
    "lr": 0.005,
    "weight_decay": 0.001,
    "seed": 130,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9645408738532487,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.001_s130_20251207_205800",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s130_20251207_205800",
      "timestamp": "2025-12-07T20:59:54.323156",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 7,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.001_s130",
          "seed": 130,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s130_20251207_205800"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9645601394303756,
        "recall_macro": 0.964522330041993,
        "f1_macro": 0.9645408738532487,
        "precision_micro": 0.9645801526717557,
        "recall_micro": 0.9645801526717557,
        "f1_micro": 0.9645801526717557,
        "accuracy": 0.9645801526717557,
        "hamming_loss": 0.035419847328244276,
        "no_defect_precision": 0.965150620200827,
        "no_defect_recall": 0.9662921348314607,
        "no_defect_f1": 0.9657210401891253,
        "no_defect_tp": 1634,
        "no_defect_fp": 59,
        "no_defect_tn": 1525,
        "no_defect_fn": 57,
        "no_defect_support": 1691,
        "defect_precision": 0.9639696586599241,
        "defect_recall": 0.9627525252525253,
        "defect_f1": 0.9633607075173721,
        "defect_tp": 1525,
        "defect_fp": 57,
        "defect_tn": 1634,
        "defect_fn": 59,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9688896476759495,
        "recall_macro": 0.9688449066308845,
        "f1_macro": 0.9688614978149597,
        "precision_micro": 0.9688644688644689,
        "recall_micro": 0.9688644688644689,
        "f1_micro": 0.9688644688644689,
        "accuracy": 0.9688644688644689,
        "hamming_loss": 0.031135531135531136,
        "no_defect_precision": 0.9668275030156815,
        "no_defect_recall": 0.9715151515151516,
        "no_defect_f1": 0.9691656590084643,
        "no_defect_tp": 1603,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 47,
        "no_defect_support": 1650,
        "defect_precision": 0.9709517923362175,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.968557336621455,
        "defect_tp": 1571,
        "defect_fp": 47,
        "defect_tn": 1603,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.46104167146164005,
          0.2574505926300791,
          0.1982500367645938,
          0.18274243375496885,
          0.17506992935386162,
          0.1750809768814921,
          0.16898715820272597,
          0.17155094815722072,
          0.17460141602171017,
          0.16904321194443245,
          0.16745365623026212,
          0.17012219129434192,
          0.17116455563877916,
          0.17075748897496626,
          0.16654472447401808
        ],
        "val_loss": [
          0.3707727130789023,
          0.19269178435206413,
          0.14033776664963135,
          0.12638411699579313,
          0.13039673076799282,
          0.12034830923836964,
          0.10715740467779912,
          0.11223342763976409,
          0.11184883174987939,
          0.1101798051251815,
          0.10384753726136225,
          0.1028648166415783,
          0.1045727810034385,
          0.10292215186815995,
          0.10329579218075825
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8956332373882745,
            "recall_macro": 0.8899991935917424,
            "f1_macro": 0.8909366516545969,
            "precision_micro": 0.8916030534351145,
            "recall_micro": 0.8916030534351145,
            "f1_micro": 0.8916030534351145,
            "accuracy": 0.8916030534351145,
            "hamming_loss": 0.1083969465648855,
            "no_defect_precision": 0.8630434782608696,
            "no_defect_recall": 0.9390892962743939,
            "no_defect_f1": 0.8994619088077032,
            "no_defect_tp": 1588,
            "no_defect_fp": 252,
            "no_defect_tn": 1332,
            "no_defect_fn": 103,
            "no_defect_support": 1691,
            "defect_precision": 0.9282229965156794,
            "defect_recall": 0.8409090909090909,
            "defect_f1": 0.8824113945014905,
            "defect_tp": 1332,
            "defect_fp": 103,
            "defect_tn": 1588,
            "defect_fn": 252,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9442845451486728,
            "recall_macro": 0.9446677000639153,
            "f1_macro": 0.9443967440867727,
            "precision_micro": 0.9444274809160306,
            "recall_micro": 0.9444274809160306,
            "f1_micro": 0.9444274809160306,
            "accuracy": 0.9444274809160306,
            "hamming_loss": 0.055572519083969464,
            "no_defect_precision": 0.9542444310656231,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.9457040572792362,
            "no_defect_tp": 1585,
            "no_defect_fp": 76,
            "no_defect_tn": 1508,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.9343246592317225,
            "defect_recall": 0.952020202020202,
            "defect_f1": 0.943089430894309,
            "defect_tp": 1508,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 76,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9565432014706883,
            "recall_macro": 0.9556040520521597,
            "f1_macro": 0.9559441735328738,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9473684210526315,
            "no_defect_recall": 0.9686575990538143,
            "no_defect_f1": 0.9578947368421052,
            "no_defect_tp": 1638,
            "no_defect_fp": 91,
            "no_defect_tn": 1493,
            "no_defect_fn": 53,
            "no_defect_support": 1691,
            "defect_precision": 0.9657179818887451,
            "defect_recall": 0.9425505050505051,
            "defect_f1": 0.9539936102236422,
            "defect_tp": 1493,
            "defect_fp": 53,
            "defect_tn": 1638,
            "defect_fn": 91,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9593223749242215,
            "recall_macro": 0.9593758773423173,
            "f1_macro": 0.9593483187614451,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9614928909952607,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9606392423794022,
            "no_defect_tp": 1623,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9571518588531821,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9580573951434879,
            "defect_tp": 1519,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540302483073345,
            "recall_macro": 0.9544930006749937,
            "f1_macro": 0.9538855455138779,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9735547355473555,
            "no_defect_recall": 0.9361324659964518,
            "no_defect_f1": 0.9544769369912571,
            "no_defect_tp": 1583,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 108,
            "no_defect_support": 1691,
            "defect_precision": 0.9345057610673135,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9532941540364986,
            "defect_tp": 1541,
            "defect_fp": 108,
            "defect_tn": 1583,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9580820245135189,
            "recall_macro": 0.958552668912663,
            "f1_macro": 0.958151957617239,
            "precision_micro": 0.9581679389312977,
            "recall_micro": 0.9581679389312977,
            "f1_micro": 0.9581679389312977,
            "accuracy": 0.9581679389312977,
            "hamming_loss": 0.04183206106870229,
            "no_defect_precision": 0.9714805825242718,
            "no_defect_recall": 0.9467770549970431,
            "no_defect_f1": 0.9589697514225816,
            "no_defect_tp": 1601,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 90,
            "no_defect_support": 1691,
            "defect_precision": 0.9446834665027658,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9573341638118966,
            "defect_tp": 1537,
            "defect_fp": 90,
            "defect_tn": 1601,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9645601394303756,
            "recall_macro": 0.964522330041993,
            "f1_macro": 0.9645408738532487,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.965150620200827,
            "no_defect_recall": 0.9662921348314607,
            "no_defect_f1": 0.9657210401891253,
            "no_defect_tp": 1634,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 57,
            "no_defect_support": 1691,
            "defect_precision": 0.9639696586599241,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9633607075173721,
            "defect_tp": 1525,
            "defect_fp": 57,
            "defect_tn": 1634,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9580820245135189,
            "recall_macro": 0.958552668912663,
            "f1_macro": 0.958151957617239,
            "precision_micro": 0.9581679389312977,
            "recall_micro": 0.9581679389312977,
            "f1_micro": 0.9581679389312977,
            "accuracy": 0.9581679389312977,
            "hamming_loss": 0.04183206106870229,
            "no_defect_precision": 0.9714805825242718,
            "no_defect_recall": 0.9467770549970431,
            "no_defect_f1": 0.9589697514225816,
            "no_defect_tp": 1601,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 90,
            "no_defect_support": 1691,
            "defect_precision": 0.9446834665027658,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9573341638118966,
            "defect_tp": 1537,
            "defect_fp": 90,
            "defect_tn": 1601,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.959572563500056,
            "recall_macro": 0.9600111105137716,
            "f1_macro": 0.9596757042340232,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9709969788519638,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9605499103407054,
            "no_defect_tp": 1607,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9481481481481482,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9588014981273408,
            "defect_tp": 1536,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598585276219167,
            "recall_macro": 0.9602468729279787,
            "f1_macro": 0.9599772975354075,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9693140794223827,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9609305099910528,
            "no_defect_tp": 1611,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9504029758214507,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9590240850797622,
            "defect_tp": 1533,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9636012536694768,
            "recall_macro": 0.9636552544964727,
            "f1_macro": 0.9636274431023455,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9656398104265402,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.9647824800236756,
            "no_defect_tp": 1630,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9615626969124134,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9624724061810155,
            "defect_tp": 1526,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9634468584850264,
            "recall_macro": 0.9631997831657797,
            "f1_macro": 0.9633103374104603,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9612448620082208,
            "no_defect_recall": 0.9680662329982259,
            "no_defect_f1": 0.9646434885091337,
            "no_defect_tp": 1637,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 54,
            "no_defect_support": 1691,
            "defect_precision": 0.9656488549618321,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9619771863117871,
            "defect_tp": 1518,
            "defect_fp": 54,
            "defect_tn": 1637,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626232253644427,
            "recall_macro": 0.9628480995645395,
            "f1_macro": 0.9627180279213092,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9677996422182469,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9637767220902613,
            "no_defect_tp": 1623,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9574468085106383,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.961659333752357,
            "defect_tp": 1530,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629513933208083,
            "recall_macro": 0.963103835516609,
            "f1_macro": 0.9630203225618912,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9667063020214031,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9641268900088942,
            "no_defect_tp": 1626,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9591964846202135,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9619137551148883,
            "defect_tp": 1528,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626406131858241,
            "recall_macro": 0.9628081524888148,
            "f1_macro": 0.9627153838631098,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.966686496133254,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9638196915776986,
            "no_defect_tp": 1625,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.958594730238394,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.961611076148521,
            "defect_tp": 1528,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 56,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9688896476759495,
            "recall_macro": 0.9688449066308845,
            "f1_macro": 0.9688614978149597,
            "precision_micro": 0.9688644688644689,
            "recall_micro": 0.9688644688644689,
            "f1_micro": 0.9688644688644689,
            "accuracy": 0.9688644688644689,
            "hamming_loss": 0.031135531135531136,
            "no_defect_precision": 0.9668275030156815,
            "no_defect_recall": 0.9715151515151516,
            "no_defect_f1": 0.9691656590084643,
            "no_defect_tp": 1603,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 47,
            "no_defect_support": 1650,
            "defect_precision": 0.9709517923362175,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.968557336621455,
            "defect_tp": 1571,
            "defect_fp": 47,
            "defect_tn": 1603,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.001_s140_20251207_185545",
    "lr": 0.005,
    "weight_decay": 0.001,
    "seed": 140,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9645584726427606,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.001_s140_20251207_185545",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s140_20251207_185545",
      "timestamp": "2025-12-07T18:57:39.489048",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 11,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.001_s140",
          "seed": 140,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s140_20251207_185545"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9644367970454928,
        "recall_macro": 0.964801959572066,
        "f1_macro": 0.9645584726427606,
        "precision_micro": 0.9645801526717557,
        "recall_micro": 0.9645801526717557,
        "f1_micro": 0.9645801526717557,
        "accuracy": 0.9645801526717557,
        "hamming_loss": 0.035419847328244276,
        "no_defect_precision": 0.972972972972973,
        "no_defect_recall": 0.9580130100532229,
        "no_defect_f1": 0.965435041716329,
        "no_defect_tp": 1620,
        "no_defect_fp": 45,
        "no_defect_tn": 1539,
        "no_defect_fn": 71,
        "no_defect_support": 1691,
        "defect_precision": 0.9559006211180124,
        "defect_recall": 0.9715909090909091,
        "defect_f1": 0.9636819035691923,
        "defect_tp": 1539,
        "defect_fp": 71,
        "defect_tn": 1620,
        "defect_fn": 45,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9679611071454531,
        "recall_macro": 0.9679358157217937,
        "f1_macro": 0.9679462061337196,
        "precision_micro": 0.967948717948718,
        "recall_micro": 0.967948717948718,
        "f1_micro": 0.967948717948718,
        "accuracy": 0.967948717948718,
        "hamming_loss": 0.03205128205128205,
        "no_defect_precision": 0.9667673716012085,
        "no_defect_recall": 0.9696969696969697,
        "no_defect_f1": 0.9682299546142209,
        "no_defect_tp": 1600,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 50,
        "no_defect_support": 1650,
        "defect_precision": 0.9691548426896978,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.9676624576532183,
        "defect_tp": 1571,
        "defect_fp": 50,
        "defect_tn": 1600,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4621756099258008,
          0.25778973002812855,
          0.19721631484425717,
          0.17890906131292486,
          0.17358067220224996,
          0.1779404857729768,
          0.17051550038314764,
          0.17187733452564502,
          0.17052878479952593,
          0.1678159043785169,
          0.15961479481356414,
          0.16682952022078645,
          0.16428039589249938,
          0.16515304137286282,
          0.16457552551662075
        ],
        "val_loss": [
          0.37072229786561084,
          0.19218099102951014,
          0.13869074889673635,
          0.12510336849551934,
          0.11612993399970807,
          0.11166057699861434,
          0.11449931669407167,
          0.12179377094770853,
          0.10901571416224425,
          0.10270575462625577,
          0.10234835747486123,
          0.0990544230175706,
          0.1036063852505042,
          0.09996424199869999,
          0.09959361583997424
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8982164248484421,
            "recall_macro": 0.8924245784276831,
            "f1_macro": 0.8933841358070846,
            "precision_micro": 0.8940458015267175,
            "recall_micro": 0.8940458015267175,
            "f1_micro": 0.8940458015267175,
            "accuracy": 0.8940458015267175,
            "hamming_loss": 0.10595419847328244,
            "no_defect_precision": 0.8648208469055375,
            "no_defect_recall": 0.9420461265523359,
            "no_defect_f1": 0.901783187093122,
            "no_defect_tp": 1593,
            "no_defect_fp": 249,
            "no_defect_tn": 1335,
            "no_defect_fn": 98,
            "no_defect_support": 1691,
            "defect_precision": 0.9316120027913468,
            "defect_recall": 0.8428030303030303,
            "defect_f1": 0.8849850845210474,
            "defect_tp": 1335,
            "defect_fp": 98,
            "defect_tn": 1593,
            "defect_fn": 249,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9432747527603627,
            "recall_macro": 0.942510184637624,
            "f1_macro": 0.9427962292260667,
            "precision_micro": 0.9429007633587786,
            "recall_micro": 0.9429007633587786,
            "f1_micro": 0.9429007633587786,
            "accuracy": 0.9429007633587786,
            "hamming_loss": 0.05709923664122137,
            "no_defect_precision": 0.9361948955916474,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9452415812591508,
            "no_defect_tp": 1614,
            "no_defect_fp": 110,
            "no_defect_tn": 1474,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.950354609929078,
            "defect_recall": 0.9305555555555556,
            "defect_f1": 0.9403508771929825,
            "defect_tp": 1474,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 110,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9559677745698187,
            "recall_macro": 0.9560035228094068,
            "f1_macro": 0.9559852910981278,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9579632918886916,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9573964497041421,
            "no_defect_tp": 1618,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9539722572509458,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.9545741324921135,
            "defect_tp": 1513,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9561975456003581,
            "recall_macro": 0.9565988089051365,
            "f1_macro": 0.9563123510415119,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9662650602409638,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9573261712921516,
            "no_defect_tp": 1604,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9461300309597523,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9552985307908721,
            "defect_tp": 1528,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9592459939933218,
            "recall_macro": 0.9595556391830786,
            "f1_macro": 0.9593612900041601,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9664670658682635,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9604284439155013,
            "no_defect_tp": 1614,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9520249221183801,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9582941360928191,
            "defect_tp": 1528,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9583510499421879,
            "recall_macro": 0.9587884313268702,
            "f1_macro": 0.9584537558774784,
            "precision_micro": 0.9584732824427481,
            "recall_micro": 0.9584732824427481,
            "f1_micro": 0.9584732824427481,
            "accuracy": 0.9584732824427481,
            "hamming_loss": 0.04152671755725191,
            "no_defect_precision": 0.9697885196374623,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9593544530783025,
            "no_defect_tp": 1605,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9469135802469136,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9575530586766542,
            "defect_tp": 1534,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9579346556454102,
            "recall_macro": 0.9584167741877676,
            "f1_macro": 0.9578539152076166,
            "precision_micro": 0.9578625954198473,
            "recall_micro": 0.9578625954198473,
            "f1_micro": 0.9578625954198473,
            "accuracy": 0.9578625954198473,
            "hamming_loss": 0.04213740458015267,
            "no_defect_precision": 0.9760882893930104,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9584587597832631,
            "no_defect_tp": 1592,
            "no_defect_fp": 39,
            "no_defect_tn": 1545,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.9397810218978102,
            "defect_recall": 0.9753787878787878,
            "defect_f1": 0.9572490706319703,
            "defect_tp": 1545,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 39,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540096336856682,
            "recall_macro": 0.9543571059500983,
            "f1_macro": 0.9535850815850816,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.978247358607831,
            "no_defect_recall": 0.9308101714961561,
            "no_defect_f1": 0.953939393939394,
            "no_defect_tp": 1574,
            "no_defect_fp": 35,
            "no_defect_tn": 1549,
            "no_defect_fn": 117,
            "no_defect_support": 1691,
            "defect_precision": 0.9297719087635054,
            "defect_recall": 0.9779040404040404,
            "defect_f1": 0.9532307692307692,
            "defect_tp": 1549,
            "defect_fp": 117,
            "defect_tn": 1574,
            "defect_fn": 35,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.959303448779993,
            "recall_macro": 0.9597753480995646,
            "f1_macro": 0.9593737982707504,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9726941747572816,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.960167714884696,
            "no_defect_tp": 1603,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9459127228027043,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9585798816568047,
            "defect_tp": 1539,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9632423076750841,
            "recall_macro": 0.9634394656201279,
            "f1_macro": 0.9633279211690275,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9678379988088148,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9643916913946587,
            "no_defect_tp": 1625,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9586466165413534,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9622641509433962,
            "defect_tp": 1530,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644367970454928,
            "recall_macro": 0.964801959572066,
            "f1_macro": 0.9645584726427606,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.972972972972973,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.965435041716329,
            "no_defect_tp": 1620,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9559006211180124,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9636819035691923,
            "defect_tp": 1539,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635740529791239,
            "recall_macro": 0.9636952015721975,
            "f1_macro": 0.9636302128900555,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9667458432304038,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9647407407407408,
            "no_defect_tp": 1628,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.9604022627278441,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9625196850393701,
            "defect_tp": 1528,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962002563276219,
            "recall_macro": 0.96241652181185,
            "f1_macro": 0.9621175373134329,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9722724532851115,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9629850746268657,
            "no_defect_tp": 1613,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9517326732673267,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.96125,
            "defect_tp": 1538,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629193074519584,
            "recall_macro": 0.9631837296680584,
            "f1_macro": 0.9630255119535527,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9689366786140979,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9640416047548291,
            "no_defect_tp": 1622,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9569019362898189,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9620094191522763,
            "defect_tp": 1532,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635362793870275,
            "recall_macro": 0.9637750957236468,
            "f1_macro": 0.9636354254638893,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9689737470167065,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9646569646569647,
            "no_defect_tp": 1624,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9580988117573483,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9626138862708137,
            "defect_tp": 1532,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 52,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9679611071454531,
            "recall_macro": 0.9679358157217937,
            "f1_macro": 0.9679462061337196,
            "precision_micro": 0.967948717948718,
            "recall_micro": 0.967948717948718,
            "f1_micro": 0.967948717948718,
            "accuracy": 0.967948717948718,
            "hamming_loss": 0.03205128205128205,
            "no_defect_precision": 0.9667673716012085,
            "no_defect_recall": 0.9696969696969697,
            "no_defect_f1": 0.9682299546142209,
            "no_defect_tp": 1600,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 50,
            "no_defect_support": 1650,
            "defect_precision": 0.9691548426896978,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.9676624576532183,
            "defect_tp": 1571,
            "defect_fp": 50,
            "defect_tn": 1600,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.001_s150_20251207_153636",
    "lr": 0.005,
    "weight_decay": 0.001,
    "seed": 150,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9657483847207167,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.001_s150_20251207_153636",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s150_20251207_153636",
      "timestamp": "2025-12-07T15:38:37.574922",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 9,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.001_s150",
          "seed": 150,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s150_20251207_153636"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9660390566078635,
        "recall_macro": 0.9655452738502709,
        "f1_macro": 0.9657483847207167,
        "precision_micro": 0.9658015267175573,
        "recall_micro": 0.9658015267175573,
        "f1_micro": 0.9658015267175573,
        "accuracy": 0.9658015267175573,
        "hamming_loss": 0.03419847328244275,
        "no_defect_precision": 0.960887332165791,
        "no_defect_recall": 0.9733885274985216,
        "no_defect_f1": 0.9670975323149236,
        "no_defect_tp": 1646,
        "no_defect_fp": 67,
        "no_defect_tn": 1517,
        "no_defect_fn": 45,
        "no_defect_support": 1691,
        "defect_precision": 0.971190781049936,
        "defect_recall": 0.9577020202020202,
        "defect_f1": 0.9643992371265099,
        "defect_tp": 1517,
        "defect_fp": 45,
        "defect_tn": 1646,
        "defect_fn": 67,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.967049114331723,
        "recall_macro": 0.9670177792687018,
        "f1_macro": 0.9670302021865806,
        "precision_micro": 0.967032967032967,
        "recall_micro": 0.967032967032967,
        "f1_micro": 0.967032967032967,
        "accuracy": 0.967032967032967,
        "hamming_loss": 0.03296703296703297,
        "no_defect_precision": 0.9655797101449275,
        "no_defect_recall": 0.9690909090909091,
        "no_defect_f1": 0.9673321234119783,
        "no_defect_tp": 1599,
        "no_defect_fp": 57,
        "no_defect_tn": 1569,
        "no_defect_fn": 51,
        "no_defect_support": 1650,
        "defect_precision": 0.9685185185185186,
        "defect_recall": 0.9649446494464945,
        "defect_f1": 0.966728280961183,
        "defect_tp": 1569,
        "defect_fp": 51,
        "defect_tn": 1599,
        "defect_fn": 57,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4647563987696021,
          0.25958226259532835,
          0.19360855966806412,
          0.17938146571858657,
          0.1804091473067156,
          0.1759346454369224,
          0.17929972717577444,
          0.17379298831129672,
          0.17035960184729748,
          0.16641328700479105,
          0.1626537986349112,
          0.1713966186700007,
          0.17032006757029927,
          0.16715906577566678,
          0.16331470754605457
        ],
        "val_loss": [
          0.3705547262842839,
          0.19354715656775695,
          0.14057511592713687,
          0.13715493478454077,
          0.12070842689046493,
          0.1071691053847854,
          0.1119765923716701,
          0.10624738546231619,
          0.10296213562385394,
          0.10333151355958901,
          0.10330592955534275,
          0.10082900832192256,
          0.10244392689604026,
          0.10108690261124419,
          0.10150529426307632
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8938062556255626,
            "recall_macro": 0.8920208142931383,
            "f1_macro": 0.8925140039659085,
            "precision_micro": 0.8928244274809161,
            "recall_micro": 0.8928244274809161,
            "f1_micro": 0.8928244274809161,
            "accuracy": 0.8928244274809161,
            "hamming_loss": 0.10717557251908397,
            "no_defect_precision": 0.8806818181818182,
            "no_defect_recall": 0.9166173861620343,
            "no_defect_f1": 0.8982903506230078,
            "no_defect_tp": 1550,
            "no_defect_fp": 210,
            "no_defect_tn": 1374,
            "no_defect_fn": 141,
            "no_defect_support": 1691,
            "defect_precision": 0.906930693069307,
            "defect_recall": 0.8674242424242424,
            "defect_f1": 0.8867376573088093,
            "defect_tp": 1374,
            "defect_fp": 141,
            "defect_tn": 1550,
            "defect_fn": 210,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9437729014317152,
            "recall_macro": 0.9437367838646668,
            "f1_macro": 0.9437544895603256,
            "precision_micro": 0.9438167938931298,
            "recall_micro": 0.9438167938931298,
            "f1_micro": 0.9438167938931298,
            "accuracy": 0.9438167938931298,
            "hamming_loss": 0.05618320610687023,
            "no_defect_precision": 0.9450679267572357,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.9456264775413712,
            "no_defect_tp": 1600,
            "no_defect_fp": 93,
            "no_defect_tn": 1491,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9424778761061947,
            "defect_recall": 0.9412878787878788,
            "defect_f1": 0.9418825015792799,
            "defect_tp": 1491,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 93,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546159955826435,
            "recall_macro": 0.9543053987539498,
            "f1_macro": 0.9544405937927171,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9519343493552169,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.95613776861937,
            "no_defect_tp": 1624,
            "no_defect_fp": 82,
            "no_defect_tn": 1502,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9572976418100702,
            "defect_recall": 0.9482323232323232,
            "defect_f1": 0.9527434189660641,
            "defect_tp": 1502,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 82,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9536468443976251,
            "recall_macro": 0.9540214758465793,
            "f1_macro": 0.9532790276331369,
            "precision_micro": 0.9532824427480916,
            "recall_micro": 0.9532824427480916,
            "f1_micro": 0.9532824427480916,
            "accuracy": 0.9532824427480916,
            "hamming_loss": 0.0467175572519084,
            "no_defect_precision": 0.9770471464019851,
            "no_defect_recall": 0.9314015375517445,
            "no_defect_f1": 0.9536784741144414,
            "no_defect_tp": 1575,
            "no_defect_fp": 37,
            "no_defect_tn": 1547,
            "no_defect_fn": 116,
            "no_defect_support": 1691,
            "defect_precision": 0.9302465423932652,
            "defect_recall": 0.9766414141414141,
            "defect_f1": 0.9528795811518325,
            "defect_tp": 1547,
            "defect_fp": 116,
            "defect_tn": 1575,
            "defect_fn": 37,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9586605891387749,
            "recall_macro": 0.9591040878925268,
            "f1_macro": 0.9587597853689933,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.9703748488512697,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9596412556053812,
            "no_defect_tp": 1605,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9469463294262801,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9578783151326054,
            "defect_tp": 1535,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9645258579175243,
            "recall_macro": 0.9645622771177177,
            "f1_macro": 0.9645437067179363,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9662522202486679,
            "no_defect_recall": 0.9651094027202839,
            "no_defect_f1": 0.9656804733727811,
            "no_defect_tp": 1632,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 59,
            "no_defect_support": 1691,
            "defect_precision": 0.9627994955863808,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9634069400630915,
            "defect_tp": 1527,
            "defect_fp": 59,
            "defect_tn": 1632,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9616947666828304,
            "recall_macro": 0.9621008652461935,
            "f1_macro": 0.9618114956656572,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9716867469879518,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9626977021784542,
            "no_defect_tp": 1613,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.951702786377709,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9609252891528602,
            "defect_tp": 1537,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629126464205169,
            "recall_macro": 0.9633035708952327,
            "f1_macro": 0.9630324656624757,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9723225030084236,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9639129138085297,
            "no_defect_tp": 1616,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.95350278983261,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9621520175164217,
            "defect_tp": 1538,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9660390566078635,
            "recall_macro": 0.9655452738502709,
            "f1_macro": 0.9657483847207167,
            "precision_micro": 0.9658015267175573,
            "recall_micro": 0.9658015267175573,
            "f1_micro": 0.9658015267175573,
            "accuracy": 0.9658015267175573,
            "hamming_loss": 0.03419847328244275,
            "no_defect_precision": 0.960887332165791,
            "no_defect_recall": 0.9733885274985216,
            "no_defect_f1": 0.9670975323149236,
            "no_defect_tp": 1646,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 45,
            "no_defect_support": 1691,
            "defect_precision": 0.971190781049936,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9643992371265099,
            "defect_tp": 1517,
            "defect_fp": 45,
            "defect_tn": 1646,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9645423035798553,
            "recall_macro": 0.9645423035798553,
            "f1_macro": 0.9645423035798553,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9657007687758723,
            "no_defect_recall": 0.9657007687758723,
            "no_defect_f1": 0.9657007687758723,
            "no_defect_tp": 1633,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 58,
            "no_defect_support": 1691,
            "defect_precision": 0.9633838383838383,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9633838383838383,
            "defect_tp": 1526,
            "defect_fp": 58,
            "defect_tn": 1633,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626113652017465,
            "recall_macro": 0.9628880466402643,
            "f1_macro": 0.9627205602991089,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9689181111775254,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9637336504161712,
            "no_defect_tp": 1621,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9563046192259675,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9617074701820465,
            "defect_tp": 1532,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638205434391107,
            "recall_macro": 0.9634555191178491,
            "f1_macro": 0.9636119571076265,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9601873536299765,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.9649897028537805,
            "no_defect_tp": 1640,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.967453733248245,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9622342113614726,
            "defect_tp": 1516,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629412972085386,
            "recall_macro": 0.9631238090544714,
            "f1_macro": 0.9630216614539442,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9672619047619048,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9641056066449125,
            "no_defect_tp": 1625,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9586206896551724,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9619377162629758,
            "defect_tp": 1529,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9636012536694768,
            "recall_macro": 0.9636552544964727,
            "f1_macro": 0.9636274431023455,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9656398104265402,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.9647824800236756,
            "no_defect_tp": 1630,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9615626969124134,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9624724061810155,
            "defect_tp": 1526,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635869601732552,
            "recall_macro": 0.963675228034335,
            "f1_macro": 0.9636288416263183,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9661921708185054,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9647616227420788,
            "no_defect_tp": 1629,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9609817495280051,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9624960605105578,
            "defect_tp": 1527,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 57,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.967049114331723,
            "recall_macro": 0.9670177792687018,
            "f1_macro": 0.9670302021865806,
            "precision_micro": 0.967032967032967,
            "recall_micro": 0.967032967032967,
            "f1_micro": 0.967032967032967,
            "accuracy": 0.967032967032967,
            "hamming_loss": 0.03296703296703297,
            "no_defect_precision": 0.9655797101449275,
            "no_defect_recall": 0.9690909090909091,
            "no_defect_f1": 0.9673321234119783,
            "no_defect_tp": 1599,
            "no_defect_fp": 57,
            "no_defect_tn": 1569,
            "no_defect_fn": 51,
            "no_defect_support": 1650,
            "defect_precision": 0.9685185185185186,
            "defect_recall": 0.9649446494464945,
            "defect_f1": 0.966728280961183,
            "defect_tp": 1569,
            "defect_fp": 51,
            "defect_tn": 1599,
            "defect_fn": 57,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.01_s10_20251207_151929",
    "lr": 0.005,
    "weight_decay": 0.01,
    "seed": 10,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9642555599430551,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.01_s10_20251207_151929",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s10_20251207_151929",
      "timestamp": "2025-12-07T15:21:20.835620",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.01_s10",
          "seed": 10,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s10_20251207_151929"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9641379760528181,
        "recall_macro": 0.9645462236199965,
        "f1_macro": 0.9642555599430551,
        "precision_micro": 0.9642748091603054,
        "recall_micro": 0.9642748091603054,
        "f1_micro": 0.9642748091603054,
        "accuracy": 0.9642748091603054,
        "hamming_loss": 0.03572519083969466,
        "no_defect_precision": 0.9740963855421687,
        "no_defect_recall": 0.9562389118864577,
        "no_defect_f1": 0.9650850492390332,
        "no_defect_tp": 1617,
        "no_defect_fp": 43,
        "no_defect_tn": 1541,
        "no_defect_fn": 74,
        "no_defect_support": 1691,
        "defect_precision": 0.9541795665634675,
        "defect_recall": 0.9728535353535354,
        "defect_f1": 0.9634260706470772,
        "defect_tp": 1541,
        "defect_fp": 74,
        "defect_tn": 1617,
        "defect_fn": 43,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9679611071454531,
        "recall_macro": 0.9679358157217937,
        "f1_macro": 0.9679462061337196,
        "precision_micro": 0.967948717948718,
        "recall_micro": 0.967948717948718,
        "f1_micro": 0.967948717948718,
        "accuracy": 0.967948717948718,
        "hamming_loss": 0.03205128205128205,
        "no_defect_precision": 0.9667673716012085,
        "no_defect_recall": 0.9696969696969697,
        "no_defect_f1": 0.9682299546142209,
        "no_defect_tp": 1600,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 50,
        "no_defect_support": 1650,
        "defect_precision": 0.9691548426896978,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.9676624576532183,
        "defect_tp": 1571,
        "defect_fp": 50,
        "defect_tn": 1600,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.466898134188672,
          0.25963237738260164,
          0.19914285551803382,
          0.18492759190593305,
          0.17577939318438454,
          0.17221085382742363,
          0.17842187031043624,
          0.17775537901281313,
          0.1716424993796578,
          0.16724196509711414,
          0.16624465829470667,
          0.16750452742292293,
          0.16064317702124808,
          0.16156415231370028,
          0.16827435037082208
        ],
        "val_loss": [
          0.3712975915807944,
          0.19589625356289056,
          0.155588827883968,
          0.12444593563962442,
          0.11694816829493412,
          0.11440477033074085,
          0.11456563173291776,
          0.1089315411563103,
          0.11083415379891029,
          0.10587947135074781,
          0.10567424947825763,
          0.10651377774775028,
          0.10292091901199175,
          0.10329266257870656,
          0.10300059695369922
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8914824445872028,
            "recall_macro": 0.8899510330985789,
            "f1_macro": 0.8903951588959362,
            "precision_micro": 0.8906870229007634,
            "recall_micro": 0.8906870229007634,
            "f1_micro": 0.8906870229007634,
            "accuracy": 0.8906870229007634,
            "hamming_loss": 0.10931297709923664,
            "no_defect_precision": 0.8802053622361665,
            "no_defect_recall": 0.9124778237729154,
            "no_defect_f1": 0.8960511033681765,
            "no_defect_tp": 1543,
            "no_defect_fp": 210,
            "no_defect_tn": 1374,
            "no_defect_fn": 148,
            "no_defect_support": 1691,
            "defect_precision": 0.9027595269382391,
            "defect_recall": 0.8674242424242424,
            "defect_f1": 0.8847392144236961,
            "defect_tp": 1374,
            "defect_fp": 148,
            "defect_tn": 1543,
            "defect_fn": 210,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.944462372458984,
            "recall_macro": 0.9442682293066682,
            "f1_macro": 0.9443564636681923,
            "precision_micro": 0.9444274809160306,
            "recall_micro": 0.9444274809160306,
            "f1_micro": 0.9444274809160306,
            "accuracy": 0.9444274809160306,
            "hamming_loss": 0.055572519083969464,
            "no_defect_precision": 0.9435626102292769,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9463443396226415,
            "no_defect_tp": 1605,
            "no_defect_fp": 96,
            "no_defect_tn": 1488,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9453621346886912,
            "defect_recall": 0.9393939393939394,
            "defect_f1": 0.9423685877137429,
            "defect_tp": 1488,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 96,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9487238021913913,
            "recall_macro": 0.9491107855611107,
            "f1_macro": 0.9483926161276862,
            "precision_micro": 0.9483969465648855,
            "recall_micro": 0.9483969465648855,
            "f1_micro": 0.9483969465648855,
            "accuracy": 0.9483969465648855,
            "hamming_loss": 0.0516030534351145,
            "no_defect_precision": 0.9714993804213135,
            "no_defect_recall": 0.9272619751626257,
            "no_defect_f1": 0.9488653555219364,
            "no_defect_tp": 1568,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 123,
            "no_defect_support": 1691,
            "defect_precision": 0.925948223961469,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.947919876733436,
            "defect_tp": 1538,
            "defect_fp": 123,
            "defect_tn": 1568,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.958131723139922,
            "recall_macro": 0.958113251079691,
            "f1_macro": 0.9581223974961268,
            "precision_micro": 0.9581679389312977,
            "recall_micro": 0.9581679389312977,
            "f1_micro": 0.9581679389312977,
            "accuracy": 0.9581679389312977,
            "hamming_loss": 0.04183206106870229,
            "no_defect_precision": 0.9592198581560284,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9595033993496896,
            "no_defect_tp": 1623,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9570435881238155,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9567413956425639,
            "defect_tp": 1515,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9631285283459197,
            "recall_macro": 0.9629041001379854,
            "f1_macro": 0.9630054087581421,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9612220916568742,
            "no_defect_recall": 0.9674748669426375,
            "no_defect_f1": 0.9643383436486884,
            "no_defect_tp": 1636,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 55,
            "no_defect_support": 1691,
            "defect_precision": 0.965034965034965,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9616724738675958,
            "defect_tp": 1518,
            "defect_fp": 55,
            "defect_tn": 1636,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.959337726093368,
            "recall_macro": 0.959355903804455,
            "f1_macro": 0.959346725230902,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9609467455621302,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9606625258799172,
            "no_defect_tp": 1624,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9577287066246056,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.958030924581887,
            "defect_tp": 1518,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9601656785487013,
            "recall_macro": 0.9605625294936353,
            "f1_macro": 0.960283388633409,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9698976520168573,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.961217183770883,
            "no_defect_tp": 1611,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9504337050805453,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.959349593495935,
            "defect_tp": 1534,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620806912467512,
            "recall_macro": 0.9621169187439147,
            "f1_macro": 0.9620984451122767,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9638839550029603,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9633136094674556,
            "no_defect_tp": 1628,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.9602774274905422,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9608832807570978,
            "defect_tp": 1523,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962002563276219,
            "recall_macro": 0.96241652181185,
            "f1_macro": 0.9621175373134329,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9722724532851115,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9629850746268657,
            "no_defect_tp": 1613,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9517326732673267,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.96125,
            "defect_tp": 1538,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9632241479120787,
            "recall_macro": 0.9636392009987516,
            "f1_macro": 0.963339552238806,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9734779987944545,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9641791044776119,
            "no_defect_tp": 1615,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9529702970297029,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9625,
            "defect_tp": 1540,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9619930491513637,
            "recall_macro": 0.9623366276604006,
            "f1_macro": 0.962113070048558,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.97000599880024,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9630732578916021,
            "no_defect_tp": 1617,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9539800995024875,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9611528822055138,
            "defect_tp": 1534,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9641379760528181,
            "recall_macro": 0.9645462236199965,
            "f1_macro": 0.9642555599430551,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.9740963855421687,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9650850492390332,
            "no_defect_tp": 1617,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9541795665634675,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9634260706470772,
            "defect_tp": 1541,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629325844122211,
            "recall_macro": 0.9631437825923337,
            "f1_macro": 0.9630229726460042,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9678188319427891,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9640842980112793,
            "no_defect_tp": 1624,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9580463368816531,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9619616472807293,
            "defect_tp": 1530,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629252545967721,
            "recall_macro": 0.9631637561301961,
            "f1_macro": 0.9630242561439546,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9683770883054893,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9640629640629641,
            "no_defect_tp": 1623,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.957473420888055,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.961985548224945,
            "defect_tp": 1531,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629252545967721,
            "recall_macro": 0.9631637561301961,
            "f1_macro": 0.9630242561439546,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9683770883054893,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9640629640629641,
            "no_defect_tp": 1623,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.957473420888055,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.961985548224945,
            "defect_tp": 1531,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 53,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9679611071454531,
            "recall_macro": 0.9679358157217937,
            "f1_macro": 0.9679462061337196,
            "precision_micro": 0.967948717948718,
            "recall_micro": 0.967948717948718,
            "f1_micro": 0.967948717948718,
            "accuracy": 0.967948717948718,
            "hamming_loss": 0.03205128205128205,
            "no_defect_precision": 0.9667673716012085,
            "no_defect_recall": 0.9696969696969697,
            "no_defect_f1": 0.9682299546142209,
            "no_defect_tp": 1600,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 50,
            "no_defect_support": 1650,
            "defect_precision": 0.9691548426896978,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.9676624576532183,
            "defect_tp": 1571,
            "defect_fp": 50,
            "defect_tn": 1600,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.01_s20_20251207_150251",
    "lr": 0.005,
    "weight_decay": 0.01,
    "seed": 20,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.964241469816273,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.01_s20_20251207_150251",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s20_20251207_150251",
      "timestamp": "2025-12-07T15:04:43.199963",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 11,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.01_s20",
          "seed": 20,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s20_20251207_150251"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9641852328492664,
        "recall_macro": 0.9643065411656482,
        "f1_macro": 0.964241469816273,
        "precision_micro": 0.9642748091603054,
        "recall_micro": 0.9642748091603054,
        "f1_micro": 0.9642748091603054,
        "accuracy": 0.9642748091603054,
        "hamming_loss": 0.03572519083969466,
        "no_defect_precision": 0.9673396674584323,
        "no_defect_recall": 0.9633353045535187,
        "no_defect_f1": 0.9653333333333334,
        "no_defect_tp": 1629,
        "no_defect_fp": 55,
        "no_defect_tn": 1529,
        "no_defect_fn": 62,
        "no_defect_support": 1691,
        "defect_precision": 0.9610307982401005,
        "defect_recall": 0.9652777777777778,
        "defect_f1": 0.9631496062992126,
        "defect_tp": 1529,
        "defect_fp": 62,
        "defect_tn": 1629,
        "defect_fn": 55,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9679416100290906,
        "recall_macro": 0.9679581795817958,
        "f1_macro": 0.9679476397981144,
        "precision_micro": 0.967948717948718,
        "recall_micro": 0.967948717948718,
        "f1_micro": 0.967948717948718,
        "accuracy": 0.967948717948718,
        "hamming_loss": 0.03205128205128205,
        "no_defect_precision": 0.9696048632218845,
        "no_defect_recall": 0.9666666666666667,
        "no_defect_f1": 0.9681335356600911,
        "no_defect_tp": 1595,
        "no_defect_fp": 50,
        "no_defect_tn": 1576,
        "no_defect_fn": 55,
        "no_defect_support": 1650,
        "defect_precision": 0.9662783568362967,
        "defect_recall": 0.9692496924969249,
        "defect_f1": 0.9677617439361376,
        "defect_tp": 1576,
        "defect_fp": 55,
        "defect_tn": 1595,
        "defect_fn": 50,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.46931810645877564,
          0.25686735145467093,
          0.19769193656025572,
          0.18161002116347955,
          0.17404741556948697,
          0.1744761204339221,
          0.17232874461360057,
          0.1784912972520086,
          0.16726160563809103,
          0.16995589399250483,
          0.1666180664774763,
          0.16750923943195384,
          0.16588423025470897,
          0.16742316052068226,
          0.1685248556776775
        ],
        "val_loss": [
          0.36987355981881803,
          0.19228878817879236,
          0.14322926992407212,
          0.12103145096737605,
          0.1323825212625357,
          0.11238243724577703,
          0.1077044725847932,
          0.11219421380127852,
          0.11114384176639411,
          0.10534066699731809,
          0.1027797872487169,
          0.10585666899211131,
          0.10457523181461371,
          0.10545305420572941,
          0.10603062729709424
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8965500231336581,
            "recall_macro": 0.8916573705714747,
            "f1_macro": 0.8925381490742672,
            "precision_micro": 0.8931297709923665,
            "recall_micro": 0.8931297709923665,
            "f1_micro": 0.8931297709923665,
            "accuracy": 0.8931297709923665,
            "hamming_loss": 0.10687022900763359,
            "no_defect_precision": 0.8669950738916257,
            "no_defect_recall": 0.9367238320520402,
            "no_defect_f1": 0.900511654349062,
            "no_defect_tp": 1584,
            "no_defect_fp": 243,
            "no_defect_tn": 1341,
            "no_defect_fn": 107,
            "no_defect_support": 1691,
            "defect_precision": 0.9261049723756906,
            "defect_recall": 0.8465909090909091,
            "defect_f1": 0.8845646437994723,
            "defect_tp": 1341,
            "defect_fp": 107,
            "defect_tn": 1584,
            "defect_fn": 243,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9445617708667284,
            "recall_macro": 0.9441883351552187,
            "f1_macro": 0.9443464052287581,
            "precision_micro": 0.9444274809160306,
            "recall_micro": 0.9444274809160306,
            "f1_micro": 0.9444274809160306,
            "accuracy": 0.9444274809160306,
            "hamming_loss": 0.055572519083969464,
            "no_defect_precision": 0.9414862492685782,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9464705882352941,
            "no_defect_tp": 1609,
            "no_defect_fp": 100,
            "no_defect_tn": 1484,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9476372924648787,
            "defect_recall": 0.9368686868686869,
            "defect_f1": 0.9422222222222222,
            "defect_tp": 1484,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 100,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9504101500625728,
            "recall_macro": 0.9490551583248212,
            "f1_macro": 0.9495007831759178,
            "precision_micro": 0.9496183206106871,
            "recall_micro": 0.9496183206106871,
            "f1_micro": 0.9496183206106871,
            "accuracy": 0.9496183206106871,
            "hamming_loss": 0.050381679389312976,
            "no_defect_precision": 0.9380022962112514,
            "no_defect_recall": 0.9662921348314607,
            "no_defect_f1": 0.9519370812700262,
            "no_defect_tp": 1634,
            "no_defect_fp": 108,
            "no_defect_tn": 1476,
            "no_defect_fn": 57,
            "no_defect_support": 1691,
            "defect_precision": 0.9628180039138943,
            "defect_recall": 0.9318181818181818,
            "defect_f1": 0.9470644850818094,
            "defect_tp": 1476,
            "defect_fp": 57,
            "defect_tn": 1634,
            "defect_fn": 108,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9630226370911981,
            "recall_macro": 0.9630039678272972,
            "f1_macro": 0.96301321238709,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9639479905437353,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9642329293526456,
            "no_defect_tp": 1631,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9620972836386608,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9617934954215346,
            "defect_tp": 1523,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540096336856682,
            "recall_macro": 0.9543571059500983,
            "f1_macro": 0.9535850815850816,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.978247358607831,
            "no_defect_recall": 0.9308101714961561,
            "no_defect_f1": 0.953939393939394,
            "no_defect_tp": 1574,
            "no_defect_fp": 35,
            "no_defect_tn": 1549,
            "no_defect_fn": 117,
            "no_defect_support": 1691,
            "defect_precision": 0.9297719087635054,
            "defect_recall": 0.9779040404040404,
            "defect_f1": 0.9532307692307692,
            "defect_tp": 1549,
            "defect_fp": 117,
            "defect_tn": 1574,
            "defect_fn": 35,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9632159435072343,
            "recall_macro": 0.9635393333094397,
            "f1_macro": 0.96333407971339,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9706411024565608,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9642857142857143,
            "no_defect_tp": 1620,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9557907845579079,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9623824451410659,
            "defect_tp": 1535,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.963269137053713,
            "recall_macro": 0.9628042324486736,
            "f1_macro": 0.9629969107988139,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9585280373831776,
            "no_defect_recall": 0.9704316972205795,
            "no_defect_f1": 0.9644431384072877,
            "no_defect_tp": 1641,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 50,
            "no_defect_support": 1691,
            "defect_precision": 0.9680102367242482,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.96155068319034,
            "defect_tp": 1513,
            "defect_fp": 50,
            "defect_tn": 1641,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9611490026979108,
            "recall_macro": 0.9616293404177793,
            "f1_macro": 0.9612074710348961,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9750911300121506,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9619418639496554,
            "no_defect_tp": 1605,
            "no_defect_fp": 41,
            "no_defect_tn": 1543,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.947206875383671,
            "defect_recall": 0.9741161616161617,
            "defect_f1": 0.9604730781201369,
            "defect_tp": 1543,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 41,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962015590615792,
            "recall_macro": 0.9624564688875747,
            "f1_macro": 0.9621196009471126,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9734138972809667,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.962940824865511,
            "no_defect_tp": 1611,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9506172839506173,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9612983770287141,
            "defect_tp": 1540,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629325844122211,
            "recall_macro": 0.9631437825923337,
            "f1_macro": 0.9630229726460042,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9678188319427891,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9640842980112793,
            "no_defect_tp": 1624,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9580463368816531,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9619616472807293,
            "defect_tp": 1530,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9641852328492664,
            "recall_macro": 0.9643065411656482,
            "f1_macro": 0.964241469816273,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.9673396674584323,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9653333333333334,
            "no_defect_tp": 1629,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9610307982401005,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9631496062992126,
            "defect_tp": 1529,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629147426923801,
            "recall_macro": 0.9632037032059209,
            "f1_macro": 0.963026740080432,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9694976076555024,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9640202200416295,
            "no_defect_tp": 1621,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9563318777292577,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9620332601192344,
            "defect_tp": 1533,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620294949009409,
            "recall_macro": 0.962196812895364,
            "f1_macro": 0.9621041606477511,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9660916121356335,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.963226571767497,
            "no_defect_tp": 1624,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9579673776662484,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9609817495280051,
            "defect_tp": 1527,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623006323800996,
            "recall_macro": 0.9626123371503323,
            "f1_macro": 0.9624168321091106,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9694610778443113,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9634037488842606,
            "no_defect_tp": 1619,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9551401869158879,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9614299153339605,
            "defect_tp": 1533,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626050304169431,
            "recall_macro": 0.9629279937159889,
            "f1_macro": 0.9627229810419466,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9700419412822049,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9636904761904762,
            "no_defect_tp": 1619,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9551681195516812,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.961755485893417,
            "defect_tp": 1534,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 50,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9679416100290906,
            "recall_macro": 0.9679581795817958,
            "f1_macro": 0.9679476397981144,
            "precision_micro": 0.967948717948718,
            "recall_micro": 0.967948717948718,
            "f1_micro": 0.967948717948718,
            "accuracy": 0.967948717948718,
            "hamming_loss": 0.03205128205128205,
            "no_defect_precision": 0.9696048632218845,
            "no_defect_recall": 0.9666666666666667,
            "no_defect_f1": 0.9681335356600911,
            "no_defect_tp": 1595,
            "no_defect_fp": 50,
            "no_defect_tn": 1576,
            "no_defect_fn": 55,
            "no_defect_support": 1650,
            "defect_precision": 0.9662783568362967,
            "defect_recall": 0.9692496924969249,
            "defect_f1": 0.9677617439361376,
            "defect_tp": 1576,
            "defect_fp": 55,
            "defect_tn": 1595,
            "defect_fn": 50,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.01_s30_20251207_210045",
    "lr": 0.005,
    "weight_decay": 0.01,
    "seed": 30,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9636031894523449,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.01_s30_20251207_210045",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s30_20251207_210045",
      "timestamp": "2025-12-07T21:02:41.636674",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 8,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.01_s30",
          "seed": 30,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s30_20251207_210045"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9639823681103701,
        "recall_macro": 0.9633556514285373,
        "f1_macro": 0.9636031894523449,
        "precision_micro": 0.9636641221374046,
        "recall_micro": 0.9636641221374046,
        "f1_micro": 0.9636641221374046,
        "accuracy": 0.9636641221374046,
        "hamming_loss": 0.03633587786259542,
        "no_defect_precision": 0.9575087310826542,
        "no_defect_recall": 0.9727971614429332,
        "no_defect_f1": 0.9650924024640657,
        "no_defect_tp": 1645,
        "no_defect_fp": 73,
        "no_defect_tn": 1511,
        "no_defect_fn": 46,
        "no_defect_support": 1691,
        "defect_precision": 0.970456005138086,
        "defect_recall": 0.9539141414141414,
        "defect_f1": 0.962113976440624,
        "defect_tp": 1511,
        "defect_fp": 46,
        "defect_tn": 1645,
        "defect_fn": 73,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9664157019433615,
        "recall_macro": 0.966429609750643,
        "f1_macro": 0.9664212149042246,
        "precision_micro": 0.9664224664224664,
        "recall_micro": 0.9664224664224664,
        "f1_micro": 0.9664224664224664,
        "accuracy": 0.9664224664224664,
        "hamming_loss": 0.033577533577533576,
        "no_defect_precision": 0.9678007290400972,
        "no_defect_recall": 0.9654545454545455,
        "no_defect_f1": 0.966626213592233,
        "no_defect_tp": 1593,
        "no_defect_fp": 53,
        "no_defect_tn": 1573,
        "no_defect_fn": 57,
        "no_defect_support": 1650,
        "defect_precision": 0.9650306748466257,
        "defect_recall": 0.9674046740467405,
        "defect_f1": 0.9662162162162162,
        "defect_tp": 1573,
        "defect_fp": 57,
        "defect_tn": 1593,
        "defect_fn": 53,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.471504573043919,
          0.25406545375680323,
          0.19702407518191317,
          0.18354691222123024,
          0.18100695255910004,
          0.17907966026514144,
          0.17241510783154596,
          0.17338165131136463,
          0.17397246500438227,
          0.16942935921719385,
          0.1745003725881357,
          0.1669477994347217,
          0.16467489925637904,
          0.16117756770121003,
          0.16562069171579813
        ],
        "val_loss": [
          0.3681850416155962,
          0.19250386380232298,
          0.13940840300459129,
          0.1301073985031018,
          0.11799970770684573,
          0.11573639827278945,
          0.10992330405861139,
          0.1069034906820609,
          0.10786073740858299,
          0.1109610261538854,
          0.11034916233844481,
          0.10493175936146425,
          0.10860115053275457,
          0.10583555075125052,
          0.10599196114792274
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9009664357545928,
            "recall_macro": 0.8986057350560603,
            "f1_macro": 0.8992027241622056,
            "precision_micro": 0.8995419847328244,
            "recall_micro": 0.8995419847328244,
            "f1_micro": 0.8995419847328244,
            "accuracy": 0.8995419847328244,
            "hamming_loss": 0.10045801526717557,
            "no_defect_precision": 0.8838782412626832,
            "no_defect_recall": 0.9272619751626257,
            "no_defect_f1": 0.9050505050505051,
            "no_defect_tp": 1568,
            "no_defect_fp": 206,
            "no_defect_tn": 1378,
            "no_defect_fn": 123,
            "no_defect_support": 1691,
            "defect_precision": 0.9180546302465024,
            "defect_recall": 0.8699494949494949,
            "defect_f1": 0.893354943273906,
            "defect_tp": 1378,
            "defect_fp": 123,
            "defect_tn": 1568,
            "defect_fn": 206,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9448953579717507,
            "recall_macro": 0.945279039657366,
            "f1_macro": 0.9450077688770279,
            "precision_micro": 0.9450381679389313,
            "recall_micro": 0.9450381679389313,
            "f1_micro": 0.9450381679389313,
            "accuracy": 0.9450381679389313,
            "hamming_loss": 0.0549618320610687,
            "no_defect_precision": 0.954846478025286,
            "no_defect_recall": 0.937906564163217,
            "no_defect_f1": 0.9463007159904535,
            "no_defect_tp": 1586,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 105,
            "no_defect_support": 1691,
            "defect_precision": 0.9349442379182156,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9437148217636022,
            "defect_tp": 1509,
            "defect_fp": 105,
            "defect_tn": 1586,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9573556605711937,
            "recall_macro": 0.9570664136934095,
            "f1_macro": 0.9571934754080484,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9548387096774194,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9587750294464076,
            "no_defect_tp": 1628,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.9598726114649682,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.9556119213696893,
            "defect_tp": 1507,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.95894860168657,
            "recall_macro": 0.9593598238445962,
            "f1_macro": 0.9590624999999999,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.969258589511754,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.96,
            "no_defect_tp": 1608,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9486386138613861,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.958125,
            "defect_tp": 1533,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.959776864357017,
            "recall_macro": 0.959531745605075,
            "f1_macro": 0.9596413711515064,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9577216676453317,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9611078373600471,
            "no_defect_tp": 1631,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9618320610687023,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.9581749049429658,
            "defect_tp": 1512,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629103026667623,
            "recall_macro": 0.9632835973573703,
            "f1_macro": 0.9630313758690576,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9717548076923077,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9639344262295082,
            "no_defect_tp": 1617,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9540657976412167,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9621283255086072,
            "defect_tp": 1537,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9632223393800188,
            "recall_macro": 0.963499386233715,
            "f1_macro": 0.9633316986548612,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9695158398087268,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9643281807372176,
            "no_defect_tp": 1622,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9569288389513109,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9623352165725048,
            "defect_tp": 1533,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9639823681103701,
            "recall_macro": 0.9633556514285373,
            "f1_macro": 0.9636031894523449,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9575087310826542,
            "no_defect_recall": 0.9727971614429332,
            "no_defect_f1": 0.9650924024640657,
            "no_defect_tp": 1645,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 46,
            "no_defect_support": 1691,
            "defect_precision": 0.970456005138086,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.962113976440624,
            "defect_tp": 1511,
            "defect_fp": 46,
            "defect_tn": 1645,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626406131858241,
            "recall_macro": 0.9628081524888148,
            "f1_macro": 0.9627153838631098,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.966686496133254,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9638196915776986,
            "no_defect_tp": 1625,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.958594730238394,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.961611076148521,
            "defect_tp": 1528,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623055690253273,
            "recall_macro": 0.9627122048396441,
            "f1_macro": 0.9624225117350067,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9722891566265061,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.963294538943599,
            "no_defect_tp": 1614,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9523219814241486,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9615504845264145,
            "defect_tp": 1538,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604783463994218,
            "recall_macro": 0.9608981595971543,
            "f1_macro": 0.9605905664184332,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.971049457177322,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9614810391161541,
            "no_defect_tp": 1610,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9499072356215214,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9597000937207123,
            "defect_tp": 1536,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629757369578964,
            "recall_macro": 0.9630638884408843,
            "f1_macro": 0.9630175616536514,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9655990510083037,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9641693811074918,
            "no_defect_tp": 1628,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.960352422907489,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9618657421998109,
            "defect_tp": 1526,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623018226607968,
            "recall_macro": 0.9626922313017818,
            "f1_macro": 0.9624214320370621,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9717208182912154,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9633164330450343,
            "no_defect_tp": 1615,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9528828270303782,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9615264310290897,
            "defect_tp": 1537,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626312281597382,
            "recall_macro": 0.9628281260266771,
            "f1_macro": 0.9627167198551779,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9672424061941632,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9637982195845697,
            "no_defect_tp": 1624,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9580200501253133,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9616352201257862,
            "defect_tp": 1529,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626232253644427,
            "recall_macro": 0.9628480995645395,
            "f1_macro": 0.9627180279213092,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9677996422182469,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9637767220902613,
            "no_defect_tp": 1623,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9574468085106383,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.961659333752357,
            "defect_tp": 1530,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 54,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9664157019433615,
            "recall_macro": 0.966429609750643,
            "f1_macro": 0.9664212149042246,
            "precision_micro": 0.9664224664224664,
            "recall_micro": 0.9664224664224664,
            "f1_micro": 0.9664224664224664,
            "accuracy": 0.9664224664224664,
            "hamming_loss": 0.033577533577533576,
            "no_defect_precision": 0.9678007290400972,
            "no_defect_recall": 0.9654545454545455,
            "no_defect_f1": 0.966626213592233,
            "no_defect_tp": 1593,
            "no_defect_fp": 53,
            "no_defect_tn": 1573,
            "no_defect_fn": 57,
            "no_defect_support": 1650,
            "defect_precision": 0.9650306748466257,
            "defect_recall": 0.9674046740467405,
            "defect_f1": 0.9662162162162162,
            "defect_tp": 1573,
            "defect_fp": 57,
            "defect_tn": 1593,
            "defect_fn": 53,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.01_s40_20251207_133323",
    "lr": 0.005,
    "weight_decay": 0.01,
    "seed": 40,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9645551394767857,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.01_s40_20251207_133323",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s40_20251207_133323",
      "timestamp": "2025-12-07T13:35:12.377920",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 8,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.01_s40",
          "seed": 40,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s40_20251207_133323"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9644403354271414,
        "recall_macro": 0.9647420389584789,
        "f1_macro": 0.9645551394767857,
        "precision_micro": 0.9645801526717557,
        "recall_micro": 0.9645801526717557,
        "f1_micro": 0.9645801526717557,
        "accuracy": 0.9645801526717557,
        "hamming_loss": 0.035419847328244276,
        "no_defect_precision": 0.9712746858168761,
        "no_defect_recall": 0.9597871082199881,
        "no_defect_f1": 0.9654967281380131,
        "no_defect_tp": 1623,
        "no_defect_fp": 48,
        "no_defect_tn": 1536,
        "no_defect_fn": 68,
        "no_defect_support": 1691,
        "defect_precision": 0.9576059850374065,
        "defect_recall": 0.9696969696969697,
        "defect_f1": 0.9636135508155583,
        "defect_tp": 1536,
        "defect_fp": 68,
        "defect_tn": 1623,
        "defect_fn": 48,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9679611071454531,
        "recall_macro": 0.9679358157217937,
        "f1_macro": 0.9679462061337196,
        "precision_micro": 0.967948717948718,
        "recall_micro": 0.967948717948718,
        "f1_micro": 0.967948717948718,
        "accuracy": 0.967948717948718,
        "hamming_loss": 0.03205128205128205,
        "no_defect_precision": 0.9667673716012085,
        "no_defect_recall": 0.9696969696969697,
        "no_defect_f1": 0.9682299546142209,
        "no_defect_tp": 1600,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 50,
        "no_defect_support": 1650,
        "defect_precision": 0.9691548426896978,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.9676624576532183,
        "defect_tp": 1571,
        "defect_fp": 50,
        "defect_tn": 1600,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4628156093124565,
          0.2578588712290241,
          0.19905972602352437,
          0.1846719298153243,
          0.17194306576102347,
          0.17520870880913536,
          0.17043206703588054,
          0.1708861836017924,
          0.1705218768487665,
          0.16492007551208201,
          0.17018272403518525,
          0.1610210120802644,
          0.16444512760601782,
          0.16816768577034005,
          0.1666636299575722
        ],
        "val_loss": [
          0.36877293426256913,
          0.19704064411612657,
          0.14170509447845128,
          0.12676307902886316,
          0.1250667807717736,
          0.10982828186108516,
          0.11556758566831167,
          0.10846615145699336,
          0.10641947768342036,
          0.11236210031291613,
          0.10388900690640394,
          0.1051155082308329,
          0.10322981628660972,
          0.10308486946786825,
          0.103683893640454
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8948058773742025,
            "recall_macro": 0.8886966202533915,
            "f1_macro": 0.8896647115422784,
            "precision_micro": 0.890381679389313,
            "recall_micro": 0.890381679389313,
            "f1_micro": 0.890381679389313,
            "accuracy": 0.890381679389313,
            "hamming_loss": 0.10961832061068702,
            "no_defect_precision": 0.8603896103896104,
            "no_defect_recall": 0.9402720283855707,
            "no_defect_f1": 0.8985589149477253,
            "no_defect_tp": 1590,
            "no_defect_fp": 258,
            "no_defect_tn": 1326,
            "no_defect_fn": 101,
            "no_defect_support": 1691,
            "defect_precision": 0.9292221443587947,
            "defect_recall": 0.8371212121212122,
            "defect_f1": 0.8807705081368317,
            "defect_tp": 1326,
            "defect_fp": 101,
            "defect_tn": 1590,
            "defect_fn": 258,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9443945947518344,
            "recall_macro": 0.9448674354425389,
            "f1_macro": 0.9444106418204323,
            "precision_micro": 0.9444274809160306,
            "recall_micro": 0.9444274809160306,
            "f1_micro": 0.9444274809160306,
            "accuracy": 0.9444274809160306,
            "hamming_loss": 0.055572519083969464,
            "no_defect_precision": 0.9597806215722121,
            "no_defect_recall": 0.9314015375517445,
            "no_defect_f1": 0.9453781512605042,
            "no_defect_tp": 1575,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 116,
            "no_defect_support": 1691,
            "defect_precision": 0.9290085679314566,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9434431323803605,
            "defect_tp": 1518,
            "defect_fp": 116,
            "defect_tn": 1575,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9542045793180092,
            "recall_macro": 0.9540896098776052,
            "f1_macro": 0.9541438809594752,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9540365350618739,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9557260920897285,
            "no_defect_tp": 1619,
            "no_defect_fp": 78,
            "no_defect_tn": 1506,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9543726235741445,
            "defect_recall": 0.9507575757575758,
            "defect_f1": 0.952561669829222,
            "defect_tp": 1506,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 78,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9565016234190227,
            "recall_macro": 0.9567746507057566,
            "f1_macro": 0.9566091767415856,
            "precision_micro": 0.9566412213740458,
            "recall_micro": 0.9566412213740458,
            "f1_micro": 0.9566412213740458,
            "accuracy": 0.9566412213740458,
            "hamming_loss": 0.0433587786259542,
            "no_defect_precision": 0.962940824865511,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9577883472057075,
            "no_defect_tp": 1611,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9500624219725343,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9554300062774639,
            "defect_tp": 1522,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9560788711509645,
            "recall_macro": 0.956562781869553,
            "f1_macro": 0.9560206893001583,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9736680955296999,
            "no_defect_recall": 0.9402720283855707,
            "no_defect_f1": 0.9566787003610109,
            "no_defect_tp": 1590,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 101,
            "no_defect_support": 1691,
            "defect_precision": 0.938489646772229,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9553626782393057,
            "defect_tp": 1541,
            "defect_fp": 101,
            "defect_tn": 1590,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9624929971988796,
            "recall_macro": 0.962312734082397,
            "f1_macro": 0.9623955708689809,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9611764705882353,
            "no_defect_recall": 0.9662921348314607,
            "no_defect_f1": 0.9637275140076673,
            "no_defect_tp": 1634,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 57,
            "no_defect_support": 1691,
            "defect_precision": 0.9638095238095238,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9610636277302944,
            "defect_tp": 1518,
            "defect_fp": 57,
            "defect_tn": 1634,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9611355851797041,
            "recall_macro": 0.9616093668799168,
            "f1_macro": 0.9612065592510173,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9745145631067961,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9619646600778676,
            "no_defect_tp": 1606,
            "no_defect_fp": 42,
            "no_defect_tn": 1542,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9477566072526121,
            "defect_recall": 0.9734848484848485,
            "defect_f1": 0.9604484584241669,
            "defect_tp": 1542,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 42,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644403354271414,
            "recall_macro": 0.9647420389584789,
            "f1_macro": 0.9645551394767857,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9712746858168761,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9654967281380131,
            "no_defect_tp": 1623,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9576059850374065,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9636135508155583,
            "defect_tp": 1536,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635362793870275,
            "recall_macro": 0.9637750957236468,
            "f1_macro": 0.9636354254638893,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9689737470167065,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9646569646569647,
            "no_defect_tp": 1624,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9580988117573483,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9626138862708137,
            "defect_tp": 1532,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9608126736147371,
            "recall_macro": 0.9612737367763979,
            "f1_macro": 0.9608996658563048,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9733494851605088,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9616995810891682,
            "no_defect_tp": 1607,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9482758620689655,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9600997506234414,
            "defect_tp": 1540,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638205434391107,
            "recall_macro": 0.9634555191178491,
            "f1_macro": 0.9636119571076265,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9601873536299765,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.9649897028537805,
            "no_defect_tp": 1640,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.967453733248245,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9622342113614726,
            "defect_tp": 1516,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635257009136577,
            "recall_macro": 0.9638150427993716,
            "f1_macro": 0.9636378683435654,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9700956937799043,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9646149271483794,
            "no_defect_tp": 1622,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9569557080474111,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9626608095387512,
            "defect_tp": 1534,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9645108019691253,
            "recall_macro": 0.9645822506555801,
            "f1_macro": 0.9645450832737907,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.966804979253112,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9656601539372409,
            "no_defect_tp": 1631,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9622166246851386,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9634300126103404,
            "defect_tp": 1528,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9639145662498311,
            "recall_macro": 0.963950937524267,
            "f1_macro": 0.9639323913165214,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9656601539372409,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9650887573964497,
            "no_defect_tp": 1631,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9621689785624212,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9627760252365931,
            "defect_tp": 1526,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9641736700323129,
            "recall_macro": 0.9643265147035106,
            "f1_macro": 0.9642427912375312,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.9678953626634959,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9653127779424845,
            "no_defect_tp": 1628,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.96045197740113,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9631728045325779,
            "defect_tp": 1530,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 54,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9679611071454531,
            "recall_macro": 0.9679358157217937,
            "f1_macro": 0.9679462061337196,
            "precision_micro": 0.967948717948718,
            "recall_micro": 0.967948717948718,
            "f1_micro": 0.967948717948718,
            "accuracy": 0.967948717948718,
            "hamming_loss": 0.03205128205128205,
            "no_defect_precision": 0.9667673716012085,
            "no_defect_recall": 0.9696969696969697,
            "no_defect_f1": 0.9682299546142209,
            "no_defect_tp": 1600,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 50,
            "no_defect_support": 1650,
            "defect_precision": 0.9691548426896978,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.9676624576532183,
            "defect_tp": 1571,
            "defect_fp": 50,
            "defect_tn": 1600,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.01_s50_20251207_202720",
    "lr": 0.005,
    "weight_decay": 0.01,
    "seed": 50,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9636378683435654,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.01_s50_20251207_202720",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s50_20251207_202720",
      "timestamp": "2025-12-07T20:29:11.616470",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.01_s50",
          "seed": 50,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s50_20251207_202720"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9635257009136577,
        "recall_macro": 0.9638150427993716,
        "f1_macro": 0.9636378683435654,
        "precision_micro": 0.9636641221374046,
        "recall_micro": 0.9636641221374046,
        "f1_micro": 0.9636641221374046,
        "accuracy": 0.9636641221374046,
        "hamming_loss": 0.03633587786259542,
        "no_defect_precision": 0.9700956937799043,
        "no_defect_recall": 0.9591957421643997,
        "no_defect_f1": 0.9646149271483794,
        "no_defect_tp": 1622,
        "no_defect_fp": 50,
        "no_defect_tn": 1534,
        "no_defect_fn": 69,
        "no_defect_support": 1691,
        "defect_precision": 0.9569557080474111,
        "defect_recall": 0.9684343434343434,
        "defect_f1": 0.9626608095387512,
        "defect_tp": 1534,
        "defect_fp": 69,
        "defect_tn": 1622,
        "defect_fn": 50,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.967343864792966,
        "recall_macro": 0.9673297551157329,
        "f1_macro": 0.9673359985843475,
        "precision_micro": 0.9673382173382173,
        "recall_micro": 0.9673382173382173,
        "f1_micro": 0.9673382173382173,
        "accuracy": 0.9673382173382173,
        "hamming_loss": 0.032661782661782664,
        "no_defect_precision": 0.9667271627344223,
        "no_defect_recall": 0.9684848484848485,
        "no_defect_f1": 0.9676052073872238,
        "no_defect_tp": 1598,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 52,
        "no_defect_support": 1650,
        "defect_precision": 0.9679605668515096,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.9670667897814712,
        "defect_tp": 1571,
        "defect_fp": 52,
        "defect_tn": 1598,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.46110771689953667,
          0.254568013000189,
          0.19935796101222977,
          0.1854671259492511,
          0.17373087836982815,
          0.1774392521873927,
          0.17646739747234966,
          0.16936865635995585,
          0.17274388474525268,
          0.17281494688663523,
          0.17287414337052462,
          0.1669045487987696,
          0.16505487914738795,
          0.16349810734391212,
          0.16733396890335503
        ],
        "val_loss": [
          0.36418538425977415,
          0.19310557985535035,
          0.1515516032679723,
          0.1377597305064018,
          0.11792249304170792,
          0.11731085539437257,
          0.11131077789916442,
          0.10554845702762787,
          0.10907979015834056,
          0.10435711327367105,
          0.1137881511105941,
          0.10521462222991082,
          0.10559685521114331,
          0.10403509631466407,
          0.10388916308203569
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8991075742706486,
            "recall_macro": 0.8971872405306764,
            "f1_macro": 0.8977096920920058,
            "precision_micro": 0.8980152671755726,
            "recall_micro": 0.8980152671755726,
            "f1_micro": 0.8980152671755726,
            "accuracy": 0.8980152671755726,
            "hamming_loss": 0.10198473282442748,
            "no_defect_precision": 0.8848553601815088,
            "no_defect_recall": 0.9225310467179184,
            "no_defect_f1": 0.903300521134916,
            "no_defect_tp": 1560,
            "no_defect_fp": 203,
            "no_defect_tn": 1381,
            "no_defect_fn": 131,
            "no_defect_support": 1691,
            "defect_precision": 0.9133597883597884,
            "defect_recall": 0.8718434343434344,
            "defect_f1": 0.8921188630490956,
            "defect_tp": 1381,
            "defect_fp": 131,
            "defect_tn": 1560,
            "defect_fn": 203,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9440910387134585,
            "recall_macro": 0.943021656541763,
            "f1_macro": 0.943392700729927,
            "precision_micro": 0.9435114503816794,
            "recall_micro": 0.9435114503816794,
            "f1_micro": 0.9435114503816794,
            "accuracy": 0.9435114503816794,
            "hamming_loss": 0.05648854961832061,
            "no_defect_precision": 0.9342560553633218,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.945985401459854,
            "no_defect_tp": 1620,
            "no_defect_fp": 114,
            "no_defect_tn": 1470,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9539260220635951,
            "defect_recall": 0.928030303030303,
            "defect_f1": 0.9408,
            "defect_tp": 1470,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 114,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9518040297070247,
            "recall_macro": 0.9522834047153976,
            "f1_macro": 0.951744922982118,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.9693815064298836,
            "no_defect_recall": 0.9361324659964518,
            "no_defect_f1": 0.9524669073405535,
            "no_defect_tp": 1583,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 108,
            "no_defect_support": 1691,
            "defect_precision": 0.9342265529841657,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9510229386236826,
            "defect_tp": 1534,
            "defect_fp": 108,
            "defect_tn": 1583,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9514547353500691,
            "recall_macro": 0.9518518269627081,
            "f1_macro": 0.9511406604440009,
            "precision_micro": 0.9511450381679389,
            "recall_micro": 0.9511450381679389,
            "f1_micro": 0.9511450381679389,
            "accuracy": 0.9511450381679389,
            "hamming_loss": 0.04885496183206107,
            "no_defect_precision": 0.9739938080495356,
            "no_defect_recall": 0.9302188054405677,
            "no_defect_f1": 0.9516031457955233,
            "no_defect_tp": 1573,
            "no_defect_fp": 42,
            "no_defect_tn": 1542,
            "no_defect_fn": 118,
            "no_defect_support": 1691,
            "defect_precision": 0.9289156626506024,
            "defect_recall": 0.9734848484848485,
            "defect_f1": 0.9506781750924784,
            "defect_tp": 1542,
            "defect_fp": 118,
            "defect_tn": 1573,
            "defect_fn": 42,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9577264273605557,
            "recall_macro": 0.9568467047769236,
            "f1_macro": 0.9571702511009628,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9490445859872612,
            "no_defect_recall": 0.9692489651094027,
            "no_defect_f1": 0.9590403744880047,
            "no_defect_tp": 1639,
            "no_defect_fp": 88,
            "no_defect_tn": 1496,
            "no_defect_fn": 52,
            "no_defect_support": 1691,
            "defect_precision": 0.9664082687338501,
            "defect_recall": 0.9444444444444444,
            "defect_f1": 0.9553001277139208,
            "defect_tp": 1496,
            "defect_fp": 52,
            "defect_tn": 1639,
            "defect_fn": 88,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9611490026979108,
            "recall_macro": 0.9616293404177793,
            "f1_macro": 0.9612074710348961,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9750911300121506,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9619418639496554,
            "no_defect_tp": 1605,
            "no_defect_fp": 41,
            "no_defect_tn": 1543,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.947206875383671,
            "defect_recall": 0.9741161616161617,
            "defect_f1": 0.9604730781201369,
            "defect_tp": 1543,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 41,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9607746791011699,
            "recall_macro": 0.9610740013977743,
            "f1_macro": 0.9608884297674877,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9676840215439856,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9619274241522903,
            "no_defect_tp": 1617,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9538653366583542,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9598494353826851,
            "defect_tp": 1530,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638810907612367,
            "recall_macro": 0.9634155720421244,
            "f1_macro": 0.9636085321079244,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9591121495327103,
            "no_defect_recall": 0.9710230632761679,
            "no_defect_f1": 0.9650308551278284,
            "no_defect_tp": 1642,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 49,
            "no_defect_support": 1691,
            "defect_precision": 0.9686500319897633,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9621862090880203,
            "defect_tp": 1514,
            "defect_fp": 49,
            "defect_tn": 1642,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626058843102469,
            "recall_macro": 0.9629879143295761,
            "f1_macro": 0.962726402935094,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9717378232110644,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9636255217650567,
            "no_defect_tp": 1616,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9534739454094293,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9618272841051314,
            "defect_tp": 1537,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9631285283459197,
            "recall_macro": 0.9629041001379854,
            "f1_macro": 0.9630054087581421,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9612220916568742,
            "no_defect_recall": 0.9674748669426375,
            "no_defect_f1": 0.9643383436486884,
            "no_defect_tp": 1636,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 55,
            "no_defect_support": 1691,
            "defect_precision": 0.965034965034965,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9616724738675958,
            "defect_tp": 1518,
            "defect_fp": 55,
            "defect_tn": 1636,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9587371978521555,
            "recall_macro": 0.9592239291197009,
            "f1_macro": 0.958765693168633,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.9738124238733252,
            "no_defect_recall": 0.9455943228858663,
            "no_defect_f1": 0.9594959495949595,
            "no_defect_tp": 1599,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 92,
            "no_defect_support": 1691,
            "defect_precision": 0.9436619718309859,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9580354367423065,
            "defect_tp": 1541,
            "defect_fp": 92,
            "defect_tn": 1599,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629097593114059,
            "recall_macro": 0.9632436502816455,
            "f1_macro": 0.9630291133079425,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9706235011990407,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9639773742185174,
            "no_defect_tp": 1619,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.955196017423771,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9620808523973676,
            "defect_tp": 1535,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635257009136577,
            "recall_macro": 0.9638150427993716,
            "f1_macro": 0.9636378683435654,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9700956937799043,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9646149271483794,
            "no_defect_tp": 1622,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9569557080474111,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9626608095387512,
            "defect_tp": 1534,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626312281597382,
            "recall_macro": 0.9628281260266771,
            "f1_macro": 0.9627167198551779,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9672424061941632,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9637982195845697,
            "no_defect_tp": 1624,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9580200501253133,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9616352201257862,
            "defect_tp": 1529,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626312281597382,
            "recall_macro": 0.9628281260266771,
            "f1_macro": 0.9627167198551779,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9672424061941632,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9637982195845697,
            "no_defect_tp": 1624,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9580200501253133,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9616352201257862,
            "defect_tp": 1529,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 55,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.967343864792966,
            "recall_macro": 0.9673297551157329,
            "f1_macro": 0.9673359985843475,
            "precision_micro": 0.9673382173382173,
            "recall_micro": 0.9673382173382173,
            "f1_micro": 0.9673382173382173,
            "accuracy": 0.9673382173382173,
            "hamming_loss": 0.032661782661782664,
            "no_defect_precision": 0.9667271627344223,
            "no_defect_recall": 0.9684848484848485,
            "no_defect_f1": 0.9676052073872238,
            "no_defect_tp": 1598,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 52,
            "no_defect_support": 1650,
            "defect_precision": 0.9679605668515096,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.9670667897814712,
            "defect_tp": 1571,
            "defect_fp": 52,
            "defect_tn": 1598,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.01_s60_20251207_155024",
    "lr": 0.005,
    "weight_decay": 0.01,
    "seed": 60,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9663926583841012,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.01_s60_20251207_155024",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s60_20251207_155024",
      "timestamp": "2025-12-07T15:52:21.778769",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.01_s60",
          "seed": 60,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s60_20251207_155024"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9662708952250783,
        "recall_macro": 0.9666559518902806,
        "f1_macro": 0.9663926583841012,
        "precision_micro": 0.966412213740458,
        "recall_micro": 0.966412213740458,
        "f1_micro": 0.966412213740458,
        "accuracy": 0.966412213740458,
        "hamming_loss": 0.03358778625954199,
        "no_defect_precision": 0.9753457606734817,
        "no_defect_recall": 0.9591957421643997,
        "no_defect_f1": 0.9672033392963626,
        "no_defect_tp": 1622,
        "no_defect_fp": 41,
        "no_defect_tn": 1543,
        "no_defect_fn": 69,
        "no_defect_support": 1691,
        "defect_precision": 0.957196029776675,
        "defect_recall": 0.9741161616161617,
        "defect_f1": 0.9655819774718398,
        "defect_tp": 1543,
        "defect_fp": 69,
        "defect_tn": 1622,
        "defect_fn": 41,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.966721680470435,
        "recall_macro": 0.9667326400536733,
        "f1_macro": 0.9667263494672576,
        "precision_micro": 0.9667277167277167,
        "recall_micro": 0.9667277167277167,
        "f1_micro": 0.9667277167277167,
        "accuracy": 0.9667277167277167,
        "hamming_loss": 0.03327228327228327,
        "no_defect_precision": 0.9678202792956891,
        "no_defect_recall": 0.9660606060606061,
        "no_defect_f1": 0.9669396420988777,
        "no_defect_tp": 1594,
        "no_defect_fp": 53,
        "no_defect_tn": 1573,
        "no_defect_fn": 56,
        "no_defect_support": 1650,
        "defect_precision": 0.9656230816451811,
        "defect_recall": 0.9674046740467405,
        "defect_f1": 0.9665130568356375,
        "defect_tp": 1573,
        "defect_fp": 56,
        "defect_tn": 1594,
        "defect_fn": 53,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.46706505038748225,
          0.2620762102773499,
          0.19512951495632466,
          0.17780064635571077,
          0.17463317207960902,
          0.17333598385046717,
          0.1720078604833601,
          0.16898662374047055,
          0.17293867671464777,
          0.169368169406842,
          0.1742191976209066,
          0.16459518406056958,
          0.16696938149101065,
          0.16756081952086055,
          0.16687889657447028
        ],
        "val_loss": [
          0.36905220322884047,
          0.19523138409623733,
          0.1430925176693843,
          0.129125201000044,
          0.1214034639728757,
          0.11239483171644118,
          0.10610526334494352,
          0.10596589894535449,
          0.10565362501746187,
          0.10896374765210427,
          0.10554889131050843,
          0.10632941925611633,
          0.10459482100290748,
          0.10399056842120794,
          0.10478152377674213
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8990374749982524,
            "recall_macro": 0.8963961390964643,
            "f1_macro": 0.8970320065396467,
            "precision_micro": 0.8974045801526718,
            "recall_micro": 0.8974045801526718,
            "f1_micro": 0.8974045801526718,
            "accuracy": 0.8974045801526718,
            "hamming_loss": 0.10259541984732824,
            "no_defect_precision": 0.8804042672655812,
            "no_defect_recall": 0.9272619751626257,
            "no_defect_f1": 0.9032258064516129,
            "no_defect_tp": 1568,
            "no_defect_fp": 213,
            "no_defect_tn": 1371,
            "no_defect_fn": 123,
            "no_defect_support": 1691,
            "defect_precision": 0.9176706827309237,
            "defect_recall": 0.865530303030303,
            "defect_f1": 0.8908382066276803,
            "defect_tp": 1371,
            "defect_fp": 123,
            "defect_tn": 1568,
            "defect_fn": 213,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9445895896904339,
            "recall_macro": 0.9448435418645353,
            "f1_macro": 0.9446910550710168,
            "precision_micro": 0.944732824427481,
            "recall_micro": 0.944732824427481,
            "f1_micro": 0.944732824427481,
            "accuracy": 0.944732824427481,
            "hamming_loss": 0.05526717557251908,
            "no_defect_precision": 0.951015531660693,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9462109955423477,
            "no_defect_tp": 1592,
            "no_defect_fp": 82,
            "no_defect_tn": 1502,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.9381636477201749,
            "defect_recall": 0.9482323232323232,
            "defect_f1": 0.9431711145996861,
            "defect_tp": 1502,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 82,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555929571137092,
            "recall_macro": 0.9558276810087869,
            "f1_macro": 0.9556902243047389,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.961217183770883,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9569349569349569,
            "no_defect_tp": 1611,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9499687304565353,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9544454916745209,
            "defect_tp": 1519,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.957106485367355,
            "recall_macro": 0.9574658844506567,
            "f1_macro": 0.9572257428447111,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9657657657657658,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9582836710369488,
            "no_defect_tp": 1608,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9484472049689441,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9561678146524734,
            "defect_tp": 1527,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9605021415815926,
            "recall_macro": 0.9609580802107414,
            "f1_macro": 0.9605936982936575,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9727602905569007,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.961411905474125,
            "no_defect_tp": 1607,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9482439926062847,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9597754911131899,
            "defect_tp": 1539,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9594836909370494,
            "recall_macro": 0.9587206706330006,
            "f1_macro": 0.9590101308537474,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9518282066163668,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.9607498535442296,
            "no_defect_tp": 1640,
            "no_defect_fp": 83,
            "no_defect_tn": 1501,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.967139175257732,
            "defect_recall": 0.94760101010101,
            "defect_f1": 0.9572704081632653,
            "defect_tp": 1501,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 83,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9648952346242547,
            "recall_macro": 0.9647980395319249,
            "f1_macro": 0.9648443804354695,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.964622641509434,
            "no_defect_recall": 0.9674748669426375,
            "no_defect_f1": 0.9660466489518749,
            "no_defect_tp": 1636,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 55,
            "no_defect_support": 1691,
            "defect_precision": 0.9651678277390754,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9636421119190641,
            "defect_tp": 1524,
            "defect_fp": 55,
            "defect_tn": 1636,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626406131858241,
            "recall_macro": 0.9628081524888148,
            "f1_macro": 0.9627153838631098,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.966686496133254,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9638196915776986,
            "no_defect_tp": 1625,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.958594730238394,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.961611076148521,
            "defect_tp": 1528,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962758664304644,
            "recall_macro": 0.9616775009109426,
            "f1_macro": 0.9620588701335199,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9521061742642816,
            "no_defect_recall": 0.9757539917208752,
            "no_defect_f1": 0.9637850467289719,
            "no_defect_tp": 1650,
            "no_defect_fp": 83,
            "no_defect_tn": 1501,
            "no_defect_fn": 41,
            "no_defect_support": 1691,
            "defect_precision": 0.9734111543450065,
            "defect_recall": 0.94760101010101,
            "defect_f1": 0.9603326935380678,
            "defect_tp": 1501,
            "defect_fp": 41,
            "defect_tn": 1650,
            "defect_fn": 83,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9647680794768183,
            "recall_macro": 0.9652174838270344,
            "f1_macro": 0.964869446795809,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9764207980652962,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9656203288490284,
            "no_defect_tp": 1615,
            "no_defect_fp": 39,
            "no_defect_tn": 1545,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9531153608883405,
            "defect_recall": 0.9753787878787878,
            "defect_f1": 0.9641185647425897,
            "defect_tp": 1545,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 39,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9647419564469666,
            "recall_macro": 0.9650976425998602,
            "f1_macro": 0.9648634687455364,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9729891956782714,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9657432231158772,
            "no_defect_tp": 1621,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9564947172156619,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9639837143751957,
            "defect_tp": 1539,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9662708952250783,
            "recall_macro": 0.9666559518902806,
            "f1_macro": 0.9663926583841012,
            "precision_micro": 0.966412213740458,
            "recall_micro": 0.966412213740458,
            "f1_micro": 0.966412213740458,
            "accuracy": 0.966412213740458,
            "hamming_loss": 0.03358778625954199,
            "no_defect_precision": 0.9753457606734817,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9672033392963626,
            "no_defect_tp": 1622,
            "no_defect_fp": 41,
            "no_defect_tn": 1543,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.957196029776675,
            "defect_recall": 0.9741161616161617,
            "defect_f1": 0.9655819774718398,
            "defect_tp": 1543,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 41,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644442877365635,
            "recall_macro": 0.9647220654206166,
            "f1_macro": 0.9645539753663658,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9707112970711297,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9655172413793104,
            "no_defect_tp": 1624,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9581772784019975,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9635907093534212,
            "defect_tp": 1535,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9647583289675379,
            "recall_macro": 0.9649977749105484,
            "f1_macro": 0.9648577641037585,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9701670644391408,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9658449658449658,
            "no_defect_tp": 1626,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.959349593495935,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9638705623625511,
            "defect_tp": 1534,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9647522792281109,
            "recall_macro": 0.9650177484484108,
            "f1_macro": 0.9648589576418063,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9707287933094385,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9658246656760773,
            "no_defect_tp": 1625,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9587757651467833,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9638932496075353,
            "defect_tp": 1535,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 49,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.966721680470435,
            "recall_macro": 0.9667326400536733,
            "f1_macro": 0.9667263494672576,
            "precision_micro": 0.9667277167277167,
            "recall_micro": 0.9667277167277167,
            "f1_micro": 0.9667277167277167,
            "accuracy": 0.9667277167277167,
            "hamming_loss": 0.03327228327228327,
            "no_defect_precision": 0.9678202792956891,
            "no_defect_recall": 0.9660606060606061,
            "no_defect_f1": 0.9669396420988777,
            "no_defect_tp": 1594,
            "no_defect_fp": 53,
            "no_defect_tn": 1573,
            "no_defect_fn": 56,
            "no_defect_support": 1650,
            "defect_precision": 0.9656230816451811,
            "defect_recall": 0.9674046740467405,
            "defect_f1": 0.9665130568356375,
            "defect_tp": 1573,
            "defect_fp": 56,
            "defect_tn": 1594,
            "defect_fn": 53,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.01_s70_20251207_140731",
    "lr": 0.005,
    "weight_decay": 0.01,
    "seed": 70,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9642401215989853,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.01_s70_20251207_140731",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s70_20251207_140731",
      "timestamp": "2025-12-07T14:09:25.512347",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.01_s70",
          "seed": 70,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s70_20251207_140731"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.964198183388614,
        "recall_macro": 0.9642865676277859,
        "f1_macro": 0.9642401215989853,
        "precision_micro": 0.9642748091603054,
        "recall_micro": 0.9642748091603054,
        "f1_micro": 0.9642748091603054,
        "accuracy": 0.9642748091603054,
        "hamming_loss": 0.03572519083969466,
        "no_defect_precision": 0.966785290628707,
        "no_defect_recall": 0.9639266706091071,
        "no_defect_f1": 0.9653538643766657,
        "no_defect_tp": 1630,
        "no_defect_fp": 56,
        "no_defect_tn": 1528,
        "no_defect_fn": 61,
        "no_defect_support": 1691,
        "defect_precision": 0.961611076148521,
        "defect_recall": 0.9646464646464646,
        "defect_f1": 0.9631263788213048,
        "defect_tp": 1528,
        "defect_fp": 61,
        "defect_tn": 1630,
        "defect_fn": 56,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9667205865087337,
        "recall_macro": 0.9667371128256737,
        "f1_macro": 0.9667265975047091,
        "precision_micro": 0.9667277167277167,
        "recall_micro": 0.9667277167277167,
        "f1_micro": 0.9667277167277167,
        "accuracy": 0.9667277167277167,
        "hamming_loss": 0.03327228327228327,
        "no_defect_precision": 0.9683890577507599,
        "no_defect_recall": 0.9654545454545455,
        "no_defect_f1": 0.9669195751138088,
        "no_defect_tp": 1593,
        "no_defect_fp": 52,
        "no_defect_tn": 1574,
        "no_defect_fn": 57,
        "no_defect_support": 1650,
        "defect_precision": 0.9650521152667075,
        "defect_recall": 0.968019680196802,
        "defect_f1": 0.9665336198956095,
        "defect_tp": 1574,
        "defect_fp": 57,
        "defect_tn": 1593,
        "defect_fn": 52,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4652954884902204,
          0.2518516969107185,
          0.1987166071162563,
          0.1788734914929797,
          0.17550739857940992,
          0.1781136816889671,
          0.1682477182393044,
          0.17191696460027575,
          0.17879769310479882,
          0.1725713759348981,
          0.16506958729490076,
          0.16875150626735708,
          0.17111029335644454,
          0.16018020857328152,
          0.16542121973745993
        ],
        "val_loss": [
          0.3689615554534472,
          0.19185918655533057,
          0.15075951456450498,
          0.12594701786740467,
          0.11916697404992121,
          0.1131258997349785,
          0.11086348616159879,
          0.1082953241152259,
          0.11695676834250872,
          0.10512672869775158,
          0.10295071603300479,
          0.10326251545204566,
          0.10535569546314386,
          0.10504151594180328,
          0.1051892997840276
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8945480653123625,
            "recall_macro": 0.8869385755843473,
            "f1_macro": 0.8879948015907915,
            "precision_micro": 0.888854961832061,
            "recall_micro": 0.888854961832061,
            "f1_micro": 0.888854961832061,
            "accuracy": 0.888854961832061,
            "hamming_loss": 0.11114503816793893,
            "no_defect_precision": 0.8546231961517905,
            "no_defect_recall": 0.9455943228858663,
            "no_defect_f1": 0.8978102189781022,
            "no_defect_tp": 1599,
            "no_defect_fp": 272,
            "no_defect_tn": 1312,
            "no_defect_fn": 92,
            "no_defect_support": 1691,
            "defect_precision": 0.9344729344729344,
            "defect_recall": 0.8282828282828283,
            "defect_f1": 0.8781793842034806,
            "defect_tp": 1312,
            "defect_fp": 92,
            "defect_tn": 1599,
            "defect_fn": 272,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.94572433621898,
            "recall_macro": 0.9449555430114271,
            "f1_macro": 0.9452434493661279,
            "precision_micro": 0.9453435114503816,
            "recall_micro": 0.9453435114503816,
            "f1_micro": 0.9453435114503816,
            "accuracy": 0.9453435114503816,
            "hamming_loss": 0.05465648854961832,
            "no_defect_precision": 0.9385150812064965,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9475841874084919,
            "no_defect_tp": 1618,
            "no_defect_fp": 106,
            "no_defect_tn": 1478,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9529335912314636,
            "defect_recall": 0.9330808080808081,
            "defect_f1": 0.9429027113237639,
            "defect_tp": 1478,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 106,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9525734265734266,
            "recall_macro": 0.9530306390337437,
            "f1_macro": 0.9526525264873029,
            "precision_micro": 0.9526717557251908,
            "recall_micro": 0.9526717557251908,
            "f1_micro": 0.9526717557251908,
            "accuracy": 0.9526717557251908,
            "hamming_loss": 0.04732824427480916,
            "no_defect_precision": 0.9654545454545455,
            "no_defect_recall": 0.9420461265523359,
            "no_defect_f1": 0.9536067045794673,
            "no_defect_tp": 1593,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 98,
            "no_defect_support": 1691,
            "defect_precision": 0.9396923076923077,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9516983483951387,
            "defect_tp": 1527,
            "defect_fp": 98,
            "defect_tn": 1593,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9580734341478417,
            "recall_macro": 0.9581931452311405,
            "f1_macro": 0.9581289005540974,
            "precision_micro": 0.9581679389312977,
            "recall_micro": 0.9581679389312977,
            "f1_micro": 0.9581679389312977,
            "accuracy": 0.9581679389312977,
            "hamming_loss": 0.04183206106870229,
            "no_defect_precision": 0.9614014251781473,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9594074074074074,
            "no_defect_tp": 1619,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9547454431175362,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9568503937007874,
            "defect_tp": 1519,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9563140251324981,
            "recall_macro": 0.95483292415581,
            "f1_macro": 0.9553118478791562,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9426934097421203,
            "no_defect_recall": 0.9727971614429332,
            "no_defect_f1": 0.9575087310826542,
            "no_defect_tp": 1645,
            "no_defect_fp": 100,
            "no_defect_tn": 1484,
            "no_defect_fn": 46,
            "no_defect_support": 1691,
            "defect_precision": 0.9699346405228758,
            "defect_recall": 0.9368686868686869,
            "defect_f1": 0.9531149646756584,
            "defect_tp": 1484,
            "defect_fp": 46,
            "defect_tn": 1645,
            "defect_fn": 100,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604811554357511,
            "recall_macro": 0.960718397756393,
            "f1_macro": 0.960579578864216,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9659904534606205,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9616869616869617,
            "no_defect_tp": 1619,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9549718574108818,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9594721960414703,
            "defect_tp": 1527,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9572420746051304,
            "recall_macro": 0.9571662813827213,
            "f1_macro": 0.9572027452968758,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9575221238938053,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.958653278204371,
            "no_defect_tp": 1623,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9569620253164557,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.9557522123893806,
            "defect_tp": 1512,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9613825005129353,
            "recall_macro": 0.9617452616048121,
            "f1_macro": 0.96150316856024,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.96996996996997,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9624553039332538,
            "no_defect_tp": 1615,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9527950310559006,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.960551033187226,
            "defect_tp": 1534,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9587736806734974,
            "recall_macro": 0.9592638761954255,
            "f1_macro": 0.9587674159580382,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.974969474969475,
            "no_defect_recall": 0.9444115907746895,
            "no_defect_f1": 0.9594472814659056,
            "no_defect_tp": 1597,
            "no_defect_fp": 41,
            "no_defect_tn": 1543,
            "no_defect_fn": 94,
            "no_defect_support": 1691,
            "defect_precision": 0.9425778863775198,
            "defect_recall": 0.9741161616161617,
            "defect_f1": 0.9580875504501708,
            "defect_tp": 1543,
            "defect_fp": 94,
            "defect_tn": 1597,
            "defect_fn": 41,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9607979896137007,
            "recall_macro": 0.9609941072463248,
            "f1_macro": 0.9608831159136293,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9654556283502085,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9620178041543027,
            "no_defect_tp": 1621,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.956140350877193,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.959748427672956,
            "defect_tp": 1526,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9642706813911777,
            "recall_macro": 0.9636713079941939,
            "f1_macro": 0.9639099449230926,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9580663948747816,
            "no_defect_recall": 0.9727971614429332,
            "no_defect_f1": 0.9653755868544601,
            "no_defect_tp": 1645,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 46,
            "no_defect_support": 1691,
            "defect_precision": 0.9704749679075738,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.962444302991725,
            "defect_tp": 1512,
            "defect_fp": 46,
            "defect_tn": 1645,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.964198183388614,
            "recall_macro": 0.9642865676277859,
            "f1_macro": 0.9642401215989853,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.966785290628707,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.9653538643766657,
            "no_defect_tp": 1630,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.961611076148521,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9631263788213048,
            "defect_tp": 1528,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629252545967721,
            "recall_macro": 0.9631637561301961,
            "f1_macro": 0.9630242561439546,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9683770883054893,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9640629640629641,
            "no_defect_tp": 1623,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.957473420888055,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.961985548224945,
            "defect_tp": 1531,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626166044776119,
            "recall_macro": 0.962868073102402,
            "f1_macro": 0.9627193080673719,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9683582089552238,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9637551990493167,
            "no_defect_tp": 1622,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.956875,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9616834170854272,
            "defect_tp": 1531,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629193074519584,
            "recall_macro": 0.9631837296680584,
            "f1_macro": 0.9630255119535527,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9689366786140979,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9640416047548291,
            "no_defect_tp": 1622,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9569019362898189,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9620094191522763,
            "defect_tp": 1532,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 52,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9667205865087337,
            "recall_macro": 0.9667371128256737,
            "f1_macro": 0.9667265975047091,
            "precision_micro": 0.9667277167277167,
            "recall_micro": 0.9667277167277167,
            "f1_micro": 0.9667277167277167,
            "accuracy": 0.9667277167277167,
            "hamming_loss": 0.03327228327228327,
            "no_defect_precision": 0.9683890577507599,
            "no_defect_recall": 0.9654545454545455,
            "no_defect_f1": 0.9669195751138088,
            "no_defect_tp": 1593,
            "no_defect_fp": 52,
            "no_defect_tn": 1574,
            "no_defect_fn": 57,
            "no_defect_support": 1650,
            "defect_precision": 0.9650521152667075,
            "defect_recall": 0.968019680196802,
            "defect_f1": 0.9665336198956095,
            "defect_tp": 1574,
            "defect_fp": 57,
            "defect_tn": 1593,
            "defect_fn": 52,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.01_s80_20251207_153043",
    "lr": 0.005,
    "weight_decay": 0.01,
    "seed": 80,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9642512913804072,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.01_s80_20251207_153043",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s80_20251207_153043",
      "timestamp": "2025-12-07T15:32:43.778000",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.01_s80",
          "seed": 80,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s80_20251207_153043"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9641315572308798,
        "recall_macro": 0.9644663294685472,
        "f1_macro": 0.9642512913804072,
        "precision_micro": 0.9642748091603054,
        "recall_micro": 0.9642748091603054,
        "f1_micro": 0.9642748091603054,
        "accuracy": 0.9642748091603054,
        "hamming_loss": 0.03572519083969466,
        "no_defect_precision": 0.9718225419664268,
        "no_defect_recall": 0.9586043761088113,
        "no_defect_f1": 0.9651682048228639,
        "no_defect_tp": 1621,
        "no_defect_fp": 47,
        "no_defect_tn": 1537,
        "no_defect_fn": 70,
        "no_defect_support": 1691,
        "defect_precision": 0.9564405724953329,
        "defect_recall": 0.9703282828282829,
        "defect_f1": 0.9633343779379505,
        "defect_tp": 1537,
        "defect_fp": 70,
        "defect_tn": 1621,
        "defect_fn": 47,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9682522643408252,
        "recall_macro": 0.9682522643408252,
        "f1_macro": 0.9682522643408252,
        "precision_micro": 0.9682539682539683,
        "recall_micro": 0.9682539682539683,
        "f1_micro": 0.9682539682539683,
        "accuracy": 0.9682539682539683,
        "hamming_loss": 0.031746031746031744,
        "no_defect_precision": 0.9684848484848485,
        "no_defect_recall": 0.9684848484848485,
        "no_defect_f1": 0.9684848484848485,
        "no_defect_tp": 1598,
        "no_defect_fp": 52,
        "no_defect_tn": 1574,
        "no_defect_fn": 52,
        "no_defect_support": 1650,
        "defect_precision": 0.968019680196802,
        "defect_recall": 0.968019680196802,
        "defect_f1": 0.968019680196802,
        "defect_tp": 1574,
        "defect_fp": 52,
        "defect_tn": 1598,
        "defect_fn": 52,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4597143846326293,
          0.2501825972082226,
          0.19651644823441444,
          0.18605618789854408,
          0.1803363396096429,
          0.175317562352788,
          0.17220794796070793,
          0.17088473725393727,
          0.16703934495232095,
          0.1703758953786046,
          0.16630131115349767,
          0.16211029525581264,
          0.1663980885217878,
          0.16657738375115094,
          0.1619542283181366
        ],
        "val_loss": [
          0.36479443598252076,
          0.1918819211423397,
          0.1446783566990724,
          0.12305991165339947,
          0.12234651791648223,
          0.11561261769384146,
          0.11570760392798828,
          0.11385993659496307,
          0.10887128515885426,
          0.10261376596127565,
          0.10489838473642102,
          0.10678674646008474,
          0.1055021989517487,
          0.10387177514628722,
          0.10392695955502299
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8968844110675837,
            "recall_macro": 0.8964638997903338,
            "f1_macro": 0.8966335181750202,
            "precision_micro": 0.896793893129771,
            "recall_micro": 0.896793893129771,
            "f1_micro": 0.896793893129771,
            "accuracy": 0.896793893129771,
            "hamming_loss": 0.103206106870229,
            "no_defect_precision": 0.8949211908931699,
            "no_defect_recall": 0.9065641632170314,
            "no_defect_f1": 0.900705052878966,
            "no_defect_tp": 1533,
            "no_defect_fp": 180,
            "no_defect_tn": 1404,
            "no_defect_fn": 158,
            "no_defect_support": 1691,
            "defect_precision": 0.8988476312419974,
            "defect_recall": 0.8863636363636364,
            "defect_f1": 0.8925619834710744,
            "defect_tp": 1404,
            "defect_fp": 158,
            "defect_tn": 1533,
            "defect_fn": 180,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9467212900693699,
            "recall_macro": 0.9470331642862689,
            "f1_macro": 0.9468344155844155,
            "precision_micro": 0.9468702290076336,
            "recall_micro": 0.9468702290076336,
            "f1_micro": 0.9468702290076336,
            "accuracy": 0.9468702290076336,
            "hamming_loss": 0.05312977099236641,
            "no_defect_precision": 0.9544637507489515,
            "no_defect_recall": 0.9420461265523359,
            "no_defect_f1": 0.9482142857142857,
            "no_defect_tp": 1593,
            "no_defect_fp": 76,
            "no_defect_tn": 1508,
            "no_defect_fn": 98,
            "no_defect_support": 1691,
            "defect_precision": 0.9389788293897883,
            "defect_recall": 0.952020202020202,
            "defect_f1": 0.9454545454545454,
            "defect_tp": 1508,
            "defect_fp": 98,
            "defect_tn": 1593,
            "defect_fn": 76,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9561975456003581,
            "recall_macro": 0.9565988089051365,
            "f1_macro": 0.9563123510415119,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9662650602409638,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9573261712921516,
            "no_defect_tp": 1604,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9461300309597523,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9552985307908721,
            "defect_tp": 1528,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.961129333498554,
            "recall_macro": 0.9612498431983943,
            "f1_macro": 0.9611851851851851,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9643705463182898,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9623703703703703,
            "no_defect_tp": 1624,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9578881206788183,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.96,
            "defect_tp": 1524,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9599020979020979,
            "recall_macro": 0.960366714155153,
            "f1_macro": 0.9599837481924948,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9727272727272728,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9607901825800659,
            "no_defect_tp": 1605,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.947076923076923,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9591773138049237,
            "defect_tp": 1539,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9616879613919318,
            "recall_macro": 0.962020971094744,
            "f1_macro": 0.9618069352354779,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9694244604316546,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9627865436141709,
            "no_defect_tp": 1617,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9539514623522091,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9608273268567847,
            "defect_tp": 1533,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9608240336496755,
            "recall_macro": 0.9612937103142603,
            "f1_macro": 0.9609006286492436,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9739235900545785,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9616766467065868,
            "no_defect_tp": 1606,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9477244772447725,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9601246105919004,
            "defect_tp": 1541,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9608508773565554,
            "recall_macro": 0.9613336573899851,
            "f1_macro": 0.9609024665768319,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9750759878419453,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9616306954436451,
            "no_defect_tp": 1604,
            "no_defect_fp": 41,
            "no_defect_tn": 1543,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9466257668711656,
            "defect_recall": 0.9741161616161617,
            "defect_f1": 0.9601742377100186,
            "defect_tp": 1543,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 41,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962325083341601,
            "recall_macro": 0.9627721254532313,
            "f1_macro": 0.9624255822250827,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9740024183796856,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9632286995515695,
            "no_defect_tp": 1611,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9506477483035164,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9616224648985959,
            "defect_tp": 1541,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620969452060523,
            "recall_macro": 0.9620969452060523,
            "f1_macro": 0.9620969452060523,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9633353045535187,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9633353045535187,
            "no_defect_tp": 1629,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9608585858585859,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9608585858585859,
            "defect_tp": 1522,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635523958799821,
            "recall_macro": 0.9637351486479222,
            "f1_macro": 0.9636328736613169,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9678571428571429,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9646989024028478,
            "no_defect_tp": 1626,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9592476489028213,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9625668449197861,
            "defect_tp": 1530,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629103026667623,
            "recall_macro": 0.9632835973573703,
            "f1_macro": 0.9630313758690576,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9717548076923077,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9639344262295082,
            "no_defect_tp": 1617,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9540657976412167,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9621283255086072,
            "defect_tp": 1537,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9641315572308798,
            "recall_macro": 0.9644663294685472,
            "f1_macro": 0.9642512913804072,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.9718225419664268,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9651682048228639,
            "no_defect_tp": 1621,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9564405724953329,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9633343779379505,
            "defect_tp": 1537,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629252545967721,
            "recall_macro": 0.9631637561301961,
            "f1_macro": 0.9630242561439546,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9683770883054893,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9640629640629641,
            "no_defect_tp": 1623,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.957473420888055,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.961985548224945,
            "defect_tp": 1531,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629252545967721,
            "recall_macro": 0.9631637561301961,
            "f1_macro": 0.9630242561439546,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9683770883054893,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9640629640629641,
            "no_defect_tp": 1623,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.957473420888055,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.961985548224945,
            "defect_tp": 1531,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 53,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9682522643408252,
            "recall_macro": 0.9682522643408252,
            "f1_macro": 0.9682522643408252,
            "precision_micro": 0.9682539682539683,
            "recall_micro": 0.9682539682539683,
            "f1_micro": 0.9682539682539683,
            "accuracy": 0.9682539682539683,
            "hamming_loss": 0.031746031746031744,
            "no_defect_precision": 0.9684848484848485,
            "no_defect_recall": 0.9684848484848485,
            "no_defect_f1": 0.9684848484848485,
            "no_defect_tp": 1598,
            "no_defect_fp": 52,
            "no_defect_tn": 1574,
            "no_defect_fn": 52,
            "no_defect_support": 1650,
            "defect_precision": 0.968019680196802,
            "defect_recall": 0.968019680196802,
            "defect_f1": 0.968019680196802,
            "defect_tp": 1574,
            "defect_fp": 52,
            "defect_tn": 1598,
            "defect_fn": 52,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.01_s90_20251207_185259",
    "lr": 0.005,
    "weight_decay": 0.01,
    "seed": 90,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9630086134785402,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.01_s90_20251207_185259",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s90_20251207_185259",
      "timestamp": "2025-12-07T18:54:52.831066",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.01_s90",
          "seed": 90,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s90_20251207_185259"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9630820100188741,
        "recall_macro": 0.9629440472137101,
        "f1_macro": 0.9630086134785402,
        "precision_micro": 0.9630534351145038,
        "recall_micro": 0.9630534351145038,
        "f1_micro": 0.9630534351145038,
        "accuracy": 0.9630534351145038,
        "hamming_loss": 0.036946564885496185,
        "no_defect_precision": 0.9623085983510011,
        "no_defect_recall": 0.9662921348314607,
        "no_defect_f1": 0.9642962525818826,
        "no_defect_tp": 1634,
        "no_defect_fp": 64,
        "no_defect_tn": 1520,
        "no_defect_fn": 57,
        "no_defect_support": 1691,
        "defect_precision": 0.963855421686747,
        "defect_recall": 0.9595959595959596,
        "defect_f1": 0.9617209743751978,
        "defect_tp": 1520,
        "defect_fp": 57,
        "defect_tn": 1634,
        "defect_fn": 64,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9667225735035138,
        "recall_macro": 0.9667460583696745,
        "f1_macro": 0.96672701915989,
        "precision_micro": 0.9667277167277167,
        "recall_micro": 0.9667277167277167,
        "f1_micro": 0.9667277167277167,
        "accuracy": 0.9667277167277167,
        "hamming_loss": 0.03327228327228327,
        "no_defect_precision": 0.9695307739183425,
        "no_defect_recall": 0.9642424242424242,
        "no_defect_f1": 0.9668793679732605,
        "no_defect_tp": 1591,
        "no_defect_fp": 50,
        "no_defect_tn": 1576,
        "no_defect_fn": 59,
        "no_defect_support": 1650,
        "defect_precision": 0.963914373088685,
        "defect_recall": 0.9692496924969249,
        "defect_f1": 0.9665746703465194,
        "defect_tp": 1576,
        "defect_fp": 59,
        "defect_tn": 1591,
        "defect_fn": 50,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4689849448004527,
          0.2567155739627623,
          0.19949153043859674,
          0.18454815999109875,
          0.1780310859552986,
          0.17819420681588322,
          0.17412384842604273,
          0.16613637746377968,
          0.1700956515624932,
          0.1689092636918922,
          0.16506441486181075,
          0.17077892036742245,
          0.1636585980248501,
          0.16847345340513784,
          0.16806900261211594
        ],
        "val_loss": [
          0.37036294719347584,
          0.19671863403457862,
          0.1421308285341813,
          0.13309444336650464,
          0.11870683579204175,
          0.12853811416201866,
          0.11960608698427677,
          0.11238116706506564,
          0.10639156537273756,
          0.10881175630940841,
          0.10352391792604557,
          0.10674573516903016,
          0.1032487226363558,
          0.10900958620298368,
          0.10706016736534926
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8982143984986151,
            "recall_macro": 0.8954491693994946,
            "f1_macro": 0.8961010703632216,
            "precision_micro": 0.8964885496183206,
            "recall_micro": 0.8964885496183206,
            "f1_micro": 0.8964885496183206,
            "accuracy": 0.8964885496183206,
            "hamming_loss": 0.10351145038167939,
            "no_defect_precision": 0.8789237668161435,
            "no_defect_recall": 0.9272619751626257,
            "no_defect_f1": 0.9024460431654676,
            "no_defect_tp": 1568,
            "no_defect_fp": 216,
            "no_defect_tn": 1368,
            "no_defect_fn": 123,
            "no_defect_support": 1691,
            "defect_precision": 0.9175050301810865,
            "defect_recall": 0.8636363636363636,
            "defect_f1": 0.8897560975609756,
            "defect_tp": 1368,
            "defect_fp": 123,
            "defect_tn": 1568,
            "defect_fn": 216,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9434435256565807,
            "recall_macro": 0.9434610743747349,
            "f1_macro": 0.943452211787345,
            "precision_micro": 0.9435114503816794,
            "recall_micro": 0.9435114503816794,
            "f1_micro": 0.9435114503816794,
            "accuracy": 0.9435114503816794,
            "hamming_loss": 0.05648854961832061,
            "no_defect_precision": 0.9455621301775148,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.9452824608104111,
            "no_defect_tp": 1598,
            "no_defect_fp": 92,
            "no_defect_tn": 1492,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.9413249211356467,
            "defect_recall": 0.9419191919191919,
            "defect_f1": 0.9416219627642789,
            "defect_tp": 1492,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 92,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556673768408462,
            "recall_macro": 0.9551325272237454,
            "f1_macro": 0.9553484047758858,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9504373177842566,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.9571344685848503,
            "no_defect_tp": 1630,
            "no_defect_fp": 85,
            "no_defect_tn": 1499,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9608974358974359,
            "defect_recall": 0.9463383838383839,
            "defect_f1": 0.9535623409669212,
            "defect_tp": 1499,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 85,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9568006195641712,
            "recall_macro": 0.9571502278850001,
            "f1_macro": 0.9569195573314839,
            "precision_micro": 0.9569465648854962,
            "recall_micro": 0.9569465648854962,
            "f1_micro": 0.9569465648854962,
            "accuracy": 0.9569465648854962,
            "hamming_loss": 0.04305343511450382,
            "no_defect_precision": 0.9651860744297719,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9579982126899017,
            "no_defect_tp": 1608,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9484151646985706,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.955840901973066,
            "defect_tp": 1526,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9595680124902699,
            "recall_macro": 0.9597914015972857,
            "f1_macro": 0.9596621285705969,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9648181276088252,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9608076009501187,
            "no_defect_tp": 1618,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9543178973717147,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9585166561910748,
            "defect_tp": 1525,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9518790540097029,
            "recall_macro": 0.9523433253289848,
            "f1_macro": 0.9517474068835454,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.9711124769514444,
            "no_defect_recall": 0.9343583678296866,
            "no_defect_f1": 0.9523809523809523,
            "no_defect_tp": 1580,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 111,
            "no_defect_support": 1691,
            "defect_precision": 0.9326456310679612,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9511138613861386,
            "defect_tp": 1537,
            "defect_fp": 111,
            "defect_tn": 1580,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556526713941642,
            "recall_macro": 0.9561272840767223,
            "f1_macro": 0.9557093173233067,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9696233292831106,
            "no_defect_recall": 0.9438202247191011,
            "no_defect_f1": 0.9565477974228349,
            "no_defect_tp": 1596,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 95,
            "no_defect_support": 1691,
            "defect_precision": 0.941682013505218,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9548708372237784,
            "defect_tp": 1534,
            "defect_fp": 95,
            "defect_tn": 1596,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9607868405602931,
            "recall_macro": 0.9612138161628109,
            "f1_macro": 0.9608966021087477,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.971635485817743,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.961768219832736,
            "no_defect_tp": 1610,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9499381953028431,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9600249843847595,
            "defect_tp": 1537,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9609526953747054,
            "recall_macro": 0.9607943718677012,
            "f1_macro": 0.9608677793958403,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9599764567392584,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9622418879056047,
            "no_defect_tp": 1631,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9619289340101523,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.959493670886076,
            "defect_tp": 1516,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9613825005129353,
            "recall_macro": 0.9617452616048121,
            "f1_macro": 0.96150316856024,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.96996996996997,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9624553039332538,
            "no_defect_tp": 1615,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9527950310559006,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.960551033187226,
            "defect_tp": 1534,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9632382340302299,
            "recall_macro": 0.962824205986536,
            "f1_macro": 0.9629986659818077,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9590643274853801,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.9644222287562482,
            "no_defect_tp": 1640,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.9674121405750798,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9615751032073674,
            "defect_tp": 1514,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9619930491513637,
            "recall_macro": 0.9623366276604006,
            "f1_macro": 0.962113070048558,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.97000599880024,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9630732578916021,
            "no_defect_tp": 1617,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9539800995024875,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9611528822055138,
            "defect_tp": 1534,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9630820100188741,
            "recall_macro": 0.9629440472137101,
            "f1_macro": 0.9630086134785402,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9623085983510011,
            "no_defect_recall": 0.9662921348314607,
            "no_defect_f1": 0.9642962525818826,
            "no_defect_tp": 1634,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 57,
            "no_defect_support": 1691,
            "defect_precision": 0.963855421686747,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9617209743751978,
            "defect_tp": 1520,
            "defect_fp": 57,
            "defect_tn": 1634,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962002563276219,
            "recall_macro": 0.96241652181185,
            "f1_macro": 0.9621175373134329,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9722724532851115,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9629850746268657,
            "no_defect_tp": 1613,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9517326732673267,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.96125,
            "defect_tp": 1538,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626039344369932,
            "recall_macro": 0.9629479672538513,
            "f1_macro": 0.9627241495639038,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9706058788242351,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9636688505062537,
            "no_defect_tp": 1618,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9546019900497512,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9617794486215538,
            "defect_tp": 1535,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 49,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9667225735035138,
            "recall_macro": 0.9667460583696745,
            "f1_macro": 0.96672701915989,
            "precision_micro": 0.9667277167277167,
            "recall_micro": 0.9667277167277167,
            "f1_micro": 0.9667277167277167,
            "accuracy": 0.9667277167277167,
            "hamming_loss": 0.03327228327228327,
            "no_defect_precision": 0.9695307739183425,
            "no_defect_recall": 0.9642424242424242,
            "no_defect_f1": 0.9668793679732605,
            "no_defect_tp": 1591,
            "no_defect_fp": 50,
            "no_defect_tn": 1576,
            "no_defect_fn": 59,
            "no_defect_support": 1650,
            "defect_precision": 0.963914373088685,
            "defect_recall": 0.9692496924969249,
            "defect_f1": 0.9665746703465194,
            "defect_tp": 1576,
            "defect_fp": 59,
            "defect_tn": 1591,
            "defect_fn": 50,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.01_s100_20251207_200610",
    "lr": 0.005,
    "weight_decay": 0.01,
    "seed": 100,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9630203225618912,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.01_s100_20251207_200610",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s100_20251207_200610",
      "timestamp": "2025-12-07T20:08:00.998903",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 15,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.01_s100",
          "seed": 100,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s100_20251207_200610"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9629513933208083,
        "recall_macro": 0.963103835516609,
        "f1_macro": 0.9630203225618912,
        "precision_micro": 0.9630534351145038,
        "recall_micro": 0.9630534351145038,
        "f1_micro": 0.9630534351145038,
        "accuracy": 0.9630534351145038,
        "hamming_loss": 0.036946564885496185,
        "no_defect_precision": 0.9667063020214031,
        "no_defect_recall": 0.9615612063867534,
        "no_defect_f1": 0.9641268900088942,
        "no_defect_tp": 1626,
        "no_defect_fp": 56,
        "no_defect_tn": 1528,
        "no_defect_fn": 65,
        "no_defect_support": 1691,
        "defect_precision": 0.9591964846202135,
        "defect_recall": 0.9646464646464646,
        "defect_f1": 0.9619137551148883,
        "defect_tp": 1528,
        "defect_fp": 65,
        "defect_tn": 1626,
        "defect_fn": 56,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.967041749105781,
        "recall_macro": 0.9670222520407022,
        "f1_macro": 0.9670305585705936,
        "precision_micro": 0.967032967032967,
        "recall_micro": 0.967032967032967,
        "f1_micro": 0.967032967032967,
        "accuracy": 0.967032967032967,
        "hamming_loss": 0.03296703296703297,
        "no_defect_precision": 0.966142684401451,
        "no_defect_recall": 0.9684848484848485,
        "no_defect_f1": 0.9673123486682809,
        "no_defect_tp": 1598,
        "no_defect_fp": 56,
        "no_defect_tn": 1570,
        "no_defect_fn": 52,
        "no_defect_support": 1650,
        "defect_precision": 0.967940813810111,
        "defect_recall": 0.965559655596556,
        "defect_f1": 0.9667487684729064,
        "defect_tp": 1570,
        "defect_fp": 52,
        "defect_tn": 1598,
        "defect_fn": 56,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4661800423676,
          0.2584217598498117,
          0.19467258038755242,
          0.17993579524331513,
          0.1778317213713125,
          0.17487476630502666,
          0.16999676242221348,
          0.17524287442844283,
          0.1746712100992143,
          0.16535146324018554,
          0.1702829627281203,
          0.16783419168830915,
          0.17202438783508464,
          0.1631456284655188,
          0.16344865121602015
        ],
        "val_loss": [
          0.3666556305610217,
          0.19814523338125303,
          0.14412395670436895,
          0.13210606625160345,
          0.11940417488893637,
          0.11704071288785109,
          0.11716395365790679,
          0.10575586306647612,
          0.11213929048524453,
          0.10589082352817059,
          0.109967766652027,
          0.1074786765429263,
          0.10836004523130563,
          0.104656783469881,
          0.10510213726844925
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8978659572059323,
            "recall_macro": 0.8936112305790012,
            "f1_macro": 0.8944366443708663,
            "precision_micro": 0.8949618320610687,
            "recall_micro": 0.8949618320610687,
            "f1_micro": 0.8949618320610687,
            "accuracy": 0.8949618320610687,
            "hamming_loss": 0.1050381679389313,
            "no_defect_precision": 0.8710743801652893,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.9018824871648602,
            "no_defect_tp": 1581,
            "no_defect_fp": 234,
            "no_defect_tn": 1350,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9246575342465754,
            "defect_recall": 0.8522727272727273,
            "defect_f1": 0.8869908015768725,
            "defect_tp": 1350,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 234,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9418696940062644,
            "recall_macro": 0.9423022358415616,
            "f1_macro": 0.9419589689786196,
            "precision_micro": 0.9419847328244275,
            "recall_micro": 0.9419847328244275,
            "f1_micro": 0.9419847328244275,
            "accuracy": 0.9419847328244275,
            "hamming_loss": 0.05801526717557252,
            "no_defect_precision": 0.9540229885057471,
            "no_defect_recall": 0.9325842696629213,
            "no_defect_f1": 0.9431818181818182,
            "no_defect_tp": 1577,
            "no_defect_fp": 76,
            "no_defect_tn": 1508,
            "no_defect_fn": 114,
            "no_defect_support": 1691,
            "defect_precision": 0.9297163995067818,
            "defect_recall": 0.952020202020202,
            "defect_f1": 0.940736119775421,
            "defect_tp": 1508,
            "defect_fp": 114,
            "defect_tn": 1577,
            "defect_fn": 76,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540686293167593,
            "recall_macro": 0.9542893452562288,
            "f1_macro": 0.9541615097393146,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9594514013118665,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9554631828978623,
            "no_defect_tp": 1609,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9486858573216521,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9528598365807668,
            "defect_tp": 1516,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9562269972057247,
            "recall_macro": 0.956678703056586,
            "f1_macro": 0.9563170453952947,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9685230024213075,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.9572240502542626,
            "no_defect_tp": 1600,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9439309919901417,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9554100405363268,
            "defect_tp": 1532,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598772803297004,
            "recall_macro": 0.96008708462508,
            "f1_macro": 0.9599670199721204,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9648390941597139,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9611160581775008,
            "no_defect_tp": 1619,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.954915466499687,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.95881798176674,
            "defect_tp": 1525,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9571627195192505,
            "recall_macro": 0.9572661490720331,
            "f1_macro": 0.9572112125474457,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9602373887240356,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9585308056872038,
            "no_defect_tp": 1618,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9540880503144654,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9558916194076874,
            "defect_tp": 1517,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9584080780204002,
            "recall_macro": 0.9588882990161819,
            "f1_macro": 0.9584588707378838,
            "precision_micro": 0.9584732824427481,
            "recall_micro": 0.9584732824427481,
            "f1_micro": 0.9584732824427481,
            "accuracy": 0.9584732824427481,
            "hamming_loss": 0.04152671755725191,
            "no_defect_precision": 0.9726443768996961,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.9592326139088729,
            "no_defect_tp": 1600,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9441717791411043,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9576851275668948,
            "defect_tp": 1539,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9627259713716703,
            "recall_macro": 0.9626883112616407,
            "f1_macro": 0.9627067811215202,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9633786178381571,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9639479905437353,
            "no_defect_tp": 1631,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9620733249051833,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9614655716993051,
            "defect_tp": 1522,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9611035852739923,
            "recall_macro": 0.9615494462663298,
            "f1_macro": 0.9612036499397196,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9727932285368803,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9620328849028401,
            "no_defect_tp": 1609,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9494139420111043,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.960374414976599,
            "defect_tp": 1539,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9618182116888344,
            "recall_macro": 0.9617613151025333,
            "f1_macro": 0.961788953682378,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9622195985832349,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.9630723781388478,
            "no_defect_tp": 1630,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9614168247944339,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9605055292259084,
            "defect_tp": 1520,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9601603932944754,
            "recall_macro": 0.9605026088800483,
            "f1_macro": 0.9602798315025205,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9682063587282543,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9612864800476474,
            "no_defect_tp": 1614,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9521144278606966,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9592731829573935,
            "defect_tp": 1531,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9595499225934009,
            "recall_macro": 0.9599112428244598,
            "f1_macro": 0.9596699861107276,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9681681681681682,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9606674612634089,
            "no_defect_tp": 1612,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9509316770186336,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9586725109580463,
            "defect_tp": 1531,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962002563276219,
            "recall_macro": 0.96241652181185,
            "f1_macro": 0.9621175373134329,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9722724532851115,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9629850746268657,
            "no_defect_tp": 1613,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9517326732673267,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.96125,
            "defect_tp": 1538,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.961469399579058,
            "recall_macro": 0.9615055791504639,
            "f1_macro": 0.9614871297108618,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9632918886915335,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9627218934911242,
            "no_defect_tp": 1627,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.9596469104665826,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9602523659305994,
            "defect_tp": 1522,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629513933208083,
            "recall_macro": 0.963103835516609,
            "f1_macro": 0.9630203225618912,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9667063020214031,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9641268900088942,
            "no_defect_tp": 1626,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9591964846202135,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9619137551148883,
            "defect_tp": 1528,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 56,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.967041749105781,
            "recall_macro": 0.9670222520407022,
            "f1_macro": 0.9670305585705936,
            "precision_micro": 0.967032967032967,
            "recall_micro": 0.967032967032967,
            "f1_micro": 0.967032967032967,
            "accuracy": 0.967032967032967,
            "hamming_loss": 0.03296703296703297,
            "no_defect_precision": 0.966142684401451,
            "no_defect_recall": 0.9684848484848485,
            "no_defect_f1": 0.9673123486682809,
            "no_defect_tp": 1598,
            "no_defect_fp": 56,
            "no_defect_tn": 1570,
            "no_defect_fn": 52,
            "no_defect_support": 1650,
            "defect_precision": 0.967940813810111,
            "defect_recall": 0.965559655596556,
            "defect_f1": 0.9667487684729064,
            "defect_tp": 1570,
            "defect_fp": 52,
            "defect_tn": 1598,
            "defect_fn": 56,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.01_s110_20251207_210336",
    "lr": 0.005,
    "weight_decay": 0.01,
    "seed": 110,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9648428971077034,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.01_s110_20251207_210336",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s110_20251207_210336",
      "timestamp": "2025-12-07T21:05:35.808123",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.01_s110",
          "seed": 110,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s110_20251207_210336"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9649165753585291,
        "recall_macro": 0.9647780659940625,
        "f1_macro": 0.9648428971077034,
        "precision_micro": 0.9648854961832061,
        "recall_micro": 0.9648854961832061,
        "f1_micro": 0.9648854961832061,
        "accuracy": 0.9648854961832061,
        "hamming_loss": 0.035114503816793895,
        "no_defect_precision": 0.964075382803298,
        "no_defect_recall": 0.9680662329982259,
        "no_defect_f1": 0.9660666863381528,
        "no_defect_tp": 1637,
        "no_defect_fp": 61,
        "no_defect_tn": 1523,
        "no_defect_fn": 54,
        "no_defect_support": 1691,
        "defect_precision": 0.9657577679137603,
        "defect_recall": 0.961489898989899,
        "defect_f1": 0.963619107877254,
        "defect_tp": 1523,
        "defect_fp": 54,
        "defect_tn": 1637,
        "defect_fn": 61,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9673313904970483,
        "recall_macro": 0.9673521189757353,
        "f1_macro": 0.9673373377859831,
        "precision_micro": 0.9673382173382173,
        "recall_micro": 0.9673382173382173,
        "f1_micro": 0.9673382173382173,
        "accuracy": 0.9673382173382173,
        "hamming_loss": 0.032661782661782664,
        "no_defect_precision": 0.9695678636640293,
        "no_defect_recall": 0.9654545454545455,
        "no_defect_f1": 0.967506832675372,
        "no_defect_tp": 1593,
        "no_defect_fp": 50,
        "no_defect_tn": 1576,
        "no_defect_fn": 57,
        "no_defect_support": 1650,
        "defect_precision": 0.9650949173300674,
        "defect_recall": 0.9692496924969249,
        "defect_f1": 0.9671678428965941,
        "defect_tp": 1576,
        "defect_fp": 57,
        "defect_tn": 1593,
        "defect_fn": 50,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4710465824254886,
          0.2576266932749349,
          0.19687550337244775,
          0.18264083863551647,
          0.17561108031345213,
          0.17226139839473628,
          0.17767464258867827,
          0.1707280448415788,
          0.1677495727011599,
          0.1713903622397818,
          0.1656976246808862,
          0.16504185988127437,
          0.16273674852054987,
          0.16984327195142104,
          0.17118588083708136
        ],
        "val_loss": [
          0.3724563786616692,
          0.19636757070055375,
          0.1422330755740404,
          0.12859388892180645,
          0.12743305042386055,
          0.12292216080599107,
          0.11551156074095231,
          0.11638006317214324,
          0.1114773338374037,
          0.1090940899000718,
          0.10712241632147478,
          0.10774294222490145,
          0.10305984533176972,
          0.10497019289491269,
          0.10547623353508803
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8999073652033317,
            "recall_macro": 0.895029725104385,
            "f1_macro": 0.8959202539481119,
            "precision_micro": 0.8964885496183206,
            "recall_micro": 0.8964885496183206,
            "f1_micro": 0.8964885496183206,
            "accuracy": 0.8964885496183206,
            "hamming_loss": 0.10351145038167939,
            "no_defect_precision": 0.8702081051478642,
            "no_defect_recall": 0.9396806623299823,
            "no_defect_f1": 0.903611032129656,
            "no_defect_tp": 1589,
            "no_defect_fp": 237,
            "no_defect_tn": 1347,
            "no_defect_fn": 102,
            "no_defect_support": 1691,
            "defect_precision": 0.9296066252587992,
            "defect_recall": 0.8503787878787878,
            "defect_f1": 0.8882294757665677,
            "defect_tp": 1347,
            "defect_fp": 102,
            "defect_tn": 1589,
            "defect_fn": 237,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9418350027045679,
            "recall_macro": 0.9421823946143875,
            "f1_macro": 0.9419492224321079,
            "precision_micro": 0.9419847328244275,
            "recall_micro": 0.9419847328244275,
            "f1_micro": 0.9419847328244275,
            "accuracy": 0.9419847328244275,
            "hamming_loss": 0.05801526717557252,
            "no_defect_precision": 0.9507507507507508,
            "no_defect_recall": 0.9361324659964518,
            "no_defect_f1": 0.9433849821215733,
            "no_defect_tp": 1583,
            "no_defect_fp": 82,
            "no_defect_tn": 1502,
            "no_defect_fn": 108,
            "no_defect_support": 1691,
            "defect_precision": 0.9329192546583851,
            "defect_recall": 0.9482323232323232,
            "defect_f1": 0.9405134627426425,
            "defect_tp": 1502,
            "defect_fp": 108,
            "defect_tn": 1583,
            "defect_fn": 82,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9544766037428329,
            "recall_macro": 0.9538898744989815,
            "f1_macro": 0.9541228113429143,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9487478159580663,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9559859154929577,
            "no_defect_tp": 1629,
            "no_defect_fp": 88,
            "no_defect_tn": 1496,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9602053915275995,
            "defect_recall": 0.9444444444444444,
            "defect_f1": 0.9522597071928708,
            "defect_tp": 1496,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 88,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9565646094971325,
            "recall_macro": 0.95663483594072,
            "f1_macro": 0.9565982915937783,
            "precision_micro": 0.9566412213740458,
            "recall_micro": 0.9566412213740458,
            "f1_micro": 0.9566412213740458,
            "accuracy": 0.9566412213740458,
            "hamming_loss": 0.0433587786259542,
            "no_defect_precision": 0.9590989922940131,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9579632918886916,
            "no_defect_tp": 1618,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9540302267002518,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.955233291298865,
            "defect_tp": 1515,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9566266403719843,
            "recall_macro": 0.9571142008494167,
            "f1_macro": 0.9566289892376849,
            "precision_micro": 0.9566412213740458,
            "recall_micro": 0.9566412213740458,
            "f1_micro": 0.9566412213740458,
            "accuracy": 0.9566412213740458,
            "hamming_loss": 0.0433587786259542,
            "no_defect_precision": 0.9725442342892008,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.9573573573573574,
            "no_defect_tp": 1594,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.9407090464547677,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9559006211180124,
            "defect_tp": 1539,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9578886029685985,
            "recall_macro": 0.958376827112043,
            "f1_macro": 0.9578523744794378,
            "precision_micro": 0.9578625954198473,
            "recall_micro": 0.9578625954198473,
            "f1_micro": 0.9578625954198473,
            "accuracy": 0.9578625954198473,
            "hamming_loss": 0.04213740458015267,
            "no_defect_precision": 0.9749235474006116,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.9585087191822008,
            "no_defect_tp": 1594,
            "no_defect_fp": 41,
            "no_defect_tn": 1543,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.9408536585365853,
            "defect_recall": 0.9741161616161617,
            "defect_f1": 0.957196029776675,
            "defect_tp": 1543,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 41,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598560676598387,
            "recall_macro": 0.9602268993901164,
            "f1_macro": 0.9599761176764179,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.96875,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9609538002980625,
            "no_defect_tp": 1612,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9509621353196772,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9589984350547731,
            "defect_tp": 1532,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9596025993613484,
            "recall_macro": 0.9600710311273588,
            "f1_macro": 0.9596787732945324,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9727107337780473,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9604790419161676,
            "no_defect_tp": 1604,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9464944649446494,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9588785046728971,
            "defect_tp": 1539,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9616909989010768,
            "recall_macro": 0.9620808917083311,
            "f1_macro": 0.9618103984116484,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9711191335740073,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.962719952281539,
            "no_defect_tp": 1614,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9522628642281463,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.960900844541758,
            "defect_tp": 1536,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9619965645431603,
            "recall_macro": 0.9622966805846758,
            "f1_macro": 0.9621106663372536,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9688809096349491,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9631171921475312,
            "no_defect_tp": 1619,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9551122194513716,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9611041405269761,
            "defect_tp": 1532,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620201486443924,
            "recall_macro": 0.9622167864332264,
            "f1_macro": 0.9621055185413284,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9666468135795117,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9632047477744807,
            "no_defect_tp": 1623,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9573934837092731,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9610062893081761,
            "defect_tp": 1528,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623018226607968,
            "recall_macro": 0.9626922313017818,
            "f1_macro": 0.9624214320370621,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9717208182912154,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9633164330450343,
            "no_defect_tp": 1615,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9528828270303782,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9615264310290897,
            "defect_tp": 1537,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9649165753585291,
            "recall_macro": 0.9647780659940625,
            "f1_macro": 0.9648428971077034,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.964075382803298,
            "no_defect_recall": 0.9680662329982259,
            "no_defect_f1": 0.9660666863381528,
            "no_defect_tp": 1637,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 54,
            "no_defect_support": 1691,
            "defect_precision": 0.9657577679137603,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.963619107877254,
            "defect_tp": 1523,
            "defect_fp": 54,
            "defect_tn": 1637,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644442877365635,
            "recall_macro": 0.9647220654206166,
            "f1_macro": 0.9645539753663658,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9707112970711297,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9655172413793104,
            "no_defect_tp": 1624,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9581772784019975,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9635907093534212,
            "defect_tp": 1535,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638293927061461,
            "recall_macro": 0.9641306993650282,
            "f1_macro": 0.9639440211919027,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9706762417713943,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9649018441403926,
            "no_defect_tp": 1622,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9569825436408977,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9629861982434128,
            "defect_tp": 1535,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 49,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9673313904970483,
            "recall_macro": 0.9673521189757353,
            "f1_macro": 0.9673373377859831,
            "precision_micro": 0.9673382173382173,
            "recall_micro": 0.9673382173382173,
            "f1_micro": 0.9673382173382173,
            "accuracy": 0.9673382173382173,
            "hamming_loss": 0.032661782661782664,
            "no_defect_precision": 0.9695678636640293,
            "no_defect_recall": 0.9654545454545455,
            "no_defect_f1": 0.967506832675372,
            "no_defect_tp": 1593,
            "no_defect_fp": 50,
            "no_defect_tn": 1576,
            "no_defect_fn": 57,
            "no_defect_support": 1650,
            "defect_precision": 0.9650949173300674,
            "defect_recall": 0.9692496924969249,
            "defect_f1": 0.9671678428965941,
            "defect_tp": 1576,
            "defect_fp": 57,
            "defect_tn": 1593,
            "defect_fn": 50,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.01_s120_20251207_201920",
    "lr": 0.005,
    "weight_decay": 0.01,
    "seed": 120,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9639323913165214,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.01_s120_20251207_201920",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s120_20251207_201920",
      "timestamp": "2025-12-07T20:21:11.423868",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 15,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.01_s120",
          "seed": 120,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s120_20251207_201920"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9639145662498311,
        "recall_macro": 0.963950937524267,
        "f1_macro": 0.9639323913165214,
        "precision_micro": 0.963969465648855,
        "recall_micro": 0.963969465648855,
        "f1_micro": 0.963969465648855,
        "accuracy": 0.963969465648855,
        "hamming_loss": 0.03603053435114504,
        "no_defect_precision": 0.9656601539372409,
        "no_defect_recall": 0.9645180366646955,
        "no_defect_f1": 0.9650887573964497,
        "no_defect_tp": 1631,
        "no_defect_fp": 58,
        "no_defect_tn": 1526,
        "no_defect_fn": 60,
        "no_defect_support": 1691,
        "defect_precision": 0.9621689785624212,
        "defect_recall": 0.9633838383838383,
        "defect_f1": 0.9627760252365931,
        "defect_tp": 1526,
        "defect_fp": 60,
        "defect_tn": 1631,
        "defect_fn": 58,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9667480280003264,
        "recall_macro": 0.966710276193671,
        "f1_macro": 0.9667247371336796,
        "precision_micro": 0.9667277167277167,
        "recall_micro": 0.9667277167277167,
        "f1_micro": 0.9667277167277167,
        "accuracy": 0.9667277167277167,
        "hamming_loss": 0.03327228327228327,
        "no_defect_precision": 0.9649969824984912,
        "no_defect_recall": 0.9690909090909091,
        "no_defect_f1": 0.9670396129422437,
        "no_defect_tp": 1599,
        "no_defect_fp": 58,
        "no_defect_tn": 1568,
        "no_defect_fn": 51,
        "no_defect_support": 1650,
        "defect_precision": 0.9684990735021618,
        "defect_recall": 0.964329643296433,
        "defect_f1": 0.9664098613251155,
        "defect_tp": 1568,
        "defect_fp": 51,
        "defect_tn": 1599,
        "defect_fn": 58,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4635851561524379,
          0.256485486566771,
          0.2049681504401203,
          0.1853329670541456,
          0.18471356238156683,
          0.17533086609703227,
          0.17755077490933768,
          0.16923296432864218,
          0.16837812026487234,
          0.17005542692217868,
          0.1666175502208237,
          0.16405451020311612,
          0.1684786704326025,
          0.1684692261358684,
          0.16493860721027004
        ],
        "val_loss": [
          0.368889586856732,
          0.19143785564945295,
          0.1459636274868479,
          0.132251605248222,
          0.117212675511837,
          0.11587240403661361,
          0.10781076120642516,
          0.10515120310279039,
          0.10965327768085095,
          0.10535403491499332,
          0.11189732700586319,
          0.10642548285138148,
          0.10564168607099698,
          0.10389622064450613,
          0.10431817152465765
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8984885175600962,
            "recall_macro": 0.8957648259651512,
            "f1_macro": 0.8964114248667232,
            "precision_micro": 0.896793893129771,
            "recall_micro": 0.896793893129771,
            "f1_micro": 0.896793893129771,
            "accuracy": 0.896793893129771,
            "hamming_loss": 0.103206106870229,
            "no_defect_precision": 0.8794167134043747,
            "no_defect_recall": 0.9272619751626257,
            "no_defect_f1": 0.9027058146229131,
            "no_defect_tp": 1568,
            "no_defect_fp": 215,
            "no_defect_tn": 1369,
            "no_defect_fn": 123,
            "no_defect_support": 1691,
            "defect_precision": 0.9175603217158177,
            "defect_recall": 0.8642676767676768,
            "defect_f1": 0.8901170351105332,
            "defect_tp": 1369,
            "defect_fp": 123,
            "defect_tn": 1568,
            "defect_fn": 215,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9450052076206967,
            "recall_macro": 0.9444041240315635,
            "f1_macro": 0.9446401453014657,
            "precision_micro": 0.944732824427481,
            "recall_micro": 0.944732824427481,
            "f1_micro": 0.944732824427481,
            "accuracy": 0.944732824427481,
            "hamming_loss": 0.05526717557251908,
            "no_defect_precision": 0.9394644935972061,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9469052508066882,
            "no_defect_tp": 1614,
            "no_defect_fp": 104,
            "no_defect_tn": 1480,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9505459216441875,
            "defect_recall": 0.9343434343434344,
            "defect_f1": 0.9423750397962433,
            "defect_tp": 1480,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 104,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.952780722931176,
            "recall_macro": 0.9524713799735975,
            "f1_macro": 0.9526059868313499,
            "precision_micro": 0.9526717557251908,
            "recall_micro": 0.9526717557251908,
            "f1_micro": 0.9526717557251908,
            "accuracy": 0.9526717557251908,
            "hamming_loss": 0.04732824427480916,
            "no_defect_precision": 0.9501758499413834,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9543715042684722,
            "no_defect_tp": 1621,
            "no_defect_fp": 85,
            "no_defect_tn": 1499,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9553855959209687,
            "defect_recall": 0.9463383838383839,
            "defect_f1": 0.9508404693942277,
            "defect_tp": 1499,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 85,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9551298498846127,
            "recall_macro": 0.9556158121725833,
            "f1_macro": 0.9551031850369875,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9718826405867971,
            "no_defect_recall": 0.9402720283855707,
            "no_defect_f1": 0.9558160504959423,
            "no_defect_tp": 1590,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 101,
            "no_defect_support": 1691,
            "defect_precision": 0.9383770591824283,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9543903195780329,
            "defect_tp": 1538,
            "defect_fp": 101,
            "defect_tn": 1590,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9607335710875349,
            "recall_macro": 0.9604187946884577,
            "f1_macro": 0.9605559503306074,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9577960140679953,
            "no_defect_recall": 0.9662921348314607,
            "no_defect_f1": 0.9620253164556962,
            "no_defect_tp": 1634,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 57,
            "no_defect_support": 1691,
            "defect_precision": 0.9636711281070746,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.9590865842055185,
            "defect_tp": 1512,
            "defect_fp": 57,
            "defect_tn": 1634,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9586334665932469,
            "recall_macro": 0.9589642731274901,
            "f1_macro": 0.9587514900543159,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.9664268585131894,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9598094671033045,
            "no_defect_tp": 1612,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9508400746733043,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9576935130053275,
            "defect_tp": 1528,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635302980440092,
            "recall_macro": 0.9637950692615092,
            "f1_macro": 0.9636366605163039,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9695340501792115,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9646359583952452,
            "no_defect_tp": 1623,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.957526545908807,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9626373626373627,
            "defect_tp": 1533,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9618182116888344,
            "recall_macro": 0.9617613151025333,
            "f1_macro": 0.961788953682378,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9622195985832349,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.9630723781388478,
            "no_defect_tp": 1630,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9614168247944339,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9605055292259084,
            "defect_tp": 1520,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.960176066923633,
            "recall_macro": 0.9606024765693602,
            "f1_macro": 0.9602856115166969,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9710319855159928,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9611708482676224,
            "no_defect_tp": 1609,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9493201483312732,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9594003747657714,
            "defect_tp": 1536,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635625316765606,
            "recall_macro": 0.9637151751100598,
            "f1_macro": 0.9636315568997111,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9673008323424495,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9647198339756893,
            "no_defect_tp": 1627,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.9598242310106717,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9625432798237331,
            "defect_tp": 1529,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.959280671759916,
            "recall_macro": 0.9597354010238399,
            "f1_macro": 0.9593717974655538,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9715496368038741,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9602153754113072,
            "no_defect_tp": 1605,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9470117067159581,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9585282195198004,
            "defect_tp": 1537,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9616879613919318,
            "recall_macro": 0.962020971094744,
            "f1_macro": 0.9618069352354779,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9694244604316546,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9627865436141709,
            "no_defect_tp": 1617,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9539514623522091,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9608273268567847,
            "defect_tp": 1533,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635257009136577,
            "recall_macro": 0.9638150427993716,
            "f1_macro": 0.9636378683435654,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9700956937799043,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9646149271483794,
            "no_defect_tp": 1622,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9569557080474111,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9626608095387512,
            "defect_tp": 1534,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9639679250214704,
            "recall_macro": 0.9638910169106798,
            "f1_macro": 0.9639280281787953,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9640117994100295,
            "no_defect_recall": 0.9662921348314607,
            "no_defect_f1": 0.965150620200827,
            "no_defect_tp": 1634,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 57,
            "no_defect_support": 1691,
            "defect_precision": 0.9639240506329114,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9627054361567636,
            "defect_tp": 1523,
            "defect_fp": 57,
            "defect_tn": 1634,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9639145662498311,
            "recall_macro": 0.963950937524267,
            "f1_macro": 0.9639323913165214,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9656601539372409,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9650887573964497,
            "no_defect_tp": 1631,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9621689785624212,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9627760252365931,
            "defect_tp": 1526,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 58,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9667480280003264,
            "recall_macro": 0.966710276193671,
            "f1_macro": 0.9667247371336796,
            "precision_micro": 0.9667277167277167,
            "recall_micro": 0.9667277167277167,
            "f1_micro": 0.9667277167277167,
            "accuracy": 0.9667277167277167,
            "hamming_loss": 0.03327228327228327,
            "no_defect_precision": 0.9649969824984912,
            "no_defect_recall": 0.9690909090909091,
            "no_defect_f1": 0.9670396129422437,
            "no_defect_tp": 1599,
            "no_defect_fp": 58,
            "no_defect_tn": 1568,
            "no_defect_fn": 51,
            "no_defect_support": 1650,
            "defect_precision": 0.9684990735021618,
            "defect_recall": 0.964329643296433,
            "defect_f1": 0.9664098613251155,
            "defect_tp": 1568,
            "defect_fp": 51,
            "defect_tn": 1599,
            "defect_fn": 58,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.01_s130_20251207_150008",
    "lr": 0.005,
    "weight_decay": 0.01,
    "seed": 130,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9642359161098308,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.01_s130_20251207_150008",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s130_20251207_150008",
      "timestamp": "2025-12-07T15:02:01.306542",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 7,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.01_s130",
          "seed": 130,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s130_20251207_150008"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9642453655790171,
        "recall_macro": 0.9642266470141988,
        "f1_macro": 0.9642359161098308,
        "precision_micro": 0.9642748091603054,
        "recall_micro": 0.9642748091603054,
        "f1_micro": 0.9642748091603054,
        "accuracy": 0.9642748091603054,
        "hamming_loss": 0.03572519083969466,
        "no_defect_precision": 0.9651300236406619,
        "no_defect_recall": 0.9657007687758723,
        "no_defect_f1": 0.9654153118533846,
        "no_defect_tp": 1633,
        "no_defect_fp": 59,
        "no_defect_tn": 1525,
        "no_defect_fn": 58,
        "no_defect_support": 1691,
        "defect_precision": 0.9633607075173721,
        "defect_recall": 0.9627525252525253,
        "defect_f1": 0.9630565203662772,
        "defect_tp": 1525,
        "defect_fp": 58,
        "defect_tn": 1633,
        "defect_fn": 59,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9685892769075409,
        "recall_macro": 0.9685374035558538,
        "f1_macro": 0.9685560279214958,
        "precision_micro": 0.9685592185592186,
        "recall_micro": 0.9685592185592186,
        "f1_micro": 0.9685592185592186,
        "accuracy": 0.9685592185592186,
        "hamming_loss": 0.03144078144078144,
        "no_defect_precision": 0.9662447257383966,
        "no_defect_recall": 0.9715151515151516,
        "no_defect_f1": 0.9688727712299788,
        "no_defect_tp": 1603,
        "no_defect_fp": 56,
        "no_defect_tn": 1570,
        "no_defect_fn": 47,
        "no_defect_support": 1650,
        "defect_precision": 0.9709338280766853,
        "defect_recall": 0.965559655596556,
        "defect_f1": 0.9682392846130127,
        "defect_tp": 1570,
        "defect_fp": 47,
        "defect_tn": 1603,
        "defect_fn": 56,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.46107715717419423,
          0.2576257781004806,
          0.19854781037843378,
          0.18309009573948434,
          0.17539595815676526,
          0.1753392186187301,
          0.16920118973781373,
          0.17166446852322403,
          0.17466913794935,
          0.1691613202937976,
          0.16759229708603238,
          0.17018201705613895,
          0.1711845255484142,
          0.17082977544313693,
          0.16664375101360318
        ],
        "val_loss": [
          0.370856469640365,
          0.19309230206104425,
          0.14106774100890526,
          0.12735947422110117,
          0.13139311209894144,
          0.12157961396643749,
          0.10849031899124384,
          0.11346068992637671,
          0.11344967538920733,
          0.1115976908029272,
          0.10538453006973633,
          0.10444315042919837,
          0.1061031655050241,
          0.10452622146560596,
          0.10490479979377526
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8956332373882745,
            "recall_macro": 0.8899991935917424,
            "f1_macro": 0.8909366516545969,
            "precision_micro": 0.8916030534351145,
            "recall_micro": 0.8916030534351145,
            "f1_micro": 0.8916030534351145,
            "accuracy": 0.8916030534351145,
            "hamming_loss": 0.1083969465648855,
            "no_defect_precision": 0.8630434782608696,
            "no_defect_recall": 0.9390892962743939,
            "no_defect_f1": 0.8994619088077032,
            "no_defect_tp": 1588,
            "no_defect_fp": 252,
            "no_defect_tn": 1332,
            "no_defect_fn": 103,
            "no_defect_support": 1691,
            "defect_precision": 0.9282229965156794,
            "defect_recall": 0.8409090909090909,
            "defect_f1": 0.8824113945014905,
            "defect_tp": 1332,
            "defect_fp": 103,
            "defect_tn": 1588,
            "defect_fn": 252,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9442845451486728,
            "recall_macro": 0.9446677000639153,
            "f1_macro": 0.9443967440867727,
            "precision_micro": 0.9444274809160306,
            "recall_micro": 0.9444274809160306,
            "f1_micro": 0.9444274809160306,
            "accuracy": 0.9444274809160306,
            "hamming_loss": 0.055572519083969464,
            "no_defect_precision": 0.9542444310656231,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.9457040572792362,
            "no_defect_tp": 1585,
            "no_defect_fp": 76,
            "no_defect_tn": 1508,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.9343246592317225,
            "defect_recall": 0.952020202020202,
            "defect_f1": 0.943089430894309,
            "defect_tp": 1508,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 76,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9565432014706883,
            "recall_macro": 0.9556040520521597,
            "f1_macro": 0.9559441735328738,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9473684210526315,
            "no_defect_recall": 0.9686575990538143,
            "no_defect_f1": 0.9578947368421052,
            "no_defect_tp": 1638,
            "no_defect_fp": 91,
            "no_defect_tn": 1493,
            "no_defect_fn": 53,
            "no_defect_support": 1691,
            "defect_precision": 0.9657179818887451,
            "defect_recall": 0.9425505050505051,
            "defect_f1": 0.9539936102236422,
            "defect_tp": 1493,
            "defect_fp": 53,
            "defect_tn": 1638,
            "defect_fn": 91,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9593223749242215,
            "recall_macro": 0.9593758773423173,
            "f1_macro": 0.9593483187614451,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9614928909952607,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9606392423794022,
            "no_defect_tp": 1623,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9571518588531821,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9580573951434879,
            "defect_tp": 1519,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954321902542651,
            "recall_macro": 0.9547886837027878,
            "f1_macro": 0.9541905761552647,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9735709895513215,
            "no_defect_recall": 0.9367238320520402,
            "no_defect_f1": 0.9547920433996383,
            "no_defect_tp": 1584,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 107,
            "no_defect_support": 1691,
            "defect_precision": 0.9350728155339806,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9535891089108911,
            "defect_tp": 1541,
            "defect_fp": 107,
            "defect_tn": 1584,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.957783230324214,
            "recall_macro": 0.9582569858848689,
            "f1_macro": 0.9578469967699019,
            "precision_micro": 0.9578625954198473,
            "recall_micro": 0.9578625954198473,
            "f1_micro": 0.9578625954198473,
            "accuracy": 0.9578625954198473,
            "hamming_loss": 0.04213740458015267,
            "no_defect_precision": 0.9714632665452337,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.9586578789694428,
            "no_defect_tp": 1600,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9441031941031941,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9570361145703612,
            "defect_tp": 1537,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9642453655790171,
            "recall_macro": 0.9642266470141988,
            "f1_macro": 0.9642359161098308,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.9651300236406619,
            "no_defect_recall": 0.9657007687758723,
            "no_defect_f1": 0.9654153118533846,
            "no_defect_tp": 1633,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 58,
            "no_defect_support": 1691,
            "defect_precision": 0.9633607075173721,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9630565203662772,
            "defect_tp": 1525,
            "defect_fp": 58,
            "defect_tn": 1633,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9583811650730212,
            "recall_macro": 0.9588483519404571,
            "f1_macro": 0.9584569179398212,
            "precision_micro": 0.9584732824427481,
            "recall_micro": 0.9584732824427481,
            "f1_micro": 0.9584732824427481,
            "accuracy": 0.9584732824427481,
            "hamming_loss": 0.04152671755725191,
            "no_defect_precision": 0.9714978775015161,
            "no_defect_recall": 0.9473684210526315,
            "no_defect_f1": 0.9592814371257485,
            "no_defect_tp": 1602,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 89,
            "no_defect_support": 1691,
            "defect_precision": 0.9452644526445264,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.957632398753894,
            "defect_tp": 1537,
            "defect_fp": 89,
            "defect_tn": 1602,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9592713381725793,
            "recall_macro": 0.9597154274859775,
            "f1_macro": 0.9593707515116748,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9709794437726723,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9602391629297459,
            "no_defect_tp": 1606,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9475632325724861,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9585023400936038,
            "defect_tp": 1536,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9601625437003591,
            "recall_macro": 0.960542555955773,
            "f1_macro": 0.960282232635756,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9693325315694528,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9612403100775194,
            "no_defect_tp": 1612,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9509925558312655,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9593241551939925,
            "defect_tp": 1533,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629757369578964,
            "recall_macro": 0.9630638884408843,
            "f1_macro": 0.9630175616536514,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9655990510083037,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9641693811074918,
            "no_defect_tp": 1628,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.960352422907489,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9618657421998109,
            "defect_tp": 1526,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9631538701762878,
            "recall_macro": 0.9628841266001231,
            "f1_macro": 0.963003764742128,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9606807511737089,
            "no_defect_recall": 0.9680662329982259,
            "no_defect_f1": 0.964359351988218,
            "no_defect_tp": 1637,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 54,
            "no_defect_support": 1691,
            "defect_precision": 0.9656269891788669,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.961648177496038,
            "defect_tp": 1517,
            "defect_fp": 54,
            "defect_tn": 1637,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962321523595717,
            "recall_macro": 0.962532442998883,
            "f1_macro": 0.9624117821112275,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.967222884386174,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9634906500445236,
            "no_defect_tp": 1623,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9574201628052599,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9613329141779314,
            "defect_tp": 1529,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629513933208083,
            "recall_macro": 0.963103835516609,
            "f1_macro": 0.9630203225618912,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9667063020214031,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9641268900088942,
            "no_defect_tp": 1626,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9591964846202135,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9619137551148883,
            "defect_tp": 1528,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629513933208083,
            "recall_macro": 0.963103835516609,
            "f1_macro": 0.9630203225618912,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9667063020214031,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9641268900088942,
            "no_defect_tp": 1626,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9591964846202135,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9619137551148883,
            "defect_tp": 1528,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 56,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9685892769075409,
            "recall_macro": 0.9685374035558538,
            "f1_macro": 0.9685560279214958,
            "precision_micro": 0.9685592185592186,
            "recall_micro": 0.9685592185592186,
            "f1_micro": 0.9685592185592186,
            "accuracy": 0.9685592185592186,
            "hamming_loss": 0.03144078144078144,
            "no_defect_precision": 0.9662447257383966,
            "no_defect_recall": 0.9715151515151516,
            "no_defect_f1": 0.9688727712299788,
            "no_defect_tp": 1603,
            "no_defect_fp": 56,
            "no_defect_tn": 1570,
            "no_defect_fn": 47,
            "no_defect_support": 1650,
            "defect_precision": 0.9709338280766853,
            "defect_recall": 0.965559655596556,
            "defect_f1": 0.9682392846130127,
            "defect_tp": 1570,
            "defect_fp": 47,
            "defect_tn": 1603,
            "defect_fn": 56,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.01_s140_20251207_183302",
    "lr": 0.005,
    "weight_decay": 0.01,
    "seed": 140,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9639463085945955,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.01_s140_20251207_183302",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s140_20251207_183302",
      "timestamp": "2025-12-07T18:34:56.836915",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 11,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.01_s140",
          "seed": 140,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s140_20251207_183302"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9638257050082522,
        "recall_macro": 0.9641706464407529,
        "f1_macro": 0.9639463085945955,
        "precision_micro": 0.963969465648855,
        "recall_micro": 0.963969465648855,
        "f1_micro": 0.963969465648855,
        "accuracy": 0.963969465648855,
        "hamming_loss": 0.03603053435114504,
        "no_defect_precision": 0.9718056388722256,
        "no_defect_recall": 0.9580130100532229,
        "no_defect_f1": 0.9648600357355569,
        "no_defect_tp": 1620,
        "no_defect_fp": 47,
        "no_defect_tn": 1537,
        "no_defect_fn": 71,
        "no_defect_support": 1691,
        "defect_precision": 0.9558457711442786,
        "defect_recall": 0.9703282828282829,
        "defect_f1": 0.9630325814536341,
        "defect_tp": 1537,
        "defect_fp": 71,
        "defect_tn": 1620,
        "defect_fn": 47,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9679611071454531,
        "recall_macro": 0.9679358157217937,
        "f1_macro": 0.9679462061337196,
        "precision_micro": 0.967948717948718,
        "recall_micro": 0.967948717948718,
        "f1_micro": 0.967948717948718,
        "accuracy": 0.967948717948718,
        "hamming_loss": 0.03205128205128205,
        "no_defect_precision": 0.9667673716012085,
        "no_defect_recall": 0.9696969696969697,
        "no_defect_f1": 0.9682299546142209,
        "no_defect_tp": 1600,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 50,
        "no_defect_support": 1650,
        "defect_precision": 0.9691548426896978,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.9676624576532183,
        "defect_tp": 1571,
        "defect_fp": 50,
        "defect_tn": 1600,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.46221099438527635,
          0.2579677932307311,
          0.1975301193642317,
          0.17925955910064187,
          0.1738875249876138,
          0.1781179557659636,
          0.17081198593500269,
          0.17198584348773857,
          0.1706759734507884,
          0.1679196051130983,
          0.15986592860339077,
          0.16696643015704893,
          0.16434279113820907,
          0.16523895096267616,
          0.16461201071365109
        ],
        "val_loss": [
          0.37080652381365115,
          0.19257696990210277,
          0.13938738047503507,
          0.12608768977224827,
          0.11720026442064689,
          0.11273322949329248,
          0.11591422335746196,
          0.12345024269933884,
          0.11059677135199308,
          0.10425588639023212,
          0.10392495585032381,
          0.10064397272295676,
          0.1051952073063988,
          0.10154352910243548,
          0.10119168503353229
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8982164248484421,
            "recall_macro": 0.8924245784276831,
            "f1_macro": 0.8933841358070846,
            "precision_micro": 0.8940458015267175,
            "recall_micro": 0.8940458015267175,
            "f1_micro": 0.8940458015267175,
            "accuracy": 0.8940458015267175,
            "hamming_loss": 0.10595419847328244,
            "no_defect_precision": 0.8648208469055375,
            "no_defect_recall": 0.9420461265523359,
            "no_defect_f1": 0.901783187093122,
            "no_defect_tp": 1593,
            "no_defect_fp": 249,
            "no_defect_tn": 1335,
            "no_defect_fn": 98,
            "no_defect_support": 1691,
            "defect_precision": 0.9316120027913468,
            "defect_recall": 0.8428030303030303,
            "defect_f1": 0.8849850845210474,
            "defect_tp": 1335,
            "defect_fp": 98,
            "defect_tn": 1593,
            "defect_fn": 249,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9432747527603627,
            "recall_macro": 0.942510184637624,
            "f1_macro": 0.9427962292260667,
            "precision_micro": 0.9429007633587786,
            "recall_micro": 0.9429007633587786,
            "f1_micro": 0.9429007633587786,
            "accuracy": 0.9429007633587786,
            "hamming_loss": 0.05709923664122137,
            "no_defect_precision": 0.9361948955916474,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9452415812591508,
            "no_defect_tp": 1614,
            "no_defect_fp": 110,
            "no_defect_tn": 1474,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.950354609929078,
            "defect_recall": 0.9305555555555556,
            "defect_f1": 0.9403508771929825,
            "defect_tp": 1474,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 110,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9559677745698187,
            "recall_macro": 0.9560035228094068,
            "f1_macro": 0.9559852910981278,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9579632918886916,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9573964497041421,
            "no_defect_tp": 1618,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9539722572509458,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.9545741324921135,
            "defect_tp": 1513,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555827613038765,
            "recall_macro": 0.9559674957738233,
            "f1_macro": 0.9557000621575122,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9651022864019254,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9567551446465852,
            "no_defect_tp": 1604,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9460632362058277,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9546449796684392,
            "defect_tp": 1526,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9589395518751954,
            "recall_macro": 0.9592599561552844,
            "f1_macro": 0.9590563890132856,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9664469742360695,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9601190476190476,
            "no_defect_tp": 1613,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9514321295143213,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9579937304075236,
            "defect_tp": 1528,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.957732972376993,
            "recall_macro": 0.958157118195557,
            "f1_macro": 0.9578416491484937,
            "precision_micro": 0.9578625954198473,
            "recall_micro": 0.9578625954198473,
            "f1_micro": 0.9578625954198473,
            "accuracy": 0.9578625954198473,
            "hamming_loss": 0.04213740458015267,
            "no_defect_precision": 0.9686179843089922,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9587813620071685,
            "no_defect_tp": 1605,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9468479604449939,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9569019362898189,
            "defect_tp": 1532,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9579346556454102,
            "recall_macro": 0.9584167741877676,
            "f1_macro": 0.9578539152076166,
            "precision_micro": 0.9578625954198473,
            "recall_micro": 0.9578625954198473,
            "f1_micro": 0.9578625954198473,
            "accuracy": 0.9578625954198473,
            "hamming_loss": 0.04213740458015267,
            "no_defect_precision": 0.9760882893930104,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9584587597832631,
            "no_defect_tp": 1592,
            "no_defect_fp": 39,
            "no_defect_tn": 1545,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.9397810218978102,
            "defect_recall": 0.9753787878787878,
            "defect_f1": 0.9572490706319703,
            "defect_tp": 1545,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 39,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954049579253834,
            "recall_macro": 0.9543770794879606,
            "f1_macro": 0.9535854970435695,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9788425637834475,
            "no_defect_recall": 0.9302188054405677,
            "no_defect_f1": 0.9539114614918133,
            "no_defect_tp": 1573,
            "no_defect_fp": 34,
            "no_defect_tn": 1550,
            "no_defect_fn": 118,
            "no_defect_support": 1691,
            "defect_precision": 0.9292565947242206,
            "defect_recall": 0.9785353535353535,
            "defect_f1": 0.9532595325953259,
            "defect_tp": 1550,
            "defect_fp": 118,
            "defect_tn": 1573,
            "defect_fn": 34,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.959303448779993,
            "recall_macro": 0.9597753480995646,
            "f1_macro": 0.9593737982707504,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9726941747572816,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.960167714884696,
            "no_defect_tp": 1603,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9459127228027043,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9585798816568047,
            "defect_tp": 1539,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629325844122211,
            "recall_macro": 0.9631437825923337,
            "f1_macro": 0.9630229726460042,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9678188319427891,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9640842980112793,
            "no_defect_tp": 1624,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9580463368816531,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9619616472807293,
            "defect_tp": 1530,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638257050082522,
            "recall_macro": 0.9641706464407529,
            "f1_macro": 0.9639463085945955,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9718056388722256,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9648600357355569,
            "no_defect_tp": 1620,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9558457711442786,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9630325814536341,
            "defect_tp": 1537,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638736985581502,
            "recall_macro": 0.964010858137854,
            "f1_macro": 0.963936511088648,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9673202614379085,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.965026674570243,
            "no_defect_tp": 1628,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.960427135678392,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9628463476070529,
            "defect_tp": 1529,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962002563276219,
            "recall_macro": 0.96241652181185,
            "f1_macro": 0.9621175373134329,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9722724532851115,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9629850746268657,
            "no_defect_tp": 1613,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9517326732673267,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.96125,
            "defect_tp": 1538,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626113652017465,
            "recall_macro": 0.9628880466402643,
            "f1_macro": 0.9627205602991089,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9689181111775254,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9637336504161712,
            "no_defect_tp": 1621,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9563046192259675,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9617074701820465,
            "defect_tp": 1532,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9632276119402985,
            "recall_macro": 0.9634794126958526,
            "f1_macro": 0.9633304669515134,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.968955223880597,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.964349376114082,
            "no_defect_tp": 1623,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9575,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9623115577889447,
            "defect_tp": 1532,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 52,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9679611071454531,
            "recall_macro": 0.9679358157217937,
            "f1_macro": 0.9679462061337196,
            "precision_micro": 0.967948717948718,
            "recall_micro": 0.967948717948718,
            "f1_micro": 0.967948717948718,
            "accuracy": 0.967948717948718,
            "hamming_loss": 0.03205128205128205,
            "no_defect_precision": 0.9667673716012085,
            "no_defect_recall": 0.9696969696969697,
            "no_defect_f1": 0.9682299546142209,
            "no_defect_tp": 1600,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 50,
            "no_defect_support": 1650,
            "defect_precision": 0.9691548426896978,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.9676624576532183,
            "defect_tp": 1571,
            "defect_fp": 50,
            "defect_tn": 1600,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.01_s150_20251207_134547",
    "lr": 0.005,
    "weight_decay": 0.01,
    "seed": 150,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9660550173443665,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.01_s150_20251207_134547",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s150_20251207_134547",
      "timestamp": "2025-12-07T13:47:38.867785",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 9,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.01_s150",
          "seed": 150,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.01_s150_20251207_134547"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9663289055913322,
        "recall_macro": 0.9658609304159275,
        "f1_macro": 0.9660550173443665,
        "precision_micro": 0.9661068702290077,
        "recall_micro": 0.9661068702290077,
        "f1_micro": 0.9661068702290077,
        "accuracy": 0.9661068702290077,
        "hamming_loss": 0.03389312977099237,
        "no_defect_precision": 0.9614485981308412,
        "no_defect_recall": 0.9733885274985216,
        "no_defect_f1": 0.9673817220099912,
        "no_defect_tp": 1646,
        "no_defect_fp": 66,
        "no_defect_tn": 1518,
        "no_defect_fn": 45,
        "no_defect_support": 1691,
        "defect_precision": 0.9712092130518234,
        "defect_recall": 0.9583333333333334,
        "defect_f1": 0.9647283126787417,
        "defect_tp": 1518,
        "defect_fp": 45,
        "defect_tn": 1646,
        "defect_fn": 66,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9670578727553861,
        "recall_macro": 0.9670133064967014,
        "f1_macro": 0.9670298212158397,
        "precision_micro": 0.967032967032967,
        "recall_micro": 0.967032967032967,
        "f1_micro": 0.967032967032967,
        "accuracy": 0.967032967032967,
        "hamming_loss": 0.03296703296703297,
        "no_defect_precision": 0.9650180940892642,
        "no_defect_recall": 0.9696969696969697,
        "no_defect_f1": 0.9673518742442564,
        "no_defect_tp": 1600,
        "no_defect_fp": 58,
        "no_defect_tn": 1568,
        "no_defect_fn": 50,
        "no_defect_support": 1650,
        "defect_precision": 0.969097651421508,
        "defect_recall": 0.964329643296433,
        "defect_f1": 0.966707768187423,
        "defect_tp": 1568,
        "defect_fp": 50,
        "defect_tn": 1600,
        "defect_fn": 58,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4647897390890321,
          0.2597597201498981,
          0.1939282626163012,
          0.179726302343183,
          0.1806734733938173,
          0.17621628955692428,
          0.17937414666100027,
          0.17394832979934485,
          0.17049924624016097,
          0.16654581278874286,
          0.16283218268008912,
          0.17144761287517626,
          0.17031221707433336,
          0.16722306004378587,
          0.16344991739387293
        ],
        "val_loss": [
          0.37063457587590587,
          0.19391966123993581,
          0.1412761235752931,
          0.13791225549693292,
          0.12170424075940481,
          0.10854208232978216,
          0.11349598325502414,
          0.10769233895609012,
          0.10450372092712384,
          0.10484897588881162,
          0.10480198801423495,
          0.10243650439840096,
          0.1040403859403271,
          0.10269509635579127,
          0.10311542229297069
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8938062556255626,
            "recall_macro": 0.8920208142931383,
            "f1_macro": 0.8925140039659085,
            "precision_micro": 0.8928244274809161,
            "recall_micro": 0.8928244274809161,
            "f1_micro": 0.8928244274809161,
            "accuracy": 0.8928244274809161,
            "hamming_loss": 0.10717557251908397,
            "no_defect_precision": 0.8806818181818182,
            "no_defect_recall": 0.9166173861620343,
            "no_defect_f1": 0.8982903506230078,
            "no_defect_tp": 1550,
            "no_defect_fp": 210,
            "no_defect_tn": 1374,
            "no_defect_fn": 141,
            "no_defect_support": 1691,
            "defect_precision": 0.906930693069307,
            "defect_recall": 0.8674242424242424,
            "defect_f1": 0.8867376573088093,
            "defect_tp": 1374,
            "defect_fp": 141,
            "defect_tn": 1550,
            "defect_fn": 210,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9437729014317152,
            "recall_macro": 0.9437367838646668,
            "f1_macro": 0.9437544895603256,
            "precision_micro": 0.9438167938931298,
            "recall_micro": 0.9438167938931298,
            "f1_micro": 0.9438167938931298,
            "accuracy": 0.9438167938931298,
            "hamming_loss": 0.05618320610687023,
            "no_defect_precision": 0.9450679267572357,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.9456264775413712,
            "no_defect_tp": 1600,
            "no_defect_fp": 93,
            "no_defect_tn": 1491,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9424778761061947,
            "defect_recall": 0.9412878787878788,
            "defect_f1": 0.9418825015792799,
            "defect_tp": 1491,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 93,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549087546930161,
            "recall_macro": 0.9546210553196064,
            "f1_macro": 0.9547473882885084,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9524926686217009,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9564193168433451,
            "no_defect_tp": 1624,
            "no_defect_fp": 81,
            "no_defect_tn": 1503,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9573248407643312,
            "defect_recall": 0.9488636363636364,
            "defect_f1": 0.9530754597336716,
            "defect_tp": 1503,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 81,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9536468443976251,
            "recall_macro": 0.9540214758465793,
            "f1_macro": 0.9532790276331369,
            "precision_micro": 0.9532824427480916,
            "recall_micro": 0.9532824427480916,
            "f1_micro": 0.9532824427480916,
            "accuracy": 0.9532824427480916,
            "hamming_loss": 0.0467175572519084,
            "no_defect_precision": 0.9770471464019851,
            "no_defect_recall": 0.9314015375517445,
            "no_defect_f1": 0.9536784741144414,
            "no_defect_tp": 1575,
            "no_defect_fp": 37,
            "no_defect_tn": 1547,
            "no_defect_fn": 116,
            "no_defect_support": 1691,
            "defect_precision": 0.9302465423932652,
            "defect_recall": 0.9766414141414141,
            "defect_f1": 0.9528795811518325,
            "defect_tp": 1547,
            "defect_fp": 116,
            "defect_tn": 1575,
            "defect_fn": 37,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.958343746013653,
            "recall_macro": 0.9587684577890078,
            "f1_macro": 0.9584526397405445,
            "precision_micro": 0.9584732824427481,
            "recall_micro": 0.9584732824427481,
            "f1_micro": 0.9584732824427481,
            "accuracy": 0.9584732824427481,
            "hamming_loss": 0.04152671755725191,
            "no_defect_precision": 0.9692214846107423,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.959378733572282,
            "no_defect_tp": 1606,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9474660074165636,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.957526545908807,
            "defect_tp": 1533,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9645258579175243,
            "recall_macro": 0.9645622771177177,
            "f1_macro": 0.9645437067179363,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9662522202486679,
            "no_defect_recall": 0.9651094027202839,
            "no_defect_f1": 0.9656804733727811,
            "no_defect_tp": 1632,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 59,
            "no_defect_support": 1691,
            "defect_precision": 0.9627994955863808,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9634069400630915,
            "defect_tp": 1527,
            "defect_fp": 59,
            "defect_tn": 1632,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9616947666828304,
            "recall_macro": 0.9621008652461935,
            "f1_macro": 0.9618114956656572,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9716867469879518,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9626977021784542,
            "no_defect_tp": 1613,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.951702786377709,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9609252891528602,
            "defect_tp": 1537,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626089298410134,
            "recall_macro": 0.9630078878674384,
            "f1_macro": 0.9627274877944301,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9723058398555088,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9636038186157518,
            "no_defect_tp": 1615,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.952912019826518,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9618511569731082,
            "defect_tp": 1538,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9663289055913322,
            "recall_macro": 0.9658609304159275,
            "f1_macro": 0.9660550173443665,
            "precision_micro": 0.9661068702290077,
            "recall_micro": 0.9661068702290077,
            "f1_micro": 0.9661068702290077,
            "accuracy": 0.9661068702290077,
            "hamming_loss": 0.03389312977099237,
            "no_defect_precision": 0.9614485981308412,
            "no_defect_recall": 0.9733885274985216,
            "no_defect_f1": 0.9673817220099912,
            "no_defect_tp": 1646,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 45,
            "no_defect_support": 1691,
            "defect_precision": 0.9712092130518234,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9647283126787417,
            "defect_tp": 1518,
            "defect_fp": 45,
            "defect_tn": 1646,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9645601394303756,
            "recall_macro": 0.964522330041993,
            "f1_macro": 0.9645408738532487,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.965150620200827,
            "no_defect_recall": 0.9662921348314607,
            "no_defect_f1": 0.9657210401891253,
            "no_defect_tp": 1634,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 57,
            "no_defect_support": 1691,
            "defect_precision": 0.9639696586599241,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9633607075173721,
            "defect_tp": 1525,
            "defect_fp": 57,
            "defect_tn": 1634,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626113652017465,
            "recall_macro": 0.9628880466402643,
            "f1_macro": 0.9627205602991089,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9689181111775254,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9637336504161712,
            "no_defect_tp": 1621,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9563046192259675,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9617074701820465,
            "defect_tp": 1532,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635292310934449,
            "recall_macro": 0.9631398625521925,
            "f1_macro": 0.9633053221288516,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9596255119953189,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.9647058823529412,
            "no_defect_tp": 1640,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.9674329501915708,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9619047619047619,
            "defect_tp": 1515,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626312281597382,
            "recall_macro": 0.9628281260266771,
            "f1_macro": 0.9627167198551779,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9672424061941632,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9637982195845697,
            "no_defect_tp": 1624,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9580200501253133,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9616352201257862,
            "defect_tp": 1529,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638995563943566,
            "recall_macro": 0.9639709110621293,
            "f1_macro": 0.9639337916060975,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.966212211025489,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.9650680876258141,
            "no_defect_tp": 1630,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9615869017632241,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9627994955863808,
            "defect_tp": 1527,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635869601732552,
            "recall_macro": 0.963675228034335,
            "f1_macro": 0.9636288416263183,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9661921708185054,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9647616227420788,
            "no_defect_tp": 1629,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9609817495280051,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9624960605105578,
            "defect_tp": 1527,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 57,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9670578727553861,
            "recall_macro": 0.9670133064967014,
            "f1_macro": 0.9670298212158397,
            "precision_micro": 0.967032967032967,
            "recall_micro": 0.967032967032967,
            "f1_micro": 0.967032967032967,
            "accuracy": 0.967032967032967,
            "hamming_loss": 0.03296703296703297,
            "no_defect_precision": 0.9650180940892642,
            "no_defect_recall": 0.9696969696969697,
            "no_defect_f1": 0.9673518742442564,
            "no_defect_tp": 1600,
            "no_defect_fp": 58,
            "no_defect_tn": 1568,
            "no_defect_fn": 50,
            "no_defect_support": 1650,
            "defect_precision": 0.969097651421508,
            "defect_recall": 0.964329643296433,
            "defect_f1": 0.966707768187423,
            "defect_tp": 1568,
            "defect_fp": 50,
            "defect_tn": 1600,
            "defect_fn": 58,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.1_s10_20251207_204638",
    "lr": 0.005,
    "weight_decay": 0.1,
    "seed": 10,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9627274877944301,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.1_s10_20251207_204638",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s10_20251207_204638",
      "timestamp": "2025-12-07T20:48:32.030860",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.1_s10",
          "seed": 10,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s10_20251207_204638"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9626089298410134,
        "recall_macro": 0.9630078878674384,
        "f1_macro": 0.9627274877944301,
        "precision_micro": 0.9627480916030534,
        "recall_micro": 0.9627480916030534,
        "f1_micro": 0.9627480916030534,
        "accuracy": 0.9627480916030534,
        "hamming_loss": 0.037251908396946566,
        "no_defect_precision": 0.9723058398555088,
        "no_defect_recall": 0.9550561797752809,
        "no_defect_f1": 0.9636038186157518,
        "no_defect_tp": 1615,
        "no_defect_fp": 46,
        "no_defect_tn": 1538,
        "no_defect_fn": 76,
        "no_defect_support": 1691,
        "defect_precision": 0.952912019826518,
        "defect_recall": 0.9709595959595959,
        "defect_f1": 0.9618511569731082,
        "defect_tp": 1538,
        "defect_fp": 76,
        "defect_tn": 1615,
        "defect_fn": 46,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9661374452367275,
        "recall_macro": 0.96609974281561,
        "f1_macro": 0.9661141818517288,
        "precision_micro": 0.9661172161172161,
        "recall_micro": 0.9661172161172161,
        "f1_micro": 0.9661172161172161,
        "accuracy": 0.9661172161172161,
        "hamming_loss": 0.03388278388278388,
        "no_defect_precision": 0.9643934821967411,
        "no_defect_recall": 0.9684848484848485,
        "no_defect_f1": 0.9664348351980647,
        "no_defect_tp": 1598,
        "no_defect_fp": 59,
        "no_defect_tn": 1567,
        "no_defect_fn": 52,
        "no_defect_support": 1650,
        "defect_precision": 0.967881408276714,
        "defect_recall": 0.9637146371463715,
        "defect_f1": 0.9657935285053929,
        "defect_tp": 1567,
        "defect_fp": 52,
        "defect_tn": 1598,
        "defect_fn": 59,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4672367158794004,
          0.2614036249815171,
          0.20229425770717685,
          0.18875751454211678,
          0.1794274386844625,
          0.1762943312712793,
          0.1812408687118207,
          0.18045414588316713,
          0.17541450654861818,
          0.17016199988675418,
          0.1702085903467743,
          0.17060251639976662,
          0.16443250481054872,
          0.165204405659911,
          0.17131222823486666
        ],
        "val_loss": [
          0.3720966176344798,
          0.1996175878896163,
          0.1635397426210917,
          0.13370135254584825,
          0.12811695082256427,
          0.12672620323988107,
          0.12775125419004604,
          0.12273407770464054,
          0.12347954511642456,
          0.11906461532299335,
          0.12038204353302717,
          0.1214205534555591,
          0.1174523256575832,
          0.11785373457062703,
          0.11753475336501232
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8917655687375015,
            "recall_macro": 0.8902666896642355,
            "f1_macro": 0.8907047609040738,
            "precision_micro": 0.8909923664122137,
            "recall_micro": 0.8909923664122137,
            "f1_micro": 0.8909923664122137,
            "accuracy": 0.8909923664122137,
            "hamming_loss": 0.10900763358778626,
            "no_defect_precision": 0.8807077625570776,
            "no_defect_recall": 0.9124778237729154,
            "no_defect_f1": 0.8963113563752542,
            "no_defect_tp": 1543,
            "no_defect_fp": 209,
            "no_defect_tn": 1375,
            "no_defect_fn": 148,
            "no_defect_support": 1691,
            "defect_precision": 0.9028233749179252,
            "defect_recall": 0.8680555555555556,
            "defect_f1": 0.8850981654328934,
            "defect_tp": 1375,
            "defect_fp": 148,
            "defect_tn": 1543,
            "defect_fn": 209,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9441912988646926,
            "recall_macro": 0.9439325992031492,
            "f1_macro": 0.9440470160975986,
            "precision_micro": 0.9441221374045802,
            "recall_micro": 0.9441221374045802,
            "f1_micro": 0.9441221374045802,
            "accuracy": 0.9441221374045802,
            "hamming_loss": 0.055877862595419846,
            "no_defect_precision": 0.9424882629107981,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9460972017673048,
            "no_defect_tp": 1606,
            "no_defect_fp": 98,
            "no_defect_tn": 1486,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9458943348185869,
            "defect_recall": 0.9381313131313131,
            "defect_f1": 0.9419968304278923,
            "defect_tp": 1486,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 98,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9484734233992265,
            "recall_macro": 0.948835076071179,
            "f1_macro": 0.9480880747002116,
            "precision_micro": 0.9480916030534351,
            "recall_micro": 0.9480916030534351,
            "f1_micro": 0.9480916030534351,
            "accuracy": 0.9480916030534351,
            "hamming_loss": 0.051908396946564885,
            "no_defect_precision": 0.9720670391061452,
            "no_defect_recall": 0.9260792430514488,
            "no_defect_f1": 0.9485160508782556,
            "no_defect_tp": 1566,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 125,
            "no_defect_support": 1691,
            "defect_precision": 0.9248798076923077,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9476600985221675,
            "defect_tp": 1539,
            "defect_fp": 125,
            "defect_tn": 1566,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9580998381398627,
            "recall_macro": 0.9581531981554158,
            "f1_macro": 0.958125711806902,
            "precision_micro": 0.9581679389312977,
            "recall_micro": 0.9581679389312977,
            "f1_micro": 0.9581679389312977,
            "accuracy": 0.9581679389312977,
            "hamming_loss": 0.04183206106870229,
            "no_defect_precision": 0.9603080568720379,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.959455460195324,
            "no_defect_tp": 1621,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9558916194076874,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9567959634184799,
            "defect_tp": 1517,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610818168706428,
            "recall_macro": 0.9606945041783894,
            "f1_macro": 0.960859010270775,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.957284961966062,
            "no_defect_recall": 0.9674748669426375,
            "no_defect_f1": 0.9623529411764706,
            "no_defect_tp": 1636,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 55,
            "no_defect_support": 1691,
            "defect_precision": 0.9648786717752235,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.9593650793650793,
            "defect_tp": 1511,
            "defect_fp": 55,
            "defect_tn": 1636,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9584129412405917,
            "recall_macro": 0.9584488811832099,
            "f1_macro": 0.9584305527037873,
            "precision_micro": 0.9584732824427481,
            "recall_micro": 0.9584732824427481,
            "f1_micro": 0.9584732824427481,
            "accuracy": 0.9584732824427481,
            "hamming_loss": 0.04152671755725191,
            "no_defect_precision": 0.9603315571343991,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9597633136094674,
            "no_defect_tp": 1622,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9564943253467844,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9570977917981073,
            "defect_tp": 1517,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9592441078358006,
            "recall_macro": 0.9595955862588033,
            "f1_macro": 0.959363837766577,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9675870348139256,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9603812928209711,
            "no_defect_tp": 1612,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9509011808576756,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9583463827121829,
            "defect_tp": 1530,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9599336433164007,
            "recall_macro": 0.959987216935768,
            "f1_macro": 0.9599596222387166,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9620853080568721,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9612311334714413,
            "no_defect_tp": 1624,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9577819785759294,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9586881110059918,
            "defect_tp": 1520,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598552645127209,
            "recall_macro": 0.9601869523143918,
            "f1_macro": 0.9599736681267808,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9676258992805755,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.961000297707651,
            "no_defect_tp": 1614,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9520846297448662,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9589470385459103,
            "defect_tp": 1530,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9619965645431603,
            "recall_macro": 0.9622966805846758,
            "f1_macro": 0.9621106663372536,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9688809096349491,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9631171921475312,
            "no_defect_tp": 1619,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9551122194513716,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9611041405269761,
            "defect_tp": 1532,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9613825005129353,
            "recall_macro": 0.9617452616048121,
            "f1_macro": 0.96150316856024,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.96996996996997,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9624553039332538,
            "no_defect_tp": 1615,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9527950310559006,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.960551033187226,
            "defect_tp": 1534,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626089298410134,
            "recall_macro": 0.9630078878674384,
            "f1_macro": 0.9627274877944301,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9723058398555088,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9636038186157518,
            "no_defect_tp": 1615,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.952912019826518,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9618511569731082,
            "defect_tp": 1538,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9614090691290466,
            "recall_macro": 0.9616054468397757,
            "f1_macro": 0.9614943172274788,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9660512209648601,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9626112759643917,
            "no_defect_tp": 1622,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.956766917293233,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.960377358490566,
            "defect_tp": 1527,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610921802260064,
            "recall_macro": 0.9613297373498437,
            "f1_macro": 0.9611907481841506,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9665871121718377,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9622809622809623,
            "no_defect_tp": 1620,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9555972482801751,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.960100534087339,
            "defect_tp": 1528,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610994019627086,
            "recall_macro": 0.9613097638119814,
            "f1_macro": 0.9611894010416739,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.966030989272944,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9623033541110122,
            "no_defect_tp": 1621,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9561678146524734,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9600754479723358,
            "defect_tp": 1527,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 57,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9661374452367275,
            "recall_macro": 0.96609974281561,
            "f1_macro": 0.9661141818517288,
            "precision_micro": 0.9661172161172161,
            "recall_micro": 0.9661172161172161,
            "f1_micro": 0.9661172161172161,
            "accuracy": 0.9661172161172161,
            "hamming_loss": 0.03388278388278388,
            "no_defect_precision": 0.9643934821967411,
            "no_defect_recall": 0.9684848484848485,
            "no_defect_f1": 0.9664348351980647,
            "no_defect_tp": 1598,
            "no_defect_fp": 59,
            "no_defect_tn": 1567,
            "no_defect_fn": 52,
            "no_defect_support": 1650,
            "defect_precision": 0.967881408276714,
            "defect_recall": 0.9637146371463715,
            "defect_f1": 0.9657935285053929,
            "defect_tp": 1567,
            "defect_fp": 52,
            "defect_tn": 1598,
            "defect_fn": 59,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.1_s20_20251207_153934",
    "lr": 0.005,
    "weight_decay": 0.1,
    "seed": 20,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9630216614539442,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.1_s20_20251207_153934",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s20_20251207_153934",
      "timestamp": "2025-12-07T15:41:27.775305",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 10,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.1_s20",
          "seed": 20,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s20_20251207_153934"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9629412972085386,
        "recall_macro": 0.9631238090544714,
        "f1_macro": 0.9630216614539442,
        "precision_micro": 0.9630534351145038,
        "recall_micro": 0.9630534351145038,
        "f1_micro": 0.9630534351145038,
        "accuracy": 0.9630534351145038,
        "hamming_loss": 0.036946564885496185,
        "no_defect_precision": 0.9672619047619048,
        "no_defect_recall": 0.960969840331165,
        "no_defect_f1": 0.9641056066449125,
        "no_defect_tp": 1625,
        "no_defect_fp": 55,
        "no_defect_tn": 1529,
        "no_defect_fn": 66,
        "no_defect_support": 1691,
        "defect_precision": 0.9586206896551724,
        "defect_recall": 0.9652777777777778,
        "defect_f1": 0.9619377162629758,
        "defect_tp": 1529,
        "defect_fp": 66,
        "defect_tn": 1625,
        "defect_fn": 55,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9667280436099334,
        "recall_macro": 0.9667236945096724,
        "f1_macro": 0.966725778967085,
        "precision_micro": 0.9667277167277167,
        "recall_micro": 0.9667277167277167,
        "f1_micro": 0.9667277167277167,
        "accuracy": 0.9667277167277167,
        "hamming_loss": 0.03327228327228327,
        "no_defect_precision": 0.966686856450636,
        "no_defect_recall": 0.9672727272727273,
        "no_defect_f1": 0.9669797031202666,
        "no_defect_tp": 1596,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 54,
        "no_defect_support": 1650,
        "defect_precision": 0.9667692307692307,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.9664718548139034,
        "defect_tp": 1571,
        "defect_fp": 54,
        "defect_tn": 1596,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.46965585867231363,
          0.2586694594207668,
          0.20093567578987098,
          0.18549239102392515,
          0.17763803503378664,
          0.17802837539355126,
          0.17573971622409182,
          0.1814875845255712,
          0.17063753359861453,
          0.17353428360932044,
          0.16962696879977462,
          0.17061417922377586,
          0.16902468540553767,
          0.170659054273342,
          0.17162045661874395
        ],
        "val_loss": [
          0.37069283655056584,
          0.19614408165216446,
          0.15071879757138398,
          0.1301089132634493,
          0.1423558099911763,
          0.12394992247796975,
          0.12115490766098866,
          0.126572650212508,
          0.12492004853601639,
          0.11983628678493775,
          0.1170886679051014,
          0.12046182134117071,
          0.11899477537148274,
          0.11969042598054959,
          0.12028199011603227
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8965500231336581,
            "recall_macro": 0.8916573705714747,
            "f1_macro": 0.8925381490742672,
            "precision_micro": 0.8931297709923665,
            "recall_micro": 0.8931297709923665,
            "f1_micro": 0.8931297709923665,
            "accuracy": 0.8931297709923665,
            "hamming_loss": 0.10687022900763359,
            "no_defect_precision": 0.8669950738916257,
            "no_defect_recall": 0.9367238320520402,
            "no_defect_f1": 0.900511654349062,
            "no_defect_tp": 1584,
            "no_defect_fp": 243,
            "no_defect_tn": 1341,
            "no_defect_fn": 107,
            "no_defect_support": 1691,
            "defect_precision": 0.9261049723756906,
            "defect_recall": 0.8465909090909091,
            "defect_f1": 0.8845646437994723,
            "defect_tp": 1341,
            "defect_fp": 107,
            "defect_tn": 1584,
            "defect_fn": 243,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9442422684495351,
            "recall_macro": 0.9438926521274245,
            "f1_macro": 0.9440419172327366,
            "precision_micro": 0.9441221374045802,
            "recall_micro": 0.9441221374045802,
            "f1_micro": 0.9441221374045802,
            "accuracy": 0.9441221374045802,
            "hamming_loss": 0.055877862595419846,
            "no_defect_precision": 0.9414519906323185,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9461606354810238,
            "no_defect_tp": 1608,
            "no_defect_fp": 100,
            "no_defect_tn": 1484,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9470325462667517,
            "defect_recall": 0.9368686868686869,
            "defect_f1": 0.9419231989844494,
            "defect_tp": 1484,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 100,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.950180721763395,
            "recall_macro": 0.9487195282213023,
            "f1_macro": 0.9491901832050681,
            "precision_micro": 0.9493129770992367,
            "recall_micro": 0.9493129770992367,
            "f1_micro": 0.9493129770992367,
            "accuracy": 0.9493129770992367,
            "hamming_loss": 0.05068702290076336,
            "no_defect_precision": 0.9369627507163324,
            "no_defect_recall": 0.9668835008870491,
            "no_defect_f1": 0.9516880093131548,
            "no_defect_tp": 1635,
            "no_defect_fp": 110,
            "no_defect_tn": 1474,
            "no_defect_fn": 56,
            "no_defect_support": 1691,
            "defect_precision": 0.9633986928104575,
            "defect_recall": 0.9305555555555556,
            "defect_f1": 0.9466923570969814,
            "defect_tp": 1474,
            "defect_fp": 56,
            "defect_tn": 1635,
            "defect_fn": 110,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9621540062124094,
            "recall_macro": 0.9620370245924652,
            "f1_macro": 0.9620922749264995,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9616971125515615,
            "no_defect_recall": 0.9651094027202839,
            "no_defect_f1": 0.9634002361275088,
            "no_defect_tp": 1632,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 59,
            "no_defect_support": 1691,
            "defect_precision": 0.9626108998732573,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9607843137254902,
            "defect_tp": 1519,
            "defect_fp": 59,
            "defect_tn": 1632,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9525022234359098,
            "recall_macro": 0.9528387437354024,
            "f1_macro": 0.9520584940917286,
            "precision_micro": 0.9520610687022901,
            "recall_micro": 0.9520610687022901,
            "f1_micro": 0.9520610687022901,
            "accuracy": 0.9520610687022901,
            "hamming_loss": 0.04793893129770992,
            "no_defect_precision": 0.9769900497512438,
            "no_defect_recall": 0.9290360733293909,
            "no_defect_f1": 0.9524098211579266,
            "no_defect_tp": 1571,
            "no_defect_fp": 37,
            "no_defect_tn": 1547,
            "no_defect_fn": 120,
            "no_defect_support": 1691,
            "defect_precision": 0.9280143971205759,
            "defect_recall": 0.9766414141414141,
            "defect_f1": 0.9517071670255306,
            "defect_tp": 1547,
            "defect_fp": 120,
            "defect_tn": 1571,
            "defect_fn": 37,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626770652448193,
            "recall_macro": 0.9627482318752278,
            "f1_macro": 0.962711208270711,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.965026674570243,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9638839550029603,
            "no_defect_tp": 1628,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.9603274559193955,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9615384615384616,
            "defect_tp": 1525,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962657183346189,
            "recall_macro": 0.9621928928552228,
            "f1_macro": 0.9623852894897034,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9579439252336449,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.963855421686747,
            "no_defect_tp": 1640,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.9673704414587332,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.9609151572926596,
            "defect_tp": 1512,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9589804880159211,
            "recall_macro": 0.9594397179960457,
            "f1_macro": 0.9590668376933191,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9715324046032707,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.959904248952723,
            "no_defect_tp": 1604,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9464285714285714,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9582294264339152,
            "defect_tp": 1537,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604731619978366,
            "recall_macro": 0.9608781860592919,
            "f1_macro": 0.9605894635269583,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9704819277108434,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9615040286481648,
            "no_defect_tp": 1611,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9504643962848297,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9596748984057518,
            "defect_tp": 1535,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629412972085386,
            "recall_macro": 0.9631238090544714,
            "f1_macro": 0.9630216614539442,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9672619047619048,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9641056066449125,
            "no_defect_tp": 1625,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9586206896551724,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9619377162629758,
            "defect_tp": 1529,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962351693238839,
            "recall_macro": 0.9624725223852959,
            "f1_macro": 0.9624076990376202,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9655581947743468,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9635555555555556,
            "no_defect_tp": 1626,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9591451917033312,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.961259842519685,
            "defect_tp": 1526,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620055970149254,
            "recall_macro": 0.9622567335089511,
            "f1_macro": 0.9621081491832305,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9677611940298507,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9631610219845514,
            "no_defect_tp": 1621,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.95625,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9610552763819096,
            "defect_tp": 1530,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.961418376616058,
            "recall_macro": 0.9615854733019132,
            "f1_macro": 0.9614929374323922,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9654967281380131,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9626334519572953,
            "no_defect_tp": 1623,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9573400250941029,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.960352422907489,
            "defect_tp": 1526,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620055970149254,
            "recall_macro": 0.9622567335089511,
            "f1_macro": 0.9621081491832305,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9677611940298507,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9631610219845514,
            "no_defect_tp": 1621,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.95625,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9610552763819096,
            "defect_tp": 1530,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620055970149254,
            "recall_macro": 0.9622567335089511,
            "f1_macro": 0.9621081491832305,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9677611940298507,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9631610219845514,
            "no_defect_tp": 1621,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.95625,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9610552763819096,
            "defect_tp": 1530,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 54,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9667280436099334,
            "recall_macro": 0.9667236945096724,
            "f1_macro": 0.966725778967085,
            "precision_micro": 0.9667277167277167,
            "recall_micro": 0.9667277167277167,
            "f1_micro": 0.9667277167277167,
            "accuracy": 0.9667277167277167,
            "hamming_loss": 0.03327228327228327,
            "no_defect_precision": 0.966686856450636,
            "no_defect_recall": 0.9672727272727273,
            "no_defect_f1": 0.9669797031202666,
            "no_defect_tp": 1596,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 54,
            "no_defect_support": 1650,
            "defect_precision": 0.9667692307692307,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.9664718548139034,
            "defect_tp": 1571,
            "defect_fp": 54,
            "defect_tn": 1596,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.1_s30_20251207_202440",
    "lr": 0.005,
    "weight_decay": 0.1,
    "seed": 30,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9618005915764507,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.1_s30_20251207_202440",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s30_20251207_202440",
      "timestamp": "2025-12-07T20:26:32.673361",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 7,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.1_s30",
          "seed": 30,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s30_20251207_202440"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9617104627792128,
        "recall_macro": 0.9619211034054322,
        "f1_macro": 0.9618005915764507,
        "precision_micro": 0.9618320610687023,
        "recall_micro": 0.9618320610687023,
        "f1_micro": 0.9618320610687023,
        "accuracy": 0.9618320610687023,
        "hamming_loss": 0.03816793893129771,
        "no_defect_precision": 0.966626936829559,
        "no_defect_recall": 0.9591957421643997,
        "no_defect_f1": 0.9628970020777678,
        "no_defect_tp": 1622,
        "no_defect_fp": 56,
        "no_defect_tn": 1528,
        "no_defect_fn": 69,
        "no_defect_support": 1691,
        "defect_precision": 0.9567939887288667,
        "defect_recall": 0.9646464646464646,
        "defect_f1": 0.9607041810751336,
        "defect_tp": 1528,
        "defect_fp": 69,
        "defect_tn": 1622,
        "defect_fn": 56,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9658146864824246,
        "recall_macro": 0.9658056580565806,
        "f1_macro": 0.9658098122350092,
        "precision_micro": 0.9658119658119658,
        "recall_micro": 0.9658119658119658,
        "f1_micro": 0.9658119658119658,
        "accuracy": 0.9658119658119658,
        "hamming_loss": 0.03418803418803419,
        "no_defect_precision": 0.965496368038741,
        "no_defect_recall": 0.9666666666666667,
        "no_defect_f1": 0.9660811629315567,
        "no_defect_tp": 1595,
        "no_defect_fp": 57,
        "no_defect_tn": 1569,
        "no_defect_fn": 55,
        "no_defect_support": 1650,
        "defect_precision": 0.9661330049261084,
        "defect_recall": 0.9649446494464945,
        "defect_f1": 0.9655384615384616,
        "defect_tp": 1569,
        "defect_fp": 55,
        "defect_tn": 1595,
        "defect_fn": 57,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.47183954665850397,
          0.25587809877664974,
          0.20029664566452035,
          0.18720404392256398,
          0.1843748150634965,
          0.1823342965611853,
          0.1761377746215924,
          0.1760697878866016,
          0.17693341030860046,
          0.1727021220588285,
          0.17703868009181203,
          0.17056535798510747,
          0.16849705025117268,
          0.1657683193745972,
          0.16903743743273006
        ],
        "val_loss": [
          0.3690186469600751,
          0.1963805046219092,
          0.14656225520257765,
          0.13949819439305708,
          0.1292755386004081,
          0.12744014523923397,
          0.12240552271787937,
          0.12019408795122917,
          0.12209733683042802,
          0.124582725433776,
          0.12533375678154138,
          0.11909044154274923,
          0.12311574981476252,
          0.12036238044786912,
          0.12045496043104392
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9009664357545928,
            "recall_macro": 0.8986057350560603,
            "f1_macro": 0.8992027241622056,
            "precision_micro": 0.8995419847328244,
            "recall_micro": 0.8995419847328244,
            "f1_micro": 0.8995419847328244,
            "accuracy": 0.8995419847328244,
            "hamming_loss": 0.10045801526717557,
            "no_defect_precision": 0.8838782412626832,
            "no_defect_recall": 0.9272619751626257,
            "no_defect_f1": 0.9050505050505051,
            "no_defect_tp": 1568,
            "no_defect_fp": 206,
            "no_defect_tn": 1378,
            "no_defect_fn": 123,
            "no_defect_support": 1691,
            "defect_precision": 0.9180546302465024,
            "defect_recall": 0.8699494949494949,
            "defect_f1": 0.893354943273906,
            "defect_tp": 1378,
            "defect_fp": 123,
            "defect_tn": 1568,
            "defect_fn": 206,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9451987573886361,
            "recall_macro": 0.9455747226851603,
            "f1_macro": 0.9453124905254805,
            "precision_micro": 0.9453435114503816,
            "recall_micro": 0.9453435114503816,
            "f1_micro": 0.9453435114503816,
            "accuracy": 0.9453435114503816,
            "hamming_loss": 0.05465648854961832,
            "no_defect_precision": 0.9548736462093863,
            "no_defect_recall": 0.9384979302188055,
            "no_defect_f1": 0.9466149716671637,
            "no_defect_tp": 1587,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 104,
            "no_defect_support": 1691,
            "defect_precision": 0.9355238685678859,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9440100093837973,
            "defect_tp": 1509,
            "defect_fp": 104,
            "defect_tn": 1587,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9561322076321048,
            "recall_macro": 0.9558437345065081,
            "f1_macro": 0.9559704318482785,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9536656891495601,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9575971731448764,
            "no_defect_tp": 1626,
            "no_defect_fp": 79,
            "no_defect_tn": 1505,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9585987261146497,
            "defect_recall": 0.9501262626262627,
            "defect_f1": 0.9543436905516804,
            "defect_tp": 1505,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 79,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.957419150285352,
            "recall_macro": 0.9578214880920382,
            "f1_macro": 0.9575343831802108,
            "precision_micro": 0.9575572519083969,
            "recall_micro": 0.9575572519083969,
            "f1_micro": 0.9575572519083969,
            "accuracy": 0.9575572519083969,
            "hamming_loss": 0.042442748091603054,
            "no_defect_precision": 0.9674698795180723,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.958519844822441,
            "no_defect_tp": 1606,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9473684210526315,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9565489215379807,
            "defect_tp": 1530,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9584052499033845,
            "recall_macro": 0.9578935421632051,
            "f1_macro": 0.9581019215639583,
            "precision_micro": 0.9581679389312977,
            "recall_micro": 0.9581679389312977,
            "f1_micro": 0.9581679389312977,
            "accuracy": 0.9581679389312977,
            "hamming_loss": 0.04183206106870229,
            "no_defect_precision": 0.9533255542590432,
            "no_defect_recall": 0.9662921348314607,
            "no_defect_f1": 0.9597650513950073,
            "no_defect_tp": 1634,
            "no_defect_fp": 80,
            "no_defect_tn": 1504,
            "no_defect_fn": 57,
            "no_defect_support": 1691,
            "defect_precision": 0.9634849455477258,
            "defect_recall": 0.9494949494949495,
            "defect_f1": 0.9564387917329094,
            "defect_tp": 1504,
            "defect_fp": 57,
            "defect_tn": 1634,
            "defect_fn": 80,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610787770253886,
            "recall_macro": 0.9613896579634309,
            "f1_macro": 0.9611946152671305,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9682634730538923,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9622136268967569,
            "no_defect_tp": 1617,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9538940809968848,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9601756036375039,
            "defect_tp": 1531,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9617104627792128,
            "recall_macro": 0.9619211034054322,
            "f1_macro": 0.9618005915764507,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.966626936829559,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9628970020777678,
            "no_defect_tp": 1622,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9567939887288667,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9607041810751336,
            "defect_tp": 1528,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620452296386651,
            "recall_macro": 0.9615815532617721,
            "f1_macro": 0.9617736681805928,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9573598130841121,
            "no_defect_recall": 0.9692489651094027,
            "no_defect_f1": 0.9632677049662063,
            "no_defect_tp": 1639,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 52,
            "no_defect_support": 1691,
            "defect_precision": 0.9667306461932181,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.9602796313949793,
            "defect_tp": 1511,
            "defect_fp": 52,
            "defect_tn": 1639,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9595680124902699,
            "recall_macro": 0.9597914015972857,
            "f1_macro": 0.9596621285705969,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9648181276088252,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9608076009501187,
            "no_defect_tp": 1618,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9543178973717147,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9585166561910748,
            "defect_tp": 1525,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598585276219167,
            "recall_macro": 0.9602468729279787,
            "f1_macro": 0.9599772975354075,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9693140794223827,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9609305099910528,
            "no_defect_tp": 1611,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9504029758214507,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9590240850797622,
            "defect_tp": 1533,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9595652932869729,
            "recall_macro": 0.9599911369759093,
            "f1_macro": 0.9596746209246461,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9704284852142426,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9605734767025089,
            "no_defect_tp": 1608,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9487021013597033,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9587757651467833,
            "defect_tp": 1535,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9609526953747054,
            "recall_macro": 0.9607943718677012,
            "f1_macro": 0.9608677793958403,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9599764567392584,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9622418879056047,
            "no_defect_tp": 1631,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9619289340101523,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.959493670886076,
            "defect_tp": 1516,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9601607818999123,
            "recall_macro": 0.9605225824179107,
            "f1_macro": 0.9602810469272317,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9687687687687687,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9612634088200238,
            "no_defect_tp": 1613,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9515527950310559,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9592986850344396,
            "defect_tp": 1532,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.959870130645496,
            "recall_macro": 0.9601070581629423,
            "f1_macro": 0.9599684095442813,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9653937947494033,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.961092961092961,
            "no_defect_tp": 1618,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9543464665415885,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9588438579956017,
            "defect_tp": 1526,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.960167468488657,
            "recall_macro": 0.9604426882664612,
            "f1_macro": 0.9602760068760996,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9665271966527197,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9613555291319857,
            "no_defect_tp": 1617,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9538077403245943,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9591964846202135,
            "defect_tp": 1528,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 56,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9658146864824246,
            "recall_macro": 0.9658056580565806,
            "f1_macro": 0.9658098122350092,
            "precision_micro": 0.9658119658119658,
            "recall_micro": 0.9658119658119658,
            "f1_micro": 0.9658119658119658,
            "accuracy": 0.9658119658119658,
            "hamming_loss": 0.03418803418803419,
            "no_defect_precision": 0.965496368038741,
            "no_defect_recall": 0.9666666666666667,
            "no_defect_f1": 0.9660811629315567,
            "no_defect_tp": 1595,
            "no_defect_fp": 57,
            "no_defect_tn": 1569,
            "no_defect_fn": 55,
            "no_defect_support": 1650,
            "defect_precision": 0.9661330049261084,
            "defect_recall": 0.9649446494464945,
            "defect_f1": 0.9655384615384616,
            "defect_tp": 1569,
            "defect_fp": 55,
            "defect_tn": 1595,
            "defect_fn": 57,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.1_s40_20251207_163258",
    "lr": 0.005,
    "weight_decay": 0.1,
    "seed": 40,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9633224999384042,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.1_s40_20251207_163258",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s40_20251207_163258",
      "timestamp": "2025-12-07T16:34:51.457478",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 8,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.1_s40",
          "seed": 40,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s40_20251207_163258"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.963288310819588,
        "recall_macro": 0.9633595714686785,
        "f1_macro": 0.9633224999384042,
        "precision_micro": 0.9633587786259542,
        "recall_micro": 0.9633587786259542,
        "f1_micro": 0.9633587786259542,
        "accuracy": 0.9633587786259542,
        "hamming_loss": 0.0366412213740458,
        "no_defect_precision": 0.965619442797866,
        "no_defect_recall": 0.9633353045535187,
        "no_defect_f1": 0.9644760213143873,
        "no_defect_tp": 1629,
        "no_defect_fp": 58,
        "no_defect_tn": 1526,
        "no_defect_fn": 62,
        "no_defect_support": 1691,
        "defect_precision": 0.9609571788413098,
        "defect_recall": 0.9633838383838383,
        "defect_f1": 0.9621689785624212,
        "defect_tp": 1526,
        "defect_fp": 62,
        "defect_tn": 1629,
        "defect_fn": 58,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9664385399892645,
        "recall_macro": 0.9664072458906408,
        "f1_macro": 0.9664196503752209,
        "precision_micro": 0.9664224664224664,
        "recall_micro": 0.9664224664224664,
        "f1_micro": 0.9664224664224664,
        "accuracy": 0.9664224664224664,
        "hamming_loss": 0.033577533577533576,
        "no_defect_precision": 0.964975845410628,
        "no_defect_recall": 0.9684848484848485,
        "no_defect_f1": 0.9667271627344223,
        "no_defect_tp": 1598,
        "no_defect_fp": 58,
        "no_defect_tn": 1568,
        "no_defect_fn": 52,
        "no_defect_support": 1650,
        "defect_precision": 0.9679012345679012,
        "defect_recall": 0.964329643296433,
        "defect_f1": 0.9661121380160197,
        "defect_tp": 1568,
        "defect_fp": 52,
        "defect_tn": 1598,
        "defect_fn": 58,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.46315695551150016,
          0.25962260066215964,
          0.20227288245905392,
          0.18824138479876218,
          0.17597987085082042,
          0.17866390787657335,
          0.1737367351184829,
          0.17416002535919764,
          0.17400210307108308,
          0.16843395963872326,
          0.17343182160390472,
          0.16508151703050447,
          0.1680446648697474,
          0.17104309953156874,
          0.16984683819208685
        ],
        "val_loss": [
          0.3695843191101001,
          0.20052547494952494,
          0.14882459376867002,
          0.1356977212887544,
          0.1330730367738467,
          0.12244783592625307,
          0.1295482380888783,
          0.12142091788924657,
          0.12219115489950547,
          0.12540272250771523,
          0.11849794558321054,
          0.11956172780348705,
          0.11780716063311467,
          0.11781450339521353,
          0.11858138642632045
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8948058773742025,
            "recall_macro": 0.8886966202533915,
            "f1_macro": 0.8896647115422784,
            "precision_micro": 0.890381679389313,
            "recall_micro": 0.890381679389313,
            "f1_micro": 0.890381679389313,
            "accuracy": 0.890381679389313,
            "hamming_loss": 0.10961832061068702,
            "no_defect_precision": 0.8603896103896104,
            "no_defect_recall": 0.9402720283855707,
            "no_defect_f1": 0.8985589149477253,
            "no_defect_tp": 1590,
            "no_defect_fp": 258,
            "no_defect_tn": 1326,
            "no_defect_fn": 101,
            "no_defect_support": 1691,
            "defect_precision": 0.9292221443587947,
            "defect_recall": 0.8371212121212122,
            "defect_f1": 0.8807705081368317,
            "defect_tp": 1326,
            "defect_fp": 101,
            "defect_tn": 1590,
            "defect_fn": 258,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9434535930220589,
            "recall_macro": 0.9439204657455692,
            "f1_macro": 0.9434924839291086,
            "precision_micro": 0.9435114503816794,
            "recall_micro": 0.9435114503816794,
            "f1_micro": 0.9435114503816794,
            "accuracy": 0.9435114503816794,
            "hamming_loss": 0.05648854961832061,
            "no_defect_precision": 0.958029197080292,
            "no_defect_recall": 0.9314015375517445,
            "no_defect_f1": 0.9445277361319341,
            "no_defect_tp": 1575,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 116,
            "no_defect_support": 1691,
            "defect_precision": 0.9288779889638259,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.942457231726283,
            "defect_tp": 1515,
            "defect_fp": 116,
            "defect_tn": 1575,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9533193277310925,
            "recall_macro": 0.9531426401806354,
            "f1_macro": 0.9532237588858055,
            "precision_micro": 0.9532824427480916,
            "recall_micro": 0.9532824427480916,
            "f1_micro": 0.9532824427480916,
            "accuracy": 0.9532824427480916,
            "hamming_loss": 0.0467175572519084,
            "no_defect_precision": 0.9523529411764706,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9548805662046594,
            "no_defect_tp": 1619,
            "no_defect_fp": 81,
            "no_defect_tn": 1503,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9542857142857143,
            "defect_recall": 0.9488636363636364,
            "defect_f1": 0.9515669515669516,
            "defect_tp": 1503,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 81,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9565065298507462,
            "recall_macro": 0.9567546771678942,
            "f1_macro": 0.9566077192259574,
            "precision_micro": 0.9566412213740458,
            "recall_micro": 0.9566412213740458,
            "f1_micro": 0.9566412213740458,
            "accuracy": 0.9566412213740458,
            "hamming_loss": 0.0433587786259542,
            "no_defect_precision": 0.9623880597014925,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9578134284016637,
            "no_defect_tp": 1612,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.950625,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9554020100502513,
            "defect_tp": 1521,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.955354578850206,
            "recall_macro": 0.9558316010489281,
            "f1_macro": 0.9554043759391988,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9696048632218845,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9562350119904077,
            "no_defect_tp": 1595,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9411042944785276,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.95457373988799,
            "defect_tp": 1534,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9609757546013369,
            "recall_macro": 0.9607743983298389,
            "f1_macro": 0.9608660843380692,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9594356261022927,
            "no_defect_recall": 0.9651094027202839,
            "no_defect_f1": 0.9622641509433962,
            "no_defect_tp": 1632,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 59,
            "no_defect_support": 1691,
            "defect_precision": 0.9625158831003812,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9594680177327423,
            "defect_tp": 1515,
            "defect_fp": 59,
            "defect_tn": 1632,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.959018777854439,
            "recall_macro": 0.9594996386096326,
            "f1_macro": 0.9590697696976209,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9732522796352584,
            "no_defect_recall": 0.9467770549970431,
            "no_defect_f1": 0.959832134292566,
            "no_defect_tp": 1601,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 90,
            "no_defect_support": 1691,
            "defect_precision": 0.9447852760736196,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9583074051026758,
            "defect_tp": 1540,
            "defect_fp": 90,
            "defect_tn": 1601,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.963288310819588,
            "recall_macro": 0.9633595714686785,
            "f1_macro": 0.9633224999384042,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.965619442797866,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9644760213143873,
            "no_defect_tp": 1629,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9609571788413098,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9621689785624212,
            "defect_tp": 1526,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9619965645431603,
            "recall_macro": 0.9622966805846758,
            "f1_macro": 0.9621106663372536,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9688809096349491,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9631171921475312,
            "no_defect_tp": 1619,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9551122194513716,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9611041405269761,
            "defect_tp": 1532,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598741395207275,
            "recall_macro": 0.9603067935415659,
            "f1_macro": 0.9599806575121304,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9710144927536232,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9608604720645354,
            "no_defect_tp": 1608,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.948733786287832,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9591008429597253,
            "defect_tp": 1536,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620773865898427,
            "recall_macro": 0.9615615797239097,
            "f1_macro": 0.9617718262444876,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9568261376896149,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.9632892804698973,
            "no_defect_tp": 1640,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.9673286354900704,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9602543720190779,
            "defect_tp": 1510,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9619930491513637,
            "recall_macro": 0.9623366276604006,
            "f1_macro": 0.962113070048558,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.97000599880024,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9630732578916021,
            "no_defect_tp": 1617,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9539800995024875,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9611528822055138,
            "defect_tp": 1534,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.961469399579058,
            "recall_macro": 0.9615055791504639,
            "f1_macro": 0.9614871297108618,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9632918886915335,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9627218934911242,
            "no_defect_tp": 1627,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.9596469104665826,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9602523659305994,
            "defect_tp": 1522,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9611561801007594,
            "recall_macro": 0.9612098961226696,
            "f1_macro": 0.9611822291932595,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9632701421800948,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9624149156555194,
            "no_defect_tp": 1626,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9590422180214241,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9599495427309996,
            "defect_tp": 1522,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9607979896137007,
            "recall_macro": 0.9609941072463248,
            "f1_macro": 0.9608831159136293,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9654556283502085,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9620178041543027,
            "no_defect_tp": 1621,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.956140350877193,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.959748427672956,
            "defect_tp": 1526,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 58,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9664385399892645,
            "recall_macro": 0.9664072458906408,
            "f1_macro": 0.9664196503752209,
            "precision_micro": 0.9664224664224664,
            "recall_micro": 0.9664224664224664,
            "f1_micro": 0.9664224664224664,
            "accuracy": 0.9664224664224664,
            "hamming_loss": 0.033577533577533576,
            "no_defect_precision": 0.964975845410628,
            "no_defect_recall": 0.9684848484848485,
            "no_defect_f1": 0.9667271627344223,
            "no_defect_tp": 1598,
            "no_defect_fp": 58,
            "no_defect_tn": 1568,
            "no_defect_fn": 52,
            "no_defect_support": 1650,
            "defect_precision": 0.9679012345679012,
            "defect_recall": 0.964329643296433,
            "defect_f1": 0.9661121380160197,
            "defect_tp": 1568,
            "defect_fp": 52,
            "defect_tn": 1598,
            "defect_fn": 58,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.1_s50_20251207_165315",
    "lr": 0.005,
    "weight_decay": 0.1,
    "seed": 50,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9624156118172986,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.1_s50_20251207_165315",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s50_20251207_165315",
      "timestamp": "2025-12-07T16:55:17.971097",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.1_s50",
          "seed": 50,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s50_20251207_165315"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9623037844711023,
        "recall_macro": 0.96259236361247,
        "f1_macro": 0.9624156118172986,
        "precision_micro": 0.962442748091603,
        "recall_micro": 0.962442748091603,
        "f1_micro": 0.962442748091603,
        "accuracy": 0.962442748091603,
        "hamming_loss": 0.03755725190839695,
        "no_defect_precision": 0.9688995215311005,
        "no_defect_recall": 0.9580130100532229,
        "no_defect_f1": 0.9634255129348795,
        "no_defect_tp": 1620,
        "no_defect_fp": 52,
        "no_defect_tn": 1532,
        "no_defect_fn": 71,
        "no_defect_support": 1691,
        "defect_precision": 0.9557080474111042,
        "defect_recall": 0.9671717171717171,
        "defect_f1": 0.9614057106997176,
        "defect_tp": 1532,
        "defect_fp": 71,
        "defect_tn": 1620,
        "defect_fn": 52,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9664385399892645,
        "recall_macro": 0.9664072458906408,
        "f1_macro": 0.9664196503752209,
        "precision_micro": 0.9664224664224664,
        "recall_micro": 0.9664224664224664,
        "f1_micro": 0.9664224664224664,
        "accuracy": 0.9664224664224664,
        "hamming_loss": 0.033577533577533576,
        "no_defect_precision": 0.964975845410628,
        "no_defect_recall": 0.9684848484848485,
        "no_defect_f1": 0.9667271627344223,
        "no_defect_tp": 1598,
        "no_defect_fp": 58,
        "no_defect_tn": 1568,
        "no_defect_fn": 52,
        "no_defect_support": 1650,
        "defect_precision": 0.9679012345679012,
        "defect_recall": 0.964329643296433,
        "defect_f1": 0.9661121380160197,
        "defect_tp": 1568,
        "defect_fp": 52,
        "defect_tn": 1598,
        "defect_fn": 58,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4614639314647499,
          0.2563519098145194,
          0.20239064100521878,
          0.1889540915022834,
          0.17752754909598178,
          0.180825194398479,
          0.17982625739968472,
          0.17287710262267658,
          0.17523840147705758,
          0.17586029589051483,
          0.1757296952399499,
          0.16986125648395786,
          0.16879442614740905,
          0.16708050623037327,
          0.1709118912222495
        ],
        "val_loss": [
          0.3650226896772018,
          0.19689097799933875,
          0.15801426137869173,
          0.1472727290999431,
          0.1288116300621858,
          0.13073003979829642,
          0.12478589545935392,
          0.11900832869399053,
          0.12299321477229778,
          0.11918683514858668,
          0.12985137448861048,
          0.11958861257880926,
          0.12029572282559596,
          0.11871037453126448,
          0.11859151584884295
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8994424484993644,
            "recall_macro": 0.8974829235584706,
            "f1_macro": 0.8980125266231656,
            "precision_micro": 0.8983206106870228,
            "recall_micro": 0.8983206106870228,
            "f1_micro": 0.8983206106870228,
            "accuracy": 0.8983206106870228,
            "hamming_loss": 0.1016793893129771,
            "no_defect_precision": 0.8849206349206349,
            "no_defect_recall": 0.9231224127735068,
            "no_defect_f1": 0.9036179450072359,
            "no_defect_tp": 1561,
            "no_defect_fp": 203,
            "no_defect_tn": 1381,
            "no_defect_fn": 130,
            "no_defect_support": 1691,
            "defect_precision": 0.913964262078094,
            "defect_recall": 0.8718434343434344,
            "defect_f1": 0.8924071082390953,
            "defect_tp": 1381,
            "defect_fp": 130,
            "defect_tn": 1561,
            "defect_fn": 203,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9429100304524753,
            "recall_macro": 0.9417790038169991,
            "f1_macro": 0.9421654954005696,
            "precision_micro": 0.9422900763358779,
            "recall_micro": 0.9422900763358779,
            "f1_micro": 0.9422900763358779,
            "accuracy": 0.9422900763358779,
            "hamming_loss": 0.057709923664122136,
            "no_defect_precision": 0.9326036866359447,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9448497227896119,
            "no_defect_tp": 1619,
            "no_defect_fp": 117,
            "no_defect_tn": 1467,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9532163742690059,
            "defect_recall": 0.9261363636363636,
            "defect_f1": 0.9394812680115274,
            "defect_tp": 1467,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 117,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9514657246725968,
            "recall_macro": 0.9519477746118787,
            "f1_macro": 0.951438138917558,
            "precision_micro": 0.9514503816793893,
            "recall_micro": 0.9514503816793893,
            "f1_micro": 0.9514503816793893,
            "accuracy": 0.9514503816793893,
            "hamming_loss": 0.04854961832061069,
            "no_defect_precision": 0.9682151589242054,
            "no_defect_recall": 0.9367238320520402,
            "no_defect_f1": 0.9522091974752029,
            "no_defect_tp": 1584,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 107,
            "no_defect_support": 1691,
            "defect_precision": 0.9347162904209884,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9506670803599131,
            "defect_tp": 1532,
            "defect_fp": 107,
            "defect_tn": 1584,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9502688743609198,
            "recall_macro": 0.950649121313669,
            "f1_macro": 0.9499197373112596,
            "precision_micro": 0.9499236641221374,
            "recall_micro": 0.9499236641221374,
            "f1_micro": 0.9499236641221374,
            "accuracy": 0.9499236641221374,
            "hamming_loss": 0.050076335877862595,
            "no_defect_precision": 0.9733415995040298,
            "no_defect_recall": 0.9284447072738025,
            "no_defect_f1": 0.950363196125908,
            "no_defect_tp": 1570,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 121,
            "no_defect_support": 1691,
            "defect_precision": 0.9271961492178099,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9494762784966112,
            "defect_tp": 1541,
            "defect_fp": 121,
            "defect_tn": 1570,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9560640368277256,
            "recall_macro": 0.9549327918451218,
            "f1_macro": 0.9553248750049519,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9452449567723343,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.9573847051955633,
            "no_defect_tp": 1640,
            "no_defect_fp": 95,
            "no_defect_tn": 1489,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.9668831168831169,
            "defect_recall": 0.9400252525252525,
            "defect_f1": 0.9532650448143406,
            "defect_tp": 1489,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 95,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9587210091580256,
            "recall_macro": 0.9592039555818385,
            "f1_macro": 0.95876478556989,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.9732360097323601,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.95952023988006,
            "no_defect_tp": 1600,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.944206008583691,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9580093312597201,
            "defect_tp": 1540,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9586334665932469,
            "recall_macro": 0.9589642731274901,
            "f1_macro": 0.9587514900543159,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.9664268585131894,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9598094671033045,
            "no_defect_tp": 1612,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9508400746733043,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9576935130053275,
            "defect_tp": 1528,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620144610728099,
            "recall_macro": 0.9616015267996345,
            "f1_macro": 0.9617754813861651,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9578947368421052,
            "no_defect_recall": 0.9686575990538143,
            "no_defect_f1": 0.9632461040870333,
            "no_defect_tp": 1638,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 53,
            "no_defect_support": 1691,
            "defect_precision": 0.9661341853035144,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.9603048586852969,
            "defect_tp": 1512,
            "defect_fp": 53,
            "defect_tn": 1638,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9586343736570692,
            "recall_macro": 0.959004220203215,
            "f1_macro": 0.9587540143993618,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.9675480769230769,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9597615499254843,
            "no_defect_tp": 1610,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9497206703910615,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9577464788732394,
            "defect_tp": 1530,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9609526953747054,
            "recall_macro": 0.9607943718677012,
            "f1_macro": 0.9608677793958403,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9599764567392584,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9622418879056047,
            "no_defect_tp": 1631,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9619289340101523,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.959493670886076,
            "defect_tp": 1516,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9557852013294666,
            "recall_macro": 0.9562670988417588,
            "f1_macro": 0.9557156780068413,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9736519607843137,
            "no_defect_recall": 0.9396806623299823,
            "no_defect_f1": 0.9563647306650617,
            "no_defect_tp": 1589,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 102,
            "no_defect_support": 1691,
            "defect_precision": 0.9379184418746196,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.955066625348621,
            "defect_tp": 1541,
            "defect_fp": 102,
            "defect_tn": 1589,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623037844711023,
            "recall_macro": 0.96259236361247,
            "f1_macro": 0.9624156118172986,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9688995215311005,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9634255129348795,
            "no_defect_tp": 1620,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9557080474111042,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9614057106997176,
            "defect_tp": 1532,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610863356758059,
            "recall_macro": 0.9613497108877062,
            "f1_macro": 0.9611920662652991,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9671445639187575,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.962258543833581,
            "no_defect_tp": 1619,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9550281074328545,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9601255886970173,
            "defect_tp": 1529,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.961129333498554,
            "recall_macro": 0.9612498431983943,
            "f1_macro": 0.9611851851851851,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9643705463182898,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9623703703703703,
            "no_defect_tp": 1624,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9578881206788183,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.96,
            "defect_tp": 1524,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9617405133686966,
            "recall_macro": 0.9618611827918451,
            "f1_macro": 0.9617964421114027,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9649643705463183,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9629629629629629,
            "no_defect_tp": 1625,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9585166561910748,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9606299212598425,
            "defect_tp": 1525,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 59,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9664385399892645,
            "recall_macro": 0.9664072458906408,
            "f1_macro": 0.9664196503752209,
            "precision_micro": 0.9664224664224664,
            "recall_micro": 0.9664224664224664,
            "f1_micro": 0.9664224664224664,
            "accuracy": 0.9664224664224664,
            "hamming_loss": 0.033577533577533576,
            "no_defect_precision": 0.964975845410628,
            "no_defect_recall": 0.9684848484848485,
            "no_defect_f1": 0.9667271627344223,
            "no_defect_tp": 1598,
            "no_defect_fp": 58,
            "no_defect_tn": 1568,
            "no_defect_fn": 52,
            "no_defect_support": 1650,
            "defect_precision": 0.9679012345679012,
            "defect_recall": 0.964329643296433,
            "defect_f1": 0.9661121380160197,
            "defect_tp": 1568,
            "defect_fp": 52,
            "defect_tn": 1598,
            "defect_fn": 58,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.1_s60_20251207_154221",
    "lr": 0.005,
    "weight_decay": 0.1,
    "seed": 60,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9636366605163039,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.1_s60_20251207_154221",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s60_20251207_154221",
      "timestamp": "2025-12-07T15:44:12.418919",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.1_s60",
          "seed": 60,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s60_20251207_154221"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9635302980440092,
        "recall_macro": 0.9637950692615092,
        "f1_macro": 0.9636366605163039,
        "precision_micro": 0.9636641221374046,
        "recall_micro": 0.9636641221374046,
        "f1_micro": 0.9636641221374046,
        "accuracy": 0.9636641221374046,
        "hamming_loss": 0.03633587786259542,
        "no_defect_precision": 0.9695340501792115,
        "no_defect_recall": 0.9597871082199881,
        "no_defect_f1": 0.9646359583952452,
        "no_defect_tp": 1623,
        "no_defect_fp": 51,
        "no_defect_tn": 1533,
        "no_defect_fn": 68,
        "no_defect_support": 1691,
        "defect_precision": 0.957526545908807,
        "defect_recall": 0.9678030303030303,
        "defect_f1": 0.9626373626373627,
        "defect_tp": 1533,
        "defect_fp": 68,
        "defect_tn": 1623,
        "defect_fn": 51,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.967035776905736,
        "recall_macro": 0.9670267248127027,
        "f1_macro": 0.9670308903694731,
        "precision_micro": 0.967032967032967,
        "recall_micro": 0.967032967032967,
        "f1_micro": 0.967032967032967,
        "accuracy": 0.967032967032967,
        "hamming_loss": 0.03296703296703297,
        "no_defect_precision": 0.9667070217917676,
        "no_defect_recall": 0.9678787878787879,
        "no_defect_f1": 0.9672925499697154,
        "no_defect_tp": 1597,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 53,
        "no_defect_support": 1650,
        "defect_precision": 0.9673645320197044,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.9667692307692307,
        "defect_tp": 1571,
        "defect_fp": 53,
        "defect_tn": 1597,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.46740786587842836,
          0.26389248768904217,
          0.19851921333553402,
          0.18171390700913873,
          0.17839887323613945,
          0.17655645008491172,
          0.17536520353171617,
          0.17260465106954134,
          0.17566832750412212,
          0.17288908273542775,
          0.17646069581538565,
          0.1683326783477013,
          0.16989147761314483,
          0.17048988927732453,
          0.16986328132731146
        ],
        "val_loss": [
          0.3698712421151308,
          0.19899485317560342,
          0.14988192815620166,
          0.13739695657904333,
          0.13052255345078614,
          0.1251748206380468,
          0.1193422292574094,
          0.11870240448759152,
          0.11943154237591304,
          0.12276708327520353,
          0.11937317116042742,
          0.12027246175477138,
          0.11916247748125058,
          0.1187744432200606,
          0.1195376286856257
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8990374749982524,
            "recall_macro": 0.8963961390964643,
            "f1_macro": 0.8970320065396467,
            "precision_micro": 0.8974045801526718,
            "recall_micro": 0.8974045801526718,
            "f1_micro": 0.8974045801526718,
            "accuracy": 0.8974045801526718,
            "hamming_loss": 0.10259541984732824,
            "no_defect_precision": 0.8804042672655812,
            "no_defect_recall": 0.9272619751626257,
            "no_defect_f1": 0.9032258064516129,
            "no_defect_tp": 1568,
            "no_defect_fp": 213,
            "no_defect_tn": 1371,
            "no_defect_fn": 123,
            "no_defect_support": 1691,
            "defect_precision": 0.9176706827309237,
            "defect_recall": 0.865530303030303,
            "defect_f1": 0.8908382066276803,
            "defect_tp": 1371,
            "defect_fp": 123,
            "defect_tn": 1568,
            "defect_fn": 213,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.944286380597015,
            "recall_macro": 0.9445278852988788,
            "f1_macro": 0.9443845415431287,
            "precision_micro": 0.9444274809160306,
            "recall_micro": 0.9444274809160306,
            "f1_micro": 0.9444274809160306,
            "accuracy": 0.9444274809160306,
            "hamming_loss": 0.055572519083969464,
            "no_defect_precision": 0.9504477611940298,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9459298871063577,
            "no_defect_tp": 1592,
            "no_defect_fp": 83,
            "no_defect_tn": 1501,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.938125,
            "defect_recall": 0.94760101010101,
            "defect_f1": 0.9428391959798995,
            "defect_tp": 1501,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 83,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552907144664282,
            "recall_macro": 0.9555120244431303,
            "f1_macro": 0.9553838694795995,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.960644007155635,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9566508313539193,
            "no_defect_tp": 1611,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9499374217772215,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9541169076052797,
            "defect_tp": 1518,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9561898707542988,
            "recall_macro": 0.9565189147536871,
            "f1_macro": 0.9563071339093866,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9640287769784173,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9574278058946115,
            "no_defect_tp": 1608,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9483509645301804,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9551864619241617,
            "defect_tp": 1524,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.95986756365009,
            "recall_macro": 0.9602868200037036,
            "f1_macro": 0.9599795674481764,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9704463208685162,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9608838459241564,
            "no_defect_tp": 1609,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9492888064316636,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9590752889721962,
            "defect_tp": 1535,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9565863872151531,
            "recall_macro": 0.9555840785142973,
            "f1_macro": 0.9559417698927206,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9468515309069901,
            "no_defect_recall": 0.9692489651094027,
            "no_defect_f1": 0.9579193454120397,
            "no_defect_tp": 1639,
            "no_defect_fp": 92,
            "no_defect_tn": 1492,
            "no_defect_fn": 52,
            "no_defect_support": 1691,
            "defect_precision": 0.966321243523316,
            "defect_recall": 0.9419191919191919,
            "defect_f1": 0.9539641943734015,
            "defect_tp": 1492,
            "defect_fp": 52,
            "defect_tn": 1639,
            "defect_fn": 92,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623055239820438,
            "recall_macro": 0.961917183365291,
            "f1_macro": 0.9620821661998132,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9584552369806905,
            "no_defect_recall": 0.9686575990538143,
            "no_defect_f1": 0.9635294117647059,
            "no_defect_tp": 1638,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 53,
            "no_defect_support": 1691,
            "defect_precision": 0.9661558109833972,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.9606349206349206,
            "defect_tp": 1513,
            "defect_fp": 53,
            "defect_tn": 1638,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9605181536284116,
            "recall_macro": 0.9606385036049436,
            "f1_macro": 0.9605739282589676,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9637767220902613,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9617777777777777,
            "no_defect_tp": 1623,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.957259585166562,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9593700787401575,
            "defect_tp": 1523,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9606842674188458,
            "recall_macro": 0.9595078520270715,
            "f1_macro": 0.9599136502511885,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9493087557603687,
            "no_defect_recall": 0.9745712596096984,
            "no_defect_f1": 0.9617741464838051,
            "no_defect_tp": 1648,
            "no_defect_fp": 88,
            "no_defect_tn": 1496,
            "no_defect_fn": 43,
            "no_defect_support": 1691,
            "defect_precision": 0.9720597790773229,
            "defect_recall": 0.9444444444444444,
            "defect_f1": 0.9580531540185719,
            "defect_tp": 1496,
            "defect_fp": 43,
            "defect_tn": 1648,
            "defect_fn": 88,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9607809786403595,
            "recall_macro": 0.9611938426249484,
            "f1_macro": 0.9608955223880598,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9710669077757685,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9617910447761194,
            "no_defect_tp": 1611,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9504950495049505,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.96,
            "defect_tp": 1536,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626050304169431,
            "recall_macro": 0.9629279937159889,
            "f1_macro": 0.9627229810419466,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9700419412822049,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9636904761904762,
            "no_defect_tp": 1619,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9551681195516812,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.961755485893417,
            "defect_tp": 1534,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626042191259583,
            "recall_macro": 0.9629679407917138,
            "f1_macro": 0.9627252901932482,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9711711711711711,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9636471990464839,
            "no_defect_tp": 1617,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9540372670807453,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9618033813400125,
            "defect_tp": 1536,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635302980440092,
            "recall_macro": 0.9637950692615092,
            "f1_macro": 0.9636366605163039,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9695340501792115,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9646359583952452,
            "no_defect_tp": 1623,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.957526545908807,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9626373626373627,
            "defect_tp": 1533,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626312281597382,
            "recall_macro": 0.9628281260266771,
            "f1_macro": 0.9627167198551779,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9672424061941632,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9637982195845697,
            "no_defect_tp": 1624,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9580200501253133,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9616352201257862,
            "defect_tp": 1529,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9632276119402985,
            "recall_macro": 0.9634794126958526,
            "f1_macro": 0.9633304669515134,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.968955223880597,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.964349376114082,
            "no_defect_tp": 1623,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9575,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9623115577889447,
            "defect_tp": 1532,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 52,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.967035776905736,
            "recall_macro": 0.9670267248127027,
            "f1_macro": 0.9670308903694731,
            "precision_micro": 0.967032967032967,
            "recall_micro": 0.967032967032967,
            "f1_micro": 0.967032967032967,
            "accuracy": 0.967032967032967,
            "hamming_loss": 0.03296703296703297,
            "no_defect_precision": 0.9667070217917676,
            "no_defect_recall": 0.9678787878787879,
            "no_defect_f1": 0.9672925499697154,
            "no_defect_tp": 1597,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 53,
            "no_defect_support": 1650,
            "defect_precision": 0.9673645320197044,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.9667692307692307,
            "defect_tp": 1571,
            "defect_fp": 53,
            "defect_tn": 1597,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.1_s70_20251207_165020",
    "lr": 0.005,
    "weight_decay": 0.1,
    "seed": 70,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9624104492465713,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.1_s70_20251207_165020",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s70_20251207_165020",
      "timestamp": "2025-12-07T16:52:16.642874",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.1_s70",
          "seed": 70,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s70_20251207_165020"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9623301985370951,
        "recall_macro": 0.9625124694610205,
        "f1_macro": 0.9624104492465713,
        "precision_micro": 0.962442748091603,
        "recall_micro": 0.962442748091603,
        "f1_micro": 0.962442748091603,
        "accuracy": 0.962442748091603,
        "hamming_loss": 0.03755725190839695,
        "no_defect_precision": 0.9666666666666667,
        "no_defect_recall": 0.9603784742755765,
        "no_defect_f1": 0.9635123108869772,
        "no_defect_tp": 1624,
        "no_defect_fp": 56,
        "no_defect_tn": 1528,
        "no_defect_fn": 67,
        "no_defect_support": 1691,
        "defect_precision": 0.9579937304075236,
        "defect_recall": 0.9646464646464646,
        "defect_f1": 0.9613085876061654,
        "defect_tp": 1528,
        "defect_fp": 67,
        "defect_tn": 1624,
        "defect_fn": 56,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.965500642386794,
        "recall_macro": 0.9655115732975512,
        "f1_macro": 0.9655052980715606,
        "precision_micro": 0.9655067155067155,
        "recall_micro": 0.9655067155067155,
        "f1_micro": 0.9655067155067155,
        "accuracy": 0.9655067155067155,
        "hamming_loss": 0.034493284493284496,
        "no_defect_precision": 0.9666059502125076,
        "no_defect_recall": 0.9648484848484848,
        "no_defect_f1": 0.9657264179557173,
        "no_defect_tp": 1592,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 58,
        "no_defect_support": 1650,
        "defect_precision": 0.9643953345610804,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.965284178187404,
        "defect_tp": 1571,
        "defect_fp": 58,
        "defect_tn": 1592,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4656350228576979,
          0.2536284384243658,
          0.20176563346485712,
          0.18280883214463747,
          0.17913646812094805,
          0.18105093695254507,
          0.1715834121137982,
          0.17524858074706967,
          0.18138760610417343,
          0.17587245034373455,
          0.16854051553554614,
          0.1716395111824678,
          0.17408481969743592,
          0.1643513230661468,
          0.16846240922870995
        ],
        "val_loss": [
          0.36979447362514645,
          0.195640847660028,
          0.1578573749329035,
          0.1348800528794527,
          0.13095164958101052,
          0.12557106450773203,
          0.12431553958986814,
          0.12088496603358251,
          0.13159235552526438,
          0.12012495508847329,
          0.11788150818588641,
          0.1179164401613749,
          0.11985144491952199,
          0.1197011642731153,
          0.11976096564187454
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8945480653123625,
            "recall_macro": 0.8869385755843473,
            "f1_macro": 0.8879948015907915,
            "precision_micro": 0.888854961832061,
            "recall_micro": 0.888854961832061,
            "f1_micro": 0.888854961832061,
            "accuracy": 0.888854961832061,
            "hamming_loss": 0.11114503816793893,
            "no_defect_precision": 0.8546231961517905,
            "no_defect_recall": 0.9455943228858663,
            "no_defect_f1": 0.8978102189781022,
            "no_defect_tp": 1599,
            "no_defect_fp": 272,
            "no_defect_tn": 1312,
            "no_defect_fn": 92,
            "no_defect_support": 1691,
            "defect_precision": 0.9344729344729344,
            "defect_recall": 0.8282828282828283,
            "defect_f1": 0.8781793842034806,
            "defect_tp": 1312,
            "defect_fp": 92,
            "defect_tn": 1599,
            "defect_fn": 272,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9454371201496026,
            "recall_macro": 0.9446398864457706,
            "f1_macro": 0.9449361015918184,
            "precision_micro": 0.9450381679389313,
            "recall_micro": 0.9450381679389313,
            "f1_micro": 0.9450381679389313,
            "accuracy": 0.9450381679389313,
            "hamming_loss": 0.0549618320610687,
            "no_defect_precision": 0.9379710144927537,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9473067915690867,
            "no_defect_tp": 1618,
            "no_defect_fp": 107,
            "no_defect_tn": 1477,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9529032258064516,
            "defect_recall": 0.9324494949494949,
            "defect_f1": 0.9425654116145501,
            "defect_tp": 1477,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 107,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9525625877406948,
            "recall_macro": 0.9530106654958813,
            "f1_macro": 0.9526513429109837,
            "precision_micro": 0.9526717557251908,
            "recall_micro": 0.9526717557251908,
            "f1_micro": 0.9526717557251908,
            "accuracy": 0.9526717557251908,
            "hamming_loss": 0.04732824427480916,
            "no_defect_precision": 0.9648910411622276,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.9536344600658092,
            "no_defect_tp": 1594,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.940234134319162,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9516682257561584,
            "defect_tp": 1526,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9568510744075568,
            "recall_macro": 0.956970466044239,
            "f1_macro": 0.9569063867016623,
            "precision_micro": 0.9569465648854962,
            "recall_micro": 0.9569465648854962,
            "f1_micro": 0.9569465648854962,
            "accuracy": 0.9569465648854962,
            "hamming_loss": 0.04305343511450382,
            "no_defect_precision": 0.9602137767220903,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9582222222222222,
            "no_defect_tp": 1617,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9534883720930233,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9555905511811024,
            "defect_tp": 1517,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954541738941972,
            "recall_macro": 0.952563407582627,
            "f1_macro": 0.9531501964078031,
            "precision_micro": 0.9532824427480916,
            "recall_micro": 0.9532824427480916,
            "f1_micro": 0.9532824427480916,
            "accuracy": 0.9532824427480916,
            "hamming_loss": 0.0467175572519084,
            "no_defect_precision": 0.9374288964732651,
            "no_defect_recall": 0.9745712596096984,
            "no_defect_f1": 0.9556393157436939,
            "no_defect_tp": 1648,
            "no_defect_fp": 110,
            "no_defect_tn": 1474,
            "no_defect_fn": 43,
            "no_defect_support": 1691,
            "defect_precision": 0.971654581410679,
            "defect_recall": 0.9305555555555556,
            "defect_f1": 0.9506610770719123,
            "defect_tp": 1474,
            "defect_fp": 43,
            "defect_tn": 1648,
            "defect_fn": 110,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.960167468488657,
            "recall_macro": 0.9604426882664612,
            "f1_macro": 0.9602760068760996,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9665271966527197,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9613555291319857,
            "no_defect_tp": 1617,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9538077403245943,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9591964846202135,
            "defect_tp": 1528,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9566505568239785,
            "recall_macro": 0.9565349682514082,
            "f1_macro": 0.9565895406416365,
            "precision_micro": 0.9566412213740458,
            "recall_micro": 0.9566412213740458,
            "f1_micro": 0.9566412213740458,
            "accuracy": 0.9566412213740458,
            "hamming_loss": 0.0433587786259542,
            "no_defect_precision": 0.9563936358279317,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9580873671782763,
            "no_defect_tp": 1623,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9569074778200254,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9550917141049968,
            "defect_tp": 1510,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9595527936591794,
            "recall_macro": 0.9598513222108728,
            "f1_macro": 0.9596661931977217,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9664871334530222,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9607376561570494,
            "no_defect_tp": 1615,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9526184538653366,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.958594730238394,
            "defect_tp": 1528,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549062145931838,
            "recall_macro": 0.9553800497583762,
            "f1_macro": 0.9548006266552277,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9736034376918354,
            "no_defect_recall": 0.937906564163217,
            "no_defect_f1": 0.9554216867469879,
            "no_defect_tp": 1586,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 105,
            "no_defect_support": 1691,
            "defect_precision": 0.9362089914945322,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9541795665634675,
            "defect_tp": 1541,
            "defect_fp": 105,
            "defect_tn": 1586,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598643544917043,
            "recall_macro": 0.9601270317008046,
            "f1_macro": 0.9599697691397968,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9659498207885304,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9610698365527489,
            "no_defect_tp": 1617,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9537788881948782,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9588697017268446,
            "defect_tp": 1527,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9614439995899791,
            "recall_macro": 0.9604947687997658,
            "f1_macro": 0.9608392653625544,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9519953730480046,
            "no_defect_recall": 0.9733885274985216,
            "no_defect_f1": 0.9625730994152046,
            "no_defect_tp": 1646,
            "no_defect_fp": 83,
            "no_defect_tn": 1501,
            "no_defect_fn": 45,
            "no_defect_support": 1691,
            "defect_precision": 0.9708926261319534,
            "defect_recall": 0.94760101010101,
            "defect_f1": 0.9591054313099041,
            "defect_tp": 1501,
            "defect_fp": 45,
            "defect_tn": 1646,
            "defect_fn": 83,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623787168851181,
            "recall_macro": 0.9624325753095713,
            "f1_macro": 0.9624048361478026,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9644549763033176,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9635986978395975,
            "no_defect_tp": 1628,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.9603024574669187,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9612109744560076,
            "defect_tp": 1524,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623301985370951,
            "recall_macro": 0.9625124694610205,
            "f1_macro": 0.9624104492465713,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9666666666666667,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9635123108869772,
            "no_defect_tp": 1624,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9579937304075236,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9613085876061654,
            "defect_tp": 1528,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9617032050162616,
            "recall_macro": 0.9619410769432946,
            "f1_macro": 0.9618019175040853,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9671837708830548,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9628749628749629,
            "no_defect_tp": 1621,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9562226391494684,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9607288721332077,
            "defect_tp": 1529,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9616973262678568,
            "recall_macro": 0.9619610504811569,
            "f1_macro": 0.9618032148280503,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.967741935483871,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.962852897473997,
            "no_defect_tp": 1620,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9556527170518426,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9607535321821036,
            "defect_tp": 1530,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 54,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.965500642386794,
            "recall_macro": 0.9655115732975512,
            "f1_macro": 0.9655052980715606,
            "precision_micro": 0.9655067155067155,
            "recall_micro": 0.9655067155067155,
            "f1_micro": 0.9655067155067155,
            "accuracy": 0.9655067155067155,
            "hamming_loss": 0.034493284493284496,
            "no_defect_precision": 0.9666059502125076,
            "no_defect_recall": 0.9648484848484848,
            "no_defect_f1": 0.9657264179557173,
            "no_defect_tp": 1592,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 58,
            "no_defect_support": 1650,
            "defect_precision": 0.9643953345610804,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.965284178187404,
            "defect_tp": 1571,
            "defect_fp": 58,
            "defect_tn": 1592,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.1_s80_20251207_164134",
    "lr": 0.005,
    "weight_decay": 0.1,
    "seed": 80,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9620969452060523,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.1_s80_20251207_164134",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s80_20251207_164134",
      "timestamp": "2025-12-07T16:43:31.908806",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 10,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.1_s80",
          "seed": 80,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s80_20251207_164134"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9620969452060523,
        "recall_macro": 0.9620969452060523,
        "f1_macro": 0.9620969452060523,
        "precision_micro": 0.9621374045801526,
        "recall_micro": 0.9621374045801526,
        "f1_micro": 0.9621374045801526,
        "accuracy": 0.9621374045801526,
        "hamming_loss": 0.03786259541984733,
        "no_defect_precision": 0.9633353045535187,
        "no_defect_recall": 0.9633353045535187,
        "no_defect_f1": 0.9633353045535187,
        "no_defect_tp": 1629,
        "no_defect_fp": 62,
        "no_defect_tn": 1522,
        "no_defect_fn": 62,
        "no_defect_support": 1691,
        "defect_precision": 0.9608585858585859,
        "defect_recall": 0.9608585858585859,
        "defect_f1": 0.9608585858585859,
        "defect_tp": 1522,
        "defect_fp": 62,
        "defect_tn": 1629,
        "defect_fn": 62,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.967035776905736,
        "recall_macro": 0.9670267248127027,
        "f1_macro": 0.9670308903694731,
        "precision_micro": 0.967032967032967,
        "recall_micro": 0.967032967032967,
        "f1_micro": 0.967032967032967,
        "accuracy": 0.967032967032967,
        "hamming_loss": 0.03296703296703297,
        "no_defect_precision": 0.9667070217917676,
        "no_defect_recall": 0.9678787878787879,
        "no_defect_f1": 0.9672925499697154,
        "no_defect_tp": 1597,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 53,
        "no_defect_support": 1650,
        "defect_precision": 0.9673645320197044,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.9667692307692307,
        "defect_tp": 1571,
        "defect_fp": 53,
        "defect_tn": 1597,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.46006802086052034,
          0.25199217533217316,
          0.19951171072581822,
          0.18948167718354628,
          0.18392375622833124,
          0.17878091288535664,
          0.17589322483813913,
          0.17422109293638413,
          0.17091379386361175,
          0.17303969813939418,
          0.16959220513888482,
          0.16569697581013376,
          0.16973203788491972,
          0.16966945431721261,
          0.16580133679396936
        ],
        "val_loss": [
          0.36560759062950426,
          0.19569962958876902,
          0.1514181254001764,
          0.1326225887124355,
          0.1333080823175036,
          0.12716633547097445,
          0.12802823926680362,
          0.12670056686665004,
          0.1229526583248606,
          0.11690537266146678,
          0.11940893072348374,
          0.12047582406264085,
          0.11987717557125367,
          0.11821044637606694,
          0.11828585506345217
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8968844110675837,
            "recall_macro": 0.8964638997903338,
            "f1_macro": 0.8966335181750202,
            "precision_micro": 0.896793893129771,
            "recall_micro": 0.896793893129771,
            "f1_micro": 0.896793893129771,
            "accuracy": 0.896793893129771,
            "hamming_loss": 0.103206106870229,
            "no_defect_precision": 0.8949211908931699,
            "no_defect_recall": 0.9065641632170314,
            "no_defect_f1": 0.900705052878966,
            "no_defect_tp": 1533,
            "no_defect_fp": 180,
            "no_defect_tn": 1404,
            "no_defect_fn": 158,
            "no_defect_support": 1691,
            "defect_precision": 0.8988476312419974,
            "defect_recall": 0.8863636363636364,
            "defect_f1": 0.8925619834710744,
            "defect_tp": 1404,
            "defect_fp": 158,
            "defect_tn": 1533,
            "defect_fn": 180,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9458049223418392,
            "recall_macro": 0.9461461152028863,
            "f1_macro": 0.9459202953735648,
            "precision_micro": 0.9459541984732824,
            "recall_micro": 0.9459541984732824,
            "f1_micro": 0.9459541984732824,
            "accuracy": 0.9459541984732824,
            "hamming_loss": 0.054045801526717556,
            "no_defect_precision": 0.9543817527010804,
            "no_defect_recall": 0.9402720283855707,
            "no_defect_f1": 0.9472743521000894,
            "no_defect_tp": 1590,
            "no_defect_fp": 76,
            "no_defect_tn": 1508,
            "no_defect_fn": 101,
            "no_defect_support": 1691,
            "defect_precision": 0.9372280919825979,
            "defect_recall": 0.952020202020202,
            "defect_f1": 0.9445662386470404,
            "defect_tp": 1508,
            "defect_fp": 101,
            "defect_tn": 1590,
            "defect_fn": 76,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555801386501457,
            "recall_macro": 0.955947522235961,
            "f1_macro": 0.9556987562067221,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9645432692307693,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9567809239940388,
            "no_defect_tp": 1605,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.946617008069522,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9546165884194053,
            "defect_tp": 1525,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.959906973758269,
            "recall_macro": 0.9600271640114928,
            "f1_macro": 0.95996267133275,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9631828978622328,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9611851851851851,
            "no_defect_tp": 1622,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9566310496543055,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9587401574803149,
            "defect_tp": 1522,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9577402931632539,
            "recall_macro": 0.9581770917334194,
            "f1_macro": 0.9578427816992059,
            "precision_micro": 0.9578625954198473,
            "recall_micro": 0.9578625954198473,
            "f1_micro": 0.9578625954198473,
            "accuracy": 0.9578625954198473,
            "hamming_loss": 0.04213740458015267,
            "no_defect_precision": 0.9691842900302114,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.958756724447101,
            "no_defect_tp": 1604,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9462962962962963,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9569288389513109,
            "defect_tp": 1533,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.960467849348033,
            "recall_macro": 0.9607783183699801,
            "f1_macro": 0.9605835068461404,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9676646706586827,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9616185659030051,
            "no_defect_tp": 1616,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9532710280373832,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9595484477892756,
            "defect_tp": 1530,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9583597211064141,
            "recall_macro": 0.9588084048647325,
            "f1_macro": 0.9584548409531172,
            "precision_micro": 0.9584732824427481,
            "recall_micro": 0.9584732824427481,
            "f1_micro": 0.9584732824427481,
            "accuracy": 0.9584732824427481,
            "hamming_loss": 0.04152671755725191,
            "no_defect_precision": 0.970356926799758,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9593301435406698,
            "no_defect_tp": 1604,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9463625154130703,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9575795383655645,
            "defect_tp": 1535,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9571725227462933,
            "recall_macro": 0.957645646291418,
            "f1_macro": 0.9572360836796108,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.970856102003643,
            "no_defect_recall": 0.9455943228858663,
            "no_defect_f1": 0.9580587177950869,
            "no_defect_tp": 1599,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 92,
            "no_defect_support": 1691,
            "defect_precision": 0.9434889434889435,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9564134495641345,
            "defect_tp": 1536,
            "defect_fp": 92,
            "defect_tn": 1599,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9605128205128206,
            "recall_macro": 0.9609780537486037,
            "f1_macro": 0.9605946833345941,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9733333333333334,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9613888057467824,
            "no_defect_tp": 1606,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9476923076923077,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9598005609224057,
            "defect_tp": 1540,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620969452060523,
            "recall_macro": 0.9620969452060523,
            "f1_macro": 0.9620969452060523,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9633353045535187,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9633353045535187,
            "no_defect_tp": 1629,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9608585858585859,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9608585858585859,
            "defect_tp": 1522,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.960807258331175,
            "recall_macro": 0.9609741337084625,
            "f1_macro": 0.9608817142170334,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9649018441403926,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9620403321470937,
            "no_defect_tp": 1622,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9567126725219574,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9597230962869729,
            "defect_tp": 1525,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9607722911460692,
            "recall_macro": 0.9610939749356366,
            "f1_macro": 0.9608896850276161,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9682444577591373,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9619047619047619,
            "no_defect_tp": 1616,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9533001245330013,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9598746081504702,
            "defect_tp": 1531,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604658519716152,
            "recall_macro": 0.9608182654457048,
            "f1_macro": 0.9605859779841236,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9687875150060024,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9615728328865059,
            "no_defect_tp": 1614,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9521441889372281,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9595991230817413,
            "defect_tp": 1532,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9614090691290466,
            "recall_macro": 0.9616054468397757,
            "f1_macro": 0.9614943172274788,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9660512209648601,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9626112759643917,
            "no_defect_tp": 1622,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.956766917293233,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.960377358490566,
            "defect_tp": 1527,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610994019627086,
            "recall_macro": 0.9613097638119814,
            "f1_macro": 0.9611894010416739,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.966030989272944,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9623033541110122,
            "no_defect_tp": 1621,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9561678146524734,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9600754479723358,
            "defect_tp": 1527,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 57,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.967035776905736,
            "recall_macro": 0.9670267248127027,
            "f1_macro": 0.9670308903694731,
            "precision_micro": 0.967032967032967,
            "recall_micro": 0.967032967032967,
            "f1_micro": 0.967032967032967,
            "accuracy": 0.967032967032967,
            "hamming_loss": 0.03296703296703297,
            "no_defect_precision": 0.9667070217917676,
            "no_defect_recall": 0.9678787878787879,
            "no_defect_f1": 0.9672925499697154,
            "no_defect_tp": 1597,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 53,
            "no_defect_support": 1650,
            "defect_precision": 0.9673645320197044,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.9667692307692307,
            "defect_tp": 1571,
            "defect_fp": 53,
            "defect_tn": 1597,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.1_s90_20251207_201108",
    "lr": 0.005,
    "weight_decay": 0.1,
    "seed": 90,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9627229810419466,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.1_s90_20251207_201108",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s90_20251207_201108",
      "timestamp": "2025-12-07T20:13:02.723451",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 15,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.1_s90",
          "seed": 90,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s90_20251207_201108"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9626050304169431,
        "recall_macro": 0.9629279937159889,
        "f1_macro": 0.9627229810419466,
        "precision_micro": 0.9627480916030534,
        "recall_micro": 0.9627480916030534,
        "f1_micro": 0.9627480916030534,
        "accuracy": 0.9627480916030534,
        "hamming_loss": 0.037251908396946566,
        "no_defect_precision": 0.9700419412822049,
        "no_defect_recall": 0.9574216439976345,
        "no_defect_f1": 0.9636904761904762,
        "no_defect_tp": 1619,
        "no_defect_fp": 50,
        "no_defect_tn": 1534,
        "no_defect_fn": 72,
        "no_defect_support": 1691,
        "defect_precision": 0.9551681195516812,
        "defect_recall": 0.9684343434343434,
        "defect_f1": 0.961755485893417,
        "defect_tp": 1534,
        "defect_fp": 72,
        "defect_tn": 1619,
        "defect_fn": 50,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9642788590017439,
        "recall_macro": 0.96429945208543,
        "f1_macro": 0.9642847525323366,
        "precision_micro": 0.9642857142857143,
        "recall_micro": 0.9642857142857143,
        "f1_micro": 0.9642857142857143,
        "accuracy": 0.9642857142857143,
        "hamming_loss": 0.03571428571428571,
        "no_defect_precision": 0.9665246500304321,
        "no_defect_recall": 0.9624242424242424,
        "no_defect_f1": 0.9644700880655936,
        "no_defect_tp": 1588,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 62,
        "no_defect_support": 1650,
        "defect_precision": 0.9620330679730558,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.9640994169990794,
        "defect_tp": 1571,
        "defect_fp": 62,
        "defect_tn": 1588,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.46931850773021266,
          0.25846864395311187,
          0.2026571316574408,
          0.18824814652798066,
          0.1815883102027941,
          0.1816193054597747,
          0.17732096114293303,
          0.1701357066631317,
          0.17341794983861836,
          0.1716696304039227,
          0.16866878379588346,
          0.17350880234311317,
          0.1671850169116483,
          0.17138352285618563,
          0.17061942313879602
        ],
        "val_loss": [
          0.3711850362328383,
          0.20051352135263956,
          0.1493751501234678,
          0.14206740947870108,
          0.1296591884814776,
          0.136847461000658,
          0.13282528290381798,
          0.1255137360869692,
          0.119604874903766,
          0.12274833224140681,
          0.11755162491821326,
          0.12101812589053924,
          0.11734926908348615,
          0.12295750077240743,
          0.12101054707398781
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8982143984986151,
            "recall_macro": 0.8954491693994946,
            "f1_macro": 0.8961010703632216,
            "precision_micro": 0.8964885496183206,
            "recall_micro": 0.8964885496183206,
            "f1_micro": 0.8964885496183206,
            "accuracy": 0.8964885496183206,
            "hamming_loss": 0.10351145038167939,
            "no_defect_precision": 0.8789237668161435,
            "no_defect_recall": 0.9272619751626257,
            "no_defect_f1": 0.9024460431654676,
            "no_defect_tp": 1568,
            "no_defect_fp": 216,
            "no_defect_tn": 1368,
            "no_defect_fn": 123,
            "no_defect_support": 1691,
            "defect_precision": 0.9175050301810865,
            "defect_recall": 0.8636363636363636,
            "defect_f1": 0.8897560975609756,
            "defect_tp": 1368,
            "defect_fp": 123,
            "defect_tn": 1568,
            "defect_fn": 216,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9434757640726246,
            "recall_macro": 0.9434211272990102,
            "f1_macro": 0.9434476514499196,
            "precision_micro": 0.9435114503816794,
            "recall_micro": 0.9435114503816794,
            "f1_micro": 0.9435114503816794,
            "accuracy": 0.9435114503816794,
            "hamming_loss": 0.05648854961832061,
            "no_defect_precision": 0.9445100354191264,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.9453471196454948,
            "no_defect_tp": 1600,
            "no_defect_fp": 94,
            "no_defect_tn": 1490,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9424414927261227,
            "defect_recall": 0.9406565656565656,
            "defect_f1": 0.9415481832543444,
            "defect_tp": 1490,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 94,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9534388096638133,
            "recall_macro": 0.9525673276227682,
            "f1_macro": 0.952887276211059,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.944991314418066,
            "no_defect_recall": 0.9651094027202839,
            "no_defect_f1": 0.9549444119368051,
            "no_defect_tp": 1632,
            "no_defect_fp": 95,
            "no_defect_tn": 1489,
            "no_defect_fn": 59,
            "no_defect_support": 1691,
            "defect_precision": 0.9618863049095607,
            "defect_recall": 0.9400252525252525,
            "defect_f1": 0.9508301404853129,
            "defect_tp": 1489,
            "defect_fp": 59,
            "defect_tn": 1632,
            "defect_fn": 95,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954663048141309,
            "recall_macro": 0.9550205260768537,
            "f1_macro": 0.9547814995786945,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9633633633633634,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9558998808104887,
            "no_defect_tp": 1604,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9459627329192547,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9536631183469004,
            "defect_tp": 1523,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9571238421909318,
            "recall_macro": 0.9573460432234826,
            "f1_macro": 0.957217409090027,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.962432915921288,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9584323040380047,
            "no_defect_tp": 1614,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9518147684605757,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9560025141420491,
            "defect_tp": 1521,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9530254129767217,
            "recall_macro": 0.9535060839022992,
            "f1_macro": 0.9529665705015582,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.9706062461726883,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.95367027677497,
            "no_defect_tp": 1585,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.9354445797807551,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9522628642281463,
            "defect_tp": 1536,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9532774969549558,
            "recall_macro": 0.9537618198543687,
            "f1_macro": 0.9532697380857766,
            "precision_micro": 0.9532824427480916,
            "recall_micro": 0.9532824427480916,
            "f1_micro": 0.9532824427480916,
            "accuracy": 0.9532824427480916,
            "hamming_loss": 0.0467175572519084,
            "no_defect_precision": 0.9694749694749695,
            "no_defect_recall": 0.9390892962743939,
            "no_defect_f1": 0.9540402523280265,
            "no_defect_tp": 1588,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 103,
            "no_defect_support": 1691,
            "defect_precision": 0.937080024434942,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9524992238435268,
            "defect_tp": 1534,
            "defect_fp": 103,
            "defect_tn": 1588,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9592913752913753,
            "recall_macro": 0.9597553745617022,
            "f1_macro": 0.9593728130503955,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9721212121212122,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9601915594133493,
            "no_defect_tp": 1604,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9464615384615385,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9585540666874416,
            "defect_tp": 1538,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9588235294117646,
            "recall_macro": 0.9586446965216924,
            "f1_macro": 0.9587268460757108,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.9576470588235294,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9601887348864642,
            "no_defect_tp": 1628,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.96,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.9572649572649573,
            "defect_tp": 1512,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9589440529025453,
            "recall_macro": 0.9593398503067339,
            "f1_macro": 0.9590613390528986,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9686935580975317,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9600238663484487,
            "no_defect_tp": 1609,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9491945477075588,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9580988117573483,
            "defect_tp": 1532,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9615337022407349,
            "recall_macro": 0.9609102930547342,
            "f1_macro": 0.9611563450457798,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9551804423748544,
            "no_defect_recall": 0.9704316972205795,
            "no_defect_f1": 0.9627456732179525,
            "no_defect_tp": 1641,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 50,
            "no_defect_support": 1691,
            "defect_precision": 0.9678869621066153,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.9595670168736071,
            "defect_tp": 1507,
            "defect_fp": 50,
            "defect_tn": 1641,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9613856218221651,
            "recall_macro": 0.9616853409912252,
            "f1_macro": 0.9614995480523707,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9682824655894674,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9625223081499108,
            "no_defect_tp": 1618,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9544887780548629,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9604767879548306,
            "defect_tp": 1531,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9618814192343603,
            "recall_macro": 0.9617013944889463,
            "f1_macro": 0.9617841167367691,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9605882352941176,
            "no_defect_recall": 0.9657007687758723,
            "no_defect_f1": 0.9631377174874668,
            "no_defect_tp": 1633,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 58,
            "no_defect_support": 1691,
            "defect_precision": 0.9631746031746031,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9604305159860715,
            "defect_tp": 1517,
            "defect_fp": 58,
            "defect_tn": 1633,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610801751413567,
            "recall_macro": 0.9614695521148804,
            "f1_macro": 0.9611993647862348,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.970517448856799,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9621234715180436,
            "no_defect_tp": 1613,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9516429014259145,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.960275258054426,
            "defect_tp": 1535,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626050304169431,
            "recall_macro": 0.9629279937159889,
            "f1_macro": 0.9627229810419466,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9700419412822049,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9636904761904762,
            "no_defect_tp": 1619,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9551681195516812,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.961755485893417,
            "defect_tp": 1534,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 50,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9642788590017439,
            "recall_macro": 0.96429945208543,
            "f1_macro": 0.9642847525323366,
            "precision_micro": 0.9642857142857143,
            "recall_micro": 0.9642857142857143,
            "f1_micro": 0.9642857142857143,
            "accuracy": 0.9642857142857143,
            "hamming_loss": 0.03571428571428571,
            "no_defect_precision": 0.9665246500304321,
            "no_defect_recall": 0.9624242424242424,
            "no_defect_f1": 0.9644700880655936,
            "no_defect_tp": 1588,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 62,
            "no_defect_support": 1650,
            "defect_precision": 0.9620330679730558,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.9640994169990794,
            "defect_tp": 1571,
            "defect_fp": 62,
            "defect_tn": 1588,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.1_s100_20251207_135102",
    "lr": 0.005,
    "weight_decay": 0.1,
    "seed": 100,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9614824707671882,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.1_s100_20251207_135102",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s100_20251207_135102",
      "timestamp": "2025-12-07T13:52:55.338528",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 8,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.1_s100",
          "seed": 100,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s100_20251207_135102"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9615221612337105,
        "recall_macro": 0.9614456585368768,
        "f1_macro": 0.9614824707671882,
        "precision_micro": 0.9615267175572519,
        "recall_micro": 0.9615267175572519,
        "f1_micro": 0.9615267175572519,
        "accuracy": 0.9615267175572519,
        "hamming_loss": 0.03847328244274809,
        "no_defect_precision": 0.9616519174041298,
        "no_defect_recall": 0.9639266706091071,
        "no_defect_f1": 0.9627879503839338,
        "no_defect_tp": 1630,
        "no_defect_fp": 65,
        "no_defect_tn": 1519,
        "no_defect_fn": 61,
        "no_defect_support": 1691,
        "defect_precision": 0.9613924050632912,
        "defect_recall": 0.9589646464646465,
        "defect_f1": 0.9601769911504425,
        "defect_tp": 1519,
        "defect_fp": 61,
        "defect_tn": 1630,
        "defect_fn": 65,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9661294080152678,
        "recall_macro": 0.9661042155876105,
        "f1_macro": 0.9661145607699322,
        "precision_micro": 0.9661172161172161,
        "recall_micro": 0.9661172161172161,
        "f1_micro": 0.9661172161172161,
        "accuracy": 0.9661172161172161,
        "hamming_loss": 0.03388278388278388,
        "no_defect_precision": 0.9649546827794562,
        "no_defect_recall": 0.9678787878787879,
        "no_defect_f1": 0.9664145234493192,
        "no_defect_tp": 1597,
        "no_defect_fp": 58,
        "no_defect_tn": 1568,
        "no_defect_fn": 53,
        "no_defect_support": 1650,
        "defect_precision": 0.9673041332510796,
        "defect_recall": 0.964329643296433,
        "defect_f1": 0.9658145980905452,
        "defect_tp": 1568,
        "defect_fp": 53,
        "defect_tn": 1597,
        "defect_fn": 58,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4665272065036965,
          0.2602341758032723,
          0.19772680378109841,
          0.1836971131827542,
          0.1817197019709703,
          0.17862079220835633,
          0.17353375390109657,
          0.17828216816777964,
          0.1774513467086409,
          0.1687832422336275,
          0.17337878869854256,
          0.17127513018861476,
          0.17505122693138642,
          0.16712923634750573,
          0.16743409290722724
        ],
        "val_loss": [
          0.3674931784088795,
          0.20182988334160584,
          0.15095089017771757,
          0.14020737568632916,
          0.1296311108252177,
          0.12884463613423017,
          0.12876669582552636,
          0.1195153436408593,
          0.1262856122249594,
          0.11991739158446972,
          0.12364069544352017,
          0.12150257224073777,
          0.12265157448844267,
          0.1190721127562798,
          0.11957493245315093
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8978659572059323,
            "recall_macro": 0.8936112305790012,
            "f1_macro": 0.8944366443708663,
            "precision_micro": 0.8949618320610687,
            "recall_micro": 0.8949618320610687,
            "f1_micro": 0.8949618320610687,
            "accuracy": 0.8949618320610687,
            "hamming_loss": 0.1050381679389313,
            "no_defect_precision": 0.8710743801652893,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.9018824871648602,
            "no_defect_tp": 1581,
            "no_defect_fp": 234,
            "no_defect_tn": 1350,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9246575342465754,
            "defect_recall": 0.8522727272727273,
            "defect_f1": 0.8869908015768725,
            "defect_tp": 1350,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 234,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.941559616192253,
            "recall_macro": 0.941986579275905,
            "f1_macro": 0.941652733373909,
            "precision_micro": 0.9416793893129771,
            "recall_micro": 0.9416793893129771,
            "f1_micro": 0.9416793893129771,
            "accuracy": 0.9416793893129771,
            "hamming_loss": 0.0583206106870229,
            "no_defect_precision": 0.9534461910519951,
            "no_defect_recall": 0.9325842696629213,
            "no_defect_f1": 0.9428998505231689,
            "no_defect_tp": 1577,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 114,
            "no_defect_support": 1691,
            "defect_precision": 0.9296730413325108,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.940405616224649,
            "defect_tp": 1507,
            "defect_fp": 114,
            "defect_tn": 1577,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9525620412730189,
            "recall_macro": 0.952711062427946,
            "f1_macro": 0.9526293388189515,
            "precision_micro": 0.9526717557251908,
            "recall_micro": 0.9526717557251908,
            "f1_micro": 0.9526717557251908,
            "accuracy": 0.9526717557251908,
            "hamming_loss": 0.04732824427480916,
            "no_defect_precision": 0.9565992865636147,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9540468425733768,
            "no_defect_tp": 1609,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9485247959824231,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.9512118350645263,
            "defect_tp": 1511,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556068439697532,
            "recall_macro": 0.9560473899252728,
            "f1_macro": 0.9557049546555854,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9673518742442564,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.9566517189835575,
            "no_defect_tp": 1600,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9438618136952498,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9547581903276131,
            "defect_tp": 1530,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9586846140179841,
            "recall_macro": 0.9588044848245912,
            "f1_macro": 0.9587401574803149,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.9619952494061758,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.96,
            "no_defect_tp": 1620,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9553739786297926,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9574803149606299,
            "defect_tp": 1520,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556410583735901,
            "recall_macro": 0.9557278133194751,
            "f1_macro": 0.9556822019816483,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9584816132858838,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9570624814924489,
            "no_defect_tp": 1616,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9528005034612964,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9543019224708478,
            "defect_tp": 1514,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556675259308323,
            "recall_macro": 0.9561472576145846,
            "f1_macro": 0.9557103252417337,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9701946472019465,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9565217391304348,
            "no_defect_tp": 1595,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9411404046597179,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9548989113530326,
            "defect_tp": 1535,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9615221612337105,
            "recall_macro": 0.9614456585368768,
            "f1_macro": 0.9614824707671882,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9616519174041298,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.9627879503839338,
            "no_defect_tp": 1630,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9613924050632912,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9601769911504425,
            "defect_tp": 1519,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9577402931632539,
            "recall_macro": 0.9581770917334194,
            "f1_macro": 0.9578427816992059,
            "precision_micro": 0.9578625954198473,
            "recall_micro": 0.9578625954198473,
            "f1_micro": 0.9578625954198473,
            "accuracy": 0.9578625954198473,
            "hamming_loss": 0.04213740458015267,
            "no_defect_precision": 0.9691842900302114,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.958756724447101,
            "no_defect_tp": 1604,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9462962962962963,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9569288389513109,
            "defect_tp": 1533,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9596355245759782,
            "recall_macro": 0.9596715603701116,
            "f1_macro": 0.9596531835066171,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9615156897572528,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9609467455621302,
            "no_defect_tp": 1624,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9577553593947037,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9583596214511041,
            "defect_tp": 1519,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9589395518751954,
            "recall_macro": 0.9592599561552844,
            "f1_macro": 0.9590563890132856,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9664469742360695,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9601190476190476,
            "no_defect_tp": 1613,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9514321295143213,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9579937304075236,
            "defect_tp": 1528,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598569216706774,
            "recall_macro": 0.9601669787765293,
            "f1_macro": 0.9599723984251503,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9670658682634731,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9610235049092531,
            "no_defect_tp": 1615,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9526479750778816,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9589212919410474,
            "defect_tp": 1529,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9595548657256232,
            "recall_macro": 0.9599511899001846,
            "f1_macro": 0.9596723638431537,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9692956050571945,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9606205250596659,
            "no_defect_tp": 1610,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.949814126394052,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9587242026266416,
            "defect_tp": 1533,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.96054491170858,
            "recall_macro": 0.9605985565292188,
            "f1_macro": 0.960570925715988,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9626777251184834,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9618230245634803,
            "no_defect_tp": 1625,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9584120982986768,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9593188268684958,
            "defect_tp": 1521,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9607979896137007,
            "recall_macro": 0.9609941072463248,
            "f1_macro": 0.9608831159136293,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9654556283502085,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9620178041543027,
            "no_defect_tp": 1621,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.956140350877193,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.959748427672956,
            "defect_tp": 1526,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 58,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9661294080152678,
            "recall_macro": 0.9661042155876105,
            "f1_macro": 0.9661145607699322,
            "precision_micro": 0.9661172161172161,
            "recall_micro": 0.9661172161172161,
            "f1_micro": 0.9661172161172161,
            "accuracy": 0.9661172161172161,
            "hamming_loss": 0.03388278388278388,
            "no_defect_precision": 0.9649546827794562,
            "no_defect_recall": 0.9678787878787879,
            "no_defect_f1": 0.9664145234493192,
            "no_defect_tp": 1597,
            "no_defect_fp": 58,
            "no_defect_tn": 1568,
            "no_defect_fn": 53,
            "no_defect_support": 1650,
            "defect_precision": 0.9673041332510796,
            "defect_recall": 0.964329643296433,
            "defect_f1": 0.9658145980905452,
            "defect_tp": 1568,
            "defect_fp": 53,
            "defect_tn": 1597,
            "defect_fn": 58,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.1_s110_20251207_163546",
    "lr": 0.005,
    "weight_decay": 0.1,
    "seed": 110,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9627036898470398,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.1_s110_20251207_163546",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s110_20251207_163546",
      "timestamp": "2025-12-07T16:37:40.439550",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.1_s110",
          "seed": 110,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s110_20251207_163546"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9627655005889018,
        "recall_macro": 0.9626483641859159,
        "f1_macro": 0.9627036898470398,
        "precision_micro": 0.9627480916030534,
        "recall_micro": 0.9627480916030534,
        "f1_micro": 0.9627480916030534,
        "accuracy": 0.9627480916030534,
        "hamming_loss": 0.037251908396946566,
        "no_defect_precision": 0.9622863877430761,
        "no_defect_recall": 0.9657007687758723,
        "no_defect_f1": 0.9639905548996458,
        "no_defect_tp": 1633,
        "no_defect_fp": 64,
        "no_defect_tn": 1520,
        "no_defect_fn": 58,
        "no_defect_support": 1691,
        "defect_precision": 0.9632446134347274,
        "defect_recall": 0.9595959595959596,
        "defect_f1": 0.9614168247944339,
        "defect_tp": 1520,
        "defect_fp": 58,
        "defect_tn": 1633,
        "defect_fn": 64,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.965500642386794,
        "recall_macro": 0.9655115732975512,
        "f1_macro": 0.9655052980715606,
        "precision_micro": 0.9655067155067155,
        "recall_micro": 0.9655067155067155,
        "f1_micro": 0.9655067155067155,
        "accuracy": 0.9655067155067155,
        "hamming_loss": 0.034493284493284496,
        "no_defect_precision": 0.9666059502125076,
        "no_defect_recall": 0.9648484848484848,
        "no_defect_f1": 0.9657264179557173,
        "no_defect_tp": 1592,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 58,
        "no_defect_support": 1650,
        "defect_precision": 0.9643953345610804,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.965284178187404,
        "defect_tp": 1571,
        "defect_fp": 58,
        "defect_tn": 1592,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.47137419349478876,
          0.2594562686636857,
          0.20002096906990188,
          0.18628667148461403,
          0.1792798823205497,
          0.17595811082229454,
          0.18072091869105852,
          0.1741410674503907,
          0.17121064722163906,
          0.1745525358486375,
          0.16927474144861787,
          0.1683039287705302,
          0.16658375613297877,
          0.1724285351650236,
          0.17401784430861972
        ],
        "val_loss": [
          0.37327666122179765,
          0.20002387951199824,
          0.14958827283519965,
          0.13801195515462986,
          0.13832117767574695,
          0.13514607234929615,
          0.12767731620428655,
          0.12966038150569567,
          0.12431671284139156,
          0.12361566994625789,
          0.12094980320678307,
          0.12185826174055155,
          0.11709414035654984,
          0.11895107055226198,
          0.11946254846854852
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8999073652033317,
            "recall_macro": 0.895029725104385,
            "f1_macro": 0.8959202539481119,
            "precision_micro": 0.8964885496183206,
            "recall_micro": 0.8964885496183206,
            "f1_micro": 0.8964885496183206,
            "accuracy": 0.8964885496183206,
            "hamming_loss": 0.10351145038167939,
            "no_defect_precision": 0.8702081051478642,
            "no_defect_recall": 0.9396806623299823,
            "no_defect_f1": 0.903611032129656,
            "no_defect_tp": 1589,
            "no_defect_fp": 237,
            "no_defect_tn": 1347,
            "no_defect_fn": 102,
            "no_defect_support": 1691,
            "defect_precision": 0.9296066252587992,
            "defect_recall": 0.8503787878787878,
            "defect_f1": 0.8882294757665677,
            "defect_tp": 1347,
            "defect_fp": 102,
            "defect_tn": 1589,
            "defect_fn": 237,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9415282957206108,
            "recall_macro": 0.9418467645108686,
            "f1_macro": 0.9416409970398101,
            "precision_micro": 0.9416793893129771,
            "recall_micro": 0.9416793893129771,
            "f1_micro": 0.9416793893129771,
            "accuracy": 0.9416793893129771,
            "hamming_loss": 0.0583206106870229,
            "no_defect_precision": 0.9496402877697842,
            "no_defect_recall": 0.9367238320520402,
            "no_defect_f1": 0.9431378386424532,
            "no_defect_tp": 1584,
            "no_defect_fp": 84,
            "no_defect_tn": 1500,
            "no_defect_fn": 107,
            "no_defect_support": 1691,
            "defect_precision": 0.9334163036714375,
            "defect_recall": 0.946969696969697,
            "defect_f1": 0.940144155437167,
            "defect_tp": 1500,
            "defect_fp": 107,
            "defect_tn": 1584,
            "defect_fn": 84,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540112201963534,
            "recall_macro": 0.9531986407540813,
            "f1_macro": 0.9535015968997578,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9460869565217391,
            "no_defect_recall": 0.9651094027202839,
            "no_defect_f1": 0.955503512880562,
            "no_defect_tp": 1632,
            "no_defect_fp": 93,
            "no_defect_tn": 1491,
            "no_defect_fn": 59,
            "no_defect_support": 1691,
            "defect_precision": 0.9619354838709677,
            "defect_recall": 0.9412878787878788,
            "defect_f1": 0.9514996809189534,
            "defect_tp": 1491,
            "defect_fp": 59,
            "defect_tn": 1632,
            "defect_fn": 93,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9562039819039645,
            "recall_macro": 0.9564390206022376,
            "f1_macro": 0.9563013936246736,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9618138424821002,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9575289575289575,
            "no_defect_tp": 1612,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9505941213258287,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9550738297203896,
            "defect_tp": 1520,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9527087403044834,
            "recall_macro": 0.9531904273366426,
            "f1_macro": 0.9526607215713703,
            "precision_micro": 0.9526717557251908,
            "recall_micro": 0.9526717557251908,
            "f1_micro": 0.9526717557251908,
            "accuracy": 0.9526717557251908,
            "hamming_loss": 0.04732824427480916,
            "no_defect_precision": 0.9700122399020807,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.9533834586466166,
            "no_defect_tp": 1585,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.935405240706886,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.951937984496124,
            "defect_tp": 1535,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9557621893686642,
            "recall_macro": 0.9562471253038964,
            "f1_macro": 0.9557148685667658,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9730722154222766,
            "no_defect_recall": 0.9402720283855707,
            "no_defect_f1": 0.956390977443609,
            "no_defect_tp": 1590,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 101,
            "no_defect_support": 1691,
            "defect_precision": 0.9384521633150518,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9550387596899225,
            "defect_tp": 1540,
            "defect_fp": 101,
            "defect_tn": 1590,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9586332357678933,
            "recall_macro": 0.9589842466653525,
            "f1_macro": 0.9587527676578037,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.9669867947178872,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9597855227882037,
            "no_defect_tp": 1611,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9502796768178993,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9577200125274037,
            "defect_tp": 1529,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9571866783523225,
            "recall_macro": 0.9576656198292803,
            "f1_macro": 0.9572370728184099,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9714285714285714,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.9580335731414868,
            "no_defect_tp": 1598,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.9429447852760736,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9564405724953329,
            "defect_tp": 1537,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598560676598387,
            "recall_macro": 0.9602268993901164,
            "f1_macro": 0.9599761176764179,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.96875,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9609538002980625,
            "no_defect_tp": 1612,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9509621353196772,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9589984350547731,
            "defect_tp": 1532,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9595527936591794,
            "recall_macro": 0.9598513222108728,
            "f1_macro": 0.9596661931977217,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9664871334530222,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9607376561570494,
            "no_defect_tp": 1615,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9526184538653366,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.958594730238394,
            "defect_tp": 1528,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610921802260064,
            "recall_macro": 0.9613297373498437,
            "f1_macro": 0.9611907481841506,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9665871121718377,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9622809622809623,
            "no_defect_tp": 1620,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9555972482801751,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.960100534087339,
            "defect_tp": 1528,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9613825005129353,
            "recall_macro": 0.9617452616048121,
            "f1_macro": 0.96150316856024,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.96996996996997,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9624553039332538,
            "no_defect_tp": 1615,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9527950310559006,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.960551033187226,
            "defect_tp": 1534,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9627655005889018,
            "recall_macro": 0.9626483641859159,
            "f1_macro": 0.9627036898470398,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9622863877430761,
            "no_defect_recall": 0.9657007687758723,
            "no_defect_f1": 0.9639905548996458,
            "no_defect_tp": 1633,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 58,
            "no_defect_support": 1691,
            "defect_precision": 0.9632446134347274,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9614168247944339,
            "defect_tp": 1520,
            "defect_fp": 58,
            "defect_tn": 1633,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9616973262678568,
            "recall_macro": 0.9619610504811569,
            "f1_macro": 0.9618032148280503,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.967741935483871,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.962852897473997,
            "no_defect_tp": 1620,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9556527170518426,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9607535321821036,
            "defect_tp": 1530,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9616973262678568,
            "recall_macro": 0.9619610504811569,
            "f1_macro": 0.9618032148280503,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.967741935483871,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.962852897473997,
            "no_defect_tp": 1620,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9556527170518426,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9607535321821036,
            "defect_tp": 1530,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 54,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.965500642386794,
            "recall_macro": 0.9655115732975512,
            "f1_macro": 0.9655052980715606,
            "precision_micro": 0.9655067155067155,
            "recall_micro": 0.9655067155067155,
            "f1_micro": 0.9655067155067155,
            "accuracy": 0.9655067155067155,
            "hamming_loss": 0.034493284493284496,
            "no_defect_precision": 0.9666059502125076,
            "no_defect_recall": 0.9648484848484848,
            "no_defect_f1": 0.9657264179557173,
            "no_defect_tp": 1592,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 58,
            "no_defect_support": 1650,
            "defect_precision": 0.9643953345610804,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.965284178187404,
            "defect_tp": 1571,
            "defect_fp": 58,
            "defect_tn": 1592,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.1_s120_20251207_165911",
    "lr": 0.005,
    "weight_decay": 0.1,
    "seed": 120,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9624033624315862,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.1_s120_20251207_165911",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s120_20251207_165911",
      "timestamp": "2025-12-07T17:01:08.273698",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.1_s120",
          "seed": 120,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s120_20251207_165911"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9623943031004424,
        "recall_macro": 0.9624126017717088,
        "f1_macro": 0.9624033624315862,
        "precision_micro": 0.962442748091603,
        "recall_micro": 0.962442748091603,
        "f1_micro": 0.962442748091603,
        "accuracy": 0.962442748091603,
        "hamming_loss": 0.03755725190839695,
        "no_defect_precision": 0.9639053254437869,
        "no_defect_recall": 0.9633353045535187,
        "no_defect_f1": 0.963620230700976,
        "no_defect_tp": 1629,
        "no_defect_fp": 61,
        "no_defect_tn": 1523,
        "no_defect_fn": 62,
        "no_defect_support": 1691,
        "defect_precision": 0.9608832807570978,
        "defect_recall": 0.961489898989899,
        "defect_f1": 0.9611864941621963,
        "defect_tp": 1523,
        "defect_fp": 62,
        "defect_tn": 1629,
        "defect_fn": 61,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9664472811151983,
        "recall_macro": 0.9664027731186403,
        "f1_macro": 0.9664192623494663,
        "precision_micro": 0.9664224664224664,
        "recall_micro": 0.9664224664224664,
        "f1_micro": 0.9664224664224664,
        "accuracy": 0.9664224664224664,
        "hamming_loss": 0.033577533577533576,
        "no_defect_precision": 0.9644149577804584,
        "no_defect_recall": 0.9690909090909091,
        "no_defect_f1": 0.9667472793228536,
        "no_defect_tp": 1599,
        "no_defect_fp": 59,
        "no_defect_tn": 1567,
        "no_defect_fn": 51,
        "no_defect_support": 1650,
        "defect_precision": 0.9684796044499382,
        "defect_recall": 0.9637146371463715,
        "defect_f1": 0.9660912453760789,
        "defect_tp": 1567,
        "defect_fp": 51,
        "defect_tn": 1599,
        "defect_fn": 59,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4639290094874394,
          0.2582669631581925,
          0.2079756021437286,
          0.18893403672149492,
          0.18787745648223486,
          0.1789731585175173,
          0.18067724435399268,
          0.17282920918392336,
          0.1717145646216979,
          0.17309182196481457,
          0.16999268089128838,
          0.16767647790734239,
          0.17108574858769213,
          0.1712770094962549,
          0.16889522701626541
        ],
        "val_loss": [
          0.3697025426305257,
          0.1952925450526751,
          0.1532161241540542,
          0.14215303455980924,
          0.1282498982663338,
          0.1290084423067478,
          0.12056324788584159,
          0.1189390944603544,
          0.12546615503155267,
          0.12019844224246648,
          0.12550660294408983,
          0.1204566853837325,
          0.11967885537216297,
          0.11824168673215005,
          0.11865407636818978
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8984885175600962,
            "recall_macro": 0.8957648259651512,
            "f1_macro": 0.8964114248667232,
            "precision_micro": 0.896793893129771,
            "recall_micro": 0.896793893129771,
            "f1_micro": 0.896793893129771,
            "accuracy": 0.896793893129771,
            "hamming_loss": 0.103206106870229,
            "no_defect_precision": 0.8794167134043747,
            "no_defect_recall": 0.9272619751626257,
            "no_defect_f1": 0.9027058146229131,
            "no_defect_tp": 1568,
            "no_defect_fp": 215,
            "no_defect_tn": 1369,
            "no_defect_fn": 123,
            "no_defect_support": 1691,
            "defect_precision": 0.9175603217158177,
            "defect_recall": 0.8642676767676768,
            "defect_f1": 0.8901170351105332,
            "defect_tp": 1369,
            "defect_fp": 123,
            "defect_tn": 1568,
            "defect_fn": 215,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9447509267381435,
            "recall_macro": 0.9440684939280445,
            "f1_macro": 0.9443300629054878,
            "precision_micro": 0.9444274809160306,
            "recall_micro": 0.9444274809160306,
            "f1_micro": 0.9444274809160306,
            "accuracy": 0.9444274809160306,
            "hamming_loss": 0.055572519083969464,
            "no_defect_precision": 0.9384079023823358,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9466588511137163,
            "no_defect_tp": 1615,
            "no_defect_fp": 106,
            "no_defect_tn": 1478,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9510939510939511,
            "defect_recall": 0.9330808080808081,
            "defect_f1": 0.9420012746972594,
            "defect_tp": 1478,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 106,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9519633322943553,
            "recall_macro": 0.9514844632009032,
            "f1_macro": 0.9516807570167254,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.9474605954465849,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9535840188014101,
            "no_defect_tp": 1623,
            "no_defect_fp": 90,
            "no_defect_tn": 1494,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9564660691421255,
            "defect_recall": 0.9431818181818182,
            "defect_f1": 0.9497774952320407,
            "defect_tp": 1494,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 90,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9539301199301558,
            "recall_macro": 0.9544131065235442,
            "f1_macro": 0.9538823803695284,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9712362301101591,
            "no_defect_recall": 0.9384979302188055,
            "no_defect_f1": 0.9545864661654135,
            "no_defect_tp": 1587,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 104,
            "no_defect_support": 1691,
            "defect_precision": 0.9366240097501524,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9531782945736434,
            "defect_tp": 1537,
            "defect_fp": 104,
            "defect_tn": 1587,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9595974148085697,
            "recall_macro": 0.959136194887969,
            "f1_macro": 0.9593271829441508,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9550233644859814,
            "no_defect_recall": 0.9668835008870491,
            "no_defect_f1": 0.9609168380840435,
            "no_defect_tp": 1635,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 56,
            "no_defect_support": 1691,
            "defect_precision": 0.964171465131158,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.957737527804258,
            "defect_tp": 1507,
            "defect_fp": 56,
            "defect_tn": 1635,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9561935850635965,
            "recall_macro": 0.9565788353672742,
            "f1_macro": 0.9563110957829257,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9657039711191335,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9573516254100806,
            "no_defect_tp": 1605,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9466831990080595,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.955270566155771,
            "defect_tp": 1527,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9614011402147735,
            "recall_macro": 0.961625420377638,
            "f1_macro": 0.9614956681810243,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9666070363744782,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9625890736342043,
            "no_defect_tp": 1621,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9561952440550688,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9604022627278441,
            "defect_tp": 1528,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9587264106919531,
            "recall_macro": 0.9587445642110042,
            "f1_macro": 0.9587353977907653,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.9603550295857988,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9600709849157054,
            "no_defect_tp": 1623,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9570977917981073,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9573998106658251,
            "defect_tp": 1517,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9580954853069406,
            "recall_macro": 0.9585726424505253,
            "f1_macro": 0.9581529411951242,
            "precision_micro": 0.9581679389312977,
            "recall_micro": 0.9581679389312977,
            "f1_micro": 0.9581679389312977,
            "accuracy": 0.9581679389312977,
            "hamming_loss": 0.04183206106870229,
            "no_defect_precision": 0.9720534629404617,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.958945160323644,
            "no_defect_tp": 1600,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9441375076734193,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9573607220666044,
            "defect_tp": 1538,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610994019627086,
            "recall_macro": 0.9613097638119814,
            "f1_macro": 0.9611894010416739,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.966030989272944,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9623033541110122,
            "no_defect_tp": 1621,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9561678146524734,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9600754479723358,
            "defect_tp": 1527,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9601701863224297,
            "recall_macro": 0.9605825030314977,
            "f1_macro": 0.9602845149253731,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9704641350210971,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9611940298507463,
            "no_defect_tp": 1610,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9498762376237624,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.959375,
            "defect_tp": 1535,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9601637363801747,
            "recall_macro": 0.9604626618043235,
            "f1_macro": 0.9602773114826046,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9670855774985039,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9613325401546698,
            "no_defect_tp": 1616,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9532418952618454,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9592220828105396,
            "defect_tp": 1529,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9601725746268657,
            "recall_macro": 0.9604227147285989,
            "f1_macro": 0.9602746725308061,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9659701492537314,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9613784907902555,
            "no_defect_tp": 1618,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.954375,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9591708542713567,
            "defect_tp": 1527,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623943031004424,
            "recall_macro": 0.9624126017717088,
            "f1_macro": 0.9624033624315862,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9639053254437869,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.963620230700976,
            "no_defect_tp": 1629,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9608832807570978,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9611864941621963,
            "defect_tp": 1523,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9614545740952819,
            "recall_macro": 0.9615255526883262,
            "f1_macro": 0.9614886249353244,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.963841138114997,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9626998223801065,
            "no_defect_tp": 1626,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9590680100755667,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9602774274905422,
            "defect_tp": 1523,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 61,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9664472811151983,
            "recall_macro": 0.9664027731186403,
            "f1_macro": 0.9664192623494663,
            "precision_micro": 0.9664224664224664,
            "recall_micro": 0.9664224664224664,
            "f1_micro": 0.9664224664224664,
            "accuracy": 0.9664224664224664,
            "hamming_loss": 0.033577533577533576,
            "no_defect_precision": 0.9644149577804584,
            "no_defect_recall": 0.9690909090909091,
            "no_defect_f1": 0.9667472793228536,
            "no_defect_tp": 1599,
            "no_defect_fp": 59,
            "no_defect_tn": 1567,
            "no_defect_fn": 51,
            "no_defect_support": 1650,
            "defect_precision": 0.9684796044499382,
            "defect_recall": 0.9637146371463715,
            "defect_f1": 0.9660912453760789,
            "defect_tp": 1567,
            "defect_fp": 51,
            "defect_tn": 1599,
            "defect_fn": 59,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.1_s130_20251207_145720",
    "lr": 0.005,
    "weight_decay": 0.1,
    "seed": 130,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9627126280770597,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.1_s130_20251207_145720",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s130_20251207_145720",
      "timestamp": "2025-12-07T14:59:15.944436",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.1_s130",
          "seed": 130,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s130_20251207_145720"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9626635313438964,
        "recall_macro": 0.96276820541309,
        "f1_macro": 0.9627126280770597,
        "precision_micro": 0.9627480916030534,
        "recall_micro": 0.9627480916030534,
        "f1_micro": 0.9627480916030534,
        "accuracy": 0.9627480916030534,
        "hamming_loss": 0.037251908396946566,
        "no_defect_precision": 0.9655786350148368,
        "no_defect_recall": 0.9621525724423418,
        "no_defect_f1": 0.9638625592417062,
        "no_defect_tp": 1627,
        "no_defect_fp": 58,
        "no_defect_tn": 1526,
        "no_defect_fn": 64,
        "no_defect_support": 1691,
        "defect_precision": 0.959748427672956,
        "defect_recall": 0.9633838383838383,
        "defect_f1": 0.9615626969124134,
        "defect_tp": 1526,
        "defect_fp": 64,
        "defect_tn": 1627,
        "defect_fn": 58,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9682790560357617,
        "recall_macro": 0.9682343732528235,
        "f1_macro": 0.9682509389485863,
        "precision_micro": 0.9682539682539683,
        "recall_micro": 0.9682539682539683,
        "f1_micro": 0.9682539682539683,
        "accuracy": 0.9682539682539683,
        "hamming_loss": 0.031746031746031744,
        "no_defect_precision": 0.9662243667068757,
        "no_defect_recall": 0.9709090909090909,
        "no_defect_f1": 0.9685610640870617,
        "no_defect_tp": 1602,
        "no_defect_fp": 56,
        "no_defect_tn": 1570,
        "no_defect_fn": 48,
        "no_defect_support": 1650,
        "defect_precision": 0.9703337453646477,
        "defect_recall": 0.965559655596556,
        "defect_f1": 0.967940813810111,
        "defect_tp": 1570,
        "defect_fp": 48,
        "defect_tn": 1602,
        "defect_fn": 56,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.4614295241224217,
          0.25938950011420947,
          0.2016438406319299,
          0.18690533639870927,
          0.1793162408732969,
          0.17902467446596554,
          0.17278551763882197,
          0.17463521634435056,
          0.1775204360516251,
          0.17252596852732005,
          0.17123534106435137,
          0.17328375961366557,
          0.17397327892575803,
          0.174027637208356,
          0.17006183864556595
        ],
        "val_loss": [
          0.3716874191394219,
          0.197092762360206,
          0.14835614925966814,
          0.13712387574979892,
          0.14101821456391078,
          0.13362991050458872,
          0.12123988124613579,
          0.12535517963652426,
          0.12832546019210264,
          0.12478308995755819,
          0.11953927820118573,
          0.11878453603444192,
          0.12004783814056562,
          0.11906460078003314,
          0.11947124651991405
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8953738152435194,
            "recall_macro": 0.8896835370260858,
            "f1_macro": 0.8906241674152893,
            "precision_micro": 0.8912977099236641,
            "recall_micro": 0.8912977099236641,
            "f1_micro": 0.8912977099236641,
            "accuracy": 0.8912977099236641,
            "hamming_loss": 0.10870229007633588,
            "no_defect_precision": 0.8625746876697447,
            "no_defect_recall": 0.9390892962743939,
            "no_defect_f1": 0.89920724801812,
            "no_defect_tp": 1588,
            "no_defect_fp": 253,
            "no_defect_tn": 1331,
            "no_defect_fn": 103,
            "no_defect_support": 1691,
            "defect_precision": 0.9281729428172942,
            "defect_recall": 0.8402777777777778,
            "defect_f1": 0.8820410868124586,
            "defect_tp": 1331,
            "defect_fp": 103,
            "defect_tn": 1588,
            "defect_fn": 253,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9439814987504196,
            "recall_macro": 0.9443720170361212,
            "f1_macro": 0.9440920296545222,
            "precision_micro": 0.9441221374045802,
            "recall_micro": 0.9441221374045802,
            "f1_micro": 0.9441221374045802,
            "accuracy": 0.9441221374045802,
            "hamming_loss": 0.055877862595419846,
            "no_defect_precision": 0.9542168674698795,
            "no_defect_recall": 0.9367238320520402,
            "no_defect_f1": 0.945389435989257,
            "no_defect_tp": 1584,
            "no_defect_fp": 76,
            "no_defect_tn": 1508,
            "no_defect_fn": 107,
            "no_defect_support": 1691,
            "defect_precision": 0.9337461300309597,
            "defect_recall": 0.952020202020202,
            "defect_f1": 0.9427946233197875,
            "defect_tp": 1508,
            "defect_fp": 107,
            "defect_tn": 1584,
            "defect_fn": 76,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9559737026427564,
            "recall_macro": 0.9549727389208466,
            "f1_macro": 0.9553298500301195,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9462738301559792,
            "no_defect_recall": 0.9686575990538143,
            "no_defect_f1": 0.9573348918760959,
            "no_defect_tp": 1638,
            "no_defect_fp": 93,
            "no_defect_tn": 1491,
            "no_defect_fn": 53,
            "no_defect_support": 1691,
            "defect_precision": 0.9656735751295337,
            "defect_recall": 0.9412878787878788,
            "defect_f1": 0.9533248081841432,
            "defect_tp": 1491,
            "defect_fp": 53,
            "defect_tn": 1638,
            "defect_fn": 93,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9577871006466698,
            "recall_macro": 0.9578575151276216,
            "f1_macro": 0.9578208749291648,
            "precision_micro": 0.9578625954198473,
            "recall_micro": 0.9578625954198473,
            "f1_micro": 0.9578625954198473,
            "accuracy": 0.9578625954198473,
            "hamming_loss": 0.04213740458015267,
            "no_defect_precision": 0.9602845287492591,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9591474245115453,
            "no_defect_tp": 1620,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9552896725440806,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9564943253467844,
            "defect_tp": 1517,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.953049082481901,
            "recall_macro": 0.9535260574401616,
            "f1_macro": 0.9529674126229926,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.9711833231146536,
            "no_defect_recall": 0.9367238320520402,
            "no_defect_f1": 0.9536423841059603,
            "no_defect_tp": 1584,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 107,
            "no_defect_support": 1691,
            "defect_precision": 0.9349148418491484,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9522924411400248,
            "defect_tp": 1537,
            "defect_fp": 107,
            "defect_tn": 1584,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9544312644377762,
            "recall_macro": 0.9549046048898207,
            "f1_macro": 0.9544875053873978,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.968408262454435,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.9553491159724303,
            "no_defect_tp": 1594,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.9404542664211173,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9536258948023654,
            "defect_tp": 1532,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9611420673118197,
            "recall_macro": 0.9612298696605319,
            "f1_macro": 0.9611837217356507,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9638196915776986,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9623926562037312,
            "no_defect_tp": 1625,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9584644430459408,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9599747872675701,
            "defect_tp": 1523,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.958343746013653,
            "recall_macro": 0.9587684577890078,
            "f1_macro": 0.9584526397405445,
            "precision_micro": 0.9584732824427481,
            "recall_micro": 0.9584732824427481,
            "f1_micro": 0.9584732824427481,
            "accuracy": 0.9584732824427481,
            "hamming_loss": 0.04152671755725191,
            "no_defect_precision": 0.9692214846107423,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.959378733572282,
            "no_defect_tp": 1606,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9474660074165636,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.957526545908807,
            "defect_tp": 1533,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9550284638473335,
            "recall_macro": 0.9554959709454092,
            "f1_macro": 0.955097355983461,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9684466019417476,
            "no_defect_recall": 0.9438202247191011,
            "no_defect_f1": 0.9559748427672956,
            "no_defect_tp": 1596,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 95,
            "no_defect_support": 1691,
            "defect_precision": 0.9416103257529195,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9542198691996263,
            "defect_tp": 1532,
            "defect_fp": 95,
            "defect_tn": 1596,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9592441078358006,
            "recall_macro": 0.9595955862588033,
            "f1_macro": 0.959363837766577,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9675870348139256,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9603812928209711,
            "no_defect_tp": 1612,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9509011808576756,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9583463827121829,
            "defect_tp": 1530,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9615031926658666,
            "recall_macro": 0.9614656320747391,
            "f1_macro": 0.9614840526337012,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9621972829297105,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9627659574468085,
            "no_defect_tp": 1629,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9608091024020228,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9602021478205938,
            "defect_tp": 1520,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598296480279283,
            "recall_macro": 0.9594917985293503,
            "f1_macro": 0.9596377235937532,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9566490919742238,
            "no_defect_recall": 0.9657007687758723,
            "no_defect_f1": 0.9611536197763391,
            "no_defect_tp": 1633,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 58,
            "no_defect_support": 1691,
            "defect_precision": 0.9630102040816326,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9581218274111675,
            "defect_tp": 1510,
            "defect_fp": 58,
            "defect_tn": 1633,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9611179782535513,
            "recall_macro": 0.9612698167362568,
            "f1_macro": 0.9611866195484313,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.964922711058264,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9623480581085088,
            "no_defect_tp": 1623,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9573132454488387,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9600251809883538,
            "defect_tp": 1525,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626635313438964,
            "recall_macro": 0.96276820541309,
            "f1_macro": 0.9627126280770597,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9655786350148368,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9638625592417062,
            "no_defect_tp": 1627,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.959748427672956,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9615626969124134,
            "defect_tp": 1526,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9617190998656515,
            "recall_macro": 0.9619011298675698,
            "f1_macro": 0.9617992370391986,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9660714285714286,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9629190151290419,
            "no_defect_tp": 1623,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9573667711598746,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9606794589493551,
            "defect_tp": 1527,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 57,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9682790560357617,
            "recall_macro": 0.9682343732528235,
            "f1_macro": 0.9682509389485863,
            "precision_micro": 0.9682539682539683,
            "recall_micro": 0.9682539682539683,
            "f1_micro": 0.9682539682539683,
            "accuracy": 0.9682539682539683,
            "hamming_loss": 0.031746031746031744,
            "no_defect_precision": 0.9662243667068757,
            "no_defect_recall": 0.9709090909090909,
            "no_defect_f1": 0.9685610640870617,
            "no_defect_tp": 1602,
            "no_defect_fp": 56,
            "no_defect_tn": 1570,
            "no_defect_fn": 48,
            "no_defect_support": 1650,
            "defect_precision": 0.9703337453646477,
            "defect_recall": 0.965559655596556,
            "defect_f1": 0.967940813810111,
            "defect_tp": 1570,
            "defect_fp": 48,
            "defect_tn": 1602,
            "defect_fn": 56,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.1_s140_20251207_164723",
    "lr": 0.005,
    "weight_decay": 0.1,
    "seed": 140,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9624090882240712,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.1_s140_20251207_164723",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s140_20251207_164723",
      "timestamp": "2025-12-07T16:49:19.590737",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.1_s140",
          "seed": 140,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s140_20251207_164723"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9623402549650559,
        "recall_macro": 0.9624924959231582,
        "f1_macro": 0.9624090882240712,
        "precision_micro": 0.962442748091603,
        "recall_micro": 0.962442748091603,
        "f1_micro": 0.962442748091603,
        "accuracy": 0.962442748091603,
        "hamming_loss": 0.03755725190839695,
        "no_defect_precision": 0.9661117717003567,
        "no_defect_recall": 0.960969840331165,
        "no_defect_f1": 0.9635339460420991,
        "no_defect_tp": 1625,
        "no_defect_fp": 57,
        "no_defect_tn": 1527,
        "no_defect_fn": 66,
        "no_defect_support": 1691,
        "defect_precision": 0.9585687382297552,
        "defect_recall": 0.9640151515151515,
        "defect_f1": 0.9612842304060434,
        "defect_tp": 1527,
        "defect_fp": 66,
        "defect_tn": 1625,
        "defect_fn": 57,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.967668464395574,
        "recall_macro": 0.9676238398747624,
        "f1_macro": 0.967640380082213,
        "precision_micro": 0.9676434676434676,
        "recall_micro": 0.9676434676434676,
        "f1_micro": 0.9676434676434676,
        "accuracy": 0.9676434676434676,
        "hamming_loss": 0.03235653235653236,
        "no_defect_precision": 0.96562123039807,
        "no_defect_recall": 0.9703030303030303,
        "no_defect_f1": 0.967956469165659,
        "no_defect_tp": 1601,
        "no_defect_fp": 57,
        "no_defect_tn": 1569,
        "no_defect_fn": 49,
        "no_defect_support": 1650,
        "defect_precision": 0.9697156983930779,
        "defect_recall": 0.9649446494464945,
        "defect_f1": 0.9673242909987669,
        "defect_tp": 1569,
        "defect_fp": 49,
        "defect_tn": 1601,
        "defect_fn": 57,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.46256238315644127,
          0.2597594186351888,
          0.20076992861521295,
          0.1831240524619693,
          0.1776802172284246,
          0.1811500592274147,
          0.17502739844711257,
          0.17492547413045892,
          0.1741090025674848,
          0.17116294146581673,
          0.16429524005207558,
          0.17056865488260858,
          0.16737273082947632,
          0.16848046206343123,
          0.16758886846288976
        ],
        "val_loss": [
          0.371642251427357,
          0.19654081360651895,
          0.14637014355797034,
          0.13588807860819194,
          0.12774140359117434,
          0.1235562927591113,
          0.1288122435172017,
          0.13853468344761774,
          0.12510403310163662,
          0.11862457543611526,
          0.11828474872387372,
          0.11504368849385244,
          0.11950009523962553,
          0.11588596767530991,
          0.11565660463216212
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8979579232305841,
            "recall_macro": 0.8921089218620265,
            "f1_macro": 0.8930716990988637,
            "precision_micro": 0.8937404580152671,
            "recall_micro": 0.8937404580152671,
            "f1_micro": 0.8937404580152671,
            "accuracy": 0.8937404580152671,
            "hamming_loss": 0.10625954198473282,
            "no_defect_precision": 0.8643516006511123,
            "no_defect_recall": 0.9420461265523359,
            "no_defect_f1": 0.9015280135823429,
            "no_defect_tp": 1593,
            "no_defect_fp": 250,
            "no_defect_tn": 1334,
            "no_defect_fn": 98,
            "no_defect_support": 1691,
            "defect_precision": 0.9315642458100558,
            "defect_recall": 0.8421717171717171,
            "defect_f1": 0.8846153846153846,
            "defect_tp": 1334,
            "defect_fp": 98,
            "defect_tn": 1593,
            "defect_fn": 250,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9421675365246833,
            "recall_macro": 0.9412275848371354,
            "f1_macro": 0.9415632527050555,
            "precision_micro": 0.9416793893129771,
            "recall_micro": 0.9416793893129771,
            "f1_micro": 0.9416793893129771,
            "accuracy": 0.9416793893129771,
            "hamming_loss": 0.0583206106870229,
            "no_defect_precision": 0.9335260115606936,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9441683718211049,
            "no_defect_tp": 1615,
            "no_defect_fp": 115,
            "no_defect_tn": 1469,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9508090614886732,
            "defect_recall": 0.92739898989899,
            "defect_f1": 0.938958133589006,
            "defect_tp": 1469,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 115,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9557040624834311,
            "recall_macro": 0.9556479191680256,
            "f1_macro": 0.9556751862715587,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9563164108618654,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9571639586410635,
            "no_defect_tp": 1620,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9550917141049968,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9541864139020537,
            "defect_tp": 1510,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552791759640771,
            "recall_macro": 0.9556718127460292,
            "f1_macro": 0.9553951903113671,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9650812763395545,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9564439140811456,
            "no_defect_tp": 1603,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9454770755885997,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9543464665415885,
            "defect_tp": 1526,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9574116686737728,
            "recall_macro": 0.9577415939405887,
            "f1_macro": 0.9575293119818513,
            "precision_micro": 0.9575572519083969,
            "recall_micro": 0.9575572519083969,
            "f1_micro": 0.9575572519083969,
            "accuracy": 0.9575572519083969,
            "hamming_loss": 0.042442748091603054,
            "no_defect_precision": 0.9652278177458034,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9586186364989581,
            "no_defect_tp": 1610,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9495955196017424,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9564399874647446,
            "defect_tp": 1526,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9574114916320786,
            "recall_macro": 0.957761567478451,
            "f1_macro": 0.9575306274402572,
            "precision_micro": 0.9575572519083969,
            "recall_micro": 0.9575572519083969,
            "f1_micro": 0.9575572519083969,
            "accuracy": 0.9575572519083969,
            "hamming_loss": 0.042442748091603054,
            "no_defect_precision": 0.9657863145258103,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.958593982722669,
            "no_defect_tp": 1609,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9490366687383468,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9564672721578453,
            "defect_tp": 1527,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9573239589999716,
            "recall_macro": 0.9578054345943169,
            "f1_macro": 0.9572431023845387,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9754751686082158,
            "no_defect_recall": 0.9408633944411591,
            "no_defect_f1": 0.9578567128236002,
            "no_defect_tp": 1591,
            "no_defect_fp": 40,
            "no_defect_tn": 1544,
            "no_defect_fn": 100,
            "no_defect_support": 1691,
            "defect_precision": 0.9391727493917275,
            "defect_recall": 0.9747474747474747,
            "defect_f1": 0.9566294919454771,
            "defect_tp": 1544,
            "defect_fp": 100,
            "defect_tn": 1591,
            "defect_fn": 40,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9502285447761194,
            "recall_macro": 0.9504732795130488,
            "f1_macro": 0.9496171180683854,
            "precision_micro": 0.9496183206106871,
            "recall_micro": 0.9496183206106871,
            "f1_micro": 0.9496183206106871,
            "accuracy": 0.9496183206106871,
            "hamming_loss": 0.050381679389312976,
            "no_defect_precision": 0.976875,
            "no_defect_recall": 0.9243051448846836,
            "no_defect_f1": 0.9498632634457612,
            "no_defect_tp": 1563,
            "no_defect_fp": 37,
            "no_defect_tn": 1547,
            "no_defect_fn": 128,
            "no_defect_support": 1691,
            "defect_precision": 0.9235820895522389,
            "defect_recall": 0.9766414141414141,
            "defect_f1": 0.9493709726910096,
            "defect_tp": 1547,
            "defect_fp": 128,
            "defect_tn": 1563,
            "defect_fn": 37,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9574996158671483,
            "recall_macro": 0.9579812763949369,
            "f1_macro": 0.9575430014386275,
            "precision_micro": 0.9575572519083969,
            "recall_micro": 0.9575572519083969,
            "f1_micro": 0.9575572519083969,
            "accuracy": 0.9575572519083969,
            "hamming_loss": 0.042442748091603054,
            "no_defect_precision": 0.9720194647201946,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.9583208395802099,
            "no_defect_tp": 1598,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.9429797670141018,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9567651632970451,
            "defect_tp": 1538,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9605181536284116,
            "recall_macro": 0.9606385036049436,
            "f1_macro": 0.9605739282589676,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9637767220902613,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9617777777777777,
            "no_defect_tp": 1623,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.957259585166562,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9593700787401575,
            "defect_tp": 1523,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9595495080088461,
            "recall_macro": 0.9598912692865975,
            "f1_macro": 0.9596687519871746,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9676064787042592,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9606908874329958,
            "no_defect_tp": 1613,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9514925373134329,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9586466165413534,
            "defect_tp": 1530,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623402549650559,
            "recall_macro": 0.9624924959231582,
            "f1_macro": 0.9624090882240712,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9661117717003567,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9635339460420991,
            "no_defect_tp": 1625,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9585687382297552,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9612842304060434,
            "defect_tp": 1527,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9613976141969529,
            "recall_macro": 0.9618251557562616,
            "f1_macro": 0.9615075927007986,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9722389861194931,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9623655913978495,
            "no_defect_tp": 1611,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9505562422744128,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9606495940037476,
            "defect_tp": 1538,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620121827896081,
            "recall_macro": 0.9622367599710888,
            "f1_macro": 0.9621068480511666,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9672033392963626,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9631828978622328,
            "no_defect_tp": 1622,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9568210262828536,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9610307982401005,
            "defect_tp": 1529,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620121827896081,
            "recall_macro": 0.9622367599710888,
            "f1_macro": 0.9621068480511666,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9672033392963626,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9631828978622328,
            "no_defect_tp": 1622,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9568210262828536,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9610307982401005,
            "defect_tp": 1529,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 55,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.967668464395574,
            "recall_macro": 0.9676238398747624,
            "f1_macro": 0.967640380082213,
            "precision_micro": 0.9676434676434676,
            "recall_micro": 0.9676434676434676,
            "f1_micro": 0.9676434676434676,
            "accuracy": 0.9676434676434676,
            "hamming_loss": 0.03235653235653236,
            "no_defect_precision": 0.96562123039807,
            "no_defect_recall": 0.9703030303030303,
            "no_defect_f1": 0.967956469165659,
            "no_defect_tp": 1601,
            "no_defect_fp": 57,
            "no_defect_tn": 1569,
            "no_defect_fn": 49,
            "no_defect_support": 1650,
            "defect_precision": 0.9697156983930779,
            "defect_recall": 0.9649446494464945,
            "defect_f1": 0.9673242909987669,
            "defect_tp": 1569,
            "defect_fp": 49,
            "defect_tn": 1601,
            "defect_fn": 57,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.005_wd0.1_s150_20251207_200831",
    "lr": 0.005,
    "weight_decay": 0.1,
    "seed": 150,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9633196243929538,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.005_wd0.1_s150_20251207_200831",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s150_20251207_200831",
      "timestamp": "2025-12-07T20:10:23.345967",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.005,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.005,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.005_wd0.1_s150",
          "seed": 150,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.1_s150_20251207_200831"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9633196243929538,
        "recall_macro": 0.9633196243929538,
        "f1_macro": 0.9633196243929538,
        "precision_micro": 0.9633587786259542,
        "recall_micro": 0.9633587786259542,
        "f1_micro": 0.9633587786259542,
        "accuracy": 0.9633587786259542,
        "hamming_loss": 0.0366412213740458,
        "no_defect_precision": 0.9645180366646955,
        "no_defect_recall": 0.9645180366646955,
        "no_defect_f1": 0.9645180366646955,
        "no_defect_tp": 1631,
        "no_defect_fp": 60,
        "no_defect_tn": 1524,
        "no_defect_fn": 60,
        "no_defect_support": 1691,
        "defect_precision": 0.9621212121212122,
        "defect_recall": 0.9621212121212122,
        "defect_f1": 0.9621212121212122,
        "defect_tp": 1524,
        "defect_fp": 60,
        "defect_tn": 1631,
        "defect_fn": 60,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9667574739907471,
        "recall_macro": 0.9667058034216707,
        "f1_macro": 0.9667243402276022,
        "precision_micro": 0.9667277167277167,
        "recall_micro": 0.9667277167277167,
        "f1_micro": 0.9667277167277167,
        "accuracy": 0.9667277167277167,
        "hamming_loss": 0.03327228327228327,
        "no_defect_precision": 0.9644364074743822,
        "no_defect_recall": 0.9696969696969697,
        "no_defect_f1": 0.967059534602599,
        "no_defect_tp": 1600,
        "no_defect_fp": 59,
        "no_defect_tn": 1567,
        "no_defect_fn": 50,
        "no_defect_support": 1650,
        "defect_precision": 0.969078540507112,
        "defect_recall": 0.9637146371463715,
        "defect_f1": 0.9663891458526056,
        "defect_tp": 1567,
        "defect_fp": 50,
        "defect_tn": 1600,
        "defect_fn": 59,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.46512086184453766,
          0.2615448225866302,
          0.1972285823654929,
          0.1835514291746846,
          0.18409656150321083,
          0.18008555955093775,
          0.18183417689974837,
          0.1773359840385086,
          0.17386175810542565,
          0.16995921528364324,
          0.1666711314452742,
          0.174335048319655,
          0.17287268174742057,
          0.1702743835404328,
          0.1670397058846312
        ],
        "val_loss": [
          0.3714270018614255,
          0.1976514567549412,
          0.14828777470840857,
          0.1451227143406868,
          0.13162929593370512,
          0.12182583172733967,
          0.1275846569870527,
          0.12112877840319505,
          0.11873911679364167,
          0.1187836413200085,
          0.11857573630718085,
          0.11696950647120292,
          0.11844708448132643,
          0.11723234540281388,
          0.11764875935533872
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.8938062556255626,
            "recall_macro": 0.8920208142931383,
            "f1_macro": 0.8925140039659085,
            "precision_micro": 0.8928244274809161,
            "recall_micro": 0.8928244274809161,
            "f1_micro": 0.8928244274809161,
            "accuracy": 0.8928244274809161,
            "hamming_loss": 0.10717557251908397,
            "no_defect_precision": 0.8806818181818182,
            "no_defect_recall": 0.9166173861620343,
            "no_defect_f1": 0.8982903506230078,
            "no_defect_tp": 1550,
            "no_defect_fp": 210,
            "no_defect_tn": 1374,
            "no_defect_fn": 141,
            "no_defect_support": 1691,
            "defect_precision": 0.906930693069307,
            "defect_recall": 0.8674242424242424,
            "defect_f1": 0.8867376573088093,
            "defect_tp": 1374,
            "defect_fp": 141,
            "defect_tn": 1550,
            "defect_fn": 210,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9438091749176396,
            "recall_macro": 0.943696836788942,
            "f1_macro": 0.9437498273102896,
            "precision_micro": 0.9438167938931298,
            "recall_micro": 0.9438167938931298,
            "f1_micro": 0.9438167938931298,
            "accuracy": 0.9438167938931298,
            "hamming_loss": 0.05618320610687023,
            "no_defect_precision": 0.9440188568061285,
            "no_defect_recall": 0.9473684210526315,
            "no_defect_f1": 0.9456906729634003,
            "no_defect_tp": 1602,
            "no_defect_fp": 95,
            "no_defect_tn": 1489,
            "no_defect_fn": 89,
            "no_defect_support": 1691,
            "defect_precision": 0.9435994930291508,
            "defect_recall": 0.9400252525252525,
            "defect_f1": 0.941808981657179,
            "defect_tp": 1489,
            "defect_fp": 89,
            "defect_tn": 1602,
            "defect_fn": 95,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9548835388530045,
            "recall_macro": 0.9546410288574688,
            "f1_macro": 0.9547494161395679,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9530240751614797,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9563936358279317,
            "no_defect_tp": 1623,
            "no_defect_fp": 80,
            "no_defect_tn": 1504,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9567430025445293,
            "defect_recall": 0.9494949494949495,
            "defect_f1": 0.9531051964512041,
            "defect_tp": 1504,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 80,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9535751213005568,
            "recall_macro": 0.9539815287708546,
            "f1_macro": 0.9532779820899631,
            "precision_micro": 0.9532824427480916,
            "recall_micro": 0.9532824427480916,
            "f1_micro": 0.9532824427480916,
            "accuracy": 0.9532824427480916,
            "hamming_loss": 0.0467175572519084,
            "no_defect_precision": 0.9758663366336634,
            "no_defect_recall": 0.9325842696629213,
            "no_defect_f1": 0.9537345025703055,
            "no_defect_tp": 1577,
            "no_defect_fp": 39,
            "no_defect_tn": 1545,
            "no_defect_fn": 114,
            "no_defect_support": 1691,
            "defect_precision": 0.9312839059674503,
            "defect_recall": 0.9753787878787878,
            "defect_f1": 0.9528214616096207,
            "defect_tp": 1545,
            "defect_fp": 114,
            "defect_tn": 1577,
            "defect_fn": 39,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9589386227232166,
            "recall_macro": 0.9592799296931467,
            "f1_macro": 0.9590576724718287,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.967006598680264,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9600952948183442,
            "no_defect_tp": 1612,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9508706467661692,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9580200501253133,
            "defect_tp": 1529,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626406131858241,
            "recall_macro": 0.9628081524888148,
            "f1_macro": 0.9627153838631098,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.966686496133254,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9638196915776986,
            "no_defect_tp": 1625,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.958594730238394,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.961611076148521,
            "defect_tp": 1528,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9586605891387749,
            "recall_macro": 0.9591040878925268,
            "f1_macro": 0.9587597853689933,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.9703748488512697,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9596412556053812,
            "no_defect_tp": 1605,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9469463294262801,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9578783151326054,
            "defect_tp": 1535,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9616909989010768,
            "recall_macro": 0.9620808917083311,
            "f1_macro": 0.9618103984116484,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9711191335740073,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.962719952281539,
            "no_defect_tp": 1614,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9522628642281463,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.960900844541758,
            "defect_tp": 1536,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.96262634755152,
            "recall_macro": 0.9622128663930851,
            "f1_macro": 0.9623870736839863,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9584795321637427,
            "no_defect_recall": 0.9692489651094027,
            "no_defect_f1": 0.9638341664216407,
            "no_defect_tp": 1639,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 52,
            "no_defect_support": 1691,
            "defect_precision": 0.9667731629392972,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.9609399809463322,
            "defect_tp": 1513,
            "defect_fp": 52,
            "defect_tn": 1639,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9615221612337105,
            "recall_macro": 0.9614456585368768,
            "f1_macro": 0.9614824707671882,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9616519174041298,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.9627879503839338,
            "no_defect_tp": 1630,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9613924050632912,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9601769911504425,
            "defect_tp": 1519,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9617190998656515,
            "recall_macro": 0.9619011298675698,
            "f1_macro": 0.9617992370391986,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9660714285714286,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9629190151290419,
            "no_defect_tp": 1623,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9573667711598746,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9606794589493551,
            "defect_tp": 1527,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.96085334102769,
            "recall_macro": 0.9603389005370082,
            "f1_macro": 0.9605485246843112,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9556592765460911,
            "no_defect_recall": 0.9686575990538143,
            "no_defect_f1": 0.9621145374449339,
            "no_defect_tp": 1638,
            "no_defect_fp": 76,
            "no_defect_tn": 1508,
            "no_defect_fn": 53,
            "no_defect_support": 1691,
            "defect_precision": 0.9660474055092889,
            "defect_recall": 0.952020202020202,
            "defect_f1": 0.9589825119236884,
            "defect_tp": 1508,
            "defect_fp": 53,
            "defect_tn": 1638,
            "defect_fn": 76,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620055970149254,
            "recall_macro": 0.9622567335089511,
            "f1_macro": 0.9621081491832305,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9677611940298507,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9631610219845514,
            "no_defect_tp": 1621,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.95625,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9610552763819096,
            "defect_tp": 1530,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9633196243929538,
            "recall_macro": 0.9633196243929538,
            "f1_macro": 0.9633196243929538,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9645180366646955,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9645180366646955,
            "no_defect_tp": 1631,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9621212121212122,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9621212121212122,
            "defect_tp": 1524,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9617291166093036,
            "recall_macro": 0.9618811563297074,
            "f1_macro": 0.9617978538862513,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9655172413793104,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9629410020753039,
            "no_defect_tp": 1624,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9579409918392969,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9606547056971986,
            "defect_tp": 1526,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 58,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9667574739907471,
            "recall_macro": 0.9667058034216707,
            "f1_macro": 0.9667243402276022,
            "precision_micro": 0.9667277167277167,
            "recall_micro": 0.9667277167277167,
            "f1_micro": 0.9667277167277167,
            "accuracy": 0.9667277167277167,
            "hamming_loss": 0.03327228327228327,
            "no_defect_precision": 0.9644364074743822,
            "no_defect_recall": 0.9696969696969697,
            "no_defect_f1": 0.967059534602599,
            "no_defect_tp": 1600,
            "no_defect_fp": 59,
            "no_defect_tn": 1567,
            "no_defect_fn": 50,
            "no_defect_support": 1650,
            "defect_precision": 0.969078540507112,
            "defect_recall": 0.9637146371463715,
            "defect_f1": 0.9663891458526056,
            "defect_tp": 1567,
            "defect_fp": 50,
            "defect_tn": 1600,
            "defect_fn": 59,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.001_s10_20251207_150814",
    "lr": 0.01,
    "weight_decay": 0.001,
    "seed": 10,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9651577016457771,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.001_s10_20251207_150814",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s10_20251207_150814",
      "timestamp": "2025-12-07T15:10:06.698643",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.001_s10",
          "seed": 10,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s10_20251207_150814"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9651083365992945,
        "recall_macro": 0.9652135637868933,
        "f1_macro": 0.9651577016457771,
        "precision_micro": 0.9651908396946565,
        "recall_micro": 0.9651908396946565,
        "f1_micro": 0.9651908396946565,
        "accuracy": 0.9651908396946565,
        "hamming_loss": 0.03480916030534351,
        "no_defect_precision": 0.9679525222551929,
        "no_defect_recall": 0.9645180366646955,
        "no_defect_f1": 0.9662322274881516,
        "no_defect_tp": 1631,
        "no_defect_fp": 54,
        "no_defect_tn": 1530,
        "no_defect_fn": 60,
        "no_defect_support": 1691,
        "defect_precision": 0.9622641509433962,
        "defect_recall": 0.9659090909090909,
        "defect_f1": 0.9640831758034026,
        "defect_tp": 1530,
        "defect_fp": 60,
        "defect_tn": 1631,
        "defect_fn": 54,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9685797762911235,
        "recall_macro": 0.9685418763278542,
        "f1_macro": 0.9685564029795322,
        "precision_micro": 0.9685592185592186,
        "recall_micro": 0.9685592185592186,
        "f1_micro": 0.9685592185592186,
        "accuracy": 0.9685592185592186,
        "hamming_loss": 0.03144078144078144,
        "no_defect_precision": 0.9668074834037417,
        "no_defect_recall": 0.9709090909090909,
        "no_defect_f1": 0.9688539461747808,
        "no_defect_tp": 1602,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 48,
        "no_defect_support": 1650,
        "defect_precision": 0.9703520691785052,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.9682588597842835,
        "defect_tp": 1571,
        "defect_fp": 48,
        "defect_tn": 1602,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.3914980549193825,
          0.22044496973937525,
          0.1895902964859328,
          0.1884984889196302,
          0.18057450611596326,
          0.17983396666194604,
          0.18743287354208935,
          0.18578931173333063,
          0.1776690476079117,
          0.17215704860235856,
          0.16890053052034337,
          0.1698174210709508,
          0.16207978148091287,
          0.16208332217450422,
          0.16874685659069397
        ],
        "val_loss": [
          0.29148219554470134,
          0.15209205993092978,
          0.146903711084563,
          0.10578877557642184,
          0.10544512893718022,
          0.1028703456529631,
          0.10229566987030782,
          0.10159966320945667,
          0.10142706750104061,
          0.09507059090985702,
          0.09884940811361258,
          0.10050423865994582,
          0.09535053787896267,
          0.09668065385463145,
          0.09581200065664373
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9140400600878931,
            "recall_macro": 0.9142765621919968,
            "f1_macro": 0.9141336269334571,
            "precision_micro": 0.9141984732824427,
            "recall_micro": 0.9141984732824427,
            "f1_micro": 0.9141984732824427,
            "accuracy": 0.9141984732824427,
            "hamming_loss": 0.08580152671755725,
            "no_defect_precision": 0.921146953405018,
            "no_defect_recall": 0.911886457717327,
            "no_defect_f1": 0.9164933135215453,
            "no_defect_tp": 1542,
            "no_defect_fp": 132,
            "no_defect_tn": 1452,
            "no_defect_fn": 149,
            "no_defect_support": 1691,
            "defect_precision": 0.9069331667707683,
            "defect_recall": 0.9166666666666666,
            "defect_f1": 0.911773940345369,
            "defect_tp": 1452,
            "defect_fp": 149,
            "defect_tn": 1542,
            "defect_fn": 132,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9523700961885322,
            "recall_macro": 0.9522555910972528,
            "f1_macro": 0.9523096361978542,
            "precision_micro": 0.9523664122137404,
            "recall_micro": 0.9523664122137404,
            "f1_micro": 0.9523664122137404,
            "accuracy": 0.9523664122137404,
            "hamming_loss": 0.04763358778625954,
            "no_defect_precision": 0.9522687094873306,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9539551357733176,
            "no_defect_tp": 1616,
            "no_defect_fp": 81,
            "no_defect_tn": 1503,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9524714828897338,
            "defect_recall": 0.9488636363636364,
            "defect_f1": 0.9506641366223909,
            "defect_tp": 1503,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 81,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9466486564820604,
            "recall_macro": 0.9464535583511042,
            "f1_macro": 0.9453430018577179,
            "precision_micro": 0.9453435114503816,
            "recall_micro": 0.9453435114503816,
            "f1_micro": 0.9453435114503816,
            "accuracy": 0.9453435114503816,
            "hamming_loss": 0.05465648854961832,
            "no_defect_precision": 0.9803049555273189,
            "no_defect_recall": 0.9124778237729154,
            "no_defect_f1": 0.9451761102603369,
            "no_defect_tp": 1543,
            "no_defect_fp": 31,
            "no_defect_tn": 1553,
            "no_defect_fn": 148,
            "no_defect_support": 1691,
            "defect_precision": 0.9129923574368018,
            "defect_recall": 0.9804292929292929,
            "defect_f1": 0.945509893455099,
            "defect_tp": 1553,
            "defect_fp": 148,
            "defect_tn": 1543,
            "defect_fn": 31,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9614090691290466,
            "recall_macro": 0.9616054468397757,
            "f1_macro": 0.9614943172274788,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9660512209648601,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9626112759643917,
            "no_defect_tp": 1622,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.956766917293233,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.960377358490566,
            "defect_tp": 1527,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623671285260786,
            "recall_macro": 0.9618772362895662,
            "f1_macro": 0.9620785687979363,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9573847051955633,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.963572267920094,
            "no_defect_tp": 1640,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.9673495518565941,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.9605848696757787,
            "defect_tp": 1511,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9608581079113647,
            "recall_macro": 0.960894239557013,
            "f1_macro": 0.9608758143094469,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9626998223801065,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9621301775147929,
            "no_defect_tp": 1626,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9590163934426229,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9596214511041009,
            "defect_tp": 1521,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9595850217614089,
            "recall_macro": 0.959751454521561,
            "f1_macro": 0.9596592677863156,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9637120761451516,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9608540925266904,
            "no_defect_tp": 1620,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9554579673776662,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9584644430459408,
            "defect_tp": 1523,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635625316765606,
            "recall_macro": 0.9637151751100598,
            "f1_macro": 0.9636315568997111,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9673008323424495,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9647198339756893,
            "no_defect_tp": 1627,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.9598242310106717,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9625432798237331,
            "defect_tp": 1529,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9622994556653774,
            "recall_macro": 0.9626722577639195,
            "f1_macro": 0.9624203242305297,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9711538461538461,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.963338301043219,
            "no_defect_tp": 1616,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9534450651769087,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9615023474178404,
            "defect_tp": 1536,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638257050082522,
            "recall_macro": 0.9641706464407529,
            "f1_macro": 0.9639463085945955,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9718056388722256,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9648600357355569,
            "no_defect_tp": 1620,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9558457711442786,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9630325814536341,
            "defect_tp": 1537,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626042191259583,
            "recall_macro": 0.9629679407917138,
            "f1_macro": 0.9627252901932482,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9711711711711711,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9636471990464839,
            "no_defect_tp": 1617,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9540372670807453,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9618033813400125,
            "defect_tp": 1536,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626191614702729,
            "recall_macro": 0.9630478349431632,
            "f1_macro": 0.9627295738849002,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9734459867229933,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9635603345280764,
            "no_defect_tp": 1613,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9517923362175525,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9618988132417239,
            "defect_tp": 1540,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9651083365992945,
            "recall_macro": 0.9652135637868933,
            "f1_macro": 0.9651577016457771,
            "precision_micro": 0.9651908396946565,
            "recall_micro": 0.9651908396946565,
            "f1_micro": 0.9651908396946565,
            "accuracy": 0.9651908396946565,
            "hamming_loss": 0.03480916030534351,
            "no_defect_precision": 0.9679525222551929,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9662322274881516,
            "no_defect_tp": 1631,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9622641509433962,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9640831758034026,
            "defect_tp": 1530,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644442877365635,
            "recall_macro": 0.9647220654206166,
            "f1_macro": 0.9645539753663658,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9707112970711297,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9655172413793104,
            "no_defect_tp": 1624,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9581772784019975,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9635907093534212,
            "defect_tp": 1535,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9641634945514256,
            "recall_macro": 0.9643464882413729,
            "f1_macro": 0.9642440858686898,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.968452380952381,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9652921981607832,
            "no_defect_tp": 1627,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.9598746081504702,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9631959735765964,
            "defect_tp": 1531,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 53,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9685797762911235,
            "recall_macro": 0.9685418763278542,
            "f1_macro": 0.9685564029795322,
            "precision_micro": 0.9685592185592186,
            "recall_micro": 0.9685592185592186,
            "f1_micro": 0.9685592185592186,
            "accuracy": 0.9685592185592186,
            "hamming_loss": 0.03144078144078144,
            "no_defect_precision": 0.9668074834037417,
            "no_defect_recall": 0.9709090909090909,
            "no_defect_f1": 0.9688539461747808,
            "no_defect_tp": 1602,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 48,
            "no_defect_support": 1650,
            "defect_precision": 0.9703520691785052,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.9682588597842835,
            "defect_tp": 1571,
            "defect_fp": 48,
            "defect_tn": 1602,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.001_s20_20251207_201355",
    "lr": 0.01,
    "weight_decay": 0.001,
    "seed": 20,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9663776529221809,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.001_s20_20251207_201355",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s20_20251207_201355",
      "timestamp": "2025-12-07T20:15:50.956301",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 11,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.001_s20",
          "seed": 20,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s20_20251207_201355"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9663597329206042,
        "recall_macro": 0.9663962958980701,
        "f1_macro": 0.9663776529221809,
        "precision_micro": 0.966412213740458,
        "recall_micro": 0.966412213740458,
        "f1_micro": 0.966412213740458,
        "accuracy": 0.966412213740458,
        "hamming_loss": 0.03358778625954199,
        "no_defect_precision": 0.9680284191829485,
        "no_defect_recall": 0.9668835008870491,
        "no_defect_f1": 0.9674556213017751,
        "no_defect_tp": 1635,
        "no_defect_fp": 54,
        "no_defect_tn": 1530,
        "no_defect_fn": 56,
        "no_defect_support": 1691,
        "defect_precision": 0.9646910466582598,
        "defect_recall": 0.9659090909090909,
        "defect_f1": 0.9652996845425867,
        "defect_tp": 1530,
        "defect_fp": 56,
        "defect_tn": 1635,
        "defect_fn": 54,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9682472474636412,
        "recall_macro": 0.9682612098848261,
        "f1_macro": 0.9682527850003578,
        "precision_micro": 0.9682539682539683,
        "recall_micro": 0.9682539682539683,
        "f1_micro": 0.9682539682539683,
        "accuracy": 0.9682539682539683,
        "hamming_loss": 0.031746031746031744,
        "no_defect_precision": 0.9696233292831106,
        "no_defect_recall": 0.9672727272727273,
        "no_defect_f1": 0.9684466019417476,
        "no_defect_tp": 1596,
        "no_defect_fp": 50,
        "no_defect_tn": 1576,
        "no_defect_fn": 54,
        "no_defect_support": 1650,
        "defect_precision": 0.9668711656441717,
        "defect_recall": 0.9692496924969249,
        "defect_f1": 0.9680589680589681,
        "defect_tp": 1576,
        "defect_fp": 54,
        "defect_tn": 1596,
        "defect_fn": 50,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.392690304058865,
          0.21653765012903692,
          0.18921339667741224,
          0.1823930503434217,
          0.18043279817725325,
          0.18200161362604617,
          0.1795436135769888,
          0.18790425623622897,
          0.17286853096350466,
          0.17520549071944908,
          0.17003594569581323,
          0.17011479043623892,
          0.16784035006078218,
          0.16861437234606702,
          0.16933143004837395
        ],
        "val_loss": [
          0.28616734536794514,
          0.14934593782975122,
          0.11770475605646005,
          0.10141596255394128,
          0.12256004030887897,
          0.10009655370735206,
          0.09993076661171821,
          0.11112194845023063,
          0.10829007317526983,
          0.09735533086439738,
          0.09429147015683927,
          0.10251456008364375,
          0.09841445711656259,
          0.09857182251289487,
          0.09951406054628584
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.918525351276055,
            "recall_macro": 0.9177209707960743,
            "f1_macro": 0.9180116235361286,
            "precision_micro": 0.9181679389312977,
            "recall_micro": 0.9181679389312977,
            "f1_micro": 0.9181679389312977,
            "accuracy": 0.9181679389312977,
            "hamming_loss": 0.08183206106870229,
            "no_defect_precision": 0.9119861030689056,
            "no_defect_recall": 0.9314015375517445,
            "no_defect_f1": 0.9215915740198947,
            "no_defect_tp": 1575,
            "no_defect_fp": 152,
            "no_defect_tn": 1432,
            "no_defect_fn": 116,
            "no_defect_support": 1691,
            "defect_precision": 0.9250645994832042,
            "defect_recall": 0.9040404040404041,
            "defect_f1": 0.9144316730523627,
            "defect_tp": 1432,
            "defect_fp": 116,
            "defect_tn": 1575,
            "defect_fn": 152,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9557008634488761,
            "recall_macro": 0.9551125536858831,
            "f1_macro": 0.9553462030404365,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9499126383226558,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9571596244131455,
            "no_defect_tp": 1631,
            "no_defect_fp": 86,
            "no_defect_tn": 1498,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9614890885750963,
            "defect_recall": 0.9457070707070707,
            "defect_f1": 0.9535327816677276,
            "defect_tp": 1498,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 86,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9577023325048684,
            "recall_macro": 0.9573421231833414,
            "f1_macro": 0.9574963196467234,
            "precision_micro": 0.9575572519083969,
            "recall_micro": 0.9575572519083969,
            "f1_micro": 0.9575572519083969,
            "accuracy": 0.9575572519083969,
            "hamming_loss": 0.042442748091603054,
            "no_defect_precision": 0.9543325526932084,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.9591056192997941,
            "no_defect_tp": 1630,
            "no_defect_fp": 78,
            "no_defect_tn": 1506,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9610721123165284,
            "defect_recall": 0.9507575757575758,
            "defect_f1": 0.9558870199936528,
            "defect_tp": 1506,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 78,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9650673956637807,
            "recall_macro": 0.9652934579383425,
            "f1_macro": 0.9651627474018791,
            "precision_micro": 0.9651908396946565,
            "recall_micro": 0.9651908396946565,
            "f1_micro": 0.9651908396946565,
            "accuracy": 0.9651908396946565,
            "hamming_loss": 0.03480916030534351,
            "no_defect_precision": 0.9701848539057841,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9661520190023754,
            "no_defect_tp": 1627,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.9599499374217773,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9641734758013828,
            "defect_tp": 1534,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.952765885828329,
            "recall_macro": 0.9529585849625767,
            "f1_macro": 0.9520604250755746,
            "precision_micro": 0.9520610687022901,
            "recall_micro": 0.9520610687022901,
            "f1_micro": 0.9520610687022901,
            "accuracy": 0.9520610687022901,
            "hamming_loss": 0.04793893129770992,
            "no_defect_precision": 0.9805764411027569,
            "no_defect_recall": 0.9254878769958604,
            "no_defect_f1": 0.9522360815333131,
            "no_defect_tp": 1565,
            "no_defect_fp": 31,
            "no_defect_tn": 1553,
            "no_defect_fn": 126,
            "no_defect_support": 1691,
            "defect_precision": 0.9249553305539011,
            "defect_recall": 0.9804292929292929,
            "defect_f1": 0.9518847686178363,
            "defect_tp": 1553,
            "defect_fp": 126,
            "defect_tn": 1565,
            "defect_fn": 31,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9617551405124479,
            "recall_macro": 0.9612658966961155,
            "f1_macro": 0.9614669328108063,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9568009340338587,
            "no_defect_recall": 0.9692489651094027,
            "no_defect_f1": 0.9629847238542891,
            "no_defect_tp": 1639,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 52,
            "no_defect_support": 1691,
            "defect_precision": 0.9667093469910372,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9599491417673236,
            "defect_tp": 1510,
            "defect_fp": 52,
            "defect_tn": 1639,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635675221496734,
            "recall_macro": 0.962208946352944,
            "f1_macro": 0.9626622842626691,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9506031016657094,
            "no_defect_recall": 0.9787108219988173,
            "no_defect_f1": 0.9644522144522144,
            "no_defect_tp": 1655,
            "no_defect_fp": 86,
            "no_defect_tn": 1498,
            "no_defect_fn": 36,
            "no_defect_support": 1691,
            "defect_precision": 0.9765319426336375,
            "defect_recall": 0.9457070707070707,
            "defect_f1": 0.9608723540731238,
            "defect_tp": 1498,
            "defect_fp": 36,
            "defect_tn": 1655,
            "defect_fn": 86,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9590056320167095,
            "recall_macro": 0.9594436380361868,
            "f1_macro": 0.9587736444862891,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.980246913580247,
            "no_defect_recall": 0.9390892962743939,
            "no_defect_f1": 0.959226819691936,
            "no_defect_tp": 1588,
            "no_defect_fp": 32,
            "no_defect_tn": 1552,
            "no_defect_fn": 103,
            "no_defect_support": 1691,
            "defect_precision": 0.9377643504531722,
            "defect_recall": 0.9797979797979798,
            "defect_f1": 0.9583204692806422,
            "defect_tp": 1552,
            "defect_fp": 103,
            "defect_tn": 1588,
            "defect_fn": 32,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9596996874028029,
            "recall_macro": 0.9601908723545329,
            "f1_macro": 0.9596840979086091,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9761759315821625,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.9603365384615384,
            "no_defect_tp": 1598,
            "no_defect_fp": 39,
            "no_defect_tn": 1545,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.9432234432234432,
            "defect_recall": 0.9753787878787878,
            "defect_f1": 0.9590316573556797,
            "defect_tp": 1545,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 39,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9636169339032722,
            "recall_macro": 0.9636352809586104,
            "f1_macro": 0.9636260173118598,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9650887573964497,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9648033126293996,
            "no_defect_tp": 1631,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9621451104100947,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.96244872199432,
            "defect_tp": 1525,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9663597329206042,
            "recall_macro": 0.9663962958980701,
            "f1_macro": 0.9663776529221809,
            "precision_micro": 0.966412213740458,
            "recall_micro": 0.966412213740458,
            "f1_micro": 0.966412213740458,
            "accuracy": 0.966412213740458,
            "hamming_loss": 0.03358778625954199,
            "no_defect_precision": 0.9680284191829485,
            "no_defect_recall": 0.9668835008870491,
            "no_defect_f1": 0.9674556213017751,
            "no_defect_tp": 1635,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 56,
            "no_defect_support": 1691,
            "defect_precision": 0.9646910466582598,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9652996845425867,
            "defect_tp": 1530,
            "defect_fp": 56,
            "defect_tn": 1635,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962613355594149,
            "recall_macro": 0.9630278614053007,
            "f1_macro": 0.9627285447761194,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.972875226039783,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9635820895522388,
            "no_defect_tp": 1614,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9523514851485149,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.961875,
            "defect_tp": 1539,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626232253644427,
            "recall_macro": 0.9628480995645395,
            "f1_macro": 0.9627180279213092,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9677996422182469,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9637767220902613,
            "no_defect_tp": 1623,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9574468085106383,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.961659333752357,
            "defect_tp": 1530,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629115600574552,
            "recall_macro": 0.9632236767437832,
            "f1_macro": 0.9630279405301005,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9700598802395209,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9639988098780125,
            "no_defect_tp": 1620,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9557632398753894,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9620570711821887,
            "defect_tp": 1534,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9632148197226227,
            "recall_macro": 0.9635593068473021,
            "f1_macro": 0.9633352290792496,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9712057588482303,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9642644431209053,
            "no_defect_tp": 1619,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9552238805970149,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9624060150375939,
            "defect_tp": 1536,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 48,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9682472474636412,
            "recall_macro": 0.9682612098848261,
            "f1_macro": 0.9682527850003578,
            "precision_micro": 0.9682539682539683,
            "recall_micro": 0.9682539682539683,
            "f1_micro": 0.9682539682539683,
            "accuracy": 0.9682539682539683,
            "hamming_loss": 0.031746031746031744,
            "no_defect_precision": 0.9696233292831106,
            "no_defect_recall": 0.9672727272727273,
            "no_defect_f1": 0.9684466019417476,
            "no_defect_tp": 1596,
            "no_defect_fp": 50,
            "no_defect_tn": 1576,
            "no_defect_fn": 54,
            "no_defect_support": 1650,
            "defect_precision": 0.9668711656441717,
            "defect_recall": 0.9692496924969249,
            "defect_f1": 0.9680589680589681,
            "defect_tp": 1576,
            "defect_fp": 54,
            "defect_tn": 1596,
            "defect_fn": 50,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.001_s30_20251207_184727",
    "lr": 0.01,
    "weight_decay": 0.001,
    "seed": 30,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9645364250774804,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.001_s30_20251207_184727",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s30_20251207_184727",
      "timestamp": "2025-12-07T18:49:20.117570",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.001_s30",
          "seed": 30,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s30_20251207_184727"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9646219932298187,
        "recall_macro": 0.9644624094284059,
        "f1_macro": 0.9645364250774804,
        "precision_micro": 0.9645801526717557,
        "recall_micro": 0.9645801526717557,
        "f1_micro": 0.9645801526717557,
        "accuracy": 0.9645801526717557,
        "hamming_loss": 0.035419847328244276,
        "no_defect_precision": 0.9635079458505003,
        "no_defect_recall": 0.9680662329982259,
        "no_defect_f1": 0.9657817109144543,
        "no_defect_tp": 1637,
        "no_defect_fp": 62,
        "no_defect_tn": 1522,
        "no_defect_fn": 54,
        "no_defect_support": 1691,
        "defect_precision": 0.9657360406091371,
        "defect_recall": 0.9608585858585859,
        "defect_f1": 0.9632911392405064,
        "defect_tp": 1522,
        "defect_fp": 54,
        "defect_tn": 1637,
        "defect_fn": 62,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9676417309627642,
        "recall_macro": 0.9676417309627642,
        "f1_macro": 0.9676417309627642,
        "precision_micro": 0.9676434676434676,
        "recall_micro": 0.9676434676434676,
        "f1_micro": 0.9676434676434676,
        "accuracy": 0.9676434676434676,
        "hamming_loss": 0.03235653235653236,
        "no_defect_precision": 0.9678787878787879,
        "no_defect_recall": 0.9678787878787879,
        "no_defect_f1": 0.9678787878787879,
        "no_defect_tp": 1597,
        "no_defect_fp": 53,
        "no_defect_tn": 1573,
        "no_defect_fn": 53,
        "no_defect_support": 1650,
        "defect_precision": 0.9674046740467405,
        "defect_recall": 0.9674046740467405,
        "defect_f1": 0.9674046740467405,
        "defect_tp": 1573,
        "defect_fp": 53,
        "defect_tn": 1597,
        "defect_fn": 53,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.3930401504663244,
          0.21394556539452725,
          0.18635781408603222,
          0.1869469330057689,
          0.1879314688272057,
          0.18885809326521025,
          0.1807051034309126,
          0.1799084984825994,
          0.1797793088130123,
          0.17427452934212265,
          0.17862278205892032,
          0.16924420175255592,
          0.16598933646806113,
          0.16166281592584056,
          0.16594821624613706
        ],
        "val_loss": [
          0.2861294342348209,
          0.16086027699594313,
          0.12287161979251184,
          0.1226090404849786,
          0.10559763680570401,
          0.1061997229161744,
          0.09746441768052486,
          0.09857176752904287,
          0.1021125612852092,
          0.10890288128016087,
          0.10925885615870357,
          0.09685524449182245,
          0.10111570895577852,
          0.09886249609721395,
          0.09891053167386697
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.921875525337617,
            "recall_macro": 0.9216087172732649,
            "f1_macro": 0.921725212174717,
            "precision_micro": 0.9218320610687023,
            "recall_micro": 0.9218320610687023,
            "f1_micro": 0.9218320610687023,
            "accuracy": 0.9218320610687023,
            "hamming_loss": 0.07816793893129771,
            "no_defect_precision": 0.9208211143695014,
            "no_defect_recall": 0.9284447072738025,
            "no_defect_f1": 0.9246171967020024,
            "no_defect_tp": 1570,
            "no_defect_fp": 135,
            "no_defect_tn": 1449,
            "no_defect_fn": 121,
            "no_defect_support": 1691,
            "defect_precision": 0.9229299363057325,
            "defect_recall": 0.9147727272727273,
            "defect_f1": 0.9188332276474318,
            "defect_tp": 1449,
            "defect_fp": 121,
            "defect_tn": 1570,
            "defect_fn": 135,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9466550906748706,
            "recall_macro": 0.946845189028069,
            "f1_macro": 0.9459534728559027,
            "precision_micro": 0.9459541984732824,
            "recall_micro": 0.9459541984732824,
            "f1_micro": 0.9459541984732824,
            "accuracy": 0.9459541984732824,
            "hamming_loss": 0.054045801526717556,
            "no_defect_precision": 0.9743107769423559,
            "no_defect_recall": 0.9195742164399764,
            "no_defect_f1": 0.9461515059324612,
            "no_defect_tp": 1555,
            "no_defect_fp": 41,
            "no_defect_tn": 1543,
            "no_defect_fn": 136,
            "no_defect_support": 1691,
            "defect_precision": 0.9189994044073854,
            "defect_recall": 0.9741161616161617,
            "defect_f1": 0.9457554397793442,
            "defect_tp": 1543,
            "defect_fp": 136,
            "defect_tn": 1555,
            "defect_fn": 41,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9594737725399519,
            "recall_macro": 0.9599551099403258,
            "f1_macro": 0.9593812995354412,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9779141104294479,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.9599518217404396,
            "no_defect_tp": 1594,
            "no_defect_fp": 36,
            "no_defect_tn": 1548,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.941033434650456,
            "defect_recall": 0.9772727272727273,
            "defect_f1": 0.9588107773304428,
            "defect_tp": 1548,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 36,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9562109595866919,
            "recall_macro": 0.9566626495588648,
            "f1_macro": 0.9560242981604804,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9765865680837954,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.9565479782739892,
            "no_defect_tp": 1585,
            "no_defect_fp": 38,
            "no_defect_tn": 1546,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.9358353510895884,
            "defect_recall": 0.976010101010101,
            "defect_f1": 0.9555006180469716,
            "defect_tp": 1546,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 38,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9607906881153896,
            "recall_macro": 0.9603788476127328,
            "f1_macro": 0.9605522967905223,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9567251461988304,
            "no_defect_recall": 0.9674748669426375,
            "no_defect_f1": 0.9620699794178182,
            "no_defect_tp": 1636,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 55,
            "no_defect_support": 1691,
            "defect_precision": 0.9648562300319489,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9590346141632264,
            "defect_tp": 1510,
            "defect_fp": 55,
            "defect_tn": 1636,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638275546151907,
            "recall_macro": 0.9642105935164775,
            "f1_macro": 0.9639484880847631,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9729404690318701,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9648181276088252,
            "no_defect_tp": 1618,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9547146401985112,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9630788485607009,
            "defect_tp": 1539,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9639472137868546,
            "recall_macro": 0.9633756249663996,
            "f1_macro": 0.9636049977022284,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.958041958041958,
            "no_defect_recall": 0.9722057953873448,
            "no_defect_f1": 0.9650719107719401,
            "no_defect_tp": 1644,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 47,
            "no_defect_support": 1691,
            "defect_precision": 0.9698524695317511,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.9621380846325167,
            "defect_tp": 1512,
            "defect_fp": 47,
            "defect_tn": 1644,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9628885934866038,
            "recall_macro": 0.9625484964966041,
            "f1_macro": 0.9626954718063477,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9595782073813708,
            "no_defect_recall": 0.9686575990538143,
            "no_defect_f1": 0.9640965273690406,
            "no_defect_tp": 1638,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 53,
            "no_defect_support": 1691,
            "defect_precision": 0.9661989795918368,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9612944162436549,
            "defect_tp": 1515,
            "defect_fp": 53,
            "defect_tn": 1638,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629252545967721,
            "recall_macro": 0.9631637561301961,
            "f1_macro": 0.9630242561439546,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9683770883054893,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9640629640629641,
            "no_defect_tp": 1623,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.957473420888055,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.961985548224945,
            "defect_tp": 1531,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9584080780204002,
            "recall_macro": 0.9588882990161819,
            "f1_macro": 0.9584588707378838,
            "precision_micro": 0.9584732824427481,
            "recall_micro": 0.9584732824427481,
            "f1_micro": 0.9584732824427481,
            "accuracy": 0.9584732824427481,
            "hamming_loss": 0.04152671755725191,
            "no_defect_precision": 0.9726443768996961,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.9592326139088729,
            "no_defect_tp": 1600,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9441717791411043,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9576851275668948,
            "defect_tp": 1539,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9602725298855745,
            "recall_macro": 0.9607622648722589,
            "f1_macro": 0.9602933155860232,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.975624619134674,
            "no_defect_recall": 0.9467770549970431,
            "no_defect_f1": 0.960984393757503,
            "no_defect_tp": 1601,
            "no_defect_fp": 40,
            "no_defect_tn": 1544,
            "no_defect_fn": 90,
            "no_defect_support": 1691,
            "defect_precision": 0.944920440636475,
            "defect_recall": 0.9747474747474747,
            "defect_f1": 0.9596022374145432,
            "defect_tp": 1544,
            "defect_fp": 90,
            "defect_tn": 1601,
            "defect_fn": 40,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9646219932298187,
            "recall_macro": 0.9644624094284059,
            "f1_macro": 0.9645364250774804,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9635079458505003,
            "no_defect_recall": 0.9680662329982259,
            "no_defect_f1": 0.9657817109144543,
            "no_defect_tp": 1637,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 54,
            "no_defect_support": 1691,
            "defect_precision": 0.9657360406091371,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9632911392405064,
            "defect_tp": 1522,
            "defect_fp": 54,
            "defect_tn": 1637,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626113652017465,
            "recall_macro": 0.9628880466402643,
            "f1_macro": 0.9627205602991089,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9689181111775254,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9637336504161712,
            "no_defect_tp": 1621,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9563046192259675,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9617074701820465,
            "defect_tp": 1532,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638453105141116,
            "recall_macro": 0.9640707787514411,
            "f1_macro": 0.9639403876615942,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9689922480620154,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9649643705463183,
            "no_defect_tp": 1625,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9586983729662077,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9629164047768699,
            "defect_tp": 1532,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638453105141116,
            "recall_macro": 0.9640707787514411,
            "f1_macro": 0.9639403876615942,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9689922480620154,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9649643705463183,
            "no_defect_tp": 1625,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9586983729662077,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9629164047768699,
            "defect_tp": 1532,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 52,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9676417309627642,
            "recall_macro": 0.9676417309627642,
            "f1_macro": 0.9676417309627642,
            "precision_micro": 0.9676434676434676,
            "recall_micro": 0.9676434676434676,
            "f1_micro": 0.9676434676434676,
            "accuracy": 0.9676434676434676,
            "hamming_loss": 0.03235653235653236,
            "no_defect_precision": 0.9678787878787879,
            "no_defect_recall": 0.9678787878787879,
            "no_defect_f1": 0.9678787878787879,
            "no_defect_tp": 1597,
            "no_defect_fp": 53,
            "no_defect_tn": 1573,
            "no_defect_fn": 53,
            "no_defect_support": 1650,
            "defect_precision": 0.9674046740467405,
            "defect_recall": 0.9674046740467405,
            "defect_f1": 0.9674046740467405,
            "defect_tp": 1573,
            "defect_fp": 53,
            "defect_tn": 1597,
            "defect_fn": 53,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.001_s40_20251207_141023",
    "lr": 0.01,
    "weight_decay": 0.001,
    "seed": 40,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.966385107142164,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.001_s40_20251207_141023",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s40_20251207_141023",
      "timestamp": "2025-12-07T14:12:19.661526",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 8,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.001_s40",
          "seed": 40,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s40_20251207_141023"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9662894808134497,
        "recall_macro": 0.9665161371252442,
        "f1_macro": 0.966385107142164,
        "precision_micro": 0.966412213740458,
        "recall_micro": 0.966412213740458,
        "f1_micro": 0.966412213740458,
        "accuracy": 0.966412213740458,
        "hamming_loss": 0.03358778625954199,
        "no_defect_precision": 0.9713774597495528,
        "no_defect_recall": 0.9633353045535187,
        "no_defect_f1": 0.9673396674584323,
        "no_defect_tp": 1629,
        "no_defect_fp": 48,
        "no_defect_tn": 1536,
        "no_defect_fn": 62,
        "no_defect_support": 1691,
        "defect_precision": 0.9612015018773467,
        "defect_recall": 0.9696969696969697,
        "defect_f1": 0.9654305468258957,
        "defect_tp": 1536,
        "defect_fp": 62,
        "defect_tn": 1629,
        "defect_fn": 48,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9691822398989098,
        "recall_macro": 0.9691568824779158,
        "f1_macro": 0.9691673030429113,
        "precision_micro": 0.9691697191697192,
        "recall_micro": 0.9691697191697192,
        "f1_micro": 0.9691697191697192,
        "accuracy": 0.9691697191697192,
        "hamming_loss": 0.030830280830280832,
        "no_defect_precision": 0.9679758308157099,
        "no_defect_recall": 0.9709090909090909,
        "no_defect_f1": 0.9694402420574887,
        "no_defect_tp": 1602,
        "no_defect_fp": 53,
        "no_defect_tn": 1573,
        "no_defect_fn": 48,
        "no_defect_support": 1650,
        "defect_precision": 0.9703886489821099,
        "defect_recall": 0.9674046740467405,
        "defect_f1": 0.9688943640283338,
        "defect_tp": 1573,
        "defect_fp": 48,
        "defect_tn": 1602,
        "defect_fn": 53,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.38653776417466884,
          0.21936446284898653,
          0.1905308554112662,
          0.18686237049027965,
          0.17819382248750293,
          0.1832663126944498,
          0.17878645226733456,
          0.17795569734905056,
          0.1768514452556686,
          0.16912577443105406,
          0.17385127142882248,
          0.16241818828562812,
          0.16558146244499475,
          0.16985617849243237,
          0.16713316024721417
        ],
        "val_loss": [
          0.28653299235380614,
          0.15503253873724204,
          0.12461946782870935,
          0.11527466315489548,
          0.1014803102096686,
          0.09826301901529615,
          0.10806218359189537,
          0.09923048399818632,
          0.10558128335441534,
          0.09949297887774614,
          0.09712699198952088,
          0.09982800494449642,
          0.09592098212585999,
          0.09570113462037765,
          0.09663411788642406
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9150024327257757,
            "recall_macro": 0.9139730390839202,
            "f1_macro": 0.9143216780916887,
            "precision_micro": 0.9145038167938931,
            "recall_micro": 0.9145038167938931,
            "f1_micro": 0.9145038167938931,
            "accuracy": 0.9145038167938931,
            "hamming_loss": 0.08549618320610687,
            "no_defect_precision": 0.906628242074928,
            "no_defect_recall": 0.9302188054405677,
            "no_defect_f1": 0.9182720373613543,
            "no_defect_tp": 1573,
            "no_defect_fp": 162,
            "no_defect_tn": 1422,
            "no_defect_fn": 118,
            "no_defect_support": 1691,
            "defect_precision": 0.9233766233766234,
            "defect_recall": 0.8977272727272727,
            "defect_f1": 0.910371318822023,
            "defect_tp": 1422,
            "defect_fp": 118,
            "defect_tn": 1573,
            "defect_fn": 162,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9528732026865342,
            "recall_macro": 0.9533263220615379,
            "f1_macro": 0.9529574104833667,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.9654754694124773,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.9539198084979055,
            "no_defect_tp": 1594,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.9402709359605911,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9519950124688279,
            "defect_tp": 1527,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9562944313127614,
            "recall_macro": 0.9567785707458978,
            "f1_macro": 0.9563221786897371,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9713763702801461,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9570957095709571,
            "no_defect_tp": 1595,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9412124923453766,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9555486478085172,
            "defect_tp": 1537,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9572779145222645,
            "recall_macro": 0.9577654875185921,
            "f1_macro": 0.957241539326966,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9743119266055046,
            "no_defect_recall": 0.9420461265523359,
            "no_defect_f1": 0.957907396271798,
            "no_defect_tp": 1593,
            "no_defect_fp": 42,
            "no_defect_tn": 1542,
            "no_defect_fn": 98,
            "no_defect_support": 1691,
            "defect_precision": 0.9402439024390243,
            "defect_recall": 0.9734848484848485,
            "defect_f1": 0.956575682382134,
            "defect_tp": 1542,
            "defect_fp": 98,
            "defect_tn": 1593,
            "defect_fn": 42,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9628105748393763,
            "recall_macro": 0.9626084171101912,
            "f1_macro": 0.9627004866347222,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9611992945326279,
            "no_defect_recall": 0.9668835008870491,
            "no_defect_f1": 0.9640330188679245,
            "no_defect_tp": 1635,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 56,
            "no_defect_support": 1691,
            "defect_precision": 0.9644218551461246,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9613679544015199,
            "defect_tp": 1518,
            "defect_fp": 56,
            "defect_tn": 1635,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9643518003201798,
            "recall_macro": 0.9641267793248869,
            "f1_macro": 0.9642283704520879,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.9623971797884842,
            "no_defect_recall": 0.9686575990538143,
            "no_defect_f1": 0.9655172413793104,
            "no_defect_tp": 1638,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 53,
            "no_defect_support": 1691,
            "defect_precision": 0.9663064208518753,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9629394995248653,
            "defect_tp": 1520,
            "defect_fp": 53,
            "defect_tn": 1638,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9603313567539344,
            "recall_macro": 0.9608221854858461,
            "f1_macro": 0.9602957150893255,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9773700305810398,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.9609140108238123,
            "no_defect_tp": 1598,
            "no_defect_fp": 37,
            "no_defect_tn": 1547,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.9432926829268292,
            "defect_recall": 0.9766414141414141,
            "defect_f1": 0.9596774193548387,
            "defect_tp": 1547,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 37,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9662894808134497,
            "recall_macro": 0.9665161371252442,
            "f1_macro": 0.966385107142164,
            "precision_micro": 0.966412213740458,
            "recall_micro": 0.966412213740458,
            "f1_micro": 0.966412213740458,
            "accuracy": 0.966412213740458,
            "hamming_loss": 0.03358778625954199,
            "no_defect_precision": 0.9713774597495528,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9673396674584323,
            "no_defect_tp": 1629,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9612015018773467,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9654305468258957,
            "defect_tp": 1536,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9599275957415228,
            "recall_macro": 0.9604066612308777,
            "f1_macro": 0.9599856590989874,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9738760631834751,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9607431824992508,
            "no_defect_tp": 1603,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9459791282995703,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9592281356987239,
            "defect_tp": 1541,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638268565975256,
            "recall_macro": 0.9641506729028906,
            "f1_macro": 0.9639451783848336,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9712402636309168,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9648809523809524,
            "no_defect_tp": 1621,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9564134495641345,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9630094043887147,
            "defect_tp": 1536,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9649948992107987,
            "recall_macro": 0.9642227269740575,
            "f1_macro": 0.9645162326793635,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9570516540917006,
            "no_defect_recall": 0.9751626256652868,
            "no_defect_f1": 0.9660222612770943,
            "no_defect_tp": 1649,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 42,
            "no_defect_support": 1691,
            "defect_precision": 0.9729381443298969,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9630102040816326,
            "defect_tp": 1510,
            "defect_fp": 42,
            "defect_tn": 1649,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623171994402222,
            "recall_macro": 0.962752151915369,
            "f1_macro": 0.9624245868243666,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9734299516908212,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9632506722438005,
            "no_defect_tp": 1612,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9512044471896233,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9615985014049329,
            "defect_tp": 1540,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9642125220616562,
            "recall_macro": 0.9642665940899235,
            "f1_macro": 0.9642387465796171,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.9662322274881516,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9653743711157147,
            "no_defect_tp": 1631,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9621928166351607,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9631031220435194,
            "defect_tp": 1527,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9648395647061019,
            "recall_macro": 0.9648579601455118,
            "f1_macro": 0.9648486721921334,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9662721893491124,
            "no_defect_recall": 0.9657007687758723,
            "no_defect_f1": 0.9659863945578231,
            "no_defect_tp": 1633,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 58,
            "no_defect_support": 1691,
            "defect_precision": 0.9634069400630915,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9637109498264437,
            "defect_tp": 1527,
            "defect_fp": 58,
            "defect_tn": 1633,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9647657668617334,
            "recall_macro": 0.964977801372686,
            "f1_macro": 0.9648565442503347,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9696066746126341,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9658652419115464,
            "no_defect_tp": 1627,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.9599248591108328,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9638478465891229,
            "defect_tp": 1533,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 51,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9691822398989098,
            "recall_macro": 0.9691568824779158,
            "f1_macro": 0.9691673030429113,
            "precision_micro": 0.9691697191697192,
            "recall_micro": 0.9691697191697192,
            "f1_micro": 0.9691697191697192,
            "accuracy": 0.9691697191697192,
            "hamming_loss": 0.030830280830280832,
            "no_defect_precision": 0.9679758308157099,
            "no_defect_recall": 0.9709090909090909,
            "no_defect_f1": 0.9694402420574887,
            "no_defect_tp": 1602,
            "no_defect_fp": 53,
            "no_defect_tn": 1573,
            "no_defect_fn": 48,
            "no_defect_support": 1650,
            "defect_precision": 0.9703886489821099,
            "defect_recall": 0.9674046740467405,
            "defect_f1": 0.9688943640283338,
            "defect_tp": 1573,
            "defect_fp": 48,
            "defect_tn": 1602,
            "defect_fn": 53,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.001_s50_20251207_162128",
    "lr": 0.01,
    "weight_decay": 0.001,
    "seed": 50,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.964556277056277,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.001_s50_20251207_162128",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s50_20251207_162128",
      "timestamp": "2025-12-07T16:23:22.824251",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.001_s50",
          "seed": 50,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s50_20251207_162128"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9644377696878169,
        "recall_macro": 0.9647620124963413,
        "f1_macro": 0.964556277056277,
        "precision_micro": 0.9645801526717557,
        "recall_micro": 0.9645801526717557,
        "f1_micro": 0.9645801526717557,
        "accuracy": 0.9645801526717557,
        "hamming_loss": 0.035419847328244276,
        "no_defect_precision": 0.9718394248052726,
        "no_defect_recall": 0.9591957421643997,
        "no_defect_f1": 0.9654761904761905,
        "no_defect_tp": 1622,
        "no_defect_fp": 47,
        "no_defect_tn": 1537,
        "no_defect_fn": 69,
        "no_defect_support": 1691,
        "defect_precision": 0.9570361145703612,
        "defect_recall": 0.9703282828282829,
        "defect_f1": 0.9636363636363636,
        "defect_tp": 1537,
        "defect_fp": 69,
        "defect_tn": 1622,
        "defect_fn": 47,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9676596886741814,
        "recall_macro": 0.9676283126467629,
        "f1_macro": 0.9676407539979401,
        "precision_micro": 0.9676434676434676,
        "recall_micro": 0.9676434676434676,
        "f1_micro": 0.9676434676434676,
        "accuracy": 0.9676434676434676,
        "hamming_loss": 0.03235653235653236,
        "no_defect_precision": 0.966183574879227,
        "no_defect_recall": 0.9696969696969697,
        "no_defect_f1": 0.9679370840895342,
        "no_defect_tp": 1600,
        "no_defect_fp": 56,
        "no_defect_tn": 1570,
        "no_defect_fn": 50,
        "no_defect_support": 1650,
        "defect_precision": 0.9691358024691358,
        "defect_recall": 0.965559655596556,
        "defect_f1": 0.9673444239063462,
        "defect_tp": 1570,
        "defect_fp": 50,
        "defect_tn": 1600,
        "defect_fn": 56,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.38698799328325184,
          0.21373093994840917,
          0.190668415730219,
          0.18829222866743178,
          0.17867435664562,
          0.185441138339716,
          0.18459651150027578,
          0.17505494215249018,
          0.1796895682687041,
          0.1787800392502272,
          0.17635416870773088,
          0.16903481855365024,
          0.16641266662705392,
          0.16403950052530697,
          0.16821737289740452
        ],
        "val_loss": [
          0.28361572095981014,
          0.15056422223838475,
          0.12585176792568886,
          0.11819303057228144,
          0.11568130237551835,
          0.10994590188448246,
          0.10797831842389244,
          0.0984844032746668,
          0.10234451322601391,
          0.09808412982294193,
          0.11962309508369519,
          0.09657950423514614,
          0.09900777059822129,
          0.09721755300863431,
          0.0968893736672516
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9211241495113027,
            "recall_macro": 0.921157165982713,
            "f1_macro": 0.9211403132174789,
            "precision_micro": 0.9212213740458015,
            "recall_micro": 0.9212213740458015,
            "f1_micro": 0.9212213740458015,
            "accuracy": 0.9212213740458015,
            "hamming_loss": 0.07877862595419848,
            "no_defect_precision": 0.9242155121373594,
            "no_defect_recall": 0.9231224127735068,
            "no_defect_f1": 0.9236686390532545,
            "no_defect_tp": 1561,
            "no_defect_fp": 128,
            "no_defect_tn": 1456,
            "no_defect_fn": 130,
            "no_defect_support": 1691,
            "defect_precision": 0.9180327868852459,
            "defect_recall": 0.9191919191919192,
            "defect_f1": 0.9186119873817035,
            "defect_tp": 1456,
            "defect_fp": 130,
            "defect_tn": 1561,
            "defect_fn": 128,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549970144797731,
            "recall_macro": 0.9551763943396114,
            "f1_macro": 0.9550759027580974,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9595238095238096,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9563927617917531,
            "no_defect_tp": 1612,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9504702194357367,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9537590437244416,
            "defect_tp": 1516,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9595812045953142,
            "recall_macro": 0.9600310840516341,
            "f1_macro": 0.9596767573956726,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9715668481548699,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9605263157894737,
            "no_defect_tp": 1606,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9475955610357584,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9588271990018715,
            "defect_tp": 1537,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9559206703352199,
            "recall_macro": 0.9563669665310706,
            "f1_macro": 0.9557192292819376,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9765721331689272,
            "no_defect_recall": 0.9367238320520402,
            "no_defect_f1": 0.9562330214307274,
            "no_defect_tp": 1584,
            "no_defect_fp": 38,
            "no_defect_tn": 1546,
            "no_defect_fn": 107,
            "no_defect_support": 1691,
            "defect_precision": 0.9352692075015124,
            "defect_recall": 0.976010101010101,
            "defect_f1": 0.955205437133148,
            "defect_tp": 1546,
            "defect_fp": 107,
            "defect_tn": 1584,
            "defect_fn": 38,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555474750634929,
            "recall_macro": 0.9522837780525539,
            "f1_macro": 0.9531040342182615,
            "precision_micro": 0.9532824427480916,
            "recall_micro": 0.9532824427480916,
            "f1_micro": 0.9532824427480916,
            "accuracy": 0.9532824427480916,
            "hamming_loss": 0.0467175572519084,
            "no_defect_precision": 0.9305711086226204,
            "no_defect_recall": 0.9828503843879361,
            "no_defect_f1": 0.9559965487489215,
            "no_defect_tp": 1662,
            "no_defect_fp": 124,
            "no_defect_tn": 1460,
            "no_defect_fn": 29,
            "no_defect_support": 1691,
            "defect_precision": 0.9805238415043653,
            "defect_recall": 0.9217171717171717,
            "defect_f1": 0.9502115196876016,
            "defect_tp": 1460,
            "defect_fp": 29,
            "defect_tn": 1662,
            "defect_fn": 124,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9591560489362877,
            "recall_macro": 0.9596394533746693,
            "f1_macro": 0.9590755408537727,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9773145309625997,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.9596628537025887,
            "no_defect_tp": 1594,
            "no_defect_fp": 37,
            "no_defect_tn": 1547,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.9409975669099757,
            "defect_recall": 0.9766414141414141,
            "defect_f1": 0.9584882280049566,
            "defect_tp": 1547,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 37,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9599424024489029,
            "recall_macro": 0.96042663476874,
            "f1_macro": 0.9599865697011525,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9744525547445255,
            "no_defect_recall": 0.9473684210526315,
            "no_defect_f1": 0.9607196401799101,
            "no_defect_tp": 1602,
            "no_defect_fp": 42,
            "no_defect_tn": 1542,
            "no_defect_fn": 89,
            "no_defect_support": 1691,
            "defect_precision": 0.9454322501532803,
            "defect_recall": 0.9734848484848485,
            "defect_f1": 0.959253499222395,
            "defect_tp": 1542,
            "defect_fp": 89,
            "defect_tn": 1602,
            "defect_fn": 42,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635594715105059,
            "recall_macro": 0.9631198890143302,
            "f1_macro": 0.9633035952392157,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9590882524839275,
            "no_defect_recall": 0.9704316972205795,
            "no_defect_f1": 0.9647266313932981,
            "no_defect_tp": 1641,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 50,
            "no_defect_support": 1691,
            "defect_precision": 0.9680306905370843,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9618805590851334,
            "defect_tp": 1514,
            "defect_fp": 50,
            "defect_tn": 1641,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962002563276219,
            "recall_macro": 0.96241652181185,
            "f1_macro": 0.9621175373134329,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9722724532851115,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9629850746268657,
            "no_defect_tp": 1613,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9517326732673267,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.96125,
            "defect_tp": 1538,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9624296266093748,
            "recall_macro": 0.9623726546959841,
            "f1_macro": 0.9624003304234601,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9628099173553719,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9636632200886263,
            "no_defect_tp": 1631,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9620493358633776,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9611374407582939,
            "defect_tp": 1521,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9525022234359098,
            "recall_macro": 0.9528387437354024,
            "f1_macro": 0.9520584940917286,
            "precision_micro": 0.9520610687022901,
            "recall_micro": 0.9520610687022901,
            "f1_micro": 0.9520610687022901,
            "accuracy": 0.9520610687022901,
            "hamming_loss": 0.04793893129770992,
            "no_defect_precision": 0.9769900497512438,
            "no_defect_recall": 0.9290360733293909,
            "no_defect_f1": 0.9524098211579266,
            "no_defect_tp": 1571,
            "no_defect_fp": 37,
            "no_defect_tn": 1547,
            "no_defect_fn": 120,
            "no_defect_support": 1691,
            "defect_precision": 0.9280143971205759,
            "defect_recall": 0.9766414141414141,
            "defect_f1": 0.9517071670255306,
            "defect_tp": 1547,
            "defect_fp": 120,
            "defect_tn": 1571,
            "defect_fn": 37,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644377696878169,
            "recall_macro": 0.9647620124963413,
            "f1_macro": 0.964556277056277,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9718394248052726,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9654761904761905,
            "no_defect_tp": 1622,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9570361145703612,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9636363636363636,
            "defect_tp": 1537,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635206582711429,
            "recall_macro": 0.9638549898750963,
            "f1_macro": 0.9636402023441748,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9712230215827338,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9645727895206907,
            "no_defect_tp": 1620,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.955818294959552,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.962707615167659,
            "defect_tp": 1536,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635740529791239,
            "recall_macro": 0.9636952015721975,
            "f1_macro": 0.9636302128900555,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9667458432304038,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9647407407407408,
            "no_defect_tp": 1628,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.9604022627278441,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9625196850393701,
            "defect_tp": 1528,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635869601732552,
            "recall_macro": 0.963675228034335,
            "f1_macro": 0.9636288416263183,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9661921708185054,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9647616227420788,
            "no_defect_tp": 1629,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9609817495280051,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9624960605105578,
            "defect_tp": 1527,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 57,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9676596886741814,
            "recall_macro": 0.9676283126467629,
            "f1_macro": 0.9676407539979401,
            "precision_micro": 0.9676434676434676,
            "recall_micro": 0.9676434676434676,
            "f1_micro": 0.9676434676434676,
            "accuracy": 0.9676434676434676,
            "hamming_loss": 0.03235653235653236,
            "no_defect_precision": 0.966183574879227,
            "no_defect_recall": 0.9696969696969697,
            "no_defect_f1": 0.9679370840895342,
            "no_defect_tp": 1600,
            "no_defect_fp": 56,
            "no_defect_tn": 1570,
            "no_defect_fn": 50,
            "no_defect_support": 1650,
            "defect_precision": 0.9691358024691358,
            "defect_recall": 0.965559655596556,
            "defect_f1": 0.9673444239063462,
            "defect_tp": 1570,
            "defect_fp": 50,
            "defect_tn": 1600,
            "defect_fn": 56,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.001_s60_20251207_161006",
    "lr": 0.01,
    "weight_decay": 0.001,
    "seed": 60,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9672872039266744,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.001_s60_20251207_161006",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s60_20251207_161006",
      "timestamp": "2025-12-07T16:11:58.757345",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 7,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.001_s60",
          "seed": 60,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s60_20251207_161006"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9673856209150327,
        "recall_macro": 0.9672034508300031,
        "f1_macro": 0.9672872039266744,
        "precision_micro": 0.9673282442748091,
        "recall_micro": 0.9673282442748091,
        "f1_micro": 0.9673282442748091,
        "accuracy": 0.9673282442748091,
        "hamming_loss": 0.03267175572519084,
        "no_defect_precision": 0.9658823529411765,
        "no_defect_recall": 0.9710230632761679,
        "no_defect_f1": 0.9684458861692716,
        "no_defect_tp": 1642,
        "no_defect_fp": 58,
        "no_defect_tn": 1526,
        "no_defect_fn": 49,
        "no_defect_support": 1691,
        "defect_precision": 0.9688888888888889,
        "defect_recall": 0.9633838383838383,
        "defect_f1": 0.9661285216840773,
        "defect_tp": 1526,
        "defect_fp": 49,
        "defect_tn": 1642,
        "defect_fn": 58,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.968249057751485,
        "recall_macro": 0.9682567371128257,
        "f1_macro": 0.9682525365058929,
        "precision_micro": 0.9682539682539683,
        "recall_micro": 0.9682539682539683,
        "f1_micro": 0.9682539682539683,
        "accuracy": 0.9682539682539683,
        "hamming_loss": 0.031746031746031744,
        "no_defect_precision": 0.9690533980582524,
        "no_defect_recall": 0.9678787878787879,
        "no_defect_f1": 0.968465736810188,
        "no_defect_tp": 1597,
        "no_defect_fp": 51,
        "no_defect_tn": 1575,
        "no_defect_fn": 53,
        "no_defect_support": 1650,
        "defect_precision": 0.9674447174447175,
        "defect_recall": 0.9686346863468634,
        "defect_f1": 0.968039336201598,
        "defect_tp": 1575,
        "defect_fp": 53,
        "defect_tn": 1597,
        "defect_fn": 51,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.39155827468907983,
          0.22249827745943387,
          0.18511563129567202,
          0.1800076267896337,
          0.1804242383953667,
          0.1809236989609866,
          0.18076608407946312,
          0.17434076639087132,
          0.18141408216317328,
          0.17404255684013148,
          0.1785859842180707,
          0.1664902343566697,
          0.16874557945518812,
          0.169019156731821,
          0.16798096616210798
        ],
        "val_loss": [
          0.2881994218780444,
          0.1576963300601794,
          0.12055714320964538,
          0.1122043037142318,
          0.11798476957930969,
          0.1051997272655941,
          0.09606277319387747,
          0.09864025469869375,
          0.0993058703875599,
          0.09814286486317332,
          0.09574482829954761,
          0.09867866709828377,
          0.09831095279122774,
          0.09772592059408243,
          0.09851989880777322
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9164977981788327,
            "recall_macro": 0.9166619999522128,
            "f1_macro": 0.9165695336936095,
            "precision_micro": 0.9166412213740458,
            "recall_micro": 0.9166412213740458,
            "f1_micro": 0.9166412213740458,
            "accuracy": 0.9166412213740458,
            "hamming_loss": 0.0833587786259542,
            "no_defect_precision": 0.9220238095238096,
            "no_defect_recall": 0.9160260201064458,
            "no_defect_f1": 0.9190151290418274,
            "no_defect_tp": 1549,
            "no_defect_fp": 131,
            "no_defect_tn": 1453,
            "no_defect_fn": 142,
            "no_defect_support": 1691,
            "defect_precision": 0.9109717868338558,
            "defect_recall": 0.9172979797979798,
            "defect_f1": 0.9141239383453916,
            "defect_tp": 1453,
            "defect_fp": 142,
            "defect_tn": 1549,
            "defect_fn": 131,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9523335623187044,
            "recall_macro": 0.952814850157399,
            "f1_macro": 0.9523519787032277,
            "precision_micro": 0.9523664122137404,
            "recall_micro": 0.9523664122137404,
            "f1_micro": 0.9523664122137404,
            "accuracy": 0.9523664122137404,
            "hamming_loss": 0.04763358778625954,
            "no_defect_precision": 0.967702620353443,
            "no_defect_recall": 0.9390892962743939,
            "no_defect_f1": 0.9531812725090036,
            "no_defect_tp": 1588,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 103,
            "no_defect_support": 1691,
            "defect_precision": 0.9369645042839657,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9515226848974518,
            "defect_tp": 1531,
            "defect_fp": 103,
            "defect_tn": 1588,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9583277374375871,
            "recall_macro": 0.958668590099696,
            "f1_macro": 0.9584465929564829,
            "precision_micro": 0.9584732824427481,
            "recall_micro": 0.9584732824427481,
            "f1_micro": 0.9584732824427481,
            "accuracy": 0.9584732824427481,
            "hamming_loss": 0.04152671755725191,
            "no_defect_precision": 0.9664067186562687,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9594997022036926,
            "no_defect_tp": 1611,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9502487562189055,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9573934837092731,
            "defect_tp": 1528,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9583536715523173,
            "recall_macro": 0.9585487488725217,
            "f1_macro": 0.9584383106582312,
            "precision_micro": 0.9584732824427481,
            "recall_micro": 0.9584732824427481,
            "f1_micro": 0.9584732824427481,
            "accuracy": 0.9584732824427481,
            "hamming_loss": 0.04152671755725191,
            "no_defect_precision": 0.9630732578916021,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9596439169139466,
            "no_defect_tp": 1617,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9536340852130326,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9572327044025157,
            "defect_tp": 1522,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9550518003300182,
            "recall_macro": 0.955479917447688,
            "f1_macro": 0.9548039983588825,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9765287214329833,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.9552870090634441,
            "no_defect_tp": 1581,
            "no_defect_fp": 38,
            "no_defect_tn": 1546,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9335748792270532,
            "defect_recall": 0.976010101010101,
            "defect_f1": 0.9543209876543209,
            "defect_tp": 1546,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 38,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.956960159335712,
            "recall_macro": 0.9558597880042292,
            "f1_macro": 0.9562440875912408,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9463667820069204,
            "no_defect_recall": 0.9704316972205795,
            "no_defect_f1": 0.9582481751824817,
            "no_defect_tp": 1641,
            "no_defect_fp": 93,
            "no_defect_tn": 1491,
            "no_defect_fn": 50,
            "no_defect_support": 1691,
            "defect_precision": 0.9675535366645036,
            "defect_recall": 0.9412878787878788,
            "defect_f1": 0.95424,
            "defect_tp": 1491,
            "defect_fp": 50,
            "defect_tn": 1641,
            "defect_fn": 93,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9673856209150327,
            "recall_macro": 0.9672034508300031,
            "f1_macro": 0.9672872039266744,
            "precision_micro": 0.9673282442748091,
            "recall_micro": 0.9673282442748091,
            "f1_micro": 0.9673282442748091,
            "accuracy": 0.9673282442748091,
            "hamming_loss": 0.03267175572519084,
            "no_defect_precision": 0.9658823529411765,
            "no_defect_recall": 0.9710230632761679,
            "no_defect_f1": 0.9684458861692716,
            "no_defect_tp": 1642,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 49,
            "no_defect_support": 1691,
            "defect_precision": 0.9688888888888889,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9661285216840773,
            "defect_tp": 1526,
            "defect_fp": 49,
            "defect_tn": 1642,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.964198183388614,
            "recall_macro": 0.9642865676277859,
            "f1_macro": 0.9642401215989853,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.966785290628707,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.9653538643766657,
            "no_defect_tp": 1630,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.961611076148521,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9631263788213048,
            "defect_tp": 1528,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9634183539803136,
            "recall_macro": 0.962268866966531,
            "f1_macro": 0.9626687311685215,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9521613832853026,
            "no_defect_recall": 0.976936723832052,
            "no_defect_f1": 0.9643899591360187,
            "no_defect_tp": 1652,
            "no_defect_fp": 83,
            "no_defect_tn": 1501,
            "no_defect_fn": 39,
            "no_defect_support": 1691,
            "defect_precision": 0.9746753246753247,
            "defect_recall": 0.94760101010101,
            "defect_f1": 0.9609475032010243,
            "defect_tp": 1501,
            "defect_fp": 39,
            "defect_tn": 1652,
            "defect_fn": 83,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638259377389813,
            "recall_macro": 0.9641906199786152,
            "f1_macro": 0.9639474118262565,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9723723723723724,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9648390941597139,
            "no_defect_tp": 1619,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9552795031055901,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.963055729492799,
            "defect_tp": 1538,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9647522792281109,
            "recall_macro": 0.9650177484484108,
            "f1_macro": 0.9648589576418063,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9707287933094385,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9658246656760773,
            "no_defect_tp": 1625,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9587757651467833,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9638932496075353,
            "defect_tp": 1535,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644383897676625,
            "recall_macro": 0.9648219331099284,
            "f1_macro": 0.9645595306595975,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.973541791942273,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9654144305307096,
            "no_defect_tp": 1619,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9553349875930521,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9637046307884856,
            "defect_tp": 1540,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644367970454928,
            "recall_macro": 0.964801959572066,
            "f1_macro": 0.9645584726427606,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.972972972972973,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.965435041716329,
            "no_defect_tp": 1620,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9559006211180124,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9636819035691923,
            "defect_tp": 1539,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9650673956637807,
            "recall_macro": 0.9652934579383425,
            "f1_macro": 0.9651627474018791,
            "precision_micro": 0.9651908396946565,
            "recall_micro": 0.9651908396946565,
            "f1_micro": 0.9651908396946565,
            "accuracy": 0.9651908396946565,
            "hamming_loss": 0.03480916030534351,
            "no_defect_precision": 0.9701848539057841,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9661520190023754,
            "no_defect_tp": 1627,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.9599499374217773,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9641734758013828,
            "defect_tp": 1534,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9650606343283582,
            "recall_macro": 0.965313431476205,
            "f1_macro": 0.9651639436039376,
            "precision_micro": 0.9651908396946565,
            "recall_micro": 0.9651908396946565,
            "f1_micro": 0.9651908396946565,
            "accuracy": 0.9651908396946565,
            "hamming_loss": 0.03480916030534351,
            "no_defect_precision": 0.9707462686567164,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.966131907308378,
            "no_defect_tp": 1626,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.959375,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9641959798994975,
            "defect_tp": 1535,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 49,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.968249057751485,
            "recall_macro": 0.9682567371128257,
            "f1_macro": 0.9682525365058929,
            "precision_micro": 0.9682539682539683,
            "recall_micro": 0.9682539682539683,
            "f1_micro": 0.9682539682539683,
            "accuracy": 0.9682539682539683,
            "hamming_loss": 0.031746031746031744,
            "no_defect_precision": 0.9690533980582524,
            "no_defect_recall": 0.9678787878787879,
            "no_defect_f1": 0.968465736810188,
            "no_defect_tp": 1597,
            "no_defect_fp": 51,
            "no_defect_tn": 1575,
            "no_defect_fn": 53,
            "no_defect_support": 1650,
            "defect_precision": 0.9674447174447175,
            "defect_recall": 0.9686346863468634,
            "defect_f1": 0.968039336201598,
            "defect_tp": 1575,
            "defect_fp": 53,
            "defect_tn": 1597,
            "defect_fn": 51,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.001_s70_20251207_134831",
    "lr": 0.01,
    "weight_decay": 0.001,
    "seed": 70,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.966064295662251,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.001_s70_20251207_134831",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s70_20251207_134831",
      "timestamp": "2025-12-07T13:50:23.438283",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.001_s70",
          "seed": 70,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s70_20251207_134831"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9661624649859943,
        "recall_macro": 0.9659807716431017,
        "f1_macro": 0.966064295662251,
        "precision_micro": 0.9661068702290077,
        "recall_micro": 0.9661068702290077,
        "f1_micro": 0.9661068702290077,
        "accuracy": 0.9661068702290077,
        "hamming_loss": 0.03389312977099237,
        "no_defect_precision": 0.9647058823529412,
        "no_defect_recall": 0.9698403311649911,
        "no_defect_f1": 0.9672662931288706,
        "no_defect_tp": 1640,
        "no_defect_fp": 60,
        "no_defect_tn": 1524,
        "no_defect_fn": 51,
        "no_defect_support": 1691,
        "defect_precision": 0.9676190476190476,
        "defect_recall": 0.9621212121212122,
        "defect_f1": 0.9648622981956315,
        "defect_tp": 1524,
        "defect_fp": 51,
        "defect_tn": 1640,
        "defect_fn": 60,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9670258158007728,
        "recall_macro": 0.9670446159007045,
        "f1_macro": 0.96703197174169,
        "precision_micro": 0.967032967032967,
        "recall_micro": 0.967032967032967,
        "f1_micro": 0.967032967032967,
        "accuracy": 0.967032967032967,
        "hamming_loss": 0.03296703296703297,
        "no_defect_precision": 0.968978102189781,
        "no_defect_recall": 0.9654545454545455,
        "no_defect_f1": 0.9672131147540983,
        "no_defect_tp": 1593,
        "no_defect_fp": 51,
        "no_defect_tn": 1575,
        "no_defect_fn": 57,
        "no_defect_support": 1650,
        "defect_precision": 0.9650735294117647,
        "defect_recall": 0.9686346863468634,
        "defect_f1": 0.9668508287292817,
        "defect_tp": 1575,
        "defect_fp": 57,
        "defect_tn": 1593,
        "defect_fn": 51,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.39015940480152433,
          0.2140478326249322,
          0.18995333012489593,
          0.18183819165601392,
          0.18159634777379835,
          0.18844208247554353,
          0.17593303913538924,
          0.1794558919529785,
          0.1852890135229382,
          0.1779126087866069,
          0.16843514183388095,
          0.1714795651109149,
          0.17234916804225875,
          0.16067938377231233,
          0.165985457645924
        ],
        "val_loss": [
          0.28603830790290463,
          0.15145742463377806,
          0.12221906348489799,
          0.10956479831097218,
          0.1161277868355123,
          0.10216365321181141,
          0.10531229314465936,
          0.09606375670633636,
          0.11214221333368467,
          0.1001460556872189,
          0.09896862682384941,
          0.09551906180926241,
          0.09943622959634432,
          0.09884303546725558,
          0.09889654582366347
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9187650244442644,
            "recall_macro": 0.9167501075211011,
            "f1_macro": 0.9173102301342562,
            "precision_micro": 0.917557251908397,
            "recall_micro": 0.917557251908397,
            "f1_micro": 0.917557251908397,
            "accuracy": 0.917557251908397,
            "hamming_loss": 0.08244274809160305,
            "no_defect_precision": 0.9030062393647192,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9218297625940938,
            "no_defect_tp": 1592,
            "no_defect_fp": 171,
            "no_defect_tn": 1413,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.9345238095238095,
            "defect_recall": 0.8920454545454546,
            "defect_f1": 0.9127906976744186,
            "defect_tp": 1413,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 171,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9510293657730469,
            "recall_macro": 0.9511927002132502,
            "f1_macro": 0.9511021427712917,
            "precision_micro": 0.9511450381679389,
            "recall_micro": 0.9511450381679389,
            "f1_micro": 0.9511450381679389,
            "accuracy": 0.9511450381679389,
            "hamming_loss": 0.04885496183206107,
            "no_defect_precision": 0.9553837001784652,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9525504151838672,
            "no_defect_tp": 1606,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9466750313676286,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9496538703587162,
            "defect_tp": 1509,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9601496168785654,
            "recall_macro": 0.9597874815571446,
            "f1_macro": 0.9599425746310847,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9566744730679156,
            "no_defect_recall": 0.9662921348314607,
            "no_defect_f1": 0.9614592527213887,
            "no_defect_tp": 1634,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 57,
            "no_defect_support": 1691,
            "defect_precision": 0.9636247606892151,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9584258965407807,
            "defect_tp": 1510,
            "defect_fp": 57,
            "defect_tn": 1634,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9599490414947829,
            "recall_macro": 0.9599672433979057,
            "f1_macro": 0.959958052671039,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9615384615384616,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.961254066844129,
            "no_defect_tp": 1625,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9583596214511041,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9586620384979488,
            "defect_tp": 1519,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9535156523302641,
            "recall_macro": 0.9501141291686828,
            "f1_macro": 0.9509528623310495,
            "precision_micro": 0.9511450381679389,
            "recall_micro": 0.9511450381679389,
            "f1_micro": 0.9511450381679389,
            "accuracy": 0.9511450381679389,
            "hamming_loss": 0.04885496183206107,
            "no_defect_precision": 0.9278926774734488,
            "no_defect_recall": 0.9816676522767593,
            "no_defect_f1": 0.9540229885057471,
            "no_defect_tp": 1660,
            "no_defect_fp": 129,
            "no_defect_tn": 1455,
            "no_defect_fn": 31,
            "no_defect_support": 1691,
            "defect_precision": 0.9791386271870794,
            "defect_recall": 0.9185606060606061,
            "defect_f1": 0.9478827361563518,
            "defect_tp": 1455,
            "defect_fp": 31,
            "defect_tn": 1660,
            "defect_fn": 129,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9592662195131962,
            "recall_macro": 0.9594757450316291,
            "f1_macro": 0.9593558294373437,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.964243146603099,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.960522410210745,
            "no_defect_tp": 1618,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9542892924232936,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9581892486639422,
            "defect_tp": 1524,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9588719992349599,
            "recall_macro": 0.9586047494459677,
            "f1_macro": 0.9587232085965891,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.9565727699530516,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.9602356406480118,
            "no_defect_tp": 1630,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9611712285168682,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9572107765451664,
            "defect_tp": 1510,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9627259713716703,
            "recall_macro": 0.9626883112616407,
            "f1_macro": 0.9627067811215202,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9633786178381571,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9639479905437353,
            "no_defect_tp": 1631,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9620733249051833,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9614655716993051,
            "defect_tp": 1522,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9592646341408834,
            "recall_macro": 0.9597193475261186,
            "f1_macro": 0.9590781663437803,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9796672828096118,
            "no_defect_recall": 0.9402720283855707,
            "no_defect_f1": 0.9595654797827399,
            "no_defect_tp": 1590,
            "no_defect_fp": 33,
            "no_defect_tn": 1551,
            "no_defect_fn": 101,
            "no_defect_support": 1691,
            "defect_precision": 0.9388619854721549,
            "defect_recall": 0.9791666666666666,
            "defect_f1": 0.9585908529048207,
            "defect_tp": 1551,
            "defect_fp": 101,
            "defect_tn": 1590,
            "defect_fn": 33,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610891291487536,
            "recall_macro": 0.961509499190605,
            "f1_macro": 0.9612015653886901,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9716525934861279,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9620782323081517,
            "no_defect_tp": 1611,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9505256648113791,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9603248984692284,
            "defect_tp": 1537,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626169747770679,
            "recall_macro": 0.9608863994767307,
            "f1_macro": 0.961426417701839,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9468874928612222,
            "no_defect_recall": 0.9804849201655825,
            "no_defect_f1": 0.9633933759442185,
            "no_defect_tp": 1658,
            "no_defect_fp": 93,
            "no_defect_tn": 1491,
            "no_defect_fn": 33,
            "no_defect_support": 1691,
            "defect_precision": 0.9783464566929134,
            "defect_recall": 0.9412878787878788,
            "defect_f1": 0.9594594594594594,
            "defect_tp": 1491,
            "defect_fp": 33,
            "defect_tn": 1658,
            "defect_fn": 93,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9661624649859943,
            "recall_macro": 0.9659807716431017,
            "f1_macro": 0.966064295662251,
            "precision_micro": 0.9661068702290077,
            "recall_micro": 0.9661068702290077,
            "f1_micro": 0.9661068702290077,
            "accuracy": 0.9661068702290077,
            "hamming_loss": 0.03389312977099237,
            "no_defect_precision": 0.9647058823529412,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.9672662931288706,
            "no_defect_tp": 1640,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.9676190476190476,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9648622981956315,
            "defect_tp": 1524,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638257050082522,
            "recall_macro": 0.9641706464407529,
            "f1_macro": 0.9639463085945955,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9718056388722256,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9648600357355569,
            "no_defect_tp": 1620,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9558457711442786,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9630325814536341,
            "defect_tp": 1537,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638257050082522,
            "recall_macro": 0.9641706464407529,
            "f1_macro": 0.9639463085945955,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9718056388722256,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9648600357355569,
            "no_defect_tp": 1620,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9558457711442786,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9630325814536341,
            "defect_tp": 1537,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635202123111519,
            "recall_macro": 0.9638749634129586,
            "f1_macro": 0.9636413285279899,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9717887154861945,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9645516830503426,
            "no_defect_tp": 1619,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9552517091361094,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9627309740056373,
            "defect_tp": 1537,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 47,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9670258158007728,
            "recall_macro": 0.9670446159007045,
            "f1_macro": 0.96703197174169,
            "precision_micro": 0.967032967032967,
            "recall_micro": 0.967032967032967,
            "f1_micro": 0.967032967032967,
            "accuracy": 0.967032967032967,
            "hamming_loss": 0.03296703296703297,
            "no_defect_precision": 0.968978102189781,
            "no_defect_recall": 0.9654545454545455,
            "no_defect_f1": 0.9672131147540983,
            "no_defect_tp": 1593,
            "no_defect_fp": 51,
            "no_defect_tn": 1575,
            "no_defect_fn": 57,
            "no_defect_support": 1650,
            "defect_precision": 0.9650735294117647,
            "defect_recall": 0.9686346863468634,
            "defect_f1": 0.9668508287292817,
            "defect_tp": 1575,
            "defect_fp": 57,
            "defect_tn": 1593,
            "defect_fn": 51,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.001_s80_20251207_194457",
    "lr": 0.01,
    "weight_decay": 0.001,
    "seed": 80,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9651493495292012,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.001_s80_20251207_194457",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s80_20251207_194457",
      "timestamp": "2025-12-07T19:46:53.407814",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 10,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.001_s80",
          "seed": 80,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s80_20251207_194457"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9652114780948711,
        "recall_macro": 0.965093722559719,
        "f1_macro": 0.9651493495292012,
        "precision_micro": 0.9651908396946565,
        "recall_micro": 0.9651908396946565,
        "f1_micro": 0.9651908396946565,
        "accuracy": 0.9651908396946565,
        "hamming_loss": 0.03480916030534351,
        "no_defect_precision": 0.9646434885091337,
        "no_defect_recall": 0.9680662329982259,
        "no_defect_f1": 0.9663518299881936,
        "no_defect_tp": 1637,
        "no_defect_fp": 60,
        "no_defect_tn": 1524,
        "no_defect_fn": 54,
        "no_defect_support": 1691,
        "defect_precision": 0.9657794676806084,
        "defect_recall": 0.9621212121212122,
        "defect_f1": 0.9639468690702088,
        "defect_tp": 1524,
        "defect_fp": 54,
        "defect_tn": 1637,
        "defect_fn": 60,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9682522643408252,
        "recall_macro": 0.9682522643408252,
        "f1_macro": 0.9682522643408252,
        "precision_micro": 0.9682539682539683,
        "recall_micro": 0.9682539682539683,
        "f1_micro": 0.9682539682539683,
        "accuracy": 0.9682539682539683,
        "hamming_loss": 0.031746031746031744,
        "no_defect_precision": 0.9684848484848485,
        "no_defect_recall": 0.9684848484848485,
        "no_defect_f1": 0.9684848484848485,
        "no_defect_tp": 1598,
        "no_defect_fp": 52,
        "no_defect_tn": 1574,
        "no_defect_fn": 52,
        "no_defect_support": 1650,
        "defect_precision": 0.968019680196802,
        "defect_recall": 0.968019680196802,
        "defect_f1": 0.968019680196802,
        "defect_tp": 1574,
        "defect_fp": 52,
        "defect_tn": 1598,
        "defect_fn": 52,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.38621641333881285,
          0.21075667428421674,
          0.18932714568895276,
          0.18847172726023645,
          0.18769518208054817,
          0.18246367927562743,
          0.1803799582076372,
          0.1788090521228114,
          0.17314293979039752,
          0.1759520724540475,
          0.17001027057422755,
          0.16372141706519547,
          0.16826751803254483,
          0.16783253203251372,
          0.16249599462086686
        ],
        "val_loss": [
          0.28724727865595084,
          0.15476128430320665,
          0.12383621988388208,
          0.10659146484417412,
          0.10928899930933347,
          0.10527033774325481,
          0.11541231589105266,
          0.10855588521091984,
          0.10067652706773235,
          0.09459354875322717,
          0.09840609323090085,
          0.10105700328802833,
          0.10022654993316302,
          0.09711959320478715,
          0.09689924457611945
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9150009734570705,
            "recall_macro": 0.915407213769869,
            "f1_macro": 0.9147976894459353,
            "precision_micro": 0.9148091603053435,
            "recall_micro": 0.9148091603053435,
            "f1_micro": 0.9148091603053435,
            "accuracy": 0.9148091603053435,
            "hamming_loss": 0.08519083969465649,
            "no_defect_precision": 0.9352651048088779,
            "no_defect_recall": 0.8971023063276168,
            "no_defect_f1": 0.9157862964080894,
            "no_defect_tp": 1517,
            "no_defect_fp": 105,
            "no_defect_tn": 1479,
            "no_defect_fn": 174,
            "no_defect_support": 1691,
            "defect_precision": 0.8947368421052632,
            "defect_recall": 0.9337121212121212,
            "defect_f1": 0.9138090824837812,
            "defect_tp": 1479,
            "defect_fp": 174,
            "defect_tn": 1517,
            "defect_fn": 105,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9517607553649092,
            "recall_macro": 0.9522434576396729,
            "f1_macro": 0.9517430868906078,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.9682345754428833,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.9525240384615384,
            "no_defect_tp": 1585,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.9352869352869353,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9509621353196772,
            "defect_tp": 1532,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9575333780860744,
            "recall_macro": 0.9580212234706617,
            "f1_macro": 0.9575448387030288,
            "precision_micro": 0.9575572519083969,
            "recall_micro": 0.9575572519083969,
            "f1_micro": 0.9575572519083969,
            "accuracy": 0.9575572519083969,
            "hamming_loss": 0.042442748091603054,
            "no_defect_precision": 0.973170731707317,
            "no_defect_recall": 0.9438202247191011,
            "no_defect_f1": 0.9582707895526869,
            "no_defect_tp": 1596,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 95,
            "no_defect_support": 1691,
            "defect_precision": 0.9418960244648318,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9568188878533707,
            "defect_tp": 1540,
            "defect_fp": 95,
            "defect_tn": 1596,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623006323800996,
            "recall_macro": 0.9626123371503323,
            "f1_macro": 0.9624168321091106,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9694610778443113,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9634037488842606,
            "no_defect_tp": 1619,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9551401869158879,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9614299153339605,
            "defect_tp": 1533,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598820872063836,
            "recall_macro": 0.9603267670794282,
            "f1_macro": 0.9599817176543564,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.971584038694075,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9608370702541106,
            "no_defect_tp": 1607,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9481801357186922,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9591263650546021,
            "defect_tp": 1537,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604661634724578,
            "recall_macro": 0.9607982919078425,
            "f1_macro": 0.9605847571630131,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9682254196642686,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9615957130098244,
            "no_defect_tp": 1615,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9527069072806472,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9595738013162018,
            "defect_tp": 1531,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9559518481220395,
            "recall_macro": 0.956386940068933,
            "f1_macro": 0.9557198403741624,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9771604938271605,
            "no_defect_recall": 0.9361324659964518,
            "no_defect_f1": 0.9562065841135609,
            "no_defect_tp": 1583,
            "no_defect_fp": 37,
            "no_defect_tn": 1547,
            "no_defect_fn": 108,
            "no_defect_support": 1691,
            "defect_precision": 0.9347432024169184,
            "defect_recall": 0.9766414141414141,
            "defect_f1": 0.9552330966347639,
            "defect_tp": 1547,
            "defect_fp": 108,
            "defect_tn": 1583,
            "defect_fn": 37,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9600153501673004,
            "recall_macro": 0.9605065289201895,
            "f1_macro": 0.9599899131962271,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9767726161369193,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.9606251878569282,
            "no_defect_tp": 1598,
            "no_defect_fp": 38,
            "no_defect_tn": 1546,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.9432580841976815,
            "defect_recall": 0.976010101010101,
            "defect_f1": 0.9593546385355259,
            "defect_tp": 1546,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 38,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9622994556653774,
            "recall_macro": 0.9626722577639195,
            "f1_macro": 0.9624203242305297,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9711538461538461,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.963338301043219,
            "no_defect_tp": 1616,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9534450651769087,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9615023474178404,
            "defect_tp": 1536,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9652114780948711,
            "recall_macro": 0.965093722559719,
            "f1_macro": 0.9651493495292012,
            "precision_micro": 0.9651908396946565,
            "recall_micro": 0.9651908396946565,
            "f1_micro": 0.9651908396946565,
            "accuracy": 0.9651908396946565,
            "hamming_loss": 0.03480916030534351,
            "no_defect_precision": 0.9646434885091337,
            "no_defect_recall": 0.9680662329982259,
            "no_defect_f1": 0.9663518299881936,
            "no_defect_tp": 1637,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 54,
            "no_defect_support": 1691,
            "defect_precision": 0.9657794676806084,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9639468690702088,
            "defect_tp": 1524,
            "defect_fp": 54,
            "defect_tn": 1637,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.963251731470707,
            "recall_macro": 0.9634194920822656,
            "f1_macro": 0.9633266070784687,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9672813801308745,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9644128113879004,
            "no_defect_tp": 1626,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9592220828105396,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9622404027690371,
            "defect_tp": 1529,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9632197426640914,
            "recall_macro": 0.9636192274608892,
            "f1_macro": 0.9633385125846853,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9729078868151716,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.964200477326969,
            "no_defect_tp": 1616,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9535315985130112,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9624765478424016,
            "defect_tp": 1539,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626089298410134,
            "recall_macro": 0.9630078878674384,
            "f1_macro": 0.9627274877944301,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9723058398555088,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9636038186157518,
            "no_defect_tp": 1615,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.952912019826518,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9618511569731082,
            "defect_tp": 1538,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644496268656717,
            "recall_macro": 0.9647020918827542,
            "f1_macro": 0.9645527847197962,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9701492537313433,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9655377302436126,
            "no_defect_tp": 1625,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.95875,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9635678391959799,
            "defect_tp": 1534,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644496268656717,
            "recall_macro": 0.9647020918827542,
            "f1_macro": 0.9645527847197962,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9701492537313433,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9655377302436126,
            "no_defect_tp": 1625,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.95875,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9635678391959799,
            "defect_tp": 1534,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 50,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9682522643408252,
            "recall_macro": 0.9682522643408252,
            "f1_macro": 0.9682522643408252,
            "precision_micro": 0.9682539682539683,
            "recall_micro": 0.9682539682539683,
            "f1_micro": 0.9682539682539683,
            "accuracy": 0.9682539682539683,
            "hamming_loss": 0.031746031746031744,
            "no_defect_precision": 0.9684848484848485,
            "no_defect_recall": 0.9684848484848485,
            "no_defect_f1": 0.9684848484848485,
            "no_defect_tp": 1598,
            "no_defect_fp": 52,
            "no_defect_tn": 1574,
            "no_defect_fn": 52,
            "no_defect_support": 1650,
            "defect_precision": 0.968019680196802,
            "defect_recall": 0.968019680196802,
            "defect_f1": 0.968019680196802,
            "defect_tp": 1574,
            "defect_fp": 52,
            "defect_tn": 1598,
            "defect_fn": 52,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.001_s90_20251207_163835",
    "lr": 0.01,
    "weight_decay": 0.001,
    "seed": 90,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9645216407718538,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.001_s90_20251207_163835",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s90_20251207_163835",
      "timestamp": "2025-12-07T16:40:32.833876",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 11,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.001_s90",
          "seed": 90,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s90_20251207_163835"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9648828112441992,
        "recall_macro": 0.9642826475876446,
        "f1_macro": 0.9645216407718538,
        "precision_micro": 0.9645801526717557,
        "recall_micro": 0.9645801526717557,
        "f1_micro": 0.9645801526717557,
        "accuracy": 0.9645801526717557,
        "hamming_loss": 0.035419847328244276,
        "no_defect_precision": 0.9586488060570763,
        "no_defect_recall": 0.9733885274985216,
        "no_defect_f1": 0.965962441314554,
        "no_defect_tp": 1646,
        "no_defect_fp": 71,
        "no_defect_tn": 1513,
        "no_defect_fn": 45,
        "no_defect_support": 1691,
        "defect_precision": 0.9711168164313222,
        "defect_recall": 0.9551767676767676,
        "defect_f1": 0.9630808402291534,
        "defect_tp": 1513,
        "defect_fp": 45,
        "defect_tn": 1646,
        "defect_fn": 71,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.967026807025495,
        "recall_macro": 0.9670490886727049,
        "f1_macro": 0.9670321806349655,
        "precision_micro": 0.967032967032967,
        "recall_micro": 0.967032967032967,
        "f1_micro": 0.967032967032967,
        "accuracy": 0.967032967032967,
        "hamming_loss": 0.03296703296703297,
        "no_defect_precision": 0.9695493300852619,
        "no_defect_recall": 0.9648484848484848,
        "no_defect_f1": 0.9671931956257594,
        "no_defect_tp": 1592,
        "no_defect_fp": 50,
        "no_defect_tn": 1576,
        "no_defect_fn": 58,
        "no_defect_support": 1650,
        "defect_precision": 0.9645042839657283,
        "defect_recall": 0.9692496924969249,
        "defect_f1": 0.9668711656441717,
        "defect_tp": 1576,
        "defect_fp": 58,
        "defect_tn": 1592,
        "defect_fn": 50,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.39271961626398016,
          0.21821721786609755,
          0.19110047514842643,
          0.186209637749644,
          0.1833136680859402,
          0.1871444756734072,
          0.18314952739985918,
          0.17344403589557406,
          0.17508966114107036,
          0.1735860251014951,
          0.16824039208963826,
          0.17400691650464944,
          0.16487448684341238,
          0.1690316575123426,
          0.16911899430918892
        ],
        "val_loss": [
          0.2869342892215802,
          0.15853784849437383,
          0.11874097399413586,
          0.11749180499464273,
          0.11072625449070564,
          0.10913724223008522,
          0.11225890128228527,
          0.11486289048424134,
          0.10064139442804915,
          0.1008440266506603,
          0.09597191397243968,
          0.10008697125774163,
          0.0966807920127534,
          0.10403965169993731,
          0.10063060512766242
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9212636343710703,
            "recall_macro": 0.920481985735534,
            "f1_macro": 0.9207670739261018,
            "precision_micro": 0.9209160305343511,
            "recall_micro": 0.9209160305343511,
            "f1_micro": 0.9209160305343511,
            "accuracy": 0.9209160305343511,
            "hamming_loss": 0.07908396946564886,
            "no_defect_precision": 0.9148319814600232,
            "no_defect_recall": 0.9337670017740982,
            "no_defect_f1": 0.9242025168276266,
            "no_defect_tp": 1579,
            "no_defect_fp": 147,
            "no_defect_tn": 1437,
            "no_defect_fn": 112,
            "no_defect_support": 1691,
            "defect_precision": 0.9276952872821175,
            "defect_recall": 0.9071969696969697,
            "defect_f1": 0.917331631024577,
            "defect_tp": 1437,
            "defect_fp": 112,
            "defect_tn": 1579,
            "defect_fn": 147,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9494699821971919,
            "recall_macro": 0.9497941792257285,
            "f1_macro": 0.9495851545108307,
            "precision_micro": 0.9496183206106871,
            "recall_micro": 0.9496183206106871,
            "f1_micro": 0.9496183206106871,
            "accuracy": 0.9496183206106871,
            "hamming_loss": 0.050381679389312976,
            "no_defect_precision": 0.9574340527577938,
            "no_defect_recall": 0.9444115907746895,
            "no_defect_f1": 0.9508782375707056,
            "no_defect_tp": 1597,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 94,
            "no_defect_support": 1691,
            "defect_precision": 0.9415059116365899,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.9482920714509558,
            "defect_tp": 1513,
            "defect_fp": 94,
            "defect_tn": 1597,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9593071884579247,
            "recall_macro": 0.9588205383223125,
            "f1_macro": 0.9590203888622861,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9544658493870403,
            "no_defect_recall": 0.9668835008870491,
            "no_defect_f1": 0.9606345475910694,
            "no_defect_tp": 1635,
            "no_defect_fp": 78,
            "no_defect_tn": 1506,
            "no_defect_fn": 56,
            "no_defect_support": 1691,
            "defect_precision": 0.9641485275288092,
            "defect_recall": 0.9507575757575758,
            "defect_f1": 0.9574062301335029,
            "defect_tp": 1506,
            "defect_fp": 56,
            "defect_tn": 1635,
            "defect_fn": 78,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9568018326529151,
            "recall_macro": 0.9571702014228626,
            "f1_macro": 0.9569208594837779,
            "precision_micro": 0.9569465648854962,
            "recall_micro": 0.9569465648854962,
            "f1_micro": 0.9569465648854962,
            "accuracy": 0.9569465648854962,
            "hamming_loss": 0.04305343511450382,
            "no_defect_precision": 0.9657451923076923,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.957973174366617,
            "no_defect_tp": 1607,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9478584729981379,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.955868544600939,
            "defect_tp": 1527,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9593317058034642,
            "recall_macro": 0.9598152951752892,
            "f1_macro": 0.9593756776355213,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9738442822384428,
            "no_defect_recall": 0.9467770549970431,
            "no_defect_f1": 0.960119940029985,
            "no_defect_tp": 1601,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 90,
            "no_defect_support": 1691,
            "defect_precision": 0.9448191293684856,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9586314152410575,
            "defect_tp": 1541,
            "defect_fp": 90,
            "defect_tn": 1601,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9577425920369715,
            "recall_macro": 0.957937409279071,
            "f1_macro": 0.9578271093443816,
            "precision_micro": 0.9578625954198473,
            "recall_micro": 0.9578625954198473,
            "f1_micro": 0.9578625954198473,
            "accuracy": 0.9578625954198473,
            "hamming_loss": 0.04213740458015267,
            "no_defect_precision": 0.9624776652769506,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9590504451038576,
            "no_defect_tp": 1616,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9530075187969925,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9566037735849057,
            "defect_tp": 1521,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9574996158671483,
            "recall_macro": 0.9579812763949369,
            "f1_macro": 0.9575430014386275,
            "precision_micro": 0.9575572519083969,
            "recall_micro": 0.9575572519083969,
            "f1_micro": 0.9575572519083969,
            "accuracy": 0.9575572519083969,
            "hamming_loss": 0.042442748091603054,
            "no_defect_precision": 0.9720194647201946,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.9583208395802099,
            "no_defect_tp": 1598,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.9429797670141018,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9567651632970451,
            "defect_tp": 1538,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9576361284199971,
            "recall_macro": 0.9580051699729406,
            "f1_macro": 0.9572490026942919,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9813780260707635,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.9576014536644458,
            "no_defect_tp": 1581,
            "no_defect_fp": 30,
            "no_defect_tn": 1554,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9338942307692307,
            "defect_recall": 0.9810606060606061,
            "defect_f1": 0.9568965517241379,
            "defect_tp": 1554,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 30,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620003910234741,
            "recall_macro": 0.9622767070468135,
            "f1_macro": 0.9621094219433566,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.968320382546324,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9631391200951248,
            "no_defect_tp": 1620,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9556803995006242,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9610797237915882,
            "defect_tp": 1531,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635206582711429,
            "recall_macro": 0.9638549898750963,
            "f1_macro": 0.9636402023441748,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9712230215827338,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9645727895206907,
            "no_defect_tp": 1620,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.955818294959552,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.962707615167659,
            "defect_tp": 1536,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9648828112441992,
            "recall_macro": 0.9642826475876446,
            "f1_macro": 0.9645216407718538,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9586488060570763,
            "no_defect_recall": 0.9733885274985216,
            "no_defect_f1": 0.965962441314554,
            "no_defect_tp": 1646,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 45,
            "no_defect_support": 1691,
            "defect_precision": 0.9711168164313222,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.9630808402291534,
            "defect_tp": 1513,
            "defect_fp": 45,
            "defect_tn": 1646,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635211496681468,
            "recall_macro": 0.963894936950821,
            "f1_macro": 0.9636424275075857,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9723557692307693,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9645305514157974,
            "no_defect_tp": 1618,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9546865301055245,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.962754303599374,
            "defect_tp": 1538,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962787344302262,
            "recall_macro": 0.9626283906480536,
            "f1_macro": 0.9627021022366603,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9617422012948793,
            "no_defect_recall": 0.9662921348314607,
            "no_defect_f1": 0.9640117994100295,
            "no_defect_tp": 1634,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 57,
            "no_defect_support": 1691,
            "defect_precision": 0.9638324873096447,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9613924050632912,
            "defect_tp": 1519,
            "defect_fp": 57,
            "defect_tn": 1634,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620341306806146,
            "recall_macro": 0.9624964159632995,
            "f1_macro": 0.9621215512982952,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9745608721986675,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9628964691801316,
            "no_defect_tp": 1609,
            "no_defect_fp": 42,
            "no_defect_tn": 1542,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9495073891625616,
            "defect_recall": 0.9734848484848485,
            "defect_f1": 0.9613466334164589,
            "defect_tp": 1542,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 42,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635206582711429,
            "recall_macro": 0.9638549898750963,
            "f1_macro": 0.9636402023441748,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9712230215827338,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9645727895206907,
            "no_defect_tp": 1620,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.955818294959552,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.962707615167659,
            "defect_tp": 1536,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 48,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.967026807025495,
            "recall_macro": 0.9670490886727049,
            "f1_macro": 0.9670321806349655,
            "precision_micro": 0.967032967032967,
            "recall_micro": 0.967032967032967,
            "f1_micro": 0.967032967032967,
            "accuracy": 0.967032967032967,
            "hamming_loss": 0.03296703296703297,
            "no_defect_precision": 0.9695493300852619,
            "no_defect_recall": 0.9648484848484848,
            "no_defect_f1": 0.9671931956257594,
            "no_defect_tp": 1592,
            "no_defect_fp": 50,
            "no_defect_tn": 1576,
            "no_defect_fn": 58,
            "no_defect_support": 1650,
            "defect_precision": 0.9645042839657283,
            "defect_recall": 0.9692496924969249,
            "defect_f1": 0.9668711656441717,
            "defect_tp": 1576,
            "defect_fp": 58,
            "defect_tn": 1592,
            "defect_fn": 50,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.001_s100_20251207_192335",
    "lr": 0.01,
    "weight_decay": 0.001,
    "seed": 100,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.966065752860479,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.001_s100_20251207_192335",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s100_20251207_192335",
      "timestamp": "2025-12-07T19:25:27.567503",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 8,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.001_s100",
          "seed": 100,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s100_20251207_192335"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9661396189182991,
        "recall_macro": 0.966000745180964,
        "f1_macro": 0.966065752860479,
        "precision_micro": 0.9661068702290077,
        "recall_micro": 0.9661068702290077,
        "f1_micro": 0.9661068702290077,
        "accuracy": 0.9661068702290077,
        "hamming_loss": 0.03389312977099237,
        "no_defect_precision": 0.9652532391048292,
        "no_defect_recall": 0.9692489651094027,
        "no_defect_f1": 0.9672469755089997,
        "no_defect_tp": 1639,
        "no_defect_fp": 59,
        "no_defect_tn": 1525,
        "no_defect_fn": 52,
        "no_defect_support": 1691,
        "defect_precision": 0.9670259987317692,
        "defect_recall": 0.9627525252525253,
        "defect_f1": 0.9648845302119582,
        "defect_tp": 1525,
        "defect_fp": 52,
        "defect_tn": 1639,
        "defect_fn": 59,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9676417309627642,
        "recall_macro": 0.9676417309627642,
        "f1_macro": 0.9676417309627642,
        "precision_micro": 0.9676434676434676,
        "recall_micro": 0.9676434676434676,
        "f1_micro": 0.9676434676434676,
        "accuracy": 0.9676434676434676,
        "hamming_loss": 0.03235653235653236,
        "no_defect_precision": 0.9678787878787879,
        "no_defect_recall": 0.9678787878787879,
        "no_defect_f1": 0.9678787878787879,
        "no_defect_tp": 1597,
        "no_defect_fp": 53,
        "no_defect_tn": 1573,
        "no_defect_fn": 53,
        "no_defect_support": 1650,
        "defect_precision": 0.9674046740467405,
        "defect_recall": 0.9674046740467405,
        "defect_f1": 0.9674046740467405,
        "defect_tp": 1573,
        "defect_fp": 53,
        "defect_tn": 1597,
        "defect_fn": 53,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.3893801656602317,
          0.22010457210211573,
          0.183868950131548,
          0.1803611608915748,
          0.18417374540322995,
          0.1835565518229327,
          0.17704249232633343,
          0.18142132970765545,
          0.1810861114864569,
          0.1698432291183761,
          0.17445722013462536,
          0.1702968724633111,
          0.173456490632131,
          0.16373372007800446,
          0.1634021571615251
        ],
        "val_loss": [
          0.28535326512960285,
          0.1563869807869196,
          0.12152400734619452,
          0.11267871535024963,
          0.11358417964612062,
          0.10900393264511457,
          0.10665755170898941,
          0.0971862506479598,
          0.10419159339597592,
          0.10177491207678731,
          0.10590517241507769,
          0.1013053493359341,
          0.10359296700558983,
          0.09715872232873853,
          0.09813007501025613
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9197677687809267,
            "recall_macro": 0.918052680859452,
            "f1_macro": 0.9185565888434821,
            "precision_micro": 0.9187786259541985,
            "recall_micro": 0.9187786259541985,
            "f1_micro": 0.9187786259541985,
            "accuracy": 0.9187786259541985,
            "hamming_loss": 0.08122137404580153,
            "no_defect_precision": 0.905982905982906,
            "no_defect_recall": 0.9402720283855707,
            "no_defect_f1": 0.922809053975624,
            "no_defect_tp": 1590,
            "no_defect_fp": 165,
            "no_defect_tn": 1419,
            "no_defect_fn": 101,
            "no_defect_support": 1691,
            "defect_precision": 0.9335526315789474,
            "defect_recall": 0.8958333333333334,
            "defect_f1": 0.9143041237113402,
            "defect_tp": 1419,
            "defect_fp": 101,
            "defect_tn": 1590,
            "defect_fn": 165,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9497913312929176,
            "recall_macro": 0.9500099681020733,
            "f1_macro": 0.9498832506483172,
            "precision_micro": 0.9499236641221374,
            "recall_micro": 0.9499236641221374,
            "f1_micro": 0.9499236641221374,
            "accuracy": 0.9499236641221374,
            "hamming_loss": 0.050076335877862595,
            "no_defect_precision": 0.9552772808586762,
            "no_defect_recall": 0.9473684210526315,
            "no_defect_f1": 0.9513064133016627,
            "no_defect_tp": 1602,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 89,
            "no_defect_support": 1691,
            "defect_precision": 0.9443053817271589,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9484600879949717,
            "defect_tp": 1509,
            "defect_fp": 89,
            "defect_tn": 1602,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9574152325830366,
            "recall_macro": 0.9578015145541757,
            "f1_macro": 0.957533163033753,
            "precision_micro": 0.9575572519083969,
            "recall_micro": 0.9575572519083969,
            "f1_micro": 0.9575572519083969,
            "accuracy": 0.9575572519083969,
            "hamming_loss": 0.042442748091603054,
            "no_defect_precision": 0.96690734055355,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9585445869370712,
            "no_defect_tp": 1607,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9479231246125233,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9565217391304348,
            "defect_tp": 1529,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9568635048043078,
            "recall_macro": 0.9569504925063765,
            "f1_macro": 0.9569047619269822,
            "precision_micro": 0.9569465648854962,
            "recall_micro": 0.9569465648854962,
            "f1_micro": 0.9569465648854962,
            "accuracy": 0.9569465648854962,
            "hamming_loss": 0.04305343511450382,
            "no_defect_precision": 0.9596678529062871,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9582469647616227,
            "no_defect_tp": 1618,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9540591567023285,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9555625590923417,
            "defect_tp": 1516,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9574484670274013,
            "recall_macro": 0.9579013822434874,
            "f1_macro": 0.9575389462233983,
            "precision_micro": 0.9575572519083969,
            "recall_micro": 0.9575572519083969,
            "f1_micro": 0.9575572519083969,
            "accuracy": 0.9575572519083969,
            "hamming_loss": 0.042442748091603054,
            "no_defect_precision": 0.9697336561743342,
            "no_defect_recall": 0.9473684210526315,
            "no_defect_f1": 0.9584205803170804,
            "no_defect_tp": 1602,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 89,
            "no_defect_support": 1691,
            "defect_precision": 0.9451632778804683,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9566573121297163,
            "defect_tp": 1534,
            "defect_fp": 89,
            "defect_tn": 1602,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9589739034765259,
            "recall_macro": 0.9591401149281102,
            "f1_macro": 0.9590480445709568,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9631171921475312,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9602609727164887,
            "no_defect_tp": 1619,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9548306148055207,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9578351164254248,
            "defect_tp": 1522,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962015590615792,
            "recall_macro": 0.9624564688875747,
            "f1_macro": 0.9621196009471126,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9734138972809667,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.962940824865511,
            "no_defect_tp": 1611,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9506172839506173,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9612983770287141,
            "defect_tp": 1540,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9661396189182991,
            "recall_macro": 0.966000745180964,
            "f1_macro": 0.966065752860479,
            "precision_micro": 0.9661068702290077,
            "recall_micro": 0.9661068702290077,
            "f1_micro": 0.9661068702290077,
            "accuracy": 0.9661068702290077,
            "hamming_loss": 0.03389312977099237,
            "no_defect_precision": 0.9652532391048292,
            "no_defect_recall": 0.9692489651094027,
            "no_defect_f1": 0.9672469755089997,
            "no_defect_tp": 1639,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 52,
            "no_defect_support": 1691,
            "defect_precision": 0.9670259987317692,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9648845302119582,
            "defect_tp": 1525,
            "defect_fp": 52,
            "defect_tn": 1639,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629093402432446,
            "recall_macro": 0.9632636238195079,
            "f1_macro": 0.9630302584192167,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9711884753901561,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9639559130175752,
            "no_defect_tp": 1618,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9546302050963331,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9621046038208582,
            "defect_tp": 1536,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610921802260064,
            "recall_macro": 0.9613297373498437,
            "f1_macro": 0.9611907481841506,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9665871121718377,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9622809622809623,
            "no_defect_tp": 1620,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9555972482801751,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.960100534087339,
            "defect_tp": 1528,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604783463994218,
            "recall_macro": 0.9608981595971543,
            "f1_macro": 0.9605905664184332,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.971049457177322,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9614810391161541,
            "no_defect_tp": 1610,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9499072356215214,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9597000937207123,
            "defect_tp": 1536,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962613355594149,
            "recall_macro": 0.9630278614053007,
            "f1_macro": 0.9627285447761194,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.972875226039783,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9635820895522388,
            "no_defect_tp": 1614,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9523514851485149,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.961875,
            "defect_tp": 1539,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9611035852739923,
            "recall_macro": 0.9615494462663298,
            "f1_macro": 0.9612036499397196,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9727932285368803,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9620328849028401,
            "no_defect_tp": 1609,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9494139420111043,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.960374414976599,
            "defect_tp": 1539,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9651371495852176,
            "recall_macro": 0.9651736167111684,
            "f1_macro": 0.9651550221193512,
            "precision_micro": 0.9651908396946565,
            "recall_micro": 0.9651908396946565,
            "f1_micro": 0.9651908396946565,
            "accuracy": 0.9651908396946565,
            "hamming_loss": 0.03480916030534351,
            "no_defect_precision": 0.9668442865600947,
            "no_defect_recall": 0.9657007687758723,
            "no_defect_f1": 0.9662721893491124,
            "no_defect_tp": 1633,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 58,
            "no_defect_support": 1691,
            "defect_precision": 0.9634300126103404,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9640378548895899,
            "defect_tp": 1528,
            "defect_fp": 58,
            "defect_tn": 1633,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9647745932228691,
            "recall_macro": 0.9649578278348236,
            "f1_macro": 0.9648552980760626,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.969047619047619,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9658854939187185,
            "no_defect_tp": 1628,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.9605015673981191,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9638251022334068,
            "defect_tp": 1532,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 52,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9676417309627642,
            "recall_macro": 0.9676417309627642,
            "f1_macro": 0.9676417309627642,
            "precision_micro": 0.9676434676434676,
            "recall_micro": 0.9676434676434676,
            "f1_micro": 0.9676434676434676,
            "accuracy": 0.9676434676434676,
            "hamming_loss": 0.03235653235653236,
            "no_defect_precision": 0.9678787878787879,
            "no_defect_recall": 0.9678787878787879,
            "no_defect_f1": 0.9678787878787879,
            "no_defect_tp": 1597,
            "no_defect_fp": 53,
            "no_defect_tn": 1573,
            "no_defect_fn": 53,
            "no_defect_support": 1650,
            "defect_precision": 0.9674046740467405,
            "defect_recall": 0.9674046740467405,
            "defect_f1": 0.9674046740467405,
            "defect_tp": 1573,
            "defect_fp": 53,
            "defect_tn": 1597,
            "defect_fn": 53,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.001_s110_20251207_140431",
    "lr": 0.01,
    "weight_decay": 0.001,
    "seed": 110,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9669793036694143,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.001_s110_20251207_140431",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s110_20251207_140431",
      "timestamp": "2025-12-07T14:06:31.491364",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.001_s110",
          "seed": 110,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s110_20251207_140431"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9671168526130358,
        "recall_macro": 0.9668678207264843,
        "f1_macro": 0.9669793036694143,
        "precision_micro": 0.9670229007633587,
        "recall_micro": 0.9670229007633587,
        "f1_micro": 0.9670229007633587,
        "accuracy": 0.9670229007633587,
        "hamming_loss": 0.03297709923664122,
        "no_defect_precision": 0.9647680563711099,
        "no_defect_recall": 0.9716144293317563,
        "no_defect_f1": 0.9681791396582203,
        "no_defect_tp": 1643,
        "no_defect_fp": 60,
        "no_defect_tn": 1524,
        "no_defect_fn": 48,
        "no_defect_support": 1691,
        "defect_precision": 0.9694656488549618,
        "defect_recall": 0.9621212121212122,
        "defect_f1": 0.9657794676806084,
        "defect_tp": 1524,
        "defect_fp": 48,
        "defect_tn": 1643,
        "defect_fn": 60,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.969468824030163,
        "recall_macro": 0.9694912221849492,
        "f1_macro": 0.9694742413286719,
        "precision_micro": 0.9694749694749695,
        "recall_micro": 0.9694749694749695,
        "f1_micro": 0.9694749694749695,
        "accuracy": 0.9694749694749695,
        "hamming_loss": 0.030525030525030524,
        "no_defect_precision": 0.9719853836784409,
        "no_defect_recall": 0.9672727272727273,
        "no_defect_f1": 0.9696233292831106,
        "no_defect_tp": 1596,
        "no_defect_fp": 46,
        "no_defect_tn": 1580,
        "no_defect_fn": 54,
        "no_defect_support": 1650,
        "defect_precision": 0.966952264381885,
        "defect_recall": 0.971709717097171,
        "defect_f1": 0.9693251533742331,
        "defect_tp": 1580,
        "defect_fp": 54,
        "defect_tn": 1596,
        "defect_fn": 46,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.39448877558049794,
          0.2176824218620815,
          0.18816668590117697,
          0.18537708750641496,
          0.18084585970602773,
          0.1799226440645162,
          0.18584887253190682,
          0.17686711061574426,
          0.17253043036518237,
          0.17624894495289695,
          0.16884246306439324,
          0.1676972003567917,
          0.16374419473703936,
          0.17157662446341754,
          0.17212111728897156
        ],
        "val_loss": [
          0.28794034398519075,
          0.15377451121233976,
          0.11855983218321434,
          0.10772343244976722,
          0.11763324900172077,
          0.10947449394286825,
          0.10385297650757891,
          0.11304624371517163,
          0.1013091543259529,
          0.10661247849034575,
          0.09925874516081351,
          0.10176569771451446,
          0.09467589704749677,
          0.09769471036270261,
          0.09766266151116444
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9181954203663917,
            "recall_macro": 0.916969816437587,
            "f1_macro": 0.9173673504173825,
            "precision_micro": 0.917557251908397,
            "recall_micro": 0.917557251908397,
            "f1_micro": 0.917557251908397,
            "accuracy": 0.917557251908397,
            "hamming_loss": 0.08244274809160305,
            "no_defect_precision": 0.9080987937966686,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.9213286713286714,
            "no_defect_tp": 1581,
            "no_defect_fp": 160,
            "no_defect_tn": 1424,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9282920469361148,
            "defect_recall": 0.898989898989899,
            "defect_f1": 0.9134060295060936,
            "defect_tp": 1424,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 160,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9503964552238806,
            "recall_macro": 0.9506412812333864,
            "f1_macro": 0.9504961303845431,
            "precision_micro": 0.9505343511450381,
            "recall_micro": 0.9505343511450381,
            "f1_micro": 0.9505343511450381,
            "accuracy": 0.9505343511450381,
            "hamming_loss": 0.04946564885496183,
            "no_defect_precision": 0.9564179104477611,
            "no_defect_recall": 0.9473684210526315,
            "no_defect_f1": 0.9518716577540107,
            "no_defect_tp": 1602,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 89,
            "no_defect_support": 1691,
            "defect_precision": 0.944375,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.9491206030150754,
            "defect_tp": 1511,
            "defect_fp": 89,
            "defect_tn": 1602,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9575372530079407,
            "recall_macro": 0.9569465724662354,
            "f1_macro": 0.95718129058672,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9516598718695399,
            "no_defect_recall": 0.9662921348314607,
            "no_defect_f1": 0.9589201877934272,
            "no_defect_tp": 1634,
            "no_defect_fp": 83,
            "no_defect_tn": 1501,
            "no_defect_fn": 57,
            "no_defect_support": 1691,
            "defect_precision": 0.9634146341463414,
            "defect_recall": 0.94760101010101,
            "defect_f1": 0.9554423933800127,
            "defect_tp": 1501,
            "defect_fp": 57,
            "defect_tn": 1634,
            "defect_fn": 83,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9611080011942081,
            "recall_macro": 0.9612897902741191,
            "f1_macro": 0.9611880248318256,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9654761904761905,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9623257193711064,
            "no_defect_tp": 1622,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9567398119122257,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9600503302925448,
            "defect_tp": 1526,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9561025657090944,
            "recall_macro": 0.9565827554074153,
            "f1_macro": 0.9560214767383826,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9742489270386266,
            "no_defect_recall": 0.9396806623299823,
            "no_defect_f1": 0.9566526189042746,
            "no_defect_tp": 1589,
            "no_defect_fp": 42,
            "no_defect_tn": 1542,
            "no_defect_fn": 102,
            "no_defect_support": 1691,
            "defect_precision": 0.9379562043795621,
            "defect_recall": 0.9734848484848485,
            "defect_f1": 0.9553903345724907,
            "defect_tp": 1542,
            "defect_fp": 102,
            "defect_tn": 1589,
            "defect_fn": 42,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9583597211064141,
            "recall_macro": 0.9588084048647325,
            "f1_macro": 0.9584548409531172,
            "precision_micro": 0.9584732824427481,
            "recall_micro": 0.9584732824427481,
            "f1_micro": 0.9584732824427481,
            "accuracy": 0.9584732824427481,
            "hamming_loss": 0.04152671755725191,
            "no_defect_precision": 0.970356926799758,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9593301435406698,
            "no_defect_tp": 1604,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9463625154130703,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9575795383655645,
            "defect_tp": 1535,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626312281597382,
            "recall_macro": 0.9628281260266771,
            "f1_macro": 0.9627167198551779,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9672424061941632,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9637982195845697,
            "no_defect_tp": 1624,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9580200501253133,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9616352201257862,
            "defect_tp": 1529,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9581629935936594,
            "recall_macro": 0.9586525366019748,
            "f1_macro": 0.9581565628611202,
            "precision_micro": 0.9581679389312977,
            "recall_micro": 0.9581679389312977,
            "f1_micro": 0.9581679389312977,
            "accuracy": 0.9581679389312977,
            "hamming_loss": 0.04183206106870229,
            "no_defect_precision": 0.9743589743589743,
            "no_defect_recall": 0.9438202247191011,
            "no_defect_f1": 0.9588465004505857,
            "no_defect_tp": 1596,
            "no_defect_fp": 42,
            "no_defect_tn": 1542,
            "no_defect_fn": 95,
            "no_defect_support": 1691,
            "defect_precision": 0.9419670128283445,
            "defect_recall": 0.9734848484848485,
            "defect_f1": 0.9574666252716547,
            "defect_tp": 1542,
            "defect_fp": 95,
            "defect_tn": 1596,
            "defect_fn": 42,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638736985581502,
            "recall_macro": 0.964010858137854,
            "f1_macro": 0.963936511088648,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9673202614379085,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.965026674570243,
            "no_defect_tp": 1628,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.960427135678392,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9628463476070529,
            "defect_tp": 1529,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9593168922633286,
            "recall_macro": 0.9597953216374269,
            "f1_macro": 0.959374753131033,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9732685297691372,
            "no_defect_recall": 0.9473684210526315,
            "no_defect_f1": 0.9601438417740485,
            "no_defect_tp": 1602,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 89,
            "no_defect_support": 1691,
            "defect_precision": 0.94536525475752,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9586056644880174,
            "defect_tp": 1540,
            "defect_fp": 89,
            "defect_tn": 1602,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9647657668617334,
            "recall_macro": 0.964977801372686,
            "f1_macro": 0.9648565442503347,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9696066746126341,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9658652419115464,
            "no_defect_tp": 1627,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.9599248591108328,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9638478465891229,
            "defect_tp": 1533,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629279644200959,
            "recall_macro": 0.9633634915088197,
            "f1_macro": 0.9630355691524257,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9740338164251208,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9638482222886167,
            "no_defect_tp": 1613,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9518221124150711,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9622229160162348,
            "defect_tp": 1541,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9671168526130358,
            "recall_macro": 0.9668678207264843,
            "f1_macro": 0.9669793036694143,
            "precision_micro": 0.9670229007633587,
            "recall_micro": 0.9670229007633587,
            "f1_micro": 0.9670229007633587,
            "accuracy": 0.9670229007633587,
            "hamming_loss": 0.03297709923664122,
            "no_defect_precision": 0.9647680563711099,
            "no_defect_recall": 0.9716144293317563,
            "no_defect_f1": 0.9681791396582203,
            "no_defect_tp": 1643,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 48,
            "no_defect_support": 1691,
            "defect_precision": 0.9694656488549618,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9657794676806084,
            "defect_tp": 1524,
            "defect_fp": 48,
            "defect_tn": 1643,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9647419564469666,
            "recall_macro": 0.9650976425998602,
            "f1_macro": 0.9648634687455364,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9729891956782714,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9657432231158772,
            "no_defect_tp": 1621,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9564947172156619,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9639837143751957,
            "defect_tp": 1539,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9647424561906168,
            "recall_macro": 0.9650776690619978,
            "f1_macro": 0.9648623804166396,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9724220623501199,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9657636201250372,
            "no_defect_tp": 1622,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9570628500311139,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9639611407082419,
            "defect_tp": 1538,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 46,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.969468824030163,
            "recall_macro": 0.9694912221849492,
            "f1_macro": 0.9694742413286719,
            "precision_micro": 0.9694749694749695,
            "recall_micro": 0.9694749694749695,
            "f1_micro": 0.9694749694749695,
            "accuracy": 0.9694749694749695,
            "hamming_loss": 0.030525030525030524,
            "no_defect_precision": 0.9719853836784409,
            "no_defect_recall": 0.9672727272727273,
            "no_defect_f1": 0.9696233292831106,
            "no_defect_tp": 1596,
            "no_defect_fp": 46,
            "no_defect_tn": 1580,
            "no_defect_fn": 54,
            "no_defect_support": 1650,
            "defect_precision": 0.966952264381885,
            "defect_recall": 0.971709717097171,
            "defect_f1": 0.9693251533742331,
            "defect_tp": 1580,
            "defect_fp": 54,
            "defect_tn": 1596,
            "defect_fn": 46,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.001_s120_20251207_161259",
    "lr": 0.01,
    "weight_decay": 0.001,
    "seed": 120,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9654513321460336,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.001_s120_20251207_161259",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s120_20251207_161259",
      "timestamp": "2025-12-07T16:14:52.080054",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 8,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.001_s120",
          "seed": 120,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s120_20251207_161259"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9655750722944398,
        "recall_macro": 0.9653494585117885,
        "f1_macro": 0.9654513321460336,
        "precision_micro": 0.9654961832061069,
        "recall_micro": 0.9654961832061069,
        "f1_micro": 0.9654961832061069,
        "accuracy": 0.9654961832061069,
        "hamming_loss": 0.03450381679389313,
        "no_defect_precision": 0.963572267920094,
        "no_defect_recall": 0.9698403311649911,
        "no_defect_f1": 0.9666961391099322,
        "no_defect_tp": 1640,
        "no_defect_fp": 62,
        "no_defect_tn": 1522,
        "no_defect_fn": 51,
        "no_defect_support": 1691,
        "defect_precision": 0.9675778766687858,
        "defect_recall": 0.9608585858585859,
        "defect_f1": 0.9642065251821349,
        "defect_tp": 1522,
        "defect_fp": 51,
        "defect_tn": 1640,
        "defect_fn": 62,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9673680749630117,
        "recall_macro": 0.9673163367997317,
        "f1_macro": 0.9673349027922334,
        "precision_micro": 0.9673382173382173,
        "recall_micro": 0.9673382173382173,
        "f1_micro": 0.9673382173382173,
        "accuracy": 0.9673382173382173,
        "hamming_loss": 0.032661782661782664,
        "no_defect_precision": 0.9650391802290537,
        "no_defect_recall": 0.9703030303030303,
        "no_defect_f1": 0.9676639468117256,
        "no_defect_tp": 1601,
        "no_defect_fp": 58,
        "no_defect_tn": 1568,
        "no_defect_fn": 49,
        "no_defect_support": 1650,
        "defect_precision": 0.9696969696969697,
        "defect_recall": 0.964329643296433,
        "defect_f1": 0.9670058587727413,
        "defect_tp": 1568,
        "defect_fp": 49,
        "defect_tn": 1601,
        "defect_fn": 58,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.3895486272777972,
          0.21646816947470152,
          0.19674125750194535,
          0.18779653379358507,
          0.19343299619759974,
          0.1824145311154581,
          0.18531286694639398,
          0.17520547343347861,
          0.17378492138999277,
          0.1739621430822496,
          0.16944974676460403,
          0.1666113504337217,
          0.17089947917845458,
          0.16979404691622346,
          0.1646064968008127
        ],
        "val_loss": [
          0.28773114343102163,
          0.1467142981978563,
          0.1303705979281893,
          0.11723069681857641,
          0.10396495479373978,
          0.11069920068033613,
          0.09807200923275489,
          0.09553356483005561,
          0.11516365258452985,
          0.10115921647789386,
          0.10393438481080991,
          0.09959105470289405,
          0.09860237677080128,
          0.09654639270873024,
          0.09702451745621286
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9238309822361547,
            "recall_macro": 0.9239980750736221,
            "f1_macro": 0.9239040801820834,
            "precision_micro": 0.923969465648855,
            "recall_micro": 0.923969465648855,
            "f1_micro": 0.923969465648855,
            "accuracy": 0.923969465648855,
            "hamming_loss": 0.07603053435114504,
            "no_defect_precision": 0.9291666666666667,
            "no_defect_recall": 0.9231224127735068,
            "no_defect_f1": 0.9261346781370513,
            "no_defect_tp": 1561,
            "no_defect_fp": 119,
            "no_defect_tn": 1465,
            "no_defect_fn": 130,
            "no_defect_support": 1691,
            "defect_precision": 0.9184952978056427,
            "defect_recall": 0.9248737373737373,
            "defect_f1": 0.9216734822271154,
            "defect_tp": 1465,
            "defect_fp": 130,
            "defect_tn": 1561,
            "defect_fn": 119,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546236559139785,
            "recall_macro": 0.9538099803475322,
            "f1_macro": 0.9541134179931821,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9466666666666667,
            "no_defect_recall": 0.9657007687758723,
            "no_defect_f1": 0.9560889929742389,
            "no_defect_tp": 1633,
            "no_defect_fp": 92,
            "no_defect_tn": 1492,
            "no_defect_fn": 58,
            "no_defect_support": 1691,
            "defect_precision": 0.9625806451612903,
            "defect_recall": 0.9419191919191919,
            "defect_f1": 0.9521378430121251,
            "defect_tp": 1492,
            "defect_fp": 58,
            "defect_tn": 1633,
            "defect_fn": 92,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9508100033230135,
            "recall_macro": 0.9477286914084666,
            "f1_macro": 0.9485121875077204,
            "precision_micro": 0.9487022900763359,
            "recall_micro": 0.9487022900763359,
            "f1_micro": 0.9487022900763359,
            "accuracy": 0.9487022900763359,
            "hamming_loss": 0.05129770992366412,
            "no_defect_precision": 0.9270891755468312,
            "no_defect_recall": 0.9775280898876404,
            "no_defect_f1": 0.9516407599309153,
            "no_defect_tp": 1653,
            "no_defect_fp": 130,
            "no_defect_tn": 1454,
            "no_defect_fn": 38,
            "no_defect_support": 1691,
            "defect_precision": 0.9745308310991957,
            "defect_recall": 0.9179292929292929,
            "defect_f1": 0.9453836150845254,
            "defect_tp": 1454,
            "defect_fp": 38,
            "defect_tn": 1653,
            "defect_fn": 130,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9573002544206616,
            "recall_macro": 0.9577854610564546,
            "f1_macro": 0.9572423368195984,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9748928352725046,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9578820697954272,
            "no_defect_tp": 1592,
            "no_defect_fp": 41,
            "no_defect_tn": 1543,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.9397076735688186,
            "defect_recall": 0.9741161616161617,
            "defect_f1": 0.9566026038437694,
            "defect_tp": 1543,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 41,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9630608323276016,
            "recall_macro": 0.9629640207515725,
            "f1_macro": 0.96301017419732,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9628537735849056,
            "no_defect_recall": 0.9657007687758723,
            "no_defect_f1": 0.9642751697667552,
            "no_defect_tp": 1633,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 58,
            "no_defect_support": 1691,
            "defect_precision": 0.9632678910702976,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9617451786278849,
            "defect_tp": 1521,
            "defect_fp": 58,
            "defect_tn": 1633,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.95690512294761,
            "recall_macro": 0.9573899103393485,
            "f1_macro": 0.9569330573094611,
            "precision_micro": 0.9569465648854962,
            "recall_micro": 0.9569465648854962,
            "f1_micro": 0.9569465648854962,
            "accuracy": 0.9569465648854962,
            "hamming_loss": 0.04305343511450382,
            "no_defect_precision": 0.9719853836784409,
            "no_defect_recall": 0.9438202247191011,
            "no_defect_f1": 0.9576957695769577,
            "no_defect_tp": 1596,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 95,
            "no_defect_support": 1691,
            "defect_precision": 0.941824862216779,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9561703450419645,
            "defect_tp": 1538,
            "defect_fp": 95,
            "defect_tn": 1596,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626042191259583,
            "recall_macro": 0.9629679407917138,
            "f1_macro": 0.9627252901932482,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9711711711711711,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9636471990464839,
            "no_defect_tp": 1617,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9540372670807453,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9618033813400125,
            "defect_tp": 1536,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9655750722944398,
            "recall_macro": 0.9653494585117885,
            "f1_macro": 0.9654513321460336,
            "precision_micro": 0.9654961832061069,
            "recall_micro": 0.9654961832061069,
            "f1_micro": 0.9654961832061069,
            "accuracy": 0.9654961832061069,
            "hamming_loss": 0.03450381679389313,
            "no_defect_precision": 0.963572267920094,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.9666961391099322,
            "no_defect_tp": 1640,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.9675778766687858,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9642065251821349,
            "defect_tp": 1522,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9553736144296996,
            "recall_macro": 0.9557955740133446,
            "f1_macro": 0.9551096655694562,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.977132262051916,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.9555757026291931,
            "no_defect_tp": 1581,
            "no_defect_fp": 37,
            "no_defect_tn": 1547,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9336149668074833,
            "defect_recall": 0.9766414141414141,
            "defect_f1": 0.9546436285097192,
            "defect_tp": 1547,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 37,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9619933598194468,
            "recall_macro": 0.9623566011982629,
            "f1_macro": 0.9621142293767442,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9705705705705706,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9630512514898689,
            "no_defect_tp": 1616,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.953416149068323,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9611772072636193,
            "defect_tp": 1535,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9601656785487013,
            "recall_macro": 0.9605625294936353,
            "f1_macro": 0.960283388633409,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9698976520168573,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.961217183770883,
            "no_defect_tp": 1611,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9504337050805453,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.959349593495935,
            "defect_tp": 1534,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629097593114059,
            "recall_macro": 0.9632436502816455,
            "f1_macro": 0.9630291133079425,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9706235011990407,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9639773742185174,
            "no_defect_tp": 1619,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.955196017423771,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9620808523973676,
            "defect_tp": 1535,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629193074519584,
            "recall_macro": 0.9631837296680584,
            "f1_macro": 0.9630255119535527,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9689366786140979,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9640416047548291,
            "no_defect_tp": 1622,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9569019362898189,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9620094191522763,
            "defect_tp": 1532,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9652570018234286,
            "recall_macro": 0.9650537754839943,
            "f1_macro": 0.9651463563635929,
            "precision_micro": 0.9651908396946565,
            "recall_micro": 0.9651908396946565,
            "f1_micro": 0.9651908396946565,
            "accuracy": 0.9651908396946565,
            "hamming_loss": 0.03480916030534351,
            "no_defect_precision": 0.9635508524397414,
            "no_defect_recall": 0.9692489651094027,
            "no_defect_f1": 0.9663915094339622,
            "no_defect_tp": 1639,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 52,
            "no_defect_support": 1691,
            "defect_precision": 0.9669631512071156,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9639012032932236,
            "defect_tp": 1522,
            "defect_fp": 52,
            "defect_tn": 1639,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638995563943566,
            "recall_macro": 0.9639709110621293,
            "f1_macro": 0.9639337916060975,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.966212211025489,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.9650680876258141,
            "no_defect_tp": 1630,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9615869017632241,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9627994955863808,
            "defect_tp": 1527,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 57,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9673680749630117,
            "recall_macro": 0.9673163367997317,
            "f1_macro": 0.9673349027922334,
            "precision_micro": 0.9673382173382173,
            "recall_micro": 0.9673382173382173,
            "f1_micro": 0.9673382173382173,
            "accuracy": 0.9673382173382173,
            "hamming_loss": 0.032661782661782664,
            "no_defect_precision": 0.9650391802290537,
            "no_defect_recall": 0.9703030303030303,
            "no_defect_f1": 0.9676639468117256,
            "no_defect_tp": 1601,
            "no_defect_fp": 58,
            "no_defect_tn": 1568,
            "no_defect_fn": 49,
            "no_defect_support": 1650,
            "defect_precision": 0.9696969696969697,
            "defect_recall": 0.964329643296433,
            "defect_f1": 0.9670058587727413,
            "defect_tp": 1568,
            "defect_fp": 49,
            "defect_tn": 1601,
            "defect_fn": 58,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.001_s130_20251207_163006",
    "lr": 0.01,
    "weight_decay": 0.001,
    "seed": 130,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9648514015716522,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.001_s130_20251207_163006",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s130_20251207_163006",
      "timestamp": "2025-12-07T16:32:01.116942",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.001_s130",
          "seed": 130,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s130_20251207_163006"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.964809406603973,
        "recall_macro": 0.9648979072212367,
        "f1_macro": 0.9648514015716522,
        "precision_micro": 0.9648854961832061,
        "recall_micro": 0.9648854961832061,
        "f1_micro": 0.9648854961832061,
        "accuracy": 0.9648854961832061,
        "hamming_loss": 0.035114503816793895,
        "no_defect_precision": 0.9673784104389087,
        "no_defect_recall": 0.9645180366646955,
        "no_defect_f1": 0.9659461060112526,
        "no_defect_tp": 1631,
        "no_defect_fp": 55,
        "no_defect_tn": 1529,
        "no_defect_fn": 60,
        "no_defect_support": 1691,
        "defect_precision": 0.9622404027690371,
        "defect_recall": 0.9652777777777778,
        "defect_f1": 0.9637566971320517,
        "defect_tp": 1529,
        "defect_fp": 60,
        "defect_tn": 1631,
        "defect_fn": 55,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9676523079721544,
        "recall_macro": 0.9676327854187633,
        "f1_macro": 0.9676411037822493,
        "precision_micro": 0.9676434676434676,
        "recall_micro": 0.9676434676434676,
        "f1_micro": 0.9676434676434676,
        "accuracy": 0.9676434676434676,
        "hamming_loss": 0.03235653235653236,
        "no_defect_precision": 0.9667472793228536,
        "no_defect_recall": 0.9690909090909091,
        "no_defect_f1": 0.9679176755447942,
        "no_defect_tp": 1599,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 51,
        "no_defect_support": 1650,
        "defect_precision": 0.968557336621455,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.9673645320197044,
        "defect_tp": 1571,
        "defect_fp": 51,
        "defect_tn": 1599,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.38682523101692917,
          0.21837991260958517,
          0.18974494227991442,
          0.18358247490233456,
          0.18216598210038001,
          0.18270502635375227,
          0.17792003791950736,
          0.1782633677343195,
          0.18274268509516156,
          0.17459153277978737,
          0.17044709487253154,
          0.17252781050412225,
          0.173417736577439,
          0.17216473178758782,
          0.16702225855765981
        ],
        "val_loss": [
          0.28814590407105595,
          0.16234581172466278,
          0.11589719720471364,
          0.1250741228174705,
          0.11606853877982268,
          0.12739573884755373,
          0.1052808272294127,
          0.10805973306728098,
          0.11912277362381037,
          0.10535828819355139,
          0.09739251642559583,
          0.09778859588102652,
          0.0976828049080303,
          0.09672000860938659,
          0.0975778538805361
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9149019176196662,
            "recall_macro": 0.912330915601909,
            "f1_macro": 0.9129802319828568,
            "precision_micro": 0.9132824427480916,
            "recall_micro": 0.9132824427480916,
            "f1_micro": 0.9132824427480916,
            "accuracy": 0.9132824427480916,
            "hamming_loss": 0.0867175572519084,
            "no_defect_precision": 0.8958919527293191,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9181084198385236,
            "no_defect_tp": 1592,
            "no_defect_fp": 185,
            "no_defect_tn": 1399,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.9339118825100133,
            "defect_recall": 0.8832070707070707,
            "defect_f1": 0.9078520441271901,
            "defect_tp": 1399,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 185,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9425253412411536,
            "recall_macro": 0.9428015742881206,
            "f1_macro": 0.9419827800975342,
            "precision_micro": 0.9419847328244275,
            "recall_micro": 0.9419847328244275,
            "f1_micro": 0.9419847328244275,
            "accuracy": 0.9419847328244275,
            "hamming_loss": 0.05801526717557252,
            "no_defect_precision": 0.9681846537741734,
            "no_defect_recall": 0.9178001182732111,
            "no_defect_f1": 0.9423193685488768,
            "no_defect_tp": 1552,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 139,
            "no_defect_support": 1691,
            "defect_precision": 0.9168660287081339,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9416461916461917,
            "defect_tp": 1533,
            "defect_fp": 139,
            "defect_tn": 1552,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9616973262678568,
            "recall_macro": 0.9619610504811569,
            "f1_macro": 0.9618032148280503,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.967741935483871,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.962852897473997,
            "no_defect_tp": 1620,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9556527170518426,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9607535321821036,
            "defect_tp": 1530,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9550849948489101,
            "recall_macro": 0.9554998909855503,
            "f1_macro": 0.9548045714984779,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9771181199752629,
            "no_defect_recall": 0.9343583678296866,
            "no_defect_f1": 0.9552599758162031,
            "no_defect_tp": 1580,
            "no_defect_fp": 37,
            "no_defect_tn": 1547,
            "no_defect_fn": 111,
            "no_defect_support": 1691,
            "defect_precision": 0.9330518697225573,
            "defect_recall": 0.9766414141414141,
            "defect_f1": 0.9543491671807526,
            "defect_tp": 1547,
            "defect_fp": 111,
            "defect_tn": 1580,
            "defect_fn": 37,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9550906243007384,
            "recall_macro": 0.9555758650968587,
            "f1_macro": 0.9551013761823397,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9707317073170731,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9558691083758631,
            "no_defect_tp": 1592,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.9394495412844037,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9543336439888164,
            "defect_tp": 1536,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9530009059958418,
            "recall_macro": 0.9532342944525085,
            "f1_macro": 0.9523654129449718,
            "precision_micro": 0.9523664122137404,
            "recall_micro": 0.9523664122137404,
            "f1_micro": 0.9523664122137404,
            "accuracy": 0.9523664122137404,
            "hamming_loss": 0.04763358778625954,
            "no_defect_precision": 0.9799874921826142,
            "no_defect_recall": 0.9266706091070372,
            "no_defect_f1": 0.9525835866261398,
            "no_defect_tp": 1567,
            "no_defect_fp": 32,
            "no_defect_tn": 1552,
            "no_defect_fn": 124,
            "no_defect_support": 1691,
            "defect_precision": 0.9260143198090692,
            "defect_recall": 0.9797979797979798,
            "defect_f1": 0.9521472392638037,
            "defect_tp": 1552,
            "defect_fp": 124,
            "defect_tn": 1567,
            "defect_fn": 32,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604693513816367,
            "recall_macro": 0.9608582125214296,
            "f1_macro": 0.9605883311608212,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9699157641395909,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9615269907545482,
            "no_defect_tp": 1612,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9510229386236826,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9596496715670941,
            "defect_tp": 1534,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9599275957415228,
            "recall_macro": 0.9604066612308777,
            "f1_macro": 0.9599856590989874,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9738760631834751,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9607431824992508,
            "no_defect_tp": 1603,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9459791282995703,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9592281356987239,
            "defect_tp": 1541,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9535751213005568,
            "recall_macro": 0.9539815287708546,
            "f1_macro": 0.9532779820899631,
            "precision_micro": 0.9532824427480916,
            "recall_micro": 0.9532824427480916,
            "f1_micro": 0.9532824427480916,
            "accuracy": 0.9532824427480916,
            "hamming_loss": 0.0467175572519084,
            "no_defect_precision": 0.9758663366336634,
            "no_defect_recall": 0.9325842696629213,
            "no_defect_f1": 0.9537345025703055,
            "no_defect_tp": 1577,
            "no_defect_fp": 39,
            "no_defect_tn": 1545,
            "no_defect_fn": 114,
            "no_defect_support": 1691,
            "defect_precision": 0.9312839059674503,
            "defect_recall": 0.9753787878787878,
            "defect_f1": 0.9528214616096207,
            "defect_tp": 1545,
            "defect_fp": 114,
            "defect_tn": 1577,
            "defect_fn": 39,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.961077761662608,
            "recall_macro": 0.961449578577018,
            "f1_macro": 0.9611982209534737,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9699519230769231,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9621460506706409,
            "no_defect_tp": 1614,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.952203600248293,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9602503912363067,
            "defect_tp": 1534,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9642282493046871,
            "recall_macro": 0.9642466205520611,
            "f1_macro": 0.9642373447519965,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.9656804733727811,
            "no_defect_recall": 0.9651094027202839,
            "no_defect_f1": 0.9653948535936113,
            "no_defect_tp": 1632,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 59,
            "no_defect_support": 1691,
            "defect_precision": 0.9627760252365931,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9630798359103818,
            "defect_tp": 1526,
            "defect_fp": 59,
            "defect_tn": 1632,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9628105748393763,
            "recall_macro": 0.9626084171101912,
            "f1_macro": 0.9627004866347222,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9611992945326279,
            "no_defect_recall": 0.9668835008870491,
            "no_defect_f1": 0.9640330188679245,
            "no_defect_tp": 1635,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 56,
            "no_defect_support": 1691,
            "defect_precision": 0.9644218551461246,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9613679544015199,
            "defect_tp": 1518,
            "defect_fp": 56,
            "defect_tn": 1635,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626635313438964,
            "recall_macro": 0.96276820541309,
            "f1_macro": 0.9627126280770597,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9655786350148368,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9638625592417062,
            "no_defect_tp": 1627,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.959748427672956,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9615626969124134,
            "defect_tp": 1526,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.964809406603973,
            "recall_macro": 0.9648979072212367,
            "f1_macro": 0.9648514015716522,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9673784104389087,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9659461060112526,
            "no_defect_tp": 1631,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9622404027690371,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9637566971320517,
            "defect_tp": 1529,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638533871904299,
            "recall_macro": 0.9640508052135788,
            "f1_macro": 0.963939122482877,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9684335914234663,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9649851632047478,
            "no_defect_tp": 1626,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9592731829573935,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9628930817610063,
            "defect_tp": 1531,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 53,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9676523079721544,
            "recall_macro": 0.9676327854187633,
            "f1_macro": 0.9676411037822493,
            "precision_micro": 0.9676434676434676,
            "recall_micro": 0.9676434676434676,
            "f1_micro": 0.9676434676434676,
            "accuracy": 0.9676434676434676,
            "hamming_loss": 0.03235653235653236,
            "no_defect_precision": 0.9667472793228536,
            "no_defect_recall": 0.9690909090909091,
            "no_defect_f1": 0.9679176755447942,
            "no_defect_tp": 1599,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 51,
            "no_defect_support": 1650,
            "defect_precision": 0.968557336621455,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.9673645320197044,
            "defect_tp": 1571,
            "defect_fp": 51,
            "defect_tn": 1599,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.001_s140_20251207_195026",
    "lr": 0.01,
    "weight_decay": 0.001,
    "seed": 140,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9651590022381853,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.001_s140_20251207_195026",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s140_20251207_195026",
      "timestamp": "2025-12-07T19:52:18.590388",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.001_s140",
          "seed": 140,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s140_20251207_195026"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.965096016326433,
        "recall_macro": 0.9652335373247556,
        "f1_macro": 0.9651590022381853,
        "precision_micro": 0.9651908396946565,
        "recall_micro": 0.9651908396946565,
        "f1_micro": 0.9651908396946565,
        "accuracy": 0.9651908396946565,
        "hamming_loss": 0.03480916030534351,
        "no_defect_precision": 0.9685086155674391,
        "no_defect_recall": 0.9639266706091071,
        "no_defect_f1": 0.966212211025489,
        "no_defect_tp": 1630,
        "no_defect_fp": 53,
        "no_defect_tn": 1531,
        "no_defect_fn": 61,
        "no_defect_support": 1691,
        "defect_precision": 0.9616834170854272,
        "defect_recall": 0.9665404040404041,
        "defect_f1": 0.9641057934508817,
        "defect_tp": 1531,
        "defect_fp": 61,
        "defect_tn": 1630,
        "defect_fn": 53,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9688896476759495,
        "recall_macro": 0.9688449066308845,
        "f1_macro": 0.9688614978149597,
        "precision_micro": 0.9688644688644689,
        "recall_micro": 0.9688644688644689,
        "f1_micro": 0.9688644688644689,
        "accuracy": 0.9688644688644689,
        "hamming_loss": 0.031135531135531136,
        "no_defect_precision": 0.9668275030156815,
        "no_defect_recall": 0.9715151515151516,
        "no_defect_f1": 0.9691656590084643,
        "no_defect_tp": 1603,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 47,
        "no_defect_support": 1650,
        "defect_precision": 0.9709517923362175,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.968557336621455,
        "defect_tp": 1571,
        "defect_fp": 47,
        "defect_tn": 1603,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.387789751321202,
          0.2197146533236344,
          0.18761199120447725,
          0.18169737744406178,
          0.1782577593643296,
          0.18739919074534372,
          0.17745282407460353,
          0.1787050003068966,
          0.17730047237361823,
          0.17282465497756602,
          0.16280504673033577,
          0.169263564860721,
          0.16665127903035995,
          0.16626413462675765,
          0.16464712851092406
        ],
        "val_loss": [
          0.2885645072047527,
          0.15350347141233775,
          0.11644296426899158,
          0.10884124545667034,
          0.10110644072007674,
          0.09990385532952271,
          0.10296698143849006,
          0.11922516215306062,
          0.10145290829957677,
          0.10091157214572796,
          0.09670304868800136,
          0.09293063751493509,
          0.0991390310227871,
          0.09316875588578674,
          0.09327831556304143
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9186667071282888,
            "recall_macro": 0.9172055788517941,
            "f1_macro": 0.9176561066272452,
            "precision_micro": 0.9178625954198474,
            "recall_micro": 0.9178625954198474,
            "f1_micro": 0.9178625954198474,
            "accuracy": 0.9178625954198474,
            "hamming_loss": 0.08213740458015267,
            "no_defect_precision": 0.9067505720823799,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.9217795870892701,
            "no_defect_tp": 1585,
            "no_defect_fp": 163,
            "no_defect_tn": 1421,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.9305828421741977,
            "defect_recall": 0.8970959595959596,
            "defect_f1": 0.9135326261652202,
            "defect_tp": 1421,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 163,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9483162298557305,
            "recall_macro": 0.9460744344688756,
            "f1_macro": 0.9467074490052432,
            "precision_micro": 0.9468702290076336,
            "recall_micro": 0.9468702290076336,
            "f1_micro": 0.9468702290076336,
            "accuracy": 0.9468702290076336,
            "hamming_loss": 0.05312977099236641,
            "no_defect_precision": 0.9297450424929179,
            "no_defect_recall": 0.9704316972205795,
            "no_defect_f1": 0.9496527777777778,
            "no_defect_tp": 1641,
            "no_defect_fp": 124,
            "no_defect_tn": 1460,
            "no_defect_fn": 50,
            "no_defect_support": 1691,
            "defect_precision": 0.9668874172185431,
            "defect_recall": 0.9217171717171717,
            "defect_f1": 0.9437621202327084,
            "defect_tp": 1460,
            "defect_fp": 50,
            "defect_tn": 1641,
            "defect_fn": 124,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9607979896137007,
            "recall_macro": 0.9609941072463248,
            "f1_macro": 0.9608831159136293,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9654556283502085,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9620178041543027,
            "no_defect_tp": 1621,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.956140350877193,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.959748427672956,
            "defect_tp": 1526,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9577489793619642,
            "recall_macro": 0.9581970652712817,
            "f1_macro": 0.9578438827318396,
            "precision_micro": 0.9578625954198473,
            "recall_micro": 0.9578625954198473,
            "f1_micro": 0.9578625954198473,
            "accuracy": 0.9578625954198473,
            "hamming_loss": 0.04213740458015267,
            "no_defect_precision": 0.969751966122202,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.958732057416268,
            "no_defect_tp": 1603,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9457459926017263,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9569557080474111,
            "defect_tp": 1534,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9628885934866038,
            "recall_macro": 0.9625484964966041,
            "f1_macro": 0.9626954718063477,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9595782073813708,
            "no_defect_recall": 0.9686575990538143,
            "no_defect_f1": 0.9640965273690406,
            "no_defect_tp": 1638,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 53,
            "no_defect_support": 1691,
            "defect_precision": 0.9661989795918368,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9612944162436549,
            "defect_tp": 1515,
            "defect_fp": 53,
            "defect_tn": 1638,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604783463994218,
            "recall_macro": 0.9608981595971543,
            "f1_macro": 0.9605905664184332,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.971049457177322,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9614810391161541,
            "no_defect_tp": 1610,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9499072356215214,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9597000937207123,
            "defect_tp": 1536,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9611637957397803,
            "recall_macro": 0.9616493139556416,
            "f1_macro": 0.961208353832415,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.975669099756691,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9619190404797601,
            "no_defect_tp": 1604,
            "no_defect_fp": 40,
            "no_defect_tn": 1544,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9466584917228694,
            "defect_recall": 0.9747474747474747,
            "defect_f1": 0.96049766718507,
            "defect_tp": 1544,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 40,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9550284596706916,
            "recall_macro": 0.9553240491849303,
            "f1_macro": 0.9545021200021444,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9806733167082294,
            "no_defect_recall": 0.9302188054405677,
            "no_defect_f1": 0.9547799696509863,
            "no_defect_tp": 1573,
            "no_defect_fp": 31,
            "no_defect_tn": 1553,
            "no_defect_fn": 118,
            "no_defect_support": 1691,
            "defect_precision": 0.9293836026331538,
            "defect_recall": 0.9804292929292929,
            "defect_f1": 0.9542242703533026,
            "defect_tp": 1553,
            "defect_fp": 118,
            "defect_tn": 1573,
            "defect_fn": 31,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.960213316505512,
            "recall_macro": 0.9606823707208095,
            "f1_macro": 0.960289700971888,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9733171619163129,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9610778443113772,
            "no_defect_tp": 1605,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.947109471094711,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9595015576323987,
            "defect_tp": 1540,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638305554871693,
            "recall_macro": 0.96423056705434,
            "f1_macro": 0.9639495373749405,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9735099337748344,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9647971360381862,
            "no_defect_tp": 1617,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9541511771995044,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9631019387116948,
            "defect_tp": 1540,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644367970454928,
            "recall_macro": 0.964801959572066,
            "f1_macro": 0.9645584726427606,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.972972972972973,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.965435041716329,
            "no_defect_tp": 1620,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9559006211180124,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9636819035691923,
            "defect_tp": 1539,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638533871904299,
            "recall_macro": 0.9640508052135788,
            "f1_macro": 0.963939122482877,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9684335914234663,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9649851632047478,
            "no_defect_tp": 1626,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9592731829573935,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9628930817610063,
            "defect_tp": 1531,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962002563276219,
            "recall_macro": 0.96241652181185,
            "f1_macro": 0.9621175373134329,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9722724532851115,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9629850746268657,
            "no_defect_tp": 1613,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9517326732673267,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.96125,
            "defect_tp": 1538,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.965096016326433,
            "recall_macro": 0.9652335373247556,
            "f1_macro": 0.9651590022381853,
            "precision_micro": 0.9651908396946565,
            "recall_micro": 0.9651908396946565,
            "f1_micro": 0.9651908396946565,
            "accuracy": 0.9651908396946565,
            "hamming_loss": 0.03480916030534351,
            "no_defect_precision": 0.9685086155674391,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.966212211025489,
            "no_defect_tp": 1630,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9616834170854272,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9641057934508817,
            "defect_tp": 1531,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9647848083880652,
            "recall_macro": 0.9649378542969613,
            "f1_macro": 0.9648540255753512,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9684898929845422,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9659057219092796,
            "no_defect_tp": 1629,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9610797237915882,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9638023292414227,
            "defect_tp": 1531,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 53,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9688896476759495,
            "recall_macro": 0.9688449066308845,
            "f1_macro": 0.9688614978149597,
            "precision_micro": 0.9688644688644689,
            "recall_micro": 0.9688644688644689,
            "f1_micro": 0.9688644688644689,
            "accuracy": 0.9688644688644689,
            "hamming_loss": 0.031135531135531136,
            "no_defect_precision": 0.9668275030156815,
            "no_defect_recall": 0.9715151515151516,
            "no_defect_f1": 0.9691656590084643,
            "no_defect_tp": 1603,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 47,
            "no_defect_support": 1650,
            "defect_precision": 0.9709517923362175,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.968557336621455,
            "defect_tp": 1571,
            "defect_fp": 47,
            "defect_tn": 1603,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.001_s150_20251207_135329",
    "lr": 0.01,
    "weight_decay": 0.001,
    "seed": 150,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9657636023410676,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.001_s150_20251207_135329",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s150_20251207_135329",
      "timestamp": "2025-12-07T13:55:22.626925",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.001,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.001,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.001_s150",
          "seed": 150,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.001_s150_20251207_135329"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9657829181361791,
        "recall_macro": 0.9657450092288945,
        "f1_macro": 0.9657636023410676,
        "precision_micro": 0.9658015267175573,
        "recall_micro": 0.9658015267175573,
        "f1_micro": 0.9658015267175573,
        "accuracy": 0.9658015267175573,
        "hamming_loss": 0.03419847328244275,
        "no_defect_precision": 0.9663319551092735,
        "no_defect_recall": 0.9674748669426375,
        "no_defect_f1": 0.966903073286052,
        "no_defect_tp": 1636,
        "no_defect_fp": 57,
        "no_defect_tn": 1527,
        "no_defect_fn": 55,
        "no_defect_support": 1691,
        "defect_precision": 0.9652338811630847,
        "defect_recall": 0.9640151515151515,
        "defect_f1": 0.9646241313960834,
        "defect_tp": 1527,
        "defect_fp": 55,
        "defect_tn": 1636,
        "defect_fn": 57,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9688808373590982,
        "recall_macro": 0.968849379402885,
        "f1_macro": 0.9688618576206595,
        "precision_micro": 0.9688644688644689,
        "recall_micro": 0.9688644688644689,
        "f1_micro": 0.9688644688644689,
        "accuracy": 0.9688644688644689,
        "hamming_loss": 0.031135531135531136,
        "no_defect_precision": 0.967391304347826,
        "no_defect_recall": 0.9709090909090909,
        "no_defect_f1": 0.969147005444646,
        "no_defect_tp": 1602,
        "no_defect_fp": 54,
        "no_defect_tn": 1572,
        "no_defect_fn": 48,
        "no_defect_support": 1650,
        "defect_precision": 0.9703703703703703,
        "defect_recall": 0.966789667896679,
        "defect_f1": 0.9685767097966729,
        "defect_tp": 1572,
        "defect_fp": 48,
        "defect_tn": 1602,
        "defect_fn": 54,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.390245316729386,
          0.22015195922871514,
          0.18170479819116234,
          0.18098419792482542,
          0.1876907410045548,
          0.18466917224321905,
          0.18811683719938768,
          0.18086227595369686,
          0.17687400357182056,
          0.17087023984251162,
          0.16605701113595125,
          0.17486604937512007,
          0.17204961370848212,
          0.168389381256313,
          0.16357198631133743
        ],
        "val_loss": [
          0.2895608724882969,
          0.15384001112901247,
          0.11729423049837351,
          0.10570229632923236,
          0.10364202341924493,
          0.10426944565887634,
          0.10642524593724655,
          0.09723959673339358,
          0.09749709037490763,
          0.09794901805714919,
          0.09609617830182497,
          0.09689646110368463,
          0.09682691057857412,
          0.09573882746581848,
          0.09614070053570546
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9180676911728363,
            "recall_macro": 0.9181004680154592,
            "f1_macro": 0.9180837362104045,
            "precision_micro": 0.9181679389312977,
            "recall_micro": 0.9181679389312977,
            "f1_micro": 0.9181679389312977,
            "accuracy": 0.9181679389312977,
            "hamming_loss": 0.08183206106870229,
            "no_defect_precision": 0.9212551805802249,
            "no_defect_recall": 0.9201655824955648,
            "no_defect_f1": 0.9207100591715977,
            "no_defect_tp": 1556,
            "no_defect_fp": 133,
            "no_defect_tn": 1451,
            "no_defect_fn": 135,
            "no_defect_support": 1691,
            "defect_precision": 0.9148802017654477,
            "defect_recall": 0.9160353535353535,
            "defect_f1": 0.9154574132492114,
            "defect_tp": 1451,
            "defect_fp": 135,
            "defect_tn": 1556,
            "defect_fn": 133,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9540845288952642,
            "recall_macro": 0.9545290277105771,
            "f1_macro": 0.9541781334041733,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9661222020568663,
            "no_defect_recall": 0.9444115907746895,
            "no_defect_f1": 0.9551435406698564,
            "no_defect_tp": 1597,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 94,
            "no_defect_support": 1691,
            "defect_precision": 0.9420468557336621,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9532127261384903,
            "defect_tp": 1528,
            "defect_fp": 94,
            "defect_tn": 1597,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9589739034765259,
            "recall_macro": 0.9591401149281102,
            "f1_macro": 0.9590480445709568,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9631171921475312,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9602609727164887,
            "no_defect_tp": 1619,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9548306148055207,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9578351164254248,
            "defect_tp": 1522,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9613821638657343,
            "recall_macro": 0.9617252880669498,
            "f1_macro": 0.9615019905332121,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9694061187762447,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9624776652769506,
            "no_defect_tp": 1616,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9533582089552238,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9605263157894737,
            "defect_tp": 1533,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.965096016326433,
            "recall_macro": 0.9652335373247556,
            "f1_macro": 0.9651590022381853,
            "precision_micro": 0.9651908396946565,
            "recall_micro": 0.9651908396946565,
            "f1_micro": 0.9651908396946565,
            "accuracy": 0.9651908396946565,
            "hamming_loss": 0.03480916030534351,
            "no_defect_precision": 0.9685086155674391,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.966212211025489,
            "no_defect_tp": 1630,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9616834170854272,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9641057934508817,
            "defect_tp": 1531,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620877489766448,
            "recall_macro": 0.9625763101147489,
            "f1_macro": 0.9621251122909746,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9768715763846622,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9628074385122976,
            "no_defect_tp": 1605,
            "no_defect_fp": 38,
            "no_defect_tn": 1546,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9473039215686274,
            "defect_recall": 0.976010101010101,
            "defect_f1": 0.9614427860696517,
            "defect_tp": 1546,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 38,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604928362401879,
            "recall_macro": 0.960938106672879,
            "f1_macro": 0.960592683797038,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9721886336154776,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9614349775784753,
            "no_defect_tp": 1608,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9487970388648982,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9597503900156006,
            "defect_tp": 1538,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9653559414593968,
            "recall_macro": 0.9657489292690358,
            "f1_macro": 0.9654766001641302,
            "precision_micro": 0.9654961832061069,
            "recall_micro": 0.9654961832061069,
            "f1_micro": 0.9654961832061069,
            "accuracy": 0.9654961832061069,
            "hamming_loss": 0.03450381679389313,
            "no_defect_precision": 0.9747292418772563,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9662988368625112,
            "no_defect_tp": 1620,
            "no_defect_fp": 42,
            "no_defect_tn": 1542,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9559826410415375,
            "defect_recall": 0.9734848484848485,
            "defect_f1": 0.9646543634657492,
            "defect_tp": 1542,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 42,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.964696378205727,
            "recall_macro": 0.9644024888148188,
            "f1_macro": 0.9645317367666686,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9618768328445748,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.9658421672555948,
            "no_defect_tp": 1640,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.967515923566879,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9632213062777425,
            "defect_tp": 1519,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635911045533403,
            "recall_macro": 0.9630999154764678,
            "f1_macro": 0.9633018407721965,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9585522475189726,
            "no_defect_recall": 0.9710230632761679,
            "no_defect_f1": 0.9647473560517039,
            "no_defect_tp": 1642,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 49,
            "no_defect_support": 1691,
            "defect_precision": 0.9686299615877081,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.9618563254926892,
            "defect_tp": 1513,
            "defect_fp": 49,
            "defect_tn": 1642,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9636169339032722,
            "recall_macro": 0.9636352809586104,
            "f1_macro": 0.9636260173118598,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9650887573964497,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9648033126293996,
            "no_defect_tp": 1631,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9621451104100947,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.96244872199432,
            "defect_tp": 1525,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9637011272807019,
            "recall_macro": 0.9625845235321876,
            "f1_macro": 0.9629757664233577,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9527104959630911,
            "no_defect_recall": 0.976936723832052,
            "no_defect_f1": 0.9646715328467154,
            "no_defect_tp": 1652,
            "no_defect_fp": 82,
            "no_defect_tn": 1502,
            "no_defect_fn": 39,
            "no_defect_support": 1691,
            "defect_precision": 0.9746917585983128,
            "defect_recall": 0.9482323232323232,
            "defect_f1": 0.96128,
            "defect_tp": 1502,
            "defect_fp": 39,
            "defect_tn": 1652,
            "defect_fn": 82,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9647964127194089,
            "recall_macro": 0.964917880759099,
            "f1_macro": 0.9648527267424906,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9679334916864608,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.965925925925926,
            "no_defect_tp": 1630,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.961659333752357,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9637795275590552,
            "defect_tp": 1530,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9657829181361791,
            "recall_macro": 0.9657450092288945,
            "f1_macro": 0.9657636023410676,
            "precision_micro": 0.9658015267175573,
            "recall_micro": 0.9658015267175573,
            "f1_micro": 0.9658015267175573,
            "accuracy": 0.9658015267175573,
            "hamming_loss": 0.03419847328244275,
            "no_defect_precision": 0.9663319551092735,
            "no_defect_recall": 0.9674748669426375,
            "no_defect_f1": 0.966903073286052,
            "no_defect_tp": 1636,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 55,
            "no_defect_support": 1691,
            "defect_precision": 0.9652338811630847,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9646241313960834,
            "defect_tp": 1527,
            "defect_fp": 55,
            "defect_tn": 1636,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9651536431733061,
            "recall_macro": 0.9651536431733061,
            "f1_macro": 0.9651536431733061,
            "precision_micro": 0.9651908396946565,
            "recall_micro": 0.9651908396946565,
            "f1_micro": 0.9651908396946565,
            "accuracy": 0.9651908396946565,
            "hamming_loss": 0.03480916030534351,
            "no_defect_precision": 0.9662921348314607,
            "no_defect_recall": 0.9662921348314607,
            "no_defect_f1": 0.9662921348314607,
            "no_defect_tp": 1634,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 57,
            "no_defect_support": 1691,
            "defect_precision": 0.9640151515151515,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9640151515151515,
            "defect_tp": 1527,
            "defect_fp": 57,
            "defect_tn": 1634,
            "defect_fn": 57,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9688808373590982,
            "recall_macro": 0.968849379402885,
            "f1_macro": 0.9688618576206595,
            "precision_micro": 0.9688644688644689,
            "recall_micro": 0.9688644688644689,
            "f1_micro": 0.9688644688644689,
            "accuracy": 0.9688644688644689,
            "hamming_loss": 0.031135531135531136,
            "no_defect_precision": 0.967391304347826,
            "no_defect_recall": 0.9709090909090909,
            "no_defect_f1": 0.969147005444646,
            "no_defect_tp": 1602,
            "no_defect_fp": 54,
            "no_defect_tn": 1572,
            "no_defect_fn": 48,
            "no_defect_support": 1650,
            "defect_precision": 0.9703703703703703,
            "defect_recall": 0.966789667896679,
            "defect_f1": 0.9685767097966729,
            "defect_tp": 1572,
            "defect_fp": 48,
            "defect_tn": 1602,
            "defect_fn": 54,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.01_s10_20251207_140138",
    "lr": 0.01,
    "weight_decay": 0.01,
    "seed": 10,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9651577016457771,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.01_s10_20251207_140138",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s10_20251207_140138",
      "timestamp": "2025-12-07T14:03:36.111089",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.01_s10",
          "seed": 10,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s10_20251207_140138"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9651083365992945,
        "recall_macro": 0.9652135637868933,
        "f1_macro": 0.9651577016457771,
        "precision_micro": 0.9651908396946565,
        "recall_micro": 0.9651908396946565,
        "f1_micro": 0.9651908396946565,
        "accuracy": 0.9651908396946565,
        "hamming_loss": 0.03480916030534351,
        "no_defect_precision": 0.9679525222551929,
        "no_defect_recall": 0.9645180366646955,
        "no_defect_f1": 0.9662322274881516,
        "no_defect_tp": 1631,
        "no_defect_fp": 54,
        "no_defect_tn": 1530,
        "no_defect_fn": 60,
        "no_defect_support": 1691,
        "defect_precision": 0.9622641509433962,
        "defect_recall": 0.9659090909090909,
        "defect_f1": 0.9640831758034026,
        "defect_tp": 1530,
        "defect_fp": 60,
        "defect_tn": 1631,
        "defect_fn": 54,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9685797762911235,
        "recall_macro": 0.9685418763278542,
        "f1_macro": 0.9685564029795322,
        "precision_micro": 0.9685592185592186,
        "recall_micro": 0.9685592185592186,
        "f1_micro": 0.9685592185592186,
        "accuracy": 0.9685592185592186,
        "hamming_loss": 0.03144078144078144,
        "no_defect_precision": 0.9668074834037417,
        "no_defect_recall": 0.9709090909090909,
        "no_defect_f1": 0.9688539461747808,
        "no_defect_tp": 1602,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 48,
        "no_defect_support": 1650,
        "defect_precision": 0.9703520691785052,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.9682588597842835,
        "defect_tp": 1571,
        "defect_fp": 48,
        "defect_tn": 1602,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.39156130903934333,
          0.22068665525778566,
          0.18981646843036348,
          0.18853717718164292,
          0.18051523551594265,
          0.1796733691945485,
          0.18693857136568265,
          0.18518047920081407,
          0.17739268132021738,
          0.17166674706040566,
          0.16878086845994494,
          0.1694956253512634,
          0.16192973624899298,
          0.16191882700912624,
          0.1684982332256798
        ],
        "val_loss": [
          0.2916242824150966,
          0.15268691987372363,
          0.14748811535537243,
          0.1069615577132656,
          0.10703215217934205,
          0.10481524342097916,
          0.10442052849640067,
          0.10367891364372693,
          0.10335557424248411,
          0.09704643470020248,
          0.10111106029496743,
          0.10266439423251611,
          0.09752508217039016,
          0.09887965600221203,
          0.09801323357253121
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9140400600878931,
            "recall_macro": 0.9142765621919968,
            "f1_macro": 0.9141336269334571,
            "precision_micro": 0.9141984732824427,
            "recall_micro": 0.9141984732824427,
            "f1_micro": 0.9141984732824427,
            "accuracy": 0.9141984732824427,
            "hamming_loss": 0.08580152671755725,
            "no_defect_precision": 0.921146953405018,
            "no_defect_recall": 0.911886457717327,
            "no_defect_f1": 0.9164933135215453,
            "no_defect_tp": 1542,
            "no_defect_fp": 132,
            "no_defect_tn": 1452,
            "no_defect_fn": 149,
            "no_defect_support": 1691,
            "defect_precision": 0.9069331667707683,
            "defect_recall": 0.9166666666666666,
            "defect_f1": 0.911773940345369,
            "defect_tp": 1452,
            "defect_fp": 149,
            "defect_tn": 1542,
            "defect_fn": 132,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9523700961885322,
            "recall_macro": 0.9522555910972528,
            "f1_macro": 0.9523096361978542,
            "precision_micro": 0.9523664122137404,
            "recall_micro": 0.9523664122137404,
            "f1_micro": 0.9523664122137404,
            "accuracy": 0.9523664122137404,
            "hamming_loss": 0.04763358778625954,
            "no_defect_precision": 0.9522687094873306,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9539551357733176,
            "no_defect_tp": 1616,
            "no_defect_fp": 81,
            "no_defect_tn": 1503,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9524714828897338,
            "defect_recall": 0.9488636363636364,
            "defect_f1": 0.9506641366223909,
            "defect_tp": 1503,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 81,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.946374184516477,
            "recall_macro": 0.94615787532331,
            "f1_macro": 0.9450375478858616,
            "precision_micro": 0.9450381679389313,
            "recall_micro": 0.9450381679389313,
            "f1_micro": 0.9450381679389313,
            "accuracy": 0.9450381679389313,
            "hamming_loss": 0.0549618320610687,
            "no_defect_precision": 0.9802924348378894,
            "no_defect_recall": 0.911886457717327,
            "no_defect_f1": 0.9448529411764706,
            "no_defect_tp": 1542,
            "no_defect_fp": 31,
            "no_defect_tn": 1553,
            "no_defect_fn": 149,
            "no_defect_support": 1691,
            "defect_precision": 0.9124559341950647,
            "defect_recall": 0.9804292929292929,
            "defect_f1": 0.9452221545952526,
            "defect_tp": 1553,
            "defect_fp": 149,
            "defect_tn": 1542,
            "defect_fn": 31,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9614545740952819,
            "recall_macro": 0.9615255526883262,
            "f1_macro": 0.9614886249353244,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.963841138114997,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9626998223801065,
            "no_defect_tp": 1626,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9590680100755667,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9602774274905422,
            "defect_tp": 1523,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620144610728099,
            "recall_macro": 0.9616015267996345,
            "f1_macro": 0.9617754813861651,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9578947368421052,
            "no_defect_recall": 0.9686575990538143,
            "no_defect_f1": 0.9632461040870333,
            "no_defect_tp": 1638,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 53,
            "no_defect_support": 1691,
            "defect_precision": 0.9661341853035144,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.9603048586852969,
            "defect_tp": 1512,
            "defect_fp": 53,
            "defect_tn": 1638,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.960530844096461,
            "recall_macro": 0.9606185300670812,
            "f1_macro": 0.9605724417629837,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.963226571767497,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9618004145691442,
            "no_defect_tp": 1624,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9578351164254248,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9593444689568232,
            "defect_tp": 1522,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598858038513212,
            "recall_macro": 0.9600671110872175,
            "f1_macro": 0.95996560041708,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9642857142857143,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9611391278552358,
            "no_defect_tp": 1620,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9554858934169279,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9587920729789242,
            "defect_tp": 1524,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626635313438964,
            "recall_macro": 0.96276820541309,
            "f1_macro": 0.9627126280770597,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9655786350148368,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9638625592417062,
            "no_defect_tp": 1627,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.959748427672956,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9615626969124134,
            "defect_tp": 1526,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626042191259583,
            "recall_macro": 0.9629679407917138,
            "f1_macro": 0.9627252901932482,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9711711711711711,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9636471990464839,
            "no_defect_tp": 1617,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9540372670807453,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9618033813400125,
            "defect_tp": 1536,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638268565975256,
            "recall_macro": 0.9641506729028906,
            "f1_macro": 0.9639451783848336,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9712402636309168,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9648809523809524,
            "no_defect_tp": 1621,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9564134495641345,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9630094043887147,
            "defect_tp": 1536,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9622994556653774,
            "recall_macro": 0.9626722577639195,
            "f1_macro": 0.9624203242305297,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9711538461538461,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.963338301043219,
            "no_defect_tp": 1616,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9534450651769087,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9615023474178404,
            "defect_tp": 1536,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629279644200959,
            "recall_macro": 0.9633634915088197,
            "f1_macro": 0.9630355691524257,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9740338164251208,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9638482222886167,
            "no_defect_tp": 1613,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9518221124150711,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9622229160162348,
            "defect_tp": 1541,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9651083365992945,
            "recall_macro": 0.9652135637868933,
            "f1_macro": 0.9651577016457771,
            "precision_micro": 0.9651908396946565,
            "recall_micro": 0.9651908396946565,
            "f1_micro": 0.9651908396946565,
            "accuracy": 0.9651908396946565,
            "hamming_loss": 0.03480916030534351,
            "no_defect_precision": 0.9679525222551929,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9662322274881516,
            "no_defect_tp": 1631,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9622641509433962,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9640831758034026,
            "defect_tp": 1530,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635224877348108,
            "recall_macro": 0.963835016337234,
            "f1_macro": 0.9636390489510906,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9706586826347305,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9645938708717644,
            "no_defect_tp": 1621,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.956386292834891,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.962684227030417,
            "defect_tp": 1535,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9641634945514256,
            "recall_macro": 0.9643464882413729,
            "f1_macro": 0.9642440858686898,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.968452380952381,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9652921981607832,
            "no_defect_tp": 1627,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.9598746081504702,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9631959735765964,
            "defect_tp": 1531,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 53,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9685797762911235,
            "recall_macro": 0.9685418763278542,
            "f1_macro": 0.9685564029795322,
            "precision_micro": 0.9685592185592186,
            "recall_micro": 0.9685592185592186,
            "f1_micro": 0.9685592185592186,
            "accuracy": 0.9685592185592186,
            "hamming_loss": 0.03144078144078144,
            "no_defect_precision": 0.9668074834037417,
            "no_defect_recall": 0.9709090909090909,
            "no_defect_f1": 0.9688539461747808,
            "no_defect_tp": 1602,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 48,
            "no_defect_support": 1650,
            "defect_precision": 0.9703520691785052,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.9682588597842835,
            "defect_tp": 1571,
            "defect_fp": 48,
            "defect_tn": 1602,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.01_s20_20251207_193117",
    "lr": 0.01,
    "weight_decay": 0.01,
    "seed": 20,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9660713270724071,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.01_s20_20251207_193117",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s20_20251207_193117",
      "timestamp": "2025-12-07T19:33:09.770474",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 11,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.01_s20",
          "seed": 20,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s20_20251207_193117"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9660621955089317,
        "recall_macro": 0.9660806393324135,
        "f1_macro": 0.9660713270724071,
        "precision_micro": 0.9661068702290077,
        "recall_micro": 0.9661068702290077,
        "f1_micro": 0.9661068702290077,
        "accuracy": 0.9661068702290077,
        "hamming_loss": 0.03389312977099237,
        "no_defect_precision": 0.9674556213017751,
        "no_defect_recall": 0.9668835008870491,
        "no_defect_f1": 0.9671694764862466,
        "no_defect_tp": 1635,
        "no_defect_fp": 55,
        "no_defect_tn": 1529,
        "no_defect_fn": 56,
        "no_defect_support": 1691,
        "defect_precision": 0.9646687697160883,
        "defect_recall": 0.9652777777777778,
        "defect_f1": 0.9649731776585674,
        "defect_tp": 1529,
        "defect_fp": 56,
        "defect_tn": 1635,
        "defect_fn": 55,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9679427185540762,
        "recall_macro": 0.9679537068097954,
        "f1_macro": 0.9679474008629546,
        "precision_micro": 0.967948717948718,
        "recall_micro": 0.967948717948718,
        "f1_micro": 0.967948717948718,
        "accuracy": 0.967948717948718,
        "hamming_loss": 0.03205128205128205,
        "no_defect_precision": 0.9690346083788707,
        "no_defect_recall": 0.9672727272727273,
        "no_defect_f1": 0.9681528662420382,
        "no_defect_tp": 1596,
        "no_defect_fp": 51,
        "no_defect_tn": 1575,
        "no_defect_fn": 54,
        "no_defect_support": 1650,
        "defect_precision": 0.9668508287292817,
        "defect_recall": 0.9686346863468634,
        "defect_f1": 0.967741935483871,
        "defect_tp": 1575,
        "defect_fp": 54,
        "defect_tn": 1596,
        "defect_fn": 51,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.39275409106679543,
          0.21677518046800062,
          0.18950437891558125,
          0.18245105766476946,
          0.18024280614309232,
          0.18165685353356426,
          0.17920680797686137,
          0.187406373292083,
          0.1724359579384327,
          0.17485456835774696,
          0.1696431468159085,
          0.16975397887838437,
          0.167500375282939,
          0.16831901706911032,
          0.1690615962988163
        ],
        "val_loss": [
          0.2863195257691237,
          0.14995696395635605,
          0.11881590691896585,
          0.10273892475435367,
          0.12303087043647583,
          0.10202167018388326,
          0.1018585069821431,
          0.11343871995520133,
          0.11051509221299337,
          0.0996269930440646,
          0.09640874111881623,
          0.10455391351849987,
          0.10061450227378653,
          0.10069985888325252,
          0.10164923321169156
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.918525351276055,
            "recall_macro": 0.9177209707960743,
            "f1_macro": 0.9180116235361286,
            "precision_micro": 0.9181679389312977,
            "recall_micro": 0.9181679389312977,
            "f1_micro": 0.9181679389312977,
            "accuracy": 0.9181679389312977,
            "hamming_loss": 0.08183206106870229,
            "no_defect_precision": 0.9119861030689056,
            "no_defect_recall": 0.9314015375517445,
            "no_defect_f1": 0.9215915740198947,
            "no_defect_tp": 1575,
            "no_defect_fp": 152,
            "no_defect_tn": 1432,
            "no_defect_fn": 116,
            "no_defect_support": 1691,
            "defect_precision": 0.9250645994832042,
            "defect_recall": 0.9040404040404041,
            "defect_f1": 0.9144316730523627,
            "defect_tp": 1432,
            "defect_fp": 116,
            "defect_tn": 1575,
            "defect_fn": 152,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9554120375666467,
            "recall_macro": 0.9547968971202265,
            "f1_macro": 0.9550392340293672,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9493597206053551,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9568788501026694,
            "no_defect_tp": 1631,
            "no_defect_fp": 87,
            "no_defect_tn": 1497,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9614643545279383,
            "defect_recall": 0.9450757575757576,
            "defect_f1": 0.9531996179560649,
            "defect_tp": 1497,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 87,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9573556605711937,
            "recall_macro": 0.9570664136934095,
            "f1_macro": 0.9571934754080484,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9548387096774194,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9587750294464076,
            "no_defect_tp": 1628,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.9598726114649682,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.9556119213696893,
            "defect_tp": 1507,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9650673956637807,
            "recall_macro": 0.9652934579383425,
            "f1_macro": 0.9651627474018791,
            "precision_micro": 0.9651908396946565,
            "recall_micro": 0.9651908396946565,
            "f1_micro": 0.9651908396946565,
            "accuracy": 0.9651908396946565,
            "hamming_loss": 0.03480916030534351,
            "no_defect_precision": 0.9701848539057841,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9661520190023754,
            "no_defect_tp": 1627,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.9599499374217773,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9641734758013828,
            "defect_tp": 1534,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9523898812055864,
            "recall_macro": 0.9526229548590577,
            "f1_macro": 0.951754713110933,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.9793621013133208,
            "no_defect_recall": 0.9260792430514488,
            "no_defect_f1": 0.9519756838905775,
            "no_defect_tp": 1566,
            "no_defect_fp": 33,
            "no_defect_tn": 1551,
            "no_defect_fn": 125,
            "no_defect_support": 1691,
            "defect_precision": 0.9254176610978521,
            "defect_recall": 0.9791666666666666,
            "defect_f1": 0.9515337423312883,
            "defect_tp": 1551,
            "defect_fp": 125,
            "defect_tn": 1566,
            "defect_fn": 33,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9605638409209838,
            "recall_macro": 0.9600232439713516,
            "f1_macro": 0.9602417302798982,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9551020408163265,
            "no_defect_recall": 0.9686575990538143,
            "no_defect_f1": 0.9618320610687023,
            "no_defect_tp": 1638,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 53,
            "no_defect_support": 1691,
            "defect_precision": 0.966025641025641,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.9586513994910941,
            "defect_tp": 1507,
            "defect_fp": 53,
            "defect_tn": 1638,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638483282788572,
            "recall_macro": 0.9625246029186005,
            "f1_macro": 0.9629694142453307,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9511494252873564,
            "no_defect_recall": 0.9787108219988173,
            "no_defect_f1": 0.9647333139026523,
            "no_defect_tp": 1655,
            "no_defect_fp": 85,
            "no_defect_tn": 1499,
            "no_defect_fn": 36,
            "no_defect_support": 1691,
            "defect_precision": 0.9765472312703583,
            "defect_recall": 0.9463383838383839,
            "defect_f1": 0.961205514588009,
            "defect_tp": 1499,
            "defect_fp": 36,
            "defect_tn": 1655,
            "defect_fn": 85,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9590056320167095,
            "recall_macro": 0.9594436380361868,
            "f1_macro": 0.9587736444862891,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.980246913580247,
            "no_defect_recall": 0.9390892962743939,
            "no_defect_f1": 0.959226819691936,
            "no_defect_tp": 1588,
            "no_defect_fp": 32,
            "no_defect_tn": 1552,
            "no_defect_fn": 103,
            "no_defect_support": 1691,
            "defect_precision": 0.9377643504531722,
            "defect_recall": 0.9797979797979798,
            "defect_f1": 0.9583204692806422,
            "defect_tp": 1552,
            "defect_fp": 103,
            "defect_tn": 1588,
            "defect_fn": 32,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9591099798612666,
            "recall_macro": 0.9595995062989444,
            "f1_macro": 0.9590740447843817,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9761467889908257,
            "no_defect_recall": 0.9438202247191011,
            "no_defect_f1": 0.9597113650030066,
            "no_defect_tp": 1596,
            "no_defect_fp": 39,
            "no_defect_tn": 1545,
            "no_defect_fn": 95,
            "no_defect_support": 1691,
            "defect_precision": 0.9420731707317073,
            "defect_recall": 0.9753787878787878,
            "defect_f1": 0.9584367245657568,
            "defect_tp": 1545,
            "defect_fp": 95,
            "defect_tn": 1596,
            "defect_fn": 39,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9639145662498311,
            "recall_macro": 0.963950937524267,
            "f1_macro": 0.9639323913165214,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9656601539372409,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9650887573964497,
            "no_defect_tp": 1631,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9621689785624212,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9627760252365931,
            "defect_tp": 1526,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9660621955089317,
            "recall_macro": 0.9660806393324135,
            "f1_macro": 0.9660713270724071,
            "precision_micro": 0.9661068702290077,
            "recall_micro": 0.9661068702290077,
            "f1_micro": 0.9661068702290077,
            "accuracy": 0.9661068702290077,
            "hamming_loss": 0.03389312977099237,
            "no_defect_precision": 0.9674556213017751,
            "no_defect_recall": 0.9668835008870491,
            "no_defect_f1": 0.9671694764862466,
            "no_defect_tp": 1635,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 56,
            "no_defect_support": 1691,
            "defect_precision": 0.9646687697160883,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9649731776585674,
            "defect_tp": 1529,
            "defect_fp": 56,
            "defect_tn": 1635,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623055690253273,
            "recall_macro": 0.9627122048396441,
            "f1_macro": 0.9624225117350067,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9722891566265061,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.963294538943599,
            "no_defect_tp": 1614,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9523219814241486,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9615504845264145,
            "defect_tp": 1538,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626232253644427,
            "recall_macro": 0.9628480995645395,
            "f1_macro": 0.9627180279213092,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9677996422182469,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9637767220902613,
            "no_defect_tp": 1623,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9574468085106383,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.961659333752357,
            "defect_tp": 1530,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626075072641556,
            "recall_macro": 0.9629080201781266,
            "f1_macro": 0.9627217846221368,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9694793536804309,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9637120761451516,
            "no_defect_tp": 1620,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9557356608478803,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9617314930991218,
            "defect_tp": 1533,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629093402432446,
            "recall_macro": 0.9632636238195079,
            "f1_macro": 0.9630302584192167,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9711884753901561,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9639559130175752,
            "no_defect_tp": 1618,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9546302050963331,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9621046038208582,
            "defect_tp": 1536,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 48,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9679427185540762,
            "recall_macro": 0.9679537068097954,
            "f1_macro": 0.9679474008629546,
            "precision_micro": 0.967948717948718,
            "recall_micro": 0.967948717948718,
            "f1_micro": 0.967948717948718,
            "accuracy": 0.967948717948718,
            "hamming_loss": 0.03205128205128205,
            "no_defect_precision": 0.9690346083788707,
            "no_defect_recall": 0.9672727272727273,
            "no_defect_f1": 0.9681528662420382,
            "no_defect_tp": 1596,
            "no_defect_fp": 51,
            "no_defect_tn": 1575,
            "no_defect_fn": 54,
            "no_defect_support": 1650,
            "defect_precision": 0.9668508287292817,
            "defect_recall": 0.9686346863468634,
            "defect_f1": 0.967741935483871,
            "defect_tp": 1575,
            "defect_fp": 54,
            "defect_tn": 1596,
            "defect_fn": 51,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.01_s30_20251207_143648",
    "lr": 0.01,
    "weight_decay": 0.01,
    "seed": 30,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9645364250774804,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.01_s30_20251207_143648",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s30_20251207_143648",
      "timestamp": "2025-12-07T14:38:46.313996",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.01_s30",
          "seed": 30,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s30_20251207_143648"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9646219932298187,
        "recall_macro": 0.9644624094284059,
        "f1_macro": 0.9645364250774804,
        "precision_micro": 0.9645801526717557,
        "recall_micro": 0.9645801526717557,
        "f1_micro": 0.9645801526717557,
        "accuracy": 0.9645801526717557,
        "hamming_loss": 0.035419847328244276,
        "no_defect_precision": 0.9635079458505003,
        "no_defect_recall": 0.9680662329982259,
        "no_defect_f1": 0.9657817109144543,
        "no_defect_tp": 1637,
        "no_defect_fp": 62,
        "no_defect_tn": 1522,
        "no_defect_fn": 54,
        "no_defect_support": 1691,
        "defect_precision": 0.9657360406091371,
        "defect_recall": 0.9608585858585859,
        "defect_f1": 0.9632911392405064,
        "defect_tp": 1522,
        "defect_fp": 54,
        "defect_tn": 1637,
        "defect_fn": 62,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9676417309627642,
        "recall_macro": 0.9676417309627642,
        "f1_macro": 0.9676417309627642,
        "precision_micro": 0.9676434676434676,
        "recall_micro": 0.9676434676434676,
        "f1_micro": 0.9676434676434676,
        "accuracy": 0.9676434676434676,
        "hamming_loss": 0.03235653235653236,
        "no_defect_precision": 0.9678787878787879,
        "no_defect_recall": 0.9678787878787879,
        "no_defect_f1": 0.9678787878787879,
        "no_defect_tp": 1597,
        "no_defect_fp": 53,
        "no_defect_tn": 1573,
        "no_defect_fn": 53,
        "no_defect_support": 1650,
        "defect_precision": 0.9674046740467405,
        "defect_recall": 0.9674046740467405,
        "defect_f1": 0.9674046740467405,
        "defect_tp": 1573,
        "defect_fp": 53,
        "defect_tn": 1597,
        "defect_fn": 53,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.3931040771960215,
          0.21418954893385517,
          0.1866372170308644,
          0.1868801550573385,
          0.18765916983951583,
          0.18840619058165092,
          0.18041305822246245,
          0.1793785355517555,
          0.1792932693304876,
          0.17394853055975926,
          0.17818229698486407,
          0.1690510832022673,
          0.16588278601109732,
          0.16172610798453188,
          0.1657128659657604
        ],
        "val_loss": [
          0.2862812206149101,
          0.16150875833745187,
          0.12380063648407276,
          0.12481037656275126,
          0.1072845093261164,
          0.10817791424834958,
          0.09973287080916074,
          0.10044728670842372,
          0.10450647620914075,
          0.1110201388096007,
          0.11156437538850766,
          0.09902888883908208,
          0.10328478881945977,
          0.10111314033229764,
          0.10110369675721113
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9221928454067189,
            "recall_macro": 0.921904400301059,
            "f1_macro": 0.9220292041418983,
            "precision_micro": 0.9221374045801527,
            "recall_micro": 0.9221374045801527,
            "f1_micro": 0.9221374045801527,
            "accuracy": 0.9221374045801527,
            "hamming_loss": 0.07786259541984733,
            "no_defect_precision": 0.9208675263774913,
            "no_defect_recall": 0.9290360733293909,
            "no_defect_f1": 0.9249337650868413,
            "no_defect_tp": 1571,
            "no_defect_fp": 135,
            "no_defect_tn": 1449,
            "no_defect_fn": 120,
            "no_defect_support": 1691,
            "defect_precision": 0.9235181644359465,
            "defect_recall": 0.9147727272727273,
            "defect_f1": 0.9191246431969553,
            "defect_tp": 1449,
            "defect_fp": 120,
            "defect_tn": 1571,
            "defect_fn": 135,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9463259105459207,
            "recall_macro": 0.9465295324624124,
            "f1_macro": 0.9456479985559589,
            "precision_micro": 0.945648854961832,
            "recall_micro": 0.945648854961832,
            "f1_micro": 0.945648854961832,
            "accuracy": 0.945648854961832,
            "hamming_loss": 0.05435114503816794,
            "no_defect_precision": 0.9737006887914841,
            "no_defect_recall": 0.9195742164399764,
            "no_defect_f1": 0.9458637469586375,
            "no_defect_tp": 1555,
            "no_defect_fp": 42,
            "no_defect_tn": 1542,
            "no_defect_fn": 136,
            "no_defect_support": 1691,
            "defect_precision": 0.9189511323003575,
            "defect_recall": 0.9734848484848485,
            "defect_f1": 0.9454322501532803,
            "defect_tp": 1542,
            "defect_fp": 136,
            "defect_tn": 1555,
            "defect_fn": 42,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9597430209600557,
            "recall_macro": 0.9602308194302576,
            "f1_macro": 0.9596856318584783,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.977342314758114,
            "no_defect_recall": 0.9438202247191011,
            "no_defect_f1": 0.9602888086642599,
            "no_defect_tp": 1596,
            "no_defect_fp": 37,
            "no_defect_tn": 1547,
            "no_defect_fn": 95,
            "no_defect_support": 1691,
            "defect_precision": 0.9421437271619976,
            "defect_recall": 0.9766414141414141,
            "defect_f1": 0.9590824550526968,
            "defect_tp": 1547,
            "defect_fp": 95,
            "defect_tn": 1596,
            "defect_fn": 37,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9547628407930397,
            "recall_macro": 0.9551842344198938,
            "f1_macro": 0.9544989127200609,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9765142150803461,
            "no_defect_recall": 0.9343583678296866,
            "no_defect_f1": 0.9549712904200665,
            "no_defect_tp": 1580,
            "no_defect_fp": 38,
            "no_defect_tn": 1546,
            "no_defect_fn": 111,
            "no_defect_support": 1691,
            "defect_precision": 0.9330114665057333,
            "defect_recall": 0.976010101010101,
            "defect_f1": 0.9540265350200555,
            "defect_tp": 1546,
            "defect_fp": 111,
            "defect_tn": 1580,
            "defect_fn": 38,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604998721975004,
            "recall_macro": 0.9600631910470763,
            "f1_macro": 0.9602455615091503,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9561659848042081,
            "no_defect_recall": 0.9674748669426375,
            "no_defect_f1": 0.9617871840094062,
            "no_defect_tp": 1636,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 55,
            "no_defect_support": 1691,
            "defect_precision": 0.9648337595907929,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9587039390088945,
            "defect_tp": 1509,
            "defect_fp": 55,
            "defect_tn": 1636,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635211496681468,
            "recall_macro": 0.963894936950821,
            "f1_macro": 0.9636424275075857,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9723557692307693,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9645305514157974,
            "no_defect_tp": 1618,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9546865301055245,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.962754303599374,
            "defect_tp": 1538,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9625454733113545,
            "recall_macro": 0.9617773686002544,
            "f1_macro": 0.9620690763124231,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.954730121880441,
            "no_defect_recall": 0.9727971614429332,
            "no_defect_f1": 0.9636789689513767,
            "no_defect_tp": 1645,
            "no_defect_fp": 78,
            "no_defect_tn": 1506,
            "no_defect_fn": 46,
            "no_defect_support": 1691,
            "defect_precision": 0.970360824742268,
            "defect_recall": 0.9507575757575758,
            "defect_f1": 0.9604591836734694,
            "defect_tp": 1506,
            "defect_fp": 46,
            "defect_tn": 1645,
            "defect_fn": 78,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9628885934866038,
            "recall_macro": 0.9625484964966041,
            "f1_macro": 0.9626954718063477,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9595782073813708,
            "no_defect_recall": 0.9686575990538143,
            "no_defect_f1": 0.9640965273690406,
            "no_defect_tp": 1638,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 53,
            "no_defect_support": 1691,
            "defect_precision": 0.9661989795918368,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9612944162436549,
            "defect_tp": 1515,
            "defect_fp": 53,
            "defect_tn": 1638,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629193074519584,
            "recall_macro": 0.9631837296680584,
            "f1_macro": 0.9630255119535527,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9689366786140979,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9640416047548291,
            "no_defect_tp": 1622,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9569019362898189,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9620094191522763,
            "defect_tp": 1532,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9581103125125869,
            "recall_macro": 0.9585926159883877,
            "f1_macro": 0.9581538935042587,
            "precision_micro": 0.9581679389312977,
            "recall_micro": 0.9581679389312977,
            "f1_micro": 0.9581679389312977,
            "accuracy": 0.9581679389312977,
            "hamming_loss": 0.04183206106870229,
            "no_defect_precision": 0.9726277372262774,
            "no_defect_recall": 0.9455943228858663,
            "no_defect_f1": 0.9589205397301349,
            "no_defect_tp": 1599,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 92,
            "no_defect_support": 1691,
            "defect_precision": 0.9435928877988964,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9573872472783825,
            "defect_tp": 1539,
            "defect_fp": 92,
            "defect_tn": 1599,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9596800780486641,
            "recall_macro": 0.9601708988166705,
            "f1_macro": 0.9596832857702422,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.975594874923734,
            "no_defect_recall": 0.9455943228858663,
            "no_defect_f1": 0.9603603603603603,
            "no_defect_tp": 1599,
            "no_defect_fp": 40,
            "no_defect_tn": 1544,
            "no_defect_fn": 92,
            "no_defect_support": 1691,
            "defect_precision": 0.9437652811735942,
            "defect_recall": 0.9747474747474747,
            "defect_f1": 0.9590062111801242,
            "defect_tp": 1544,
            "defect_fp": 92,
            "defect_tn": 1599,
            "defect_fn": 40,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9646219932298187,
            "recall_macro": 0.9644624094284059,
            "f1_macro": 0.9645364250774804,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9635079458505003,
            "no_defect_recall": 0.9680662329982259,
            "no_defect_f1": 0.9657817109144543,
            "no_defect_tp": 1637,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 54,
            "no_defect_support": 1691,
            "defect_precision": 0.9657360406091371,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9632911392405064,
            "defect_tp": 1522,
            "defect_fp": 54,
            "defect_tn": 1637,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620055970149254,
            "recall_macro": 0.9622567335089511,
            "f1_macro": 0.9621081491832305,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9677611940298507,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9631610219845514,
            "no_defect_tp": 1621,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.95625,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9610552763819096,
            "defect_tp": 1530,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635436452287252,
            "recall_macro": 0.9637551221857845,
            "f1_macro": 0.9636341631807811,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.968414779499404,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.964677945978035,
            "no_defect_tp": 1625,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9586725109580463,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9625903803835272,
            "defect_tp": 1531,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635436452287252,
            "recall_macro": 0.9637551221857845,
            "f1_macro": 0.9636341631807811,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.968414779499404,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.964677945978035,
            "no_defect_tp": 1625,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9586725109580463,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9625903803835272,
            "defect_tp": 1531,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 53,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9676417309627642,
            "recall_macro": 0.9676417309627642,
            "f1_macro": 0.9676417309627642,
            "precision_micro": 0.9676434676434676,
            "recall_micro": 0.9676434676434676,
            "f1_micro": 0.9676434676434676,
            "accuracy": 0.9676434676434676,
            "hamming_loss": 0.03235653235653236,
            "no_defect_precision": 0.9678787878787879,
            "no_defect_recall": 0.9678787878787879,
            "no_defect_f1": 0.9678787878787879,
            "no_defect_tp": 1597,
            "no_defect_fp": 53,
            "no_defect_tn": 1573,
            "no_defect_fn": 53,
            "no_defect_support": 1650,
            "defect_precision": 0.9674046740467405,
            "defect_recall": 0.9674046740467405,
            "defect_f1": 0.9674046740467405,
            "defect_tp": 1573,
            "defect_fp": 53,
            "defect_tn": 1597,
            "defect_fn": 53,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.01_s40_20251207_142752",
    "lr": 0.01,
    "weight_decay": 0.01,
    "seed": 40,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9660789253198883,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.01_s40_20251207_142752",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s40_20251207_142752",
      "timestamp": "2025-12-07T14:29:49.202738",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 8,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.01_s40",
          "seed": 40,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s40_20251207_142752"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9659878884947417,
        "recall_macro": 0.9662004805595876,
        "f1_macro": 0.9660789253198883,
        "precision_micro": 0.9661068702290077,
        "recall_micro": 0.9661068702290077,
        "f1_micro": 0.9661068702290077,
        "accuracy": 0.9661068702290077,
        "hamming_loss": 0.03389312977099237,
        "no_defect_precision": 0.9707985697258641,
        "no_defect_recall": 0.9633353045535187,
        "no_defect_f1": 0.9670525378450578,
        "no_defect_tp": 1629,
        "no_defect_fp": 49,
        "no_defect_tn": 1535,
        "no_defect_fn": 62,
        "no_defect_support": 1691,
        "defect_precision": 0.9611772072636193,
        "defect_recall": 0.9690656565656566,
        "defect_f1": 0.9651053127947187,
        "defect_tp": 1535,
        "defect_fp": 62,
        "defect_tn": 1629,
        "defect_fn": 49,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9691822398989098,
        "recall_macro": 0.9691568824779158,
        "f1_macro": 0.9691673030429113,
        "precision_micro": 0.9691697191697192,
        "recall_micro": 0.9691697191697192,
        "f1_micro": 0.9691697191697192,
        "accuracy": 0.9691697191697192,
        "hamming_loss": 0.030830280830280832,
        "no_defect_precision": 0.9679758308157099,
        "no_defect_recall": 0.9709090909090909,
        "no_defect_f1": 0.9694402420574887,
        "no_defect_tp": 1602,
        "no_defect_fp": 53,
        "no_defect_tn": 1573,
        "no_defect_fn": 48,
        "no_defect_support": 1650,
        "defect_precision": 0.9703886489821099,
        "defect_recall": 0.9674046740467405,
        "defect_f1": 0.9688943640283338,
        "defect_tp": 1573,
        "defect_fp": 48,
        "defect_tn": 1602,
        "defect_fn": 53,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.3866004064741494,
          0.2196013913119687,
          0.19077732124089197,
          0.18682472015025725,
          0.1780387838390582,
          0.18298769299579964,
          0.17836351318588817,
          0.17750014026481736,
          0.17653614192203498,
          0.1688494770066758,
          0.1735701578899158,
          0.16230315194469117,
          0.16540284408061573,
          0.16949809207015956,
          0.166863520259513
        ],
        "val_loss": [
          0.28667937505703706,
          0.15557955893186423,
          0.12581138871610165,
          0.11631561507685827,
          0.10296027394584738,
          0.10022378512299977,
          0.11009724706841204,
          0.10127305740920398,
          0.10837856751794998,
          0.1011505201458931,
          0.0992669493604738,
          0.10205628859022489,
          0.09814693642636904,
          0.09794135126643456,
          0.09893830199367724
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9150024327257757,
            "recall_macro": 0.9139730390839202,
            "f1_macro": 0.9143216780916887,
            "precision_micro": 0.9145038167938931,
            "recall_micro": 0.9145038167938931,
            "f1_micro": 0.9145038167938931,
            "accuracy": 0.9145038167938931,
            "hamming_loss": 0.08549618320610687,
            "no_defect_precision": 0.906628242074928,
            "no_defect_recall": 0.9302188054405677,
            "no_defect_f1": 0.9182720373613543,
            "no_defect_tp": 1573,
            "no_defect_fp": 162,
            "no_defect_tn": 1422,
            "no_defect_fn": 118,
            "no_defect_support": 1691,
            "defect_precision": 0.9233766233766234,
            "defect_recall": 0.8977272727272727,
            "defect_f1": 0.910371318822023,
            "defect_tp": 1422,
            "defect_fp": 118,
            "defect_tn": 1573,
            "defect_fn": 162,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9525625877406948,
            "recall_macro": 0.9530106654958813,
            "f1_macro": 0.9526513429109837,
            "precision_micro": 0.9526717557251908,
            "recall_micro": 0.9526717557251908,
            "f1_micro": 0.9526717557251908,
            "accuracy": 0.9526717557251908,
            "hamming_loss": 0.04732824427480916,
            "no_defect_precision": 0.9648910411622276,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.9536344600658092,
            "no_defect_tp": 1594,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.940234134319162,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9516682257561584,
            "defect_tp": 1526,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9563120011934064,
            "recall_macro": 0.9567985442837601,
            "f1_macro": 0.9563231074426842,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9719512195121951,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.957069948964275,
            "no_defect_tp": 1594,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.9406727828746178,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9555762659210935,
            "defect_tp": 1538,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9572779145222645,
            "recall_macro": 0.9577654875185921,
            "f1_macro": 0.957241539326966,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9743119266055046,
            "no_defect_recall": 0.9420461265523359,
            "no_defect_f1": 0.957907396271798,
            "no_defect_tp": 1593,
            "no_defect_fp": 42,
            "no_defect_tn": 1542,
            "no_defect_fn": 98,
            "no_defect_support": 1691,
            "defect_precision": 0.9402439024390243,
            "defect_recall": 0.9734848484848485,
            "defect_f1": 0.956575682382134,
            "defect_tp": 1542,
            "defect_fp": 98,
            "defect_tn": 1593,
            "defect_fn": 42,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9628611987970936,
            "recall_macro": 0.9625684700344666,
            "f1_macro": 0.9626971714270136,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9601173020527859,
            "no_defect_recall": 0.9680662329982259,
            "no_defect_f1": 0.964075382803298,
            "no_defect_tp": 1637,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 54,
            "no_defect_support": 1691,
            "defect_precision": 0.9656050955414013,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9613189600507293,
            "defect_tp": 1516,
            "defect_fp": 54,
            "defect_tn": 1637,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9643518003201798,
            "recall_macro": 0.9641267793248869,
            "f1_macro": 0.9642283704520879,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.9623971797884842,
            "no_defect_recall": 0.9686575990538143,
            "no_defect_f1": 0.9655172413793104,
            "no_defect_tp": 1638,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 53,
            "no_defect_support": 1691,
            "defect_precision": 0.9663064208518753,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9629394995248653,
            "defect_tp": 1520,
            "defect_fp": 53,
            "defect_tn": 1638,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9603537125949042,
            "recall_macro": 0.9608421590237084,
            "f1_macro": 0.9602964556181984,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9779546846295162,
            "no_defect_recall": 0.9444115907746895,
            "no_defect_f1": 0.9608904933814681,
            "no_defect_tp": 1597,
            "no_defect_fp": 36,
            "no_defect_tn": 1548,
            "no_defect_fn": 94,
            "no_defect_support": 1691,
            "defect_precision": 0.9427527405602923,
            "defect_recall": 0.9772727272727273,
            "defect_f1": 0.9597024178549287,
            "defect_tp": 1548,
            "defect_fp": 94,
            "defect_tn": 1597,
            "defect_fn": 36,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9659878884947417,
            "recall_macro": 0.9662004805595876,
            "f1_macro": 0.9660789253198883,
            "precision_micro": 0.9661068702290077,
            "recall_micro": 0.9661068702290077,
            "f1_micro": 0.9661068702290077,
            "accuracy": 0.9661068702290077,
            "hamming_loss": 0.03389312977099237,
            "no_defect_precision": 0.9707985697258641,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9670525378450578,
            "no_defect_tp": 1629,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9611772072636193,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9651053127947187,
            "defect_tp": 1535,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9593317058034642,
            "recall_macro": 0.9598152951752892,
            "f1_macro": 0.9593756776355213,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9738442822384428,
            "no_defect_recall": 0.9467770549970431,
            "no_defect_f1": 0.960119940029985,
            "no_defect_tp": 1601,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 90,
            "no_defect_support": 1691,
            "defect_precision": 0.9448191293684856,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9586314152410575,
            "defect_tp": 1541,
            "defect_fp": 90,
            "defect_tn": 1601,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9641334154121664,
            "recall_macro": 0.9644463559306847,
            "f1_macro": 0.9642501573720808,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.9712574850299401,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9651889318655162,
            "no_defect_tp": 1622,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9570093457943926,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9633113828786454,
            "defect_tp": 1536,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.964136956747784,
            "recall_macro": 0.9632757572770878,
            "f1_macro": 0.9635956826146954,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.955388180764774,
            "no_defect_recall": 0.9751626256652868,
            "no_defect_f1": 0.9651741293532339,
            "no_defect_tp": 1649,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 42,
            "no_defect_support": 1691,
            "defect_precision": 0.972885732730794,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.9620172358761571,
            "defect_tp": 1507,
            "defect_fp": 42,
            "defect_tn": 1649,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962015590615792,
            "recall_macro": 0.9624564688875747,
            "f1_macro": 0.9621196009471126,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9734138972809667,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.962940824865511,
            "no_defect_tp": 1611,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9506172839506173,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9612983770287141,
            "defect_tp": 1540,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.964198183388614,
            "recall_macro": 0.9642865676277859,
            "f1_macro": 0.9642401215989853,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.966785290628707,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.9653538643766657,
            "no_defect_tp": 1630,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.961611076148521,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9631263788213048,
            "defect_tp": 1528,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9648395647061019,
            "recall_macro": 0.9648579601455118,
            "f1_macro": 0.9648486721921334,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9662721893491124,
            "no_defect_recall": 0.9657007687758723,
            "no_defect_f1": 0.9659863945578231,
            "no_defect_tp": 1633,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 58,
            "no_defect_support": 1691,
            "defect_precision": 0.9634069400630915,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9637109498264437,
            "defect_tp": 1527,
            "defect_fp": 58,
            "defect_tn": 1633,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644644667057758,
            "recall_macro": 0.9646621448070294,
            "f1_macro": 0.9645503237967266,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9690291840381179,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9655786350148368,
            "no_defect_tp": 1627,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.9598997493734336,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9635220125786164,
            "defect_tp": 1532,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 52,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9691822398989098,
            "recall_macro": 0.9691568824779158,
            "f1_macro": 0.9691673030429113,
            "precision_micro": 0.9691697191697192,
            "recall_micro": 0.9691697191697192,
            "f1_micro": 0.9691697191697192,
            "accuracy": 0.9691697191697192,
            "hamming_loss": 0.030830280830280832,
            "no_defect_precision": 0.9679758308157099,
            "no_defect_recall": 0.9709090909090909,
            "no_defect_f1": 0.9694402420574887,
            "no_defect_tp": 1602,
            "no_defect_fp": 53,
            "no_defect_tn": 1573,
            "no_defect_fn": 48,
            "no_defect_support": 1650,
            "defect_precision": 0.9703886489821099,
            "defect_recall": 0.9674046740467405,
            "defect_f1": 0.9688943640283338,
            "defect_tp": 1573,
            "defect_fp": 48,
            "defect_tn": 1602,
            "defect_fn": 53,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.01_s50_20251207_141322",
    "lr": 0.01,
    "weight_decay": 0.01,
    "seed": 50,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9642489966066987,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.01_s50_20251207_141322",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s50_20251207_141322",
      "timestamp": "2025-12-07T14:15:18.921193",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.01_s50",
          "seed": 50,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s50_20251207_141322"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9641366591349354,
        "recall_macro": 0.9644263823928223,
        "f1_macro": 0.9642489966066987,
        "precision_micro": 0.9642748091603054,
        "recall_micro": 0.9642748091603054,
        "f1_micro": 0.9642748091603054,
        "accuracy": 0.9642748091603054,
        "hamming_loss": 0.03572519083969466,
        "no_defect_precision": 0.9706937799043063,
        "no_defect_recall": 0.9597871082199881,
        "no_defect_f1": 0.9652096342551294,
        "no_defect_tp": 1623,
        "no_defect_fp": 49,
        "no_defect_tn": 1535,
        "no_defect_fn": 68,
        "no_defect_support": 1691,
        "defect_precision": 0.9575795383655645,
        "defect_recall": 0.9690656565656566,
        "defect_f1": 0.9632883589582679,
        "defect_tp": 1535,
        "defect_fp": 68,
        "defect_tn": 1623,
        "defect_fn": 49,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9670578727553861,
        "recall_macro": 0.9670133064967014,
        "f1_macro": 0.9670298212158397,
        "precision_micro": 0.967032967032967,
        "recall_micro": 0.967032967032967,
        "f1_micro": 0.967032967032967,
        "accuracy": 0.967032967032967,
        "hamming_loss": 0.03296703296703297,
        "no_defect_precision": 0.9650180940892642,
        "no_defect_recall": 0.9696969696969697,
        "no_defect_f1": 0.9673518742442564,
        "no_defect_tp": 1600,
        "no_defect_fp": 58,
        "no_defect_tn": 1568,
        "no_defect_fn": 50,
        "no_defect_support": 1650,
        "defect_precision": 0.969097651421508,
        "defect_recall": 0.964329643296433,
        "defect_f1": 0.966707768187423,
        "defect_tp": 1568,
        "defect_fp": 50,
        "defect_tn": 1600,
        "defect_fn": 58,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.3870537585917876,
          0.2139777079785718,
          0.19090028786758997,
          0.1882885142100905,
          0.1785642741302566,
          0.18507854122995832,
          0.18422043736572047,
          0.17471648801009027,
          0.17906094169454595,
          0.17826280211367368,
          0.17594247708821895,
          0.1686669777159162,
          0.16626770364190743,
          0.16385862926434275,
          0.16805320767740325
        ],
        "val_loss": [
          0.28376493918207973,
          0.151157277278029,
          0.12699945643544197,
          0.11901745164337066,
          0.11693533409673434,
          0.11106397512440498,
          0.10994717446514048,
          0.10050281173048112,
          0.10428044113975304,
          0.10032609226898505,
          0.12190947266152272,
          0.09880043738163434,
          0.1011703395141432,
          0.09942982005528532,
          0.09910183500211972
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9211241495113027,
            "recall_macro": 0.921157165982713,
            "f1_macro": 0.9211403132174789,
            "precision_micro": 0.9212213740458015,
            "recall_micro": 0.9212213740458015,
            "f1_micro": 0.9212213740458015,
            "accuracy": 0.9212213740458015,
            "hamming_loss": 0.07877862595419848,
            "no_defect_precision": 0.9242155121373594,
            "no_defect_recall": 0.9231224127735068,
            "no_defect_f1": 0.9236686390532545,
            "no_defect_tp": 1561,
            "no_defect_fp": 128,
            "no_defect_tn": 1456,
            "no_defect_fn": 130,
            "no_defect_support": 1691,
            "defect_precision": 0.9180327868852459,
            "defect_recall": 0.9191919191919192,
            "defect_f1": 0.9186119873817035,
            "defect_tp": 1456,
            "defect_fp": 130,
            "defect_tn": 1561,
            "defect_fn": 128,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549970144797731,
            "recall_macro": 0.9551763943396114,
            "f1_macro": 0.9550759027580974,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9595238095238096,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9563927617917531,
            "no_defect_tp": 1612,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9504702194357367,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9537590437244416,
            "defect_tp": 1516,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.959280671759916,
            "recall_macro": 0.9597354010238399,
            "f1_macro": 0.9593717974655538,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9715496368038741,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9602153754113072,
            "no_defect_tp": 1605,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9470117067159581,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9585282195198004,
            "defect_tp": 1537,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9565015828591718,
            "recall_macro": 0.9569583325866591,
            "f1_macro": 0.9563293632754493,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9766009852216748,
            "no_defect_recall": 0.937906564163217,
            "no_defect_f1": 0.9568627450980393,
            "no_defect_tp": 1586,
            "no_defect_fp": 38,
            "no_defect_tn": 1546,
            "no_defect_fn": 105,
            "no_defect_support": 1691,
            "defect_precision": 0.9364021804966687,
            "defect_recall": 0.976010101010101,
            "defect_f1": 0.9557959814528594,
            "defect_tp": 1546,
            "defect_fp": 105,
            "defect_tn": 1586,
            "defect_fn": 38,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555474750634929,
            "recall_macro": 0.9522837780525539,
            "f1_macro": 0.9531040342182615,
            "precision_micro": 0.9532824427480916,
            "recall_micro": 0.9532824427480916,
            "f1_micro": 0.9532824427480916,
            "accuracy": 0.9532824427480916,
            "hamming_loss": 0.0467175572519084,
            "no_defect_precision": 0.9305711086226204,
            "no_defect_recall": 0.9828503843879361,
            "no_defect_f1": 0.9559965487489215,
            "no_defect_tp": 1662,
            "no_defect_fp": 124,
            "no_defect_tn": 1460,
            "no_defect_fn": 29,
            "no_defect_support": 1691,
            "defect_precision": 0.9805238415043653,
            "defect_recall": 0.9217171717171717,
            "defect_f1": 0.9502115196876016,
            "defect_tp": 1460,
            "defect_fp": 29,
            "defect_tn": 1662,
            "defect_fn": 124,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9594493648037425,
            "recall_macro": 0.9599351364024634,
            "f1_macro": 0.9593805874131718,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.977328431372549,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9599759253686428,
            "no_defect_tp": 1595,
            "no_defect_fp": 37,
            "no_defect_tn": 1547,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9415702982349361,
            "defect_recall": 0.9766414141414141,
            "defect_f1": 0.9587852494577006,
            "defect_tp": 1547,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 37,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9596294776884777,
            "recall_macro": 0.9601109782030834,
            "f1_macro": 0.9596806686573579,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9738601823708206,
            "no_defect_recall": 0.9473684210526315,
            "no_defect_f1": 0.960431654676259,
            "no_defect_tp": 1602,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 89,
            "no_defect_support": 1691,
            "defect_precision": 0.945398773006135,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9589296826384568,
            "defect_tp": 1541,
            "defect_fp": 89,
            "defect_tn": 1602,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635594715105059,
            "recall_macro": 0.9631198890143302,
            "f1_macro": 0.9633035952392157,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9590882524839275,
            "no_defect_recall": 0.9704316972205795,
            "no_defect_f1": 0.9647266313932981,
            "no_defect_tp": 1641,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 50,
            "no_defect_support": 1691,
            "defect_precision": 0.9680306905370843,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9618805590851334,
            "defect_tp": 1514,
            "defect_fp": 50,
            "defect_tn": 1641,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9616909989010768,
            "recall_macro": 0.9620808917083311,
            "f1_macro": 0.9618103984116484,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9711191335740073,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.962719952281539,
            "no_defect_tp": 1614,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9522628642281463,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.960900844541758,
            "defect_tp": 1536,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9624296266093748,
            "recall_macro": 0.9623726546959841,
            "f1_macro": 0.9624003304234601,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9628099173553719,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9636632200886263,
            "no_defect_tp": 1631,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9620493358633776,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9611374407582939,
            "defect_tp": 1521,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9521770174819462,
            "recall_macro": 0.9525230871697459,
            "f1_macro": 0.9517529137529137,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.9763828464885022,
            "no_defect_recall": 0.9290360733293909,
            "no_defect_f1": 0.9521212121212121,
            "no_defect_tp": 1571,
            "no_defect_fp": 38,
            "no_defect_tn": 1546,
            "no_defect_fn": 120,
            "no_defect_support": 1691,
            "defect_precision": 0.9279711884753902,
            "defect_recall": 0.976010101010101,
            "defect_f1": 0.9513846153846154,
            "defect_tp": 1546,
            "defect_fp": 120,
            "defect_tn": 1571,
            "defect_fn": 38,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9641366591349354,
            "recall_macro": 0.9644263823928223,
            "f1_macro": 0.9642489966066987,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.9706937799043063,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9652096342551294,
            "no_defect_tp": 1623,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9575795383655645,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9632883589582679,
            "defect_tp": 1535,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9632148197226227,
            "recall_macro": 0.9635593068473021,
            "f1_macro": 0.9633352290792496,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9712057588482303,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9642644431209053,
            "no_defect_tp": 1619,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9552238805970149,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9624060150375939,
            "defect_tp": 1536,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.963251731470707,
            "recall_macro": 0.9634194920822656,
            "f1_macro": 0.9633266070784687,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9672813801308745,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9644128113879004,
            "no_defect_tp": 1626,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9592220828105396,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9622404027690371,
            "defect_tp": 1529,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635869601732552,
            "recall_macro": 0.963675228034335,
            "f1_macro": 0.9636288416263183,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9661921708185054,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9647616227420788,
            "no_defect_tp": 1629,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9609817495280051,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9624960605105578,
            "defect_tp": 1527,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 57,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9670578727553861,
            "recall_macro": 0.9670133064967014,
            "f1_macro": 0.9670298212158397,
            "precision_micro": 0.967032967032967,
            "recall_micro": 0.967032967032967,
            "f1_micro": 0.967032967032967,
            "accuracy": 0.967032967032967,
            "hamming_loss": 0.03296703296703297,
            "no_defect_precision": 0.9650180940892642,
            "no_defect_recall": 0.9696969696969697,
            "no_defect_f1": 0.9673518742442564,
            "no_defect_tp": 1600,
            "no_defect_fp": 58,
            "no_defect_tn": 1568,
            "no_defect_fn": 50,
            "no_defect_support": 1650,
            "defect_precision": 0.969097651421508,
            "defect_recall": 0.964329643296433,
            "defect_f1": 0.966707768187423,
            "defect_tp": 1568,
            "defect_fp": 50,
            "defect_tn": 1600,
            "defect_fn": 58,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.01_s60_20251207_153344",
    "lr": 0.01,
    "weight_decay": 0.01,
    "seed": 60,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9672872039266744,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.01_s60_20251207_153344",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s60_20251207_153344",
      "timestamp": "2025-12-07T15:35:42.545778",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 7,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.01_s60",
          "seed": 60,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s60_20251207_153344"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9673856209150327,
        "recall_macro": 0.9672034508300031,
        "f1_macro": 0.9672872039266744,
        "precision_micro": 0.9673282442748091,
        "recall_micro": 0.9673282442748091,
        "f1_micro": 0.9673282442748091,
        "accuracy": 0.9673282442748091,
        "hamming_loss": 0.03267175572519084,
        "no_defect_precision": 0.9658823529411765,
        "no_defect_recall": 0.9710230632761679,
        "no_defect_f1": 0.9684458861692716,
        "no_defect_tp": 1642,
        "no_defect_fp": 58,
        "no_defect_tn": 1526,
        "no_defect_fn": 49,
        "no_defect_support": 1691,
        "defect_precision": 0.9688888888888889,
        "defect_recall": 0.9633838383838383,
        "defect_f1": 0.9661285216840773,
        "defect_tp": 1526,
        "defect_fp": 49,
        "defect_tn": 1642,
        "defect_fn": 58,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9679452224309084,
        "recall_macro": 0.9679492340377949,
        "f1_macro": 0.9679471380301644,
        "precision_micro": 0.967948717948718,
        "recall_micro": 0.967948717948718,
        "f1_micro": 0.967948717948718,
        "accuracy": 0.967948717948718,
        "hamming_loss": 0.03205128205128205,
        "no_defect_precision": 0.968465736810188,
        "no_defect_recall": 0.9678787878787879,
        "no_defect_f1": 0.9681721733858745,
        "no_defect_tp": 1597,
        "no_defect_fp": 52,
        "no_defect_tn": 1574,
        "no_defect_fn": 53,
        "no_defect_support": 1650,
        "defect_precision": 0.9674247080516287,
        "defect_recall": 0.968019680196802,
        "defect_f1": 0.9677221026744544,
        "defect_tp": 1574,
        "defect_fp": 53,
        "defect_tn": 1597,
        "defect_fn": 52,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.39162215927155947,
          0.22274638360140214,
          0.18542642016976946,
          0.1801409766265039,
          0.18028244379299954,
          0.1805817436224247,
          0.18036707557706652,
          0.17406139173642363,
          0.18089982991936815,
          0.17373329468040286,
          0.17800867504529874,
          0.1663513864589286,
          0.16839829598510614,
          0.16867588848561424,
          0.16762653482633655
        ],
        "val_loss": [
          0.2883456658858519,
          0.15834529597598773,
          0.12151896881942566,
          0.11335589063282196,
          0.11990488592821819,
          0.10717355015759285,
          0.09801841147530538,
          0.10054120084700677,
          0.10138452017249969,
          0.10012849509859315,
          0.0977757555217697,
          0.10078965987150486,
          0.1005525140163417,
          0.09998056213729657,
          0.10076581536290738
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9164977981788327,
            "recall_macro": 0.9166619999522128,
            "f1_macro": 0.9165695336936095,
            "precision_micro": 0.9166412213740458,
            "recall_micro": 0.9166412213740458,
            "f1_micro": 0.9166412213740458,
            "accuracy": 0.9166412213740458,
            "hamming_loss": 0.0833587786259542,
            "no_defect_precision": 0.9220238095238096,
            "no_defect_recall": 0.9160260201064458,
            "no_defect_f1": 0.9190151290418274,
            "no_defect_tp": 1549,
            "no_defect_fp": 131,
            "no_defect_tn": 1453,
            "no_defect_fn": 142,
            "no_defect_support": 1691,
            "defect_precision": 0.9109717868338558,
            "defect_recall": 0.9172979797979798,
            "defect_f1": 0.9141239383453916,
            "defect_tp": 1453,
            "defect_fp": 142,
            "defect_tn": 1549,
            "defect_fn": 131,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9523335623187044,
            "recall_macro": 0.952814850157399,
            "f1_macro": 0.9523519787032277,
            "precision_micro": 0.9523664122137404,
            "recall_micro": 0.9523664122137404,
            "f1_micro": 0.9523664122137404,
            "accuracy": 0.9523664122137404,
            "hamming_loss": 0.04763358778625954,
            "no_defect_precision": 0.967702620353443,
            "no_defect_recall": 0.9390892962743939,
            "no_defect_f1": 0.9531812725090036,
            "no_defect_tp": 1588,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 103,
            "no_defect_support": 1691,
            "defect_precision": 0.9369645042839657,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9515226848974518,
            "defect_tp": 1531,
            "defect_fp": 103,
            "defect_tn": 1588,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9580225676335099,
            "recall_macro": 0.9583529335340394,
            "f1_macro": 0.9581404010180836,
            "precision_micro": 0.9581679389312977,
            "recall_micro": 0.9581679389312977,
            "f1_micro": 0.9581679389312977,
            "accuracy": 0.9581679389312977,
            "hamming_loss": 0.04183206106870229,
            "no_defect_precision": 0.9658273381294964,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9592140518011313,
            "no_defect_tp": 1611,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9502177971375233,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9570667502350361,
            "defect_tp": 1527,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9580525078369906,
            "recall_macro": 0.9582330923068652,
            "f1_macro": 0.9581319637949615,
            "precision_micro": 0.9581679389312977,
            "recall_micro": 0.9581679389312977,
            "f1_micro": 0.9581679389312977,
            "accuracy": 0.9581679389312977,
            "hamming_loss": 0.04183206106870229,
            "no_defect_precision": 0.9625,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9593592405814299,
            "no_defect_tp": 1617,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9536050156739811,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9569046870084932,
            "defect_tp": 1521,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9547628407930397,
            "recall_macro": 0.9551842344198938,
            "f1_macro": 0.9544989127200609,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9765142150803461,
            "no_defect_recall": 0.9343583678296866,
            "no_defect_f1": 0.9549712904200665,
            "no_defect_tp": 1580,
            "no_defect_fp": 38,
            "no_defect_tn": 1546,
            "no_defect_fn": 111,
            "no_defect_support": 1691,
            "defect_precision": 0.9330114665057333,
            "defect_recall": 0.976010101010101,
            "defect_f1": 0.9540265350200555,
            "defect_tp": 1546,
            "defect_fp": 111,
            "defect_tn": 1580,
            "defect_fn": 38,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.956960159335712,
            "recall_macro": 0.9558597880042292,
            "f1_macro": 0.9562440875912408,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9463667820069204,
            "no_defect_recall": 0.9704316972205795,
            "no_defect_f1": 0.9582481751824817,
            "no_defect_tp": 1641,
            "no_defect_fp": 93,
            "no_defect_tn": 1491,
            "no_defect_fn": 50,
            "no_defect_support": 1691,
            "defect_precision": 0.9675535366645036,
            "defect_recall": 0.9412878787878788,
            "defect_f1": 0.95424,
            "defect_tp": 1491,
            "defect_fp": 50,
            "defect_tn": 1641,
            "defect_fn": 93,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9673856209150327,
            "recall_macro": 0.9672034508300031,
            "f1_macro": 0.9672872039266744,
            "precision_micro": 0.9673282442748091,
            "recall_micro": 0.9673282442748091,
            "f1_micro": 0.9673282442748091,
            "accuracy": 0.9673282442748091,
            "hamming_loss": 0.03267175572519084,
            "no_defect_precision": 0.9658823529411765,
            "no_defect_recall": 0.9710230632761679,
            "no_defect_f1": 0.9684458861692716,
            "no_defect_tp": 1642,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 49,
            "no_defect_support": 1691,
            "defect_precision": 0.9688888888888889,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9661285216840773,
            "defect_tp": 1526,
            "defect_fp": 49,
            "defect_tn": 1642,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635740529791239,
            "recall_macro": 0.9636952015721975,
            "f1_macro": 0.9636302128900555,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9667458432304038,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9647407407407408,
            "no_defect_tp": 1628,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.9604022627278441,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9625196850393701,
            "defect_tp": 1528,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9640312137430294,
            "recall_macro": 0.9628802065599817,
            "f1_macro": 0.9632807191821523,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9527377521613832,
            "no_defect_recall": 0.9775280898876404,
            "no_defect_f1": 0.9649737302977233,
            "no_defect_tp": 1653,
            "no_defect_fp": 82,
            "no_defect_tn": 1502,
            "no_defect_fn": 38,
            "no_defect_support": 1691,
            "defect_precision": 0.9753246753246754,
            "defect_recall": 0.9482323232323232,
            "defect_f1": 0.9615877080665813,
            "defect_tp": 1502,
            "defect_fp": 38,
            "defect_tn": 1653,
            "defect_fn": 82,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9632150784324698,
            "recall_macro": 0.9635792803851645,
            "f1_macro": 0.9633363510097523,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9717717717717718,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.964243146603099,
            "no_defect_tp": 1618,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9546583850931677,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9624295554164057,
            "defect_tp": 1537,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9647522792281109,
            "recall_macro": 0.9650177484484108,
            "f1_macro": 0.9648589576418063,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9707287933094385,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9658246656760773,
            "no_defect_tp": 1625,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9587757651467833,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9638932496075353,
            "defect_tp": 1535,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644383897676625,
            "recall_macro": 0.9648219331099284,
            "f1_macro": 0.9645595306595975,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.973541791942273,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9654144305307096,
            "no_defect_tp": 1619,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9553349875930521,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9637046307884856,
            "defect_tp": 1540,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644365902938815,
            "recall_macro": 0.9647819860342036,
            "f1_macro": 0.9645573881099414,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9724055188962207,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9654556283502085,
            "no_defect_tp": 1621,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9564676616915423,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9636591478696742,
            "defect_tp": 1538,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9650673956637807,
            "recall_macro": 0.9652934579383425,
            "f1_macro": 0.9651627474018791,
            "precision_micro": 0.9651908396946565,
            "recall_micro": 0.9651908396946565,
            "f1_micro": 0.9651908396946565,
            "accuracy": 0.9651908396946565,
            "hamming_loss": 0.03480916030534351,
            "no_defect_precision": 0.9701848539057841,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9661520190023754,
            "no_defect_tp": 1627,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.9599499374217773,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9641734758013828,
            "defect_tp": 1534,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9647522792281109,
            "recall_macro": 0.9650177484484108,
            "f1_macro": 0.9648589576418063,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9707287933094385,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9658246656760773,
            "no_defect_tp": 1625,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9587757651467833,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9638932496075353,
            "defect_tp": 1535,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 49,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9679452224309084,
            "recall_macro": 0.9679492340377949,
            "f1_macro": 0.9679471380301644,
            "precision_micro": 0.967948717948718,
            "recall_micro": 0.967948717948718,
            "f1_micro": 0.967948717948718,
            "accuracy": 0.967948717948718,
            "hamming_loss": 0.03205128205128205,
            "no_defect_precision": 0.968465736810188,
            "no_defect_recall": 0.9678787878787879,
            "no_defect_f1": 0.9681721733858745,
            "no_defect_tp": 1597,
            "no_defect_fp": 52,
            "no_defect_tn": 1574,
            "no_defect_fn": 53,
            "no_defect_support": 1650,
            "defect_precision": 0.9674247080516287,
            "defect_recall": 0.968019680196802,
            "defect_f1": 0.9677221026744544,
            "defect_tp": 1574,
            "defect_fp": 53,
            "defect_tn": 1597,
            "defect_fn": 52,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.01_s70_20251207_144850",
    "lr": 0.01,
    "weight_decay": 0.01,
    "seed": 70,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.966064295662251,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.01_s70_20251207_144850",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s70_20251207_144850",
      "timestamp": "2025-12-07T14:50:51.441005",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.01_s70",
          "seed": 70,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s70_20251207_144850"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9661624649859943,
        "recall_macro": 0.9659807716431017,
        "f1_macro": 0.966064295662251,
        "precision_micro": 0.9661068702290077,
        "recall_micro": 0.9661068702290077,
        "f1_micro": 0.9661068702290077,
        "accuracy": 0.9661068702290077,
        "hamming_loss": 0.03389312977099237,
        "no_defect_precision": 0.9647058823529412,
        "no_defect_recall": 0.9698403311649911,
        "no_defect_f1": 0.9672662931288706,
        "no_defect_tp": 1640,
        "no_defect_fp": 60,
        "no_defect_tn": 1524,
        "no_defect_fn": 51,
        "no_defect_support": 1691,
        "defect_precision": 0.9676190476190476,
        "defect_recall": 0.9621212121212122,
        "defect_f1": 0.9648622981956315,
        "defect_tp": 1524,
        "defect_fp": 51,
        "defect_tn": 1640,
        "defect_fn": 60,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9670258158007728,
        "recall_macro": 0.9670446159007045,
        "f1_macro": 0.96703197174169,
        "precision_micro": 0.967032967032967,
        "recall_micro": 0.967032967032967,
        "f1_micro": 0.967032967032967,
        "accuracy": 0.967032967032967,
        "hamming_loss": 0.03296703296703297,
        "no_defect_precision": 0.968978102189781,
        "no_defect_recall": 0.9654545454545455,
        "no_defect_f1": 0.9672131147540983,
        "no_defect_tp": 1593,
        "no_defect_fp": 51,
        "no_defect_tn": 1575,
        "no_defect_fn": 57,
        "no_defect_support": 1650,
        "defect_precision": 0.9650735294117647,
        "defect_recall": 0.9686346863468634,
        "defect_f1": 0.9668508287292817,
        "defect_tp": 1575,
        "defect_fp": 57,
        "defect_tn": 1593,
        "defect_fn": 51,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.3902228974647602,
          0.21428595502007455,
          0.19018793422494973,
          0.18195137415845025,
          0.18144354143152677,
          0.18802911340878598,
          0.17554275202077801,
          0.17906246276642487,
          0.18477602801811746,
          0.1775429276866394,
          0.1681673194449317,
          0.17110903180792741,
          0.17204213862513898,
          0.16060776519102032,
          0.16566398122570006
        ],
        "val_loss": [
          0.28619260226304716,
          0.15205328524685824,
          0.12330481560470966,
          0.11066574481530832,
          0.11820324435113715,
          0.1040308648505463,
          0.10738662297192675,
          0.0979489776520775,
          0.11354845074506906,
          0.10246542590455367,
          0.10128067888749334,
          0.09777777068890058,
          0.10154459722196826,
          0.10106781425957496,
          0.10107238132220048
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9184874037856925,
            "recall_macro": 0.9164344509554445,
            "f1_macro": 0.9170011853299636,
            "precision_micro": 0.9172519083969466,
            "recall_micro": 0.9172519083969466,
            "f1_micro": 0.9172519083969466,
            "accuracy": 0.9172519083969466,
            "hamming_loss": 0.08274809160305344,
            "no_defect_precision": 0.9024943310657596,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9215629522431259,
            "no_defect_tp": 1592,
            "no_defect_fp": 172,
            "no_defect_tn": 1412,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.9344804765056254,
            "defect_recall": 0.8914141414141414,
            "defect_f1": 0.9124394184168013,
            "defect_tp": 1412,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 172,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9510293657730469,
            "recall_macro": 0.9511927002132502,
            "f1_macro": 0.9511021427712917,
            "precision_micro": 0.9511450381679389,
            "recall_micro": 0.9511450381679389,
            "f1_micro": 0.9511450381679389,
            "accuracy": 0.9511450381679389,
            "hamming_loss": 0.04885496183206107,
            "no_defect_precision": 0.9553837001784652,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9525504151838672,
            "no_defect_tp": 1606,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9466750313676286,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9496538703587162,
            "defect_tp": 1509,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9595974148085697,
            "recall_macro": 0.959136194887969,
            "f1_macro": 0.9593271829441508,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9550233644859814,
            "no_defect_recall": 0.9668835008870491,
            "no_defect_f1": 0.9609168380840435,
            "no_defect_tp": 1635,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 56,
            "no_defect_support": 1691,
            "defect_precision": 0.964171465131158,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.957737527804258,
            "defect_tp": 1507,
            "defect_fp": 56,
            "defect_tn": 1635,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9596690246071613,
            "recall_macro": 0.9596316132943867,
            "f1_macro": 0.9596499599019727,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9604252805670408,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9609929078014184,
            "no_defect_tp": 1626,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9589127686472819,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9583070120025269,
            "defect_tp": 1517,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9524524824008195,
            "recall_macro": 0.9488515029060565,
            "f1_macro": 0.9497188901196262,
            "precision_micro": 0.9499236641221374,
            "recall_micro": 0.9499236641221374,
            "f1_micro": 0.9499236641221374,
            "accuracy": 0.9499236641221374,
            "hamming_loss": 0.050076335877862595,
            "no_defect_precision": 0.9258226436140546,
            "no_defect_recall": 0.9816676522767593,
            "no_defect_f1": 0.9529276693455798,
            "no_defect_tp": 1660,
            "no_defect_fp": 133,
            "no_defect_tn": 1451,
            "no_defect_fn": 31,
            "no_defect_support": 1691,
            "defect_precision": 0.9790823211875843,
            "defect_recall": 0.9160353535353535,
            "defect_f1": 0.9465101108936725,
            "defect_tp": 1451,
            "defect_fp": 31,
            "defect_tn": 1660,
            "defect_fn": 133,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9592662195131962,
            "recall_macro": 0.9594757450316291,
            "f1_macro": 0.9593558294373437,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.964243146603099,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.960522410210745,
            "no_defect_tp": 1618,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9542892924232936,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9581892486639422,
            "defect_tp": 1524,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9585535329810139,
            "recall_macro": 0.9583090664181735,
            "f1_macro": 0.9584183823985218,
            "precision_micro": 0.9584732824427481,
            "recall_micro": 0.9584732824427481,
            "f1_micro": 0.9584732824427481,
            "accuracy": 0.9584732824427481,
            "hamming_loss": 0.04152671755725191,
            "no_defect_precision": 0.9565472695243687,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9599292869770183,
            "no_defect_tp": 1629,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.960559796437659,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9569074778200254,
            "defect_tp": 1510,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9621336021806505,
            "recall_macro": 0.9620569981303275,
            "f1_macro": 0.9620938601200899,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9622418879056047,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9633786178381571,
            "no_defect_tp": 1631,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9620253164556962,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9608091024020228,
            "defect_tp": 1520,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9592646341408834,
            "recall_macro": 0.9597193475261186,
            "f1_macro": 0.9590781663437803,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9796672828096118,
            "no_defect_recall": 0.9402720283855707,
            "no_defect_f1": 0.9595654797827399,
            "no_defect_tp": 1590,
            "no_defect_fp": 33,
            "no_defect_tn": 1551,
            "no_defect_fn": 101,
            "no_defect_support": 1691,
            "defect_precision": 0.9388619854721549,
            "defect_recall": 0.9791666666666666,
            "defect_f1": 0.9585908529048207,
            "defect_tp": 1551,
            "defect_fp": 101,
            "defect_tn": 1590,
            "defect_fn": 33,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604731619978366,
            "recall_macro": 0.9608781860592919,
            "f1_macro": 0.9605894635269583,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9704819277108434,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9615040286481648,
            "no_defect_tp": 1611,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9504643962848297,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9596748984057518,
            "defect_tp": 1535,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9614488547134891,
            "recall_macro": 0.9596437467519667,
            "f1_macro": 0.9601993593756193,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9452367370222475,
            "no_defect_recall": 0.9798935541099941,
            "no_defect_f1": 0.962253193960511,
            "no_defect_tp": 1657,
            "no_defect_fp": 96,
            "no_defect_tn": 1488,
            "no_defect_fn": 34,
            "no_defect_support": 1691,
            "defect_precision": 0.9776609724047306,
            "defect_recall": 0.9393939393939394,
            "defect_f1": 0.9581455247907277,
            "defect_tp": 1488,
            "defect_fp": 34,
            "defect_tn": 1657,
            "defect_fn": 96,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9661624649859943,
            "recall_macro": 0.9659807716431017,
            "f1_macro": 0.966064295662251,
            "precision_micro": 0.9661068702290077,
            "recall_micro": 0.9661068702290077,
            "f1_micro": 0.9661068702290077,
            "accuracy": 0.9661068702290077,
            "hamming_loss": 0.03389312977099237,
            "no_defect_precision": 0.9647058823529412,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.9672662931288706,
            "no_defect_tp": 1640,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.9676190476190476,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9648622981956315,
            "defect_tp": 1524,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644377696878169,
            "recall_macro": 0.9647620124963413,
            "f1_macro": 0.964556277056277,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9718394248052726,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9654761904761905,
            "no_defect_tp": 1622,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9570361145703612,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9636363636363636,
            "defect_tp": 1537,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9641315572308798,
            "recall_macro": 0.9644663294685472,
            "f1_macro": 0.9642512913804072,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.9718225419664268,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9651682048228639,
            "no_defect_tp": 1621,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9564405724953329,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9633343779379505,
            "defect_tp": 1537,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638257050082522,
            "recall_macro": 0.9641706464407529,
            "f1_macro": 0.9639463085945955,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9718056388722256,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9648600357355569,
            "no_defect_tp": 1620,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9558457711442786,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9630325814536341,
            "defect_tp": 1537,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 47,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9670258158007728,
            "recall_macro": 0.9670446159007045,
            "f1_macro": 0.96703197174169,
            "precision_micro": 0.967032967032967,
            "recall_micro": 0.967032967032967,
            "f1_micro": 0.967032967032967,
            "accuracy": 0.967032967032967,
            "hamming_loss": 0.03296703296703297,
            "no_defect_precision": 0.968978102189781,
            "no_defect_recall": 0.9654545454545455,
            "no_defect_f1": 0.9672131147540983,
            "no_defect_tp": 1593,
            "no_defect_fp": 51,
            "no_defect_tn": 1575,
            "no_defect_fn": 57,
            "no_defect_support": 1650,
            "defect_precision": 0.9650735294117647,
            "defect_recall": 0.9686346863468634,
            "defect_f1": 0.9668508287292817,
            "defect_tp": 1575,
            "defect_fp": 57,
            "defect_tn": 1593,
            "defect_fn": 51,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.01_s80_20251207_193934",
    "lr": 0.01,
    "weight_decay": 0.01,
    "seed": 80,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9651493495292012,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.01_s80_20251207_193934",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s80_20251207_193934",
      "timestamp": "2025-12-07T19:41:27.352203",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 10,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.01_s80",
          "seed": 80,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s80_20251207_193934"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9652114780948711,
        "recall_macro": 0.965093722559719,
        "f1_macro": 0.9651493495292012,
        "precision_micro": 0.9651908396946565,
        "recall_micro": 0.9651908396946565,
        "f1_micro": 0.9651908396946565,
        "accuracy": 0.9651908396946565,
        "hamming_loss": 0.03480916030534351,
        "no_defect_precision": 0.9646434885091337,
        "no_defect_recall": 0.9680662329982259,
        "no_defect_f1": 0.9663518299881936,
        "no_defect_tp": 1637,
        "no_defect_fp": 60,
        "no_defect_tn": 1524,
        "no_defect_fn": 54,
        "no_defect_support": 1691,
        "defect_precision": 0.9657794676806084,
        "defect_recall": 0.9621212121212122,
        "defect_f1": 0.9639468690702088,
        "defect_tp": 1524,
        "defect_fp": 54,
        "defect_tn": 1637,
        "defect_fn": 60,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9682522643408252,
        "recall_macro": 0.9682522643408252,
        "f1_macro": 0.9682522643408252,
        "precision_micro": 0.9682539682539683,
        "recall_micro": 0.9682539682539683,
        "f1_micro": 0.9682539682539683,
        "accuracy": 0.9682539682539683,
        "hamming_loss": 0.031746031746031744,
        "no_defect_precision": 0.9684848484848485,
        "no_defect_recall": 0.9684848484848485,
        "no_defect_f1": 0.9684848484848485,
        "no_defect_tp": 1598,
        "no_defect_fp": 52,
        "no_defect_tn": 1574,
        "no_defect_fn": 52,
        "no_defect_support": 1650,
        "defect_precision": 0.968019680196802,
        "defect_recall": 0.968019680196802,
        "defect_f1": 0.968019680196802,
        "defect_tp": 1574,
        "defect_fp": 52,
        "defect_tn": 1598,
        "defect_fn": 52,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.38628041650710243,
          0.21100264631804064,
          0.1895482006743862,
          0.18846448420480705,
          0.187533628491677,
          0.1821681578413712,
          0.18008759850051612,
          0.17841046895816237,
          0.17285701199181408,
          0.1754637360572815,
          0.16973621003859712,
          0.16348591431289536,
          0.16801377741238063,
          0.16754312012110795,
          0.16231449838400386
        ],
        "val_loss": [
          0.2873893850124799,
          0.1553796734660864,
          0.1249903730618266,
          0.10793528279576164,
          0.1106369339574415,
          0.10709909761611086,
          0.11765690248173016,
          0.11057210280201756,
          0.10223489473215662,
          0.09680526413453314,
          0.10061110996712859,
          0.10312196322215292,
          0.10237343498290731,
          0.09930195580594815,
          0.0990514439673951
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9150009734570705,
            "recall_macro": 0.915407213769869,
            "f1_macro": 0.9147976894459353,
            "precision_micro": 0.9148091603053435,
            "recall_micro": 0.9148091603053435,
            "f1_micro": 0.9148091603053435,
            "accuracy": 0.9148091603053435,
            "hamming_loss": 0.08519083969465649,
            "no_defect_precision": 0.9352651048088779,
            "no_defect_recall": 0.8971023063276168,
            "no_defect_f1": 0.9157862964080894,
            "no_defect_tp": 1517,
            "no_defect_fp": 105,
            "no_defect_tn": 1479,
            "no_defect_fn": 174,
            "no_defect_support": 1691,
            "defect_precision": 0.8947368421052632,
            "defect_recall": 0.9337121212121212,
            "defect_f1": 0.9138090824837812,
            "defect_tp": 1479,
            "defect_fp": 174,
            "defect_tn": 1517,
            "defect_fn": 105,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9517607553649092,
            "recall_macro": 0.9522434576396729,
            "f1_macro": 0.9517430868906078,
            "precision_micro": 0.9517557251908397,
            "recall_micro": 0.9517557251908397,
            "f1_micro": 0.9517557251908397,
            "accuracy": 0.9517557251908397,
            "hamming_loss": 0.048244274809160305,
            "no_defect_precision": 0.9682345754428833,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.9525240384615384,
            "no_defect_tp": 1585,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.9352869352869353,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9509621353196772,
            "defect_tp": 1532,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9569416194339835,
            "recall_macro": 0.9574298574150732,
            "f1_macro": 0.9569348566672844,
            "precision_micro": 0.9569465648854962,
            "recall_micro": 0.9569465648854962,
            "f1_micro": 0.9569465648854962,
            "accuracy": 0.9569465648854962,
            "hamming_loss": 0.04305343511450382,
            "no_defect_precision": 0.9731379731379731,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.9576449384199459,
            "no_defect_tp": 1594,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.9407452657299938,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9562247749146228,
            "defect_tp": 1540,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9607746791011699,
            "recall_macro": 0.9610740013977743,
            "f1_macro": 0.9608884297674877,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9676840215439856,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9619274241522903,
            "no_defect_tp": 1617,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9538653366583542,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9598494353826851,
            "defect_tp": 1530,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.959572563500056,
            "recall_macro": 0.9600111105137716,
            "f1_macro": 0.9596757042340232,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9709969788519638,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9605499103407054,
            "no_defect_tp": 1607,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9481481481481482,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9588014981273408,
            "defect_tp": 1536,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9595495080088461,
            "recall_macro": 0.9598912692865975,
            "f1_macro": 0.9596687519871746,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9676064787042592,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9606908874329958,
            "no_defect_tp": 1613,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9514925373134329,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9586466165413534,
            "defect_tp": 1530,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9550849948489101,
            "recall_macro": 0.9554998909855503,
            "f1_macro": 0.9548045714984779,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9771181199752629,
            "no_defect_recall": 0.9343583678296866,
            "no_defect_f1": 0.9552599758162031,
            "no_defect_tp": 1580,
            "no_defect_fp": 37,
            "no_defect_tn": 1547,
            "no_defect_fn": 111,
            "no_defect_support": 1691,
            "defect_precision": 0.9330518697225573,
            "defect_recall": 0.9766414141414141,
            "defect_f1": 0.9543491671807526,
            "defect_tp": 1547,
            "defect_fp": 111,
            "defect_tn": 1580,
            "defect_fn": 37,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9591560489362877,
            "recall_macro": 0.9596394533746693,
            "f1_macro": 0.9590755408537727,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9773145309625997,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.9596628537025887,
            "no_defect_tp": 1594,
            "no_defect_fp": 37,
            "no_defect_tn": 1547,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.9409975669099757,
            "defect_recall": 0.9766414141414141,
            "defect_f1": 0.9584882280049566,
            "defect_tp": 1547,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 37,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9619930491513637,
            "recall_macro": 0.9623366276604006,
            "f1_macro": 0.962113070048558,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.97000599880024,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9630732578916021,
            "no_defect_tp": 1617,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9539800995024875,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9611528822055138,
            "defect_tp": 1534,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9652114780948711,
            "recall_macro": 0.965093722559719,
            "f1_macro": 0.9651493495292012,
            "precision_micro": 0.9651908396946565,
            "recall_micro": 0.9651908396946565,
            "f1_micro": 0.9651908396946565,
            "accuracy": 0.9651908396946565,
            "hamming_loss": 0.03480916030534351,
            "no_defect_precision": 0.9646434885091337,
            "no_defect_recall": 0.9680662329982259,
            "no_defect_f1": 0.9663518299881936,
            "no_defect_tp": 1637,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 54,
            "no_defect_support": 1691,
            "defect_precision": 0.9657794676806084,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9639468690702088,
            "defect_tp": 1524,
            "defect_fp": 54,
            "defect_tn": 1637,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9632625396740089,
            "recall_macro": 0.9633995185444032,
            "f1_macro": 0.9633252655138793,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9667260843731432,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.96443390634262,
            "no_defect_tp": 1627,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.9597989949748744,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9622166246851386,
            "defect_tp": 1528,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9632197426640914,
            "recall_macro": 0.9636192274608892,
            "f1_macro": 0.9633385125846853,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9729078868151716,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.964200477326969,
            "no_defect_tp": 1616,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9535315985130112,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9624765478424016,
            "defect_tp": 1539,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626089298410134,
            "recall_macro": 0.9630078878674384,
            "f1_macro": 0.9627274877944301,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9723058398555088,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9636038186157518,
            "no_defect_tp": 1615,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.952912019826518,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9618511569731082,
            "defect_tp": 1538,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638453105141116,
            "recall_macro": 0.9640707787514411,
            "f1_macro": 0.9639403876615942,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9689922480620154,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9649643705463183,
            "no_defect_tp": 1625,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9586983729662077,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9629164047768699,
            "defect_tp": 1532,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635436452287252,
            "recall_macro": 0.9637551221857845,
            "f1_macro": 0.9636341631807811,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.968414779499404,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.964677945978035,
            "no_defect_tp": 1625,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9586725109580463,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9625903803835272,
            "defect_tp": 1531,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 53,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9682522643408252,
            "recall_macro": 0.9682522643408252,
            "f1_macro": 0.9682522643408252,
            "precision_micro": 0.9682539682539683,
            "recall_micro": 0.9682539682539683,
            "f1_micro": 0.9682539682539683,
            "accuracy": 0.9682539682539683,
            "hamming_loss": 0.031746031746031744,
            "no_defect_precision": 0.9684848484848485,
            "no_defect_recall": 0.9684848484848485,
            "no_defect_f1": 0.9684848484848485,
            "no_defect_tp": 1598,
            "no_defect_fp": 52,
            "no_defect_tn": 1574,
            "no_defect_fn": 52,
            "no_defect_support": 1650,
            "defect_precision": 0.968019680196802,
            "defect_recall": 0.968019680196802,
            "defect_f1": 0.968019680196802,
            "defect_tp": 1574,
            "defect_fp": 52,
            "defect_tn": 1598,
            "defect_fn": 52,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.01_s90_20251207_154742",
    "lr": 0.01,
    "weight_decay": 0.01,
    "seed": 90,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9639474118262565,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.01_s90_20251207_154742",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s90_20251207_154742",
      "timestamp": "2025-12-07T15:49:33.469772",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.01_s90",
          "seed": 90,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s90_20251207_154742"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9638259377389813,
        "recall_macro": 0.9641906199786152,
        "f1_macro": 0.9639474118262565,
        "precision_micro": 0.963969465648855,
        "recall_micro": 0.963969465648855,
        "f1_micro": 0.963969465648855,
        "accuracy": 0.963969465648855,
        "hamming_loss": 0.03603053435114504,
        "no_defect_precision": 0.9723723723723724,
        "no_defect_recall": 0.9574216439976345,
        "no_defect_f1": 0.9648390941597139,
        "no_defect_tp": 1619,
        "no_defect_fp": 46,
        "no_defect_tn": 1538,
        "no_defect_fn": 72,
        "no_defect_support": 1691,
        "defect_precision": 0.9552795031055901,
        "defect_recall": 0.9709595959595959,
        "defect_f1": 0.963055729492799,
        "defect_tp": 1538,
        "defect_fp": 72,
        "defect_tn": 1619,
        "defect_fn": 46,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9667208841979874,
        "recall_macro": 0.9667415855976742,
        "f1_macro": 0.9667268207352537,
        "precision_micro": 0.9667277167277167,
        "recall_micro": 0.9667277167277167,
        "f1_micro": 0.9667277167277167,
        "accuracy": 0.9667277167277167,
        "hamming_loss": 0.03327228327228327,
        "no_defect_precision": 0.9689592209373098,
        "no_defect_recall": 0.9648484848484848,
        "no_defect_f1": 0.9668994837534164,
        "no_defect_tp": 1592,
        "no_defect_fp": 51,
        "no_defect_tn": 1575,
        "no_defect_fn": 58,
        "no_defect_support": 1650,
        "defect_precision": 0.964482547458665,
        "defect_recall": 0.9686346863468634,
        "defect_f1": 0.9665541577170911,
        "defect_tp": 1575,
        "defect_fp": 58,
        "defect_tn": 1592,
        "defect_fn": 51,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.39278249542334087,
          0.21844427658548915,
          0.19136951343160294,
          0.18628401452652082,
          0.1832167884670042,
          0.1868380445005006,
          0.18265392395928814,
          0.1731984671594957,
          0.1747664683128251,
          0.17305165323502847,
          0.16797756244697332,
          0.17353776020921424,
          0.16469691338399464,
          0.1687578525721528,
          0.16874038228554705
        ],
        "val_loss": [
          0.2870851116111645,
          0.15919753507925913,
          0.11979539749714044,
          0.11863834890895165,
          0.11246664886577772,
          0.11050145890420446,
          0.1139986882917583,
          0.11756720200467569,
          0.10268267204698461,
          0.10282816988630937,
          0.09791478643623683,
          0.10220163315534592,
          0.09876608626487163,
          0.106195892028224,
          0.10270122546129502
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9212636343710703,
            "recall_macro": 0.920481985735534,
            "f1_macro": 0.9207670739261018,
            "precision_micro": 0.9209160305343511,
            "recall_micro": 0.9209160305343511,
            "f1_micro": 0.9209160305343511,
            "accuracy": 0.9209160305343511,
            "hamming_loss": 0.07908396946564886,
            "no_defect_precision": 0.9148319814600232,
            "no_defect_recall": 0.9337670017740982,
            "no_defect_f1": 0.9242025168276266,
            "no_defect_tp": 1579,
            "no_defect_fp": 147,
            "no_defect_tn": 1437,
            "no_defect_fn": 112,
            "no_defect_support": 1691,
            "defect_precision": 0.9276952872821175,
            "defect_recall": 0.9071969696969697,
            "defect_f1": 0.917331631024577,
            "defect_tp": 1437,
            "defect_fp": 112,
            "defect_tn": 1579,
            "defect_fn": 147,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9488590832374548,
            "recall_macro": 0.9491828396322779,
            "f1_macro": 0.9489740654745984,
            "precision_micro": 0.9490076335877863,
            "recall_micro": 0.9490076335877863,
            "f1_micro": 0.9490076335877863,
            "accuracy": 0.9490076335877863,
            "hamming_loss": 0.05099236641221374,
            "no_defect_precision": 0.9568345323741008,
            "no_defect_recall": 0.9438202247191011,
            "no_defect_f1": 0.9502828222685323,
            "no_defect_tp": 1596,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 95,
            "no_defect_support": 1691,
            "defect_precision": 0.940883634100809,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.9476653086806643,
            "defect_tp": 1512,
            "defect_fp": 95,
            "defect_tn": 1596,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9593071884579247,
            "recall_macro": 0.9588205383223125,
            "f1_macro": 0.9590203888622861,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9544658493870403,
            "no_defect_recall": 0.9668835008870491,
            "no_defect_f1": 0.9606345475910694,
            "no_defect_tp": 1635,
            "no_defect_fp": 78,
            "no_defect_tn": 1506,
            "no_defect_fn": 56,
            "no_defect_support": 1691,
            "defect_precision": 0.9641485275288092,
            "defect_recall": 0.9507575757575758,
            "defect_f1": 0.9574062301335029,
            "defect_tp": 1506,
            "defect_fp": 56,
            "defect_tn": 1635,
            "defect_fn": 78,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9568018326529151,
            "recall_macro": 0.9571702014228626,
            "f1_macro": 0.9569208594837779,
            "precision_micro": 0.9569465648854962,
            "recall_micro": 0.9569465648854962,
            "f1_micro": 0.9569465648854962,
            "accuracy": 0.9569465648854962,
            "hamming_loss": 0.04305343511450382,
            "no_defect_precision": 0.9657451923076923,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.957973174366617,
            "no_defect_tp": 1607,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9478584729981379,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.955868544600939,
            "defect_tp": 1527,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9590342794147482,
            "recall_macro": 0.959519612147495,
            "f1_macro": 0.9590706858628275,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9738283627510651,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.9598080383923215,
            "no_defect_tp": 1600,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9442401960784313,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9583333333333334,
            "defect_tp": 1541,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.95775166690676,
            "recall_macro": 0.9579174357412086,
            "f1_macro": 0.957825598140239,
            "precision_micro": 0.9578625954198473,
            "recall_micro": 0.9578625954198473,
            "f1_micro": 0.9578625954198473,
            "accuracy": 0.9578625954198473,
            "hamming_loss": 0.04213740458015267,
            "no_defect_precision": 0.9619274241522903,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9590747330960854,
            "no_defect_tp": 1617,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9535759096612296,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9565764631843927,
            "defect_tp": 1520,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9568889192217096,
            "recall_macro": 0.9573699368014862,
            "f1_macro": 0.9569321093729962,
            "precision_micro": 0.9569465648854962,
            "recall_micro": 0.9569465648854962,
            "f1_micro": 0.9569465648854962,
            "accuracy": 0.9569465648854962,
            "hamming_loss": 0.04305343511450382,
            "no_defect_precision": 0.9714111922141119,
            "no_defect_recall": 0.9444115907746895,
            "no_defect_f1": 0.9577211394302848,
            "no_defect_tp": 1597,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 94,
            "no_defect_support": 1691,
            "defect_precision": 0.9423666462293072,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9561430793157076,
            "defect_tp": 1537,
            "defect_fp": 94,
            "defect_tn": 1597,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9573893057209454,
            "recall_macro": 0.9577294604830087,
            "f1_macro": 0.9569442526556289,
            "precision_micro": 0.9569465648854962,
            "recall_micro": 0.9569465648854962,
            "f1_micro": 0.9569465648854962,
            "accuracy": 0.9569465648854962,
            "hamming_loss": 0.04305343511450382,
            "no_defect_precision": 0.9819651741293532,
            "no_defect_recall": 0.9337670017740982,
            "no_defect_f1": 0.957259775689603,
            "no_defect_tp": 1579,
            "no_defect_fp": 29,
            "no_defect_tn": 1555,
            "no_defect_fn": 112,
            "no_defect_support": 1691,
            "defect_precision": 0.9328134373125375,
            "defect_recall": 0.9816919191919192,
            "defect_f1": 0.9566287296216549,
            "defect_tp": 1555,
            "defect_fp": 112,
            "defect_tn": 1579,
            "defect_fn": 29,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9613856218221651,
            "recall_macro": 0.9616853409912252,
            "f1_macro": 0.9614995480523707,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9682824655894674,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9625223081499108,
            "no_defect_tp": 1618,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9544887780548629,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9604767879548306,
            "defect_tp": 1531,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638257050082522,
            "recall_macro": 0.9641706464407529,
            "f1_macro": 0.9639463085945955,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9718056388722256,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9648600357355569,
            "no_defect_tp": 1620,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9558457711442786,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9630325814536341,
            "defect_tp": 1537,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9642361889810869,
            "recall_macro": 0.9636912815320562,
            "f1_macro": 0.9639117244079076,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.958600583090379,
            "no_defect_recall": 0.9722057953873448,
            "no_defect_f1": 0.9653552554315913,
            "no_defect_tp": 1644,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 47,
            "no_defect_support": 1691,
            "defect_precision": 0.9698717948717949,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.962468193384224,
            "defect_tp": 1513,
            "defect_fp": 47,
            "defect_tn": 1644,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638259377389813,
            "recall_macro": 0.9641906199786152,
            "f1_macro": 0.9639474118262565,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9723723723723724,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9648390941597139,
            "no_defect_tp": 1619,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9552795031055901,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.963055729492799,
            "defect_tp": 1538,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962787344302262,
            "recall_macro": 0.9626283906480536,
            "f1_macro": 0.9627021022366603,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9617422012948793,
            "no_defect_recall": 0.9662921348314607,
            "no_defect_f1": 0.9640117994100295,
            "no_defect_tp": 1634,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 57,
            "no_defect_support": 1691,
            "defect_precision": 0.9638324873096447,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9613924050632912,
            "defect_tp": 1519,
            "defect_fp": 57,
            "defect_tn": 1634,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620341306806146,
            "recall_macro": 0.9624964159632995,
            "f1_macro": 0.9621215512982952,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9745608721986675,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9628964691801316,
            "no_defect_tp": 1609,
            "no_defect_fp": 42,
            "no_defect_tn": 1542,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9495073891625616,
            "defect_recall": 0.9734848484848485,
            "defect_f1": 0.9613466334164589,
            "defect_tp": 1542,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 42,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635206582711429,
            "recall_macro": 0.9638549898750963,
            "f1_macro": 0.9636402023441748,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9712230215827338,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9645727895206907,
            "no_defect_tp": 1620,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.955818294959552,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.962707615167659,
            "defect_tp": 1536,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 48,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9667208841979874,
            "recall_macro": 0.9667415855976742,
            "f1_macro": 0.9667268207352537,
            "precision_micro": 0.9667277167277167,
            "recall_micro": 0.9667277167277167,
            "f1_micro": 0.9667277167277167,
            "accuracy": 0.9667277167277167,
            "hamming_loss": 0.03327228327228327,
            "no_defect_precision": 0.9689592209373098,
            "no_defect_recall": 0.9648484848484848,
            "no_defect_f1": 0.9668994837534164,
            "no_defect_tp": 1592,
            "no_defect_fp": 51,
            "no_defect_tn": 1575,
            "no_defect_fn": 58,
            "no_defect_support": 1650,
            "defect_precision": 0.964482547458665,
            "defect_recall": 0.9686346863468634,
            "defect_f1": 0.9665541577170911,
            "defect_tp": 1575,
            "defect_fp": 58,
            "defect_tn": 1592,
            "defect_fn": 51,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.01_s100_20251207_164431",
    "lr": 0.01,
    "weight_decay": 0.01,
    "seed": 100,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9654513321460336,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.01_s100_20251207_164431",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s100_20251207_164431",
      "timestamp": "2025-12-07T16:46:26.947635",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 8,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.01_s100",
          "seed": 100,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s100_20251207_164431"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9655750722944398,
        "recall_macro": 0.9653494585117885,
        "f1_macro": 0.9654513321460336,
        "precision_micro": 0.9654961832061069,
        "recall_micro": 0.9654961832061069,
        "f1_micro": 0.9654961832061069,
        "accuracy": 0.9654961832061069,
        "hamming_loss": 0.03450381679389313,
        "no_defect_precision": 0.963572267920094,
        "no_defect_recall": 0.9698403311649911,
        "no_defect_f1": 0.9666961391099322,
        "no_defect_tp": 1640,
        "no_defect_fp": 62,
        "no_defect_tn": 1522,
        "no_defect_fn": 51,
        "no_defect_support": 1691,
        "defect_precision": 0.9675778766687858,
        "defect_recall": 0.9608585858585859,
        "defect_f1": 0.9642065251821349,
        "defect_tp": 1522,
        "defect_fp": 51,
        "defect_tn": 1640,
        "defect_fn": 62,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9673346942867909,
        "recall_macro": 0.9673387006597338,
        "f1_macro": 0.967336607325977,
        "precision_micro": 0.9673382173382173,
        "recall_micro": 0.9673382173382173,
        "f1_micro": 0.9673382173382173,
        "accuracy": 0.9673382173382173,
        "hamming_loss": 0.032661782661782664,
        "no_defect_precision": 0.9678593086719224,
        "no_defect_recall": 0.9672727272727273,
        "no_defect_f1": 0.967565929069415,
        "no_defect_tp": 1596,
        "no_defect_fp": 53,
        "no_defect_tn": 1573,
        "no_defect_fn": 54,
        "no_defect_support": 1650,
        "defect_precision": 0.9668100799016595,
        "defect_recall": 0.9674046740467405,
        "defect_f1": 0.9671072855825392,
        "defect_tp": 1573,
        "defect_fp": 54,
        "defect_tn": 1596,
        "defect_fn": 53,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.38944486444465287,
          0.22034608691182594,
          0.18410063472627097,
          0.18048140730817946,
          0.18412469411619536,
          0.18331501048416773,
          0.17669487133559822,
          0.1810199598544063,
          0.1806036530054763,
          0.16950413639263628,
          0.17405838929272596,
          0.17003401901931445,
          0.17314408781887597,
          0.1635670496860059,
          0.1632842598288129
        ],
        "val_loss": [
          0.2855053208768368,
          0.15693406717708477,
          0.1226302908303646,
          0.11392414369262181,
          0.11514736253481644,
          0.11058914288878441,
          0.10817373106972529,
          0.09929405185035788,
          0.10610742623416278,
          0.10396919449648032,
          0.1079798207188455,
          0.10330365956402741,
          0.1056392896705522,
          0.09931933073900066,
          0.10030016686337498
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9197677687809267,
            "recall_macro": 0.918052680859452,
            "f1_macro": 0.9185565888434821,
            "precision_micro": 0.9187786259541985,
            "recall_micro": 0.9187786259541985,
            "f1_micro": 0.9187786259541985,
            "accuracy": 0.9187786259541985,
            "hamming_loss": 0.08122137404580153,
            "no_defect_precision": 0.905982905982906,
            "no_defect_recall": 0.9402720283855707,
            "no_defect_f1": 0.922809053975624,
            "no_defect_tp": 1590,
            "no_defect_fp": 165,
            "no_defect_tn": 1419,
            "no_defect_fn": 101,
            "no_defect_support": 1691,
            "defect_precision": 0.9335526315789474,
            "defect_recall": 0.8958333333333334,
            "defect_f1": 0.9143041237113402,
            "defect_tp": 1419,
            "defect_fp": 101,
            "defect_tn": 1590,
            "defect_fn": 165,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9501003072656344,
            "recall_macro": 0.9503056511298675,
            "f1_macro": 0.9501879714156918,
            "precision_micro": 0.9502290076335878,
            "recall_micro": 0.9502290076335878,
            "f1_micro": 0.9502290076335878,
            "accuracy": 0.9502290076335878,
            "hamming_loss": 0.04977099236641221,
            "no_defect_precision": 0.9553039332538736,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9516176907094093,
            "no_defect_tp": 1603,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9448966812773951,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9487582521219742,
            "defect_tp": 1509,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9577224272563892,
            "recall_macro": 0.9581171711198323,
            "f1_macro": 0.957839289472388,
            "precision_micro": 0.9578625954198473,
            "recall_micro": 0.9578625954198473,
            "f1_micro": 0.9578625954198473,
            "accuracy": 0.9578625954198473,
            "hamming_loss": 0.04213740458015267,
            "no_defect_precision": 0.9674894641782059,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9588305489260143,
            "no_defect_tp": 1607,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9479553903345725,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9568480300187617,
            "defect_tp": 1530,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9571758550719012,
            "recall_macro": 0.9572461755341708,
            "f1_macro": 0.9572095832614715,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9596917605216361,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9585553582001184,
            "no_defect_tp": 1619,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9546599496221663,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9558638083228247,
            "defect_tp": 1516,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.957148302417105,
            "recall_macro": 0.9576056992156933,
            "f1_macro": 0.9572340095303333,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9697153240460327,
            "no_defect_recall": 0.9467770549970431,
            "no_defect_f1": 0.9581089168162776,
            "no_defect_tp": 1601,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 90,
            "no_defect_support": 1691,
            "defect_precision": 0.9445812807881774,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.956359102244389,
            "defect_tp": 1534,
            "defect_fp": 90,
            "defect_tn": 1601,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9586734248305421,
            "recall_macro": 0.9588244583624537,
            "f1_macro": 0.9587416821971514,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.9625445897740785,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9599762822413282,
            "no_defect_tp": 1619,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9548022598870056,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9575070821529745,
            "defect_tp": 1521,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9617064344603485,
            "recall_macro": 0.9621408123219182,
            "f1_macro": 0.9618136044963075,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9728260869565217,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9626531221989841,
            "no_defect_tp": 1611,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9505867819641755,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.9609740867936309,
            "defect_tp": 1539,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9655750722944398,
            "recall_macro": 0.9653494585117885,
            "f1_macro": 0.9654513321460336,
            "precision_micro": 0.9654961832061069,
            "recall_micro": 0.9654961832061069,
            "f1_micro": 0.9654961832061069,
            "accuracy": 0.9654961832061069,
            "hamming_loss": 0.03450381679389313,
            "no_defect_precision": 0.963572267920094,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.9666961391099322,
            "no_defect_tp": 1640,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.9675778766687858,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9642065251821349,
            "defect_tp": 1522,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9622984681753373,
            "recall_macro": 0.9626522842260572,
            "f1_macro": 0.9624191883104434,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9705882352941176,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9633601429848079,
            "no_defect_tp": 1617,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9540087010565569,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9614782336360789,
            "defect_tp": 1535,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610921802260064,
            "recall_macro": 0.9613297373498437,
            "f1_macro": 0.9611907481841506,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9665871121718377,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9622809622809623,
            "no_defect_tp": 1620,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9555972482801751,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.960100534087339,
            "defect_tp": 1528,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.960176066923633,
            "recall_macro": 0.9606024765693602,
            "f1_macro": 0.9602856115166969,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9710319855159928,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9611708482676224,
            "no_defect_tp": 1609,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9493201483312732,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9594003747657714,
            "defect_tp": 1536,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9616947666828304,
            "recall_macro": 0.9621008652461935,
            "f1_macro": 0.9618114956656572,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9716867469879518,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9626977021784542,
            "no_defect_tp": 1613,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.951702786377709,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9609252891528602,
            "defect_tp": 1537,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9611035852739923,
            "recall_macro": 0.9615494462663298,
            "f1_macro": 0.9612036499397196,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9727932285368803,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9620328849028401,
            "no_defect_tp": 1609,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9494139420111043,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.960374414976599,
            "defect_tp": 1539,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9639309639864047,
            "recall_macro": 0.9639309639864047,
            "f1_macro": 0.9639309639864047,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9651094027202839,
            "no_defect_recall": 0.9651094027202839,
            "no_defect_f1": 0.9651094027202839,
            "no_defect_tp": 1632,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 59,
            "no_defect_support": 1691,
            "defect_precision": 0.9627525252525253,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9627525252525253,
            "defect_tp": 1525,
            "defect_fp": 59,
            "defect_tn": 1632,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644644667057758,
            "recall_macro": 0.9646621448070294,
            "f1_macro": 0.9645503237967266,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9690291840381179,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9655786350148368,
            "no_defect_tp": 1627,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.9598997493734336,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9635220125786164,
            "defect_tp": 1532,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 52,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9673346942867909,
            "recall_macro": 0.9673387006597338,
            "f1_macro": 0.967336607325977,
            "precision_micro": 0.9673382173382173,
            "recall_micro": 0.9673382173382173,
            "f1_micro": 0.9673382173382173,
            "accuracy": 0.9673382173382173,
            "hamming_loss": 0.032661782661782664,
            "no_defect_precision": 0.9678593086719224,
            "no_defect_recall": 0.9672727272727273,
            "no_defect_f1": 0.967565929069415,
            "no_defect_tp": 1596,
            "no_defect_fp": 53,
            "no_defect_tn": 1573,
            "no_defect_fn": 54,
            "no_defect_support": 1650,
            "defect_precision": 0.9668100799016595,
            "defect_recall": 0.9674046740467405,
            "defect_f1": 0.9671072855825392,
            "defect_tp": 1573,
            "defect_fp": 54,
            "defect_tn": 1596,
            "defect_fn": 53,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.01_s110_20251207_151101",
    "lr": 0.01,
    "weight_decay": 0.01,
    "seed": 110,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9669793036694143,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.01_s110_20251207_151101",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s110_20251207_151101",
      "timestamp": "2025-12-07T15:12:59.076167",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.01_s110",
          "seed": 110,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s110_20251207_151101"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9671168526130358,
        "recall_macro": 0.9668678207264843,
        "f1_macro": 0.9669793036694143,
        "precision_micro": 0.9670229007633587,
        "recall_micro": 0.9670229007633587,
        "f1_micro": 0.9670229007633587,
        "accuracy": 0.9670229007633587,
        "hamming_loss": 0.03297709923664122,
        "no_defect_precision": 0.9647680563711099,
        "no_defect_recall": 0.9716144293317563,
        "no_defect_f1": 0.9681791396582203,
        "no_defect_tp": 1643,
        "no_defect_fp": 60,
        "no_defect_tn": 1524,
        "no_defect_fn": 48,
        "no_defect_support": 1691,
        "defect_precision": 0.9694656488549618,
        "defect_recall": 0.9621212121212122,
        "defect_f1": 0.9657794676806084,
        "defect_tp": 1524,
        "defect_fp": 48,
        "defect_tn": 1643,
        "defect_fn": 60,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.96855240309517,
        "recall_macro": 0.9685731857318574,
        "f1_macro": 0.9685583718874415,
        "precision_micro": 0.9685592185592186,
        "recall_micro": 0.9685592185592186,
        "f1_micro": 0.9685592185592186,
        "accuracy": 0.9685592185592186,
        "hamming_loss": 0.03144078144078144,
        "no_defect_precision": 0.970785149117468,
        "no_defect_recall": 0.9666666666666667,
        "no_defect_f1": 0.9687215305192833,
        "no_defect_tp": 1595,
        "no_defect_fp": 48,
        "no_defect_tn": 1578,
        "no_defect_fn": 55,
        "no_defect_support": 1650,
        "defect_precision": 0.966319657072872,
        "defect_recall": 0.9704797047970479,
        "defect_f1": 0.9683952132555999,
        "defect_tp": 1578,
        "defect_fp": 55,
        "defect_tn": 1595,
        "defect_fn": 48,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.3945515171379225,
          0.21792370483092185,
          0.1884059968665554,
          0.18539794391044512,
          0.18070010064660755,
          0.17971493055942667,
          0.1854377520820087,
          0.17652882123560837,
          0.17215787906152932,
          0.1758965586300425,
          0.1685987862614159,
          0.16742382384057325,
          0.16362556749682047,
          0.17114522973675608,
          0.17176383532677236
        ],
        "val_loss": [
          0.2880905760595432,
          0.1542979206603307,
          0.11972405897596708,
          0.10888513356733781,
          0.11874402371736673,
          0.11119248452954568,
          0.10534516166752347,
          0.11478419866985999,
          0.10315534243216881,
          0.10849651805340098,
          0.10127598194118875,
          0.10387718899605367,
          0.09679209759745461,
          0.09976881534720843,
          0.09976897524813047
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9181954203663917,
            "recall_macro": 0.916969816437587,
            "f1_macro": 0.9173673504173825,
            "precision_micro": 0.917557251908397,
            "recall_micro": 0.917557251908397,
            "f1_micro": 0.917557251908397,
            "accuracy": 0.917557251908397,
            "hamming_loss": 0.08244274809160305,
            "no_defect_precision": 0.9080987937966686,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.9213286713286714,
            "no_defect_tp": 1581,
            "no_defect_fp": 160,
            "no_defect_tn": 1424,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9282920469361148,
            "defect_recall": 0.898989898989899,
            "defect_f1": 0.9134060295060936,
            "defect_tp": 1424,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 160,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9503964552238806,
            "recall_macro": 0.9506412812333864,
            "f1_macro": 0.9504961303845431,
            "precision_micro": 0.9505343511450381,
            "recall_micro": 0.9505343511450381,
            "f1_micro": 0.9505343511450381,
            "accuracy": 0.9505343511450381,
            "hamming_loss": 0.04946564885496183,
            "no_defect_precision": 0.9564179104477611,
            "no_defect_recall": 0.9473684210526315,
            "no_defect_f1": 0.9518716577540107,
            "no_defect_tp": 1602,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 89,
            "no_defect_support": 1691,
            "defect_precision": 0.944375,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.9491206030150754,
            "defect_tp": 1511,
            "defect_fp": 89,
            "defect_tn": 1602,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9572485369688731,
            "recall_macro": 0.9566309159005788,
            "f1_macro": 0.956874367334291,
            "precision_micro": 0.9569465648854962,
            "recall_micro": 0.9569465648854962,
            "f1_micro": 0.9569465648854962,
            "accuracy": 0.9569465648854962,
            "hamming_loss": 0.04305343511450382,
            "no_defect_precision": 0.9511059371362048,
            "no_defect_recall": 0.9662921348314607,
            "no_defect_f1": 0.9586388970372544,
            "no_defect_tp": 1634,
            "no_defect_fp": 84,
            "no_defect_tn": 1500,
            "no_defect_fn": 57,
            "no_defect_support": 1691,
            "defect_precision": 0.9633911368015414,
            "defect_recall": 0.946969696969697,
            "defect_f1": 0.9551098376313276,
            "defect_tp": 1500,
            "defect_fp": 57,
            "defect_tn": 1634,
            "defect_fn": 84,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604969025227645,
            "recall_macro": 0.9606784506806683,
            "f1_macro": 0.9605768126244528,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9648809523809524,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9617324236131711,
            "no_defect_tp": 1621,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9561128526645768,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9594212016357345,
            "defect_tp": 1525,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.955809573535719,
            "recall_macro": 0.9562870723796212,
            "f1_macro": 0.9557164543807442,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9742331288343559,
            "no_defect_recall": 0.9390892962743939,
            "no_defect_f1": 0.9563384522734116,
            "no_defect_tp": 1588,
            "no_defect_fp": 42,
            "no_defect_tn": 1542,
            "no_defect_fn": 103,
            "no_defect_support": 1691,
            "defect_precision": 0.9373860182370821,
            "defect_recall": 0.9734848484848485,
            "defect_f1": 0.9550944564880768,
            "defect_tp": 1542,
            "defect_fp": 103,
            "defect_tn": 1588,
            "defect_fn": 42,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9580592019382395,
            "recall_macro": 0.9585127218369383,
            "f1_macro": 0.9581498966374502,
            "precision_micro": 0.9581679389312977,
            "recall_micro": 0.9581679389312977,
            "f1_micro": 0.9581679389312977,
            "accuracy": 0.9581679389312977,
            "hamming_loss": 0.04183206106870229,
            "no_defect_precision": 0.9703389830508474,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9590188453484894,
            "no_defect_tp": 1603,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9457794208256316,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9572809479264109,
            "defect_tp": 1535,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9617190998656515,
            "recall_macro": 0.9619011298675698,
            "f1_macro": 0.9617992370391986,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9660714285714286,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9629190151290419,
            "no_defect_tp": 1623,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9573667711598746,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9606794589493551,
            "defect_tp": 1527,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9575726000259566,
            "recall_macro": 0.9580611705463864,
            "f1_macro": 0.9575465491166073,
            "precision_micro": 0.9575572519083969,
            "recall_micro": 0.9575572519083969,
            "f1_micro": 0.9575572519083969,
            "accuracy": 0.9575572519083969,
            "hamming_loss": 0.042442748091603054,
            "no_defect_precision": 0.9743276283618582,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.9582206191764352,
            "no_defect_tp": 1594,
            "no_defect_fp": 42,
            "no_defect_tn": 1542,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.9408175716900549,
            "defect_recall": 0.9734848484848485,
            "defect_f1": 0.9568724790567794,
            "defect_tp": 1542,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 42,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638736985581502,
            "recall_macro": 0.964010858137854,
            "f1_macro": 0.963936511088648,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9673202614379085,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.965026674570243,
            "no_defect_tp": 1628,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.960427135678392,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9628463476070529,
            "defect_tp": 1529,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9596153530579761,
            "recall_macro": 0.9600910046652211,
            "f1_macro": 0.9596797360407758,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9732847601700061,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9604553624925105,
            "no_defect_tp": 1603,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9459459459459459,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.958904109589041,
            "defect_tp": 1540,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644563530889462,
            "recall_macro": 0.9646821183448918,
            "f1_macro": 0.9645515675317365,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9695885509838998,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9655581947743468,
            "no_defect_tp": 1626,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9593241551939925,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9635449402891263,
            "defect_tp": 1533,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629279644200959,
            "recall_macro": 0.9633634915088197,
            "f1_macro": 0.9630355691524257,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9740338164251208,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9638482222886167,
            "no_defect_tp": 1613,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9518221124150711,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9622229160162348,
            "defect_tp": 1541,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9671168526130358,
            "recall_macro": 0.9668678207264843,
            "f1_macro": 0.9669793036694143,
            "precision_micro": 0.9670229007633587,
            "recall_micro": 0.9670229007633587,
            "f1_micro": 0.9670229007633587,
            "accuracy": 0.9670229007633587,
            "hamming_loss": 0.03297709923664122,
            "no_defect_precision": 0.9647680563711099,
            "no_defect_recall": 0.9716144293317563,
            "no_defect_f1": 0.9681791396582203,
            "no_defect_tp": 1643,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 48,
            "no_defect_support": 1691,
            "defect_precision": 0.9694656488549618,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9657794676806084,
            "defect_tp": 1524,
            "defect_fp": 48,
            "defect_tn": 1643,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644377696878169,
            "recall_macro": 0.9647620124963413,
            "f1_macro": 0.964556277056277,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9718394248052726,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9654761904761905,
            "no_defect_tp": 1622,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9570361145703612,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9636363636363636,
            "defect_tp": 1537,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644377696878169,
            "recall_macro": 0.9647620124963413,
            "f1_macro": 0.964556277056277,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9718394248052726,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9654761904761905,
            "no_defect_tp": 1622,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9570361145703612,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9636363636363636,
            "defect_tp": 1537,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 47,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.96855240309517,
            "recall_macro": 0.9685731857318574,
            "f1_macro": 0.9685583718874415,
            "precision_micro": 0.9685592185592186,
            "recall_micro": 0.9685592185592186,
            "f1_micro": 0.9685592185592186,
            "accuracy": 0.9685592185592186,
            "hamming_loss": 0.03144078144078144,
            "no_defect_precision": 0.970785149117468,
            "no_defect_recall": 0.9666666666666667,
            "no_defect_f1": 0.9687215305192833,
            "no_defect_tp": 1595,
            "no_defect_fp": 48,
            "no_defect_tn": 1578,
            "no_defect_fn": 55,
            "no_defect_support": 1650,
            "defect_precision": 0.966319657072872,
            "defect_recall": 0.9704797047970479,
            "defect_f1": 0.9683952132555999,
            "defect_tp": 1578,
            "defect_fp": 55,
            "defect_tn": 1595,
            "defect_fn": 48,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.01_s120_20251207_155609",
    "lr": 0.01,
    "weight_decay": 0.01,
    "seed": 120,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9648413873978277,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.01_s120_20251207_155609",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s120_20251207_155609",
      "timestamp": "2025-12-07T15:58:00.926151",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.01_s120",
          "seed": 120,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s120_20251207_155609"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9649393090569561,
        "recall_macro": 0.9647580924562,
        "f1_macro": 0.9648413873978277,
        "precision_micro": 0.9648854961832061,
        "recall_micro": 0.9648854961832061,
        "f1_micro": 0.9648854961832061,
        "accuracy": 0.9648854961832061,
        "hamming_loss": 0.035114503816793895,
        "no_defect_precision": 0.9635294117647059,
        "no_defect_recall": 0.9686575990538143,
        "no_defect_f1": 0.9660867000884695,
        "no_defect_tp": 1638,
        "no_defect_fp": 62,
        "no_defect_tn": 1522,
        "no_defect_fn": 53,
        "no_defect_support": 1691,
        "defect_precision": 0.9663492063492064,
        "defect_recall": 0.9608585858585859,
        "defect_f1": 0.9635960747071858,
        "defect_tp": 1522,
        "defect_fp": 53,
        "defect_tn": 1638,
        "defect_fn": 62,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9673680749630117,
        "recall_macro": 0.9673163367997317,
        "f1_macro": 0.9673349027922334,
        "precision_micro": 0.9673382173382173,
        "recall_micro": 0.9673382173382173,
        "f1_micro": 0.9673382173382173,
        "accuracy": 0.9673382173382173,
        "hamming_loss": 0.032661782661782664,
        "no_defect_precision": 0.9650391802290537,
        "no_defect_recall": 0.9703030303030303,
        "no_defect_f1": 0.9676639468117256,
        "no_defect_tp": 1601,
        "no_defect_fp": 58,
        "no_defect_tn": 1568,
        "no_defect_fn": 49,
        "no_defect_support": 1650,
        "defect_precision": 0.9696969696969697,
        "defect_recall": 0.964329643296433,
        "defect_f1": 0.9670058587727413,
        "defect_tp": 1568,
        "defect_fp": 49,
        "defect_tn": 1601,
        "defect_fn": 58,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.389611947673634,
          0.21671161601109484,
          0.19689561429756955,
          0.18784746459089063,
          0.19322135578451297,
          0.182169654270221,
          0.18487447773001184,
          0.17491373606805521,
          0.1734980570783675,
          0.1736606212808248,
          0.16921186724591952,
          0.1663876833807225,
          0.1704573472766946,
          0.16940867836941734,
          0.16454541143887214
        ],
        "val_loss": [
          0.28787875032195676,
          0.14731364797514218,
          0.1311402330891444,
          0.11829728153176032,
          0.10561071468803745,
          0.11247525027451608,
          0.10018987545313743,
          0.09756124614236447,
          0.1179367509097434,
          0.10345922783017159,
          0.10574820480094506,
          0.10166061049900375,
          0.1006834742326576,
          0.0986841765877146,
          0.09916413776003398
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9238309822361547,
            "recall_macro": 0.9239980750736221,
            "f1_macro": 0.9239040801820834,
            "precision_micro": 0.923969465648855,
            "recall_micro": 0.923969465648855,
            "f1_micro": 0.923969465648855,
            "accuracy": 0.923969465648855,
            "hamming_loss": 0.07603053435114504,
            "no_defect_precision": 0.9291666666666667,
            "no_defect_recall": 0.9231224127735068,
            "no_defect_f1": 0.9261346781370513,
            "no_defect_tp": 1561,
            "no_defect_fp": 119,
            "no_defect_tn": 1465,
            "no_defect_fn": 130,
            "no_defect_support": 1691,
            "defect_precision": 0.9184952978056427,
            "defect_recall": 0.9248737373737373,
            "defect_f1": 0.9216734822271154,
            "defect_tp": 1465,
            "defect_fp": 130,
            "defect_tn": 1561,
            "defect_fn": 119,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546236559139785,
            "recall_macro": 0.9538099803475322,
            "f1_macro": 0.9541134179931821,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9466666666666667,
            "no_defect_recall": 0.9657007687758723,
            "no_defect_f1": 0.9560889929742389,
            "no_defect_tp": 1633,
            "no_defect_fp": 92,
            "no_defect_tn": 1492,
            "no_defect_fn": 58,
            "no_defect_support": 1691,
            "defect_precision": 0.9625806451612903,
            "defect_recall": 0.9419191919191919,
            "defect_f1": 0.9521378430121251,
            "defect_tp": 1492,
            "defect_fp": 58,
            "defect_tn": 1633,
            "defect_fn": 92,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9504631790856395,
            "recall_macro": 0.9474330083806725,
            "f1_macro": 0.9482076365885267,
            "precision_micro": 0.9483969465648855,
            "recall_micro": 0.9483969465648855,
            "f1_micro": 0.9483969465648855,
            "accuracy": 0.9483969465648855,
            "hamming_loss": 0.0516030534351145,
            "no_defect_precision": 0.9270482603815937,
            "no_defect_recall": 0.976936723832052,
            "no_defect_f1": 0.9513389000863807,
            "no_defect_tp": 1652,
            "no_defect_fp": 130,
            "no_defect_tn": 1454,
            "no_defect_fn": 39,
            "no_defect_support": 1691,
            "defect_precision": 0.9738780977896851,
            "defect_recall": 0.9179292929292929,
            "defect_f1": 0.9450763730906727,
            "defect_tp": 1454,
            "defect_fp": 39,
            "defect_tn": 1652,
            "defect_fn": 130,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9575726000259566,
            "recall_macro": 0.9580611705463864,
            "f1_macro": 0.9575465491166073,
            "precision_micro": 0.9575572519083969,
            "recall_micro": 0.9575572519083969,
            "f1_micro": 0.9575572519083969,
            "accuracy": 0.9575572519083969,
            "hamming_loss": 0.042442748091603054,
            "no_defect_precision": 0.9743276283618582,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.9582206191764352,
            "no_defect_tp": 1594,
            "no_defect_fp": 42,
            "no_defect_tn": 1542,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.9408175716900549,
            "defect_recall": 0.9734848484848485,
            "defect_f1": 0.9568724790567794,
            "defect_tp": 1542,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 42,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9627259713716703,
            "recall_macro": 0.9626883112616407,
            "f1_macro": 0.9627067811215202,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9633786178381571,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9639479905437353,
            "no_defect_tp": 1631,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9620733249051833,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9614655716993051,
            "defect_tp": 1522,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9572021976776103,
            "recall_macro": 0.9576855933671427,
            "f1_macro": 0.9572380300059391,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9720024345709068,
            "no_defect_recall": 0.9444115907746895,
            "no_defect_f1": 0.9580083983203359,
            "no_defect_tp": 1597,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 94,
            "no_defect_support": 1691,
            "defect_precision": 0.9424019607843137,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9564676616915423,
            "defect_tp": 1538,
            "defect_fp": 94,
            "defect_tn": 1597,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626042191259583,
            "recall_macro": 0.9629679407917138,
            "f1_macro": 0.9627252901932482,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9711711711711711,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9636471990464839,
            "no_defect_tp": 1617,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9540372670807453,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9618033813400125,
            "defect_tp": 1536,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9649634363073099,
            "recall_macro": 0.9647381189183377,
            "f1_macro": 0.9648398512990607,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9629847238542891,
            "no_defect_recall": 0.9692489651094027,
            "no_defect_f1": 0.9661066902446213,
            "no_defect_tp": 1639,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 52,
            "no_defect_support": 1691,
            "defect_precision": 0.9669421487603306,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9635730123535001,
            "defect_tp": 1521,
            "defect_fp": 52,
            "defect_tn": 1639,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9547967059364164,
            "recall_macro": 0.9552042079577562,
            "f1_macro": 0.9544994727542777,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9771039603960396,
            "no_defect_recall": 0.9337670017740982,
            "no_defect_f1": 0.9549440580586634,
            "no_defect_tp": 1579,
            "no_defect_fp": 37,
            "no_defect_tn": 1547,
            "no_defect_fn": 112,
            "no_defect_support": 1691,
            "defect_precision": 0.9324894514767933,
            "defect_recall": 0.9766414141414141,
            "defect_f1": 0.9540548874498921,
            "defect_tp": 1547,
            "defect_fp": 112,
            "defect_tn": 1579,
            "defect_fn": 37,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9616886086639928,
            "recall_macro": 0.9620609181704687,
            "f1_macro": 0.9618092725920018,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9705528846153846,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.96274217585693,
            "no_defect_tp": 1615,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9528243327126009,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9608763693270735,
            "defect_tp": 1535,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604693513816367,
            "recall_macro": 0.9608582125214296,
            "f1_macro": 0.9605883311608212,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9699157641395909,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9615269907545482,
            "no_defect_tp": 1612,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9510229386236826,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9596496715670941,
            "defect_tp": 1534,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626039344369932,
            "recall_macro": 0.9629479672538513,
            "f1_macro": 0.9627241495639038,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9706058788242351,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9636688505062537,
            "no_defect_tp": 1618,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9546019900497512,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9617794486215538,
            "defect_tp": 1535,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623083168599076,
            "recall_macro": 0.9625723900746077,
            "f1_macro": 0.9624143633908016,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9683393070489845,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9634472511144131,
            "no_defect_tp": 1621,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9562773266708308,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9613814756671899,
            "defect_tp": 1531,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9649393090569561,
            "recall_macro": 0.9647580924562,
            "f1_macro": 0.9648413873978277,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9635294117647059,
            "no_defect_recall": 0.9686575990538143,
            "no_defect_f1": 0.9660867000884695,
            "no_defect_tp": 1638,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 53,
            "no_defect_support": 1691,
            "defect_precision": 0.9663492063492064,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9635960747071858,
            "defect_tp": 1522,
            "defect_fp": 53,
            "defect_tn": 1638,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638995563943566,
            "recall_macro": 0.9639709110621293,
            "f1_macro": 0.9639337916060975,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.966212211025489,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.9650680876258141,
            "no_defect_tp": 1630,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9615869017632241,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9627994955863808,
            "defect_tp": 1527,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 57,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9673680749630117,
            "recall_macro": 0.9673163367997317,
            "f1_macro": 0.9673349027922334,
            "precision_micro": 0.9673382173382173,
            "recall_micro": 0.9673382173382173,
            "f1_micro": 0.9673382173382173,
            "accuracy": 0.9673382173382173,
            "hamming_loss": 0.032661782661782664,
            "no_defect_precision": 0.9650391802290537,
            "no_defect_recall": 0.9703030303030303,
            "no_defect_f1": 0.9676639468117256,
            "no_defect_tp": 1601,
            "no_defect_fp": 58,
            "no_defect_tn": 1568,
            "no_defect_fn": 49,
            "no_defect_support": 1650,
            "defect_precision": 0.9696969696969697,
            "defect_recall": 0.964329643296433,
            "defect_f1": 0.9670058587727413,
            "defect_tp": 1568,
            "defect_fp": 49,
            "defect_tn": 1601,
            "defect_fn": 58,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.01_s130_20251207_152213",
    "lr": 0.01,
    "weight_decay": 0.01,
    "seed": 130,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9645464332535978,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.01_s130_20251207_152213",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s130_20251207_152213",
      "timestamp": "2025-12-07T15:24:10.265300",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.01_s130",
          "seed": 130,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s130_20251207_152213"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.964497135285445,
        "recall_macro": 0.9646022241934424,
        "f1_macro": 0.9645464332535978,
        "precision_micro": 0.9645801526717557,
        "recall_micro": 0.9645801526717557,
        "f1_micro": 0.9645801526717557,
        "accuracy": 0.9645801526717557,
        "hamming_loss": 0.035419847328244276,
        "no_defect_precision": 0.9673590504451038,
        "no_defect_recall": 0.9639266706091071,
        "no_defect_f1": 0.9656398104265402,
        "no_defect_tp": 1630,
        "no_defect_fp": 55,
        "no_defect_tn": 1529,
        "no_defect_fn": 61,
        "no_defect_support": 1691,
        "defect_precision": 0.9616352201257862,
        "defect_recall": 0.9652777777777778,
        "defect_f1": 0.9634530560806553,
        "defect_tp": 1529,
        "defect_fp": 61,
        "defect_tn": 1630,
        "defect_fn": 55,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9679544166043256,
        "recall_macro": 0.967940288493794,
        "f1_macro": 0.967946540666883,
        "precision_micro": 0.967948717948718,
        "recall_micro": 0.967948717948718,
        "f1_micro": 0.967948717948718,
        "accuracy": 0.967948717948718,
        "hamming_loss": 0.03205128205128205,
        "no_defect_precision": 0.9673321234119783,
        "no_defect_recall": 0.9690909090909091,
        "no_defect_f1": 0.9682107175295186,
        "no_defect_tp": 1599,
        "no_defect_fp": 54,
        "no_defect_tn": 1572,
        "no_defect_fn": 51,
        "no_defect_support": 1650,
        "defect_precision": 0.9685767097966729,
        "defect_recall": 0.966789667896679,
        "defect_f1": 0.9676823638042474,
        "defect_tp": 1572,
        "defect_fp": 51,
        "defect_tn": 1599,
        "defect_fn": 54,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.3868897402635678,
          0.21862271549686726,
          0.18994154135801802,
          0.18369015781637515,
          0.1820937836363475,
          0.18242600084785138,
          0.1775092299731456,
          0.1778100798662487,
          0.18221354724597733,
          0.1741363812222391,
          0.17022079746842883,
          0.17220199959173363,
          0.1729791869241822,
          0.17185682147180187,
          0.16676260150626115
        ],
        "val_loss": [
          0.2882990364271861,
          0.16302467151903188,
          0.11698954208539082,
          0.1266762793350678,
          0.11684798166299096,
          0.13094331553349128,
          0.10723065219532985,
          0.11003441642969847,
          0.1213564000164087,
          0.10724191417774329,
          0.09946661861613393,
          0.09986317920713471,
          0.09969045841493286,
          0.09889613063289569,
          0.09975762772732057
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9149019176196662,
            "recall_macro": 0.912330915601909,
            "f1_macro": 0.9129802319828568,
            "precision_micro": 0.9132824427480916,
            "recall_micro": 0.9132824427480916,
            "f1_micro": 0.9132824427480916,
            "accuracy": 0.9132824427480916,
            "hamming_loss": 0.0867175572519084,
            "no_defect_precision": 0.8958919527293191,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9181084198385236,
            "no_defect_tp": 1592,
            "no_defect_fp": 185,
            "no_defect_tn": 1399,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.9339118825100133,
            "defect_recall": 0.8832070707070707,
            "defect_f1": 0.9078520441271901,
            "defect_tp": 1399,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 185,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9425253412411536,
            "recall_macro": 0.9428015742881206,
            "f1_macro": 0.9419827800975342,
            "precision_micro": 0.9419847328244275,
            "recall_micro": 0.9419847328244275,
            "f1_micro": 0.9419847328244275,
            "accuracy": 0.9419847328244275,
            "hamming_loss": 0.05801526717557252,
            "no_defect_precision": 0.9681846537741734,
            "no_defect_recall": 0.9178001182732111,
            "no_defect_f1": 0.9423193685488768,
            "no_defect_tp": 1552,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 139,
            "no_defect_support": 1691,
            "defect_precision": 0.9168660287081339,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9416461916461917,
            "defect_tp": 1533,
            "defect_fp": 139,
            "defect_tn": 1552,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620055970149254,
            "recall_macro": 0.9622567335089511,
            "f1_macro": 0.9621081491832305,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9677611940298507,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9631610219845514,
            "no_defect_tp": 1621,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.95625,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9610552763819096,
            "defect_tp": 1530,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9550849948489101,
            "recall_macro": 0.9554998909855503,
            "f1_macro": 0.9548045714984779,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9771181199752629,
            "no_defect_recall": 0.9343583678296866,
            "no_defect_f1": 0.9552599758162031,
            "no_defect_tp": 1580,
            "no_defect_fp": 37,
            "no_defect_tn": 1547,
            "no_defect_fn": 111,
            "no_defect_support": 1691,
            "defect_precision": 0.9330518697225573,
            "defect_recall": 0.9766414141414141,
            "defect_f1": 0.9543491671807526,
            "defect_tp": 1547,
            "defect_fp": 111,
            "defect_tn": 1580,
            "defect_fn": 37,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9550906243007384,
            "recall_macro": 0.9555758650968587,
            "f1_macro": 0.9551013761823397,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9707317073170731,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9558691083758631,
            "no_defect_tp": 1592,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.9394495412844037,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9543336439888164,
            "defect_tp": 1536,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9513115868846537,
            "recall_macro": 0.9514601962857433,
            "f1_macro": 0.9505339775772679,
            "precision_micro": 0.9505343511450381,
            "recall_micro": 0.9505343511450381,
            "f1_micro": 0.9505343511450381,
            "accuracy": 0.9505343511450381,
            "hamming_loss": 0.04946564885496183,
            "no_defect_precision": 0.9799121155053359,
            "no_defect_recall": 0.9231224127735068,
            "no_defect_f1": 0.9506699147381242,
            "no_defect_tp": 1561,
            "no_defect_fp": 32,
            "no_defect_tn": 1552,
            "no_defect_fn": 130,
            "no_defect_support": 1691,
            "defect_precision": 0.9227110582639715,
            "defect_recall": 0.9797979797979798,
            "defect_f1": 0.9503980404164115,
            "defect_tp": 1552,
            "defect_fp": 130,
            "defect_tn": 1561,
            "defect_fn": 32,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604731619978366,
            "recall_macro": 0.9608781860592919,
            "f1_macro": 0.9605894635269583,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9704819277108434,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9615040286481648,
            "no_defect_tp": 1611,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9504643962848297,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9596748984057518,
            "defect_tp": 1535,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9599275957415228,
            "recall_macro": 0.9604066612308777,
            "f1_macro": 0.9599856590989874,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9738760631834751,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9607431824992508,
            "no_defect_tp": 1603,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9459791282995703,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9592281356987239,
            "defect_tp": 1541,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9536103047760154,
            "recall_macro": 0.9540015023087169,
            "f1_macro": 0.9532785222931124,
            "precision_micro": 0.9532824427480916,
            "recall_micro": 0.9532824427480916,
            "f1_micro": 0.9532824427480916,
            "accuracy": 0.9532824427480916,
            "hamming_loss": 0.0467175572519084,
            "no_defect_precision": 0.976456009913259,
            "no_defect_recall": 0.9319929036073329,
            "no_defect_f1": 0.9537065052950076,
            "no_defect_tp": 1576,
            "no_defect_fp": 38,
            "no_defect_tn": 1546,
            "no_defect_fn": 115,
            "no_defect_support": 1691,
            "defect_precision": 0.9307645996387718,
            "defect_recall": 0.976010101010101,
            "defect_f1": 0.9528505392912172,
            "defect_tp": 1546,
            "defect_fp": 115,
            "defect_tn": 1576,
            "defect_fn": 38,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.961077761662608,
            "recall_macro": 0.961449578577018,
            "f1_macro": 0.9611982209534737,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9699519230769231,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9621460506706409,
            "no_defect_tp": 1614,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.952203600248293,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9602503912363067,
            "defect_tp": 1534,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9639309639864047,
            "recall_macro": 0.9639309639864047,
            "f1_macro": 0.9639309639864047,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9651094027202839,
            "no_defect_recall": 0.9651094027202839,
            "no_defect_f1": 0.9651094027202839,
            "no_defect_tp": 1632,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 59,
            "no_defect_support": 1691,
            "defect_precision": 0.9627525252525253,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9627525252525253,
            "defect_tp": 1525,
            "defect_fp": 59,
            "defect_tn": 1632,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9625421743275269,
            "recall_macro": 0.9622727870066723,
            "f1_macro": 0.9623922567213368,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.960093896713615,
            "no_defect_recall": 0.9674748669426375,
            "no_defect_f1": 0.9637702503681885,
            "no_defect_tp": 1636,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 55,
            "no_defect_support": 1691,
            "defect_precision": 0.9649904519414386,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9610142630744849,
            "defect_tp": 1516,
            "defect_fp": 55,
            "defect_tn": 1636,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620523300300469,
            "recall_macro": 0.9621568658196393,
            "f1_macro": 0.9621013596848804,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9649851632047478,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9632701421800948,
            "no_defect_tp": 1626,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9591194968553459,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9609325771896661,
            "defect_tp": 1525,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.964497135285445,
            "recall_macro": 0.9646022241934424,
            "f1_macro": 0.9645464332535978,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9673590504451038,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.9656398104265402,
            "no_defect_tp": 1630,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9616352201257862,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9634530560806553,
            "defect_tp": 1529,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635436452287252,
            "recall_macro": 0.9637551221857845,
            "f1_macro": 0.9636341631807811,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.968414779499404,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.964677945978035,
            "no_defect_tp": 1625,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9586725109580463,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9625903803835272,
            "defect_tp": 1531,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 53,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9679544166043256,
            "recall_macro": 0.967940288493794,
            "f1_macro": 0.967946540666883,
            "precision_micro": 0.967948717948718,
            "recall_micro": 0.967948717948718,
            "f1_micro": 0.967948717948718,
            "accuracy": 0.967948717948718,
            "hamming_loss": 0.03205128205128205,
            "no_defect_precision": 0.9673321234119783,
            "no_defect_recall": 0.9690909090909091,
            "no_defect_f1": 0.9682107175295186,
            "no_defect_tp": 1599,
            "no_defect_fp": 54,
            "no_defect_tn": 1572,
            "no_defect_fn": 51,
            "no_defect_support": 1650,
            "defect_precision": 0.9685767097966729,
            "defect_recall": 0.966789667896679,
            "defect_f1": 0.9676823638042474,
            "defect_tp": 1572,
            "defect_fp": 51,
            "defect_tn": 1599,
            "defect_fn": 54,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.01_s140_20251207_190419",
    "lr": 0.01,
    "weight_decay": 0.01,
    "seed": 140,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9648540255753512,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.01_s140_20251207_190419",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s140_20251207_190419",
      "timestamp": "2025-12-07T19:06:14.084535",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 15,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.01_s140",
          "seed": 140,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s140_20251207_190419"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9647848083880652,
        "recall_macro": 0.9649378542969613,
        "f1_macro": 0.9648540255753512,
        "precision_micro": 0.9648854961832061,
        "recall_micro": 0.9648854961832061,
        "f1_micro": 0.9648854961832061,
        "accuracy": 0.9648854961832061,
        "hamming_loss": 0.035114503816793895,
        "no_defect_precision": 0.9684898929845422,
        "no_defect_recall": 0.9633353045535187,
        "no_defect_f1": 0.9659057219092796,
        "no_defect_tp": 1629,
        "no_defect_fp": 53,
        "no_defect_tn": 1531,
        "no_defect_fn": 62,
        "no_defect_support": 1691,
        "defect_precision": 0.9610797237915882,
        "defect_recall": 0.9665404040404041,
        "defect_f1": 0.9638023292414227,
        "defect_tp": 1531,
        "defect_fp": 62,
        "defect_tn": 1629,
        "defect_fn": 53,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9685797762911235,
        "recall_macro": 0.9685418763278542,
        "f1_macro": 0.9685564029795322,
        "precision_micro": 0.9685592185592186,
        "recall_micro": 0.9685592185592186,
        "f1_micro": 0.9685592185592186,
        "accuracy": 0.9685592185592186,
        "hamming_loss": 0.03144078144078144,
        "no_defect_precision": 0.9668074834037417,
        "no_defect_recall": 0.9709090909090909,
        "no_defect_f1": 0.9688539461747808,
        "no_defect_tp": 1602,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 48,
        "no_defect_support": 1650,
        "defect_precision": 0.9703520691785052,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.9682588597842835,
        "defect_tp": 1571,
        "defect_fp": 48,
        "defect_tn": 1602,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.3878542544577411,
          0.21994922462866395,
          0.18788285098315283,
          0.18180656794723607,
          0.1782181874915147,
          0.18691132177119474,
          0.1771972478371285,
          0.17821185032069434,
          0.17690531800356868,
          0.17242687554040215,
          0.1626972791633596,
          0.16898406334377233,
          0.16626969386655915,
          0.16595929156536837,
          0.16431711649982
        ],
        "val_loss": [
          0.28871659046182263,
          0.15413992278850996,
          0.11751511277487645,
          0.11030659935652064,
          0.10273156852389757,
          0.10191042248446208,
          0.10460033951900326,
          0.1209542965516448,
          0.10351415515805666,
          0.10353460510332997,
          0.0988345082777624,
          0.09501062179557405,
          0.10125135286496235,
          0.09535070827517372,
          0.09546390379993962
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9186667071282888,
            "recall_macro": 0.9172055788517941,
            "f1_macro": 0.9176561066272452,
            "precision_micro": 0.9178625954198474,
            "recall_micro": 0.9178625954198474,
            "f1_micro": 0.9178625954198474,
            "accuracy": 0.9178625954198474,
            "hamming_loss": 0.08213740458015267,
            "no_defect_precision": 0.9067505720823799,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.9217795870892701,
            "no_defect_tp": 1585,
            "no_defect_fp": 163,
            "no_defect_tn": 1421,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.9305828421741977,
            "defect_recall": 0.8970959595959596,
            "defect_f1": 0.9135326261652202,
            "defect_tp": 1421,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 163,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9480420234350785,
            "recall_macro": 0.945758777903219,
            "f1_macro": 0.9463993503484358,
            "precision_micro": 0.9465648854961832,
            "recall_micro": 0.9465648854961832,
            "f1_micro": 0.9465648854961832,
            "accuracy": 0.9465648854961832,
            "hamming_loss": 0.05343511450381679,
            "no_defect_precision": 0.9292185730464326,
            "no_defect_recall": 0.9704316972205795,
            "no_defect_f1": 0.9493780734741105,
            "no_defect_tp": 1641,
            "no_defect_fp": 125,
            "no_defect_tn": 1459,
            "no_defect_fn": 50,
            "no_defect_support": 1691,
            "defect_precision": 0.9668654738237243,
            "defect_recall": 0.9210858585858586,
            "defect_f1": 0.9434206272227611,
            "defect_tp": 1459,
            "defect_fp": 50,
            "defect_tn": 1641,
            "defect_fn": 125,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9611080011942081,
            "recall_macro": 0.9612897902741191,
            "f1_macro": 0.9611880248318256,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9654761904761905,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9623257193711064,
            "no_defect_tp": 1622,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9567398119122257,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9600503302925448,
            "defect_tp": 1526,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9574484670274013,
            "recall_macro": 0.9579013822434874,
            "f1_macro": 0.9575389462233983,
            "precision_micro": 0.9575572519083969,
            "recall_micro": 0.9575572519083969,
            "f1_micro": 0.9575572519083969,
            "accuracy": 0.9575572519083969,
            "hamming_loss": 0.042442748091603054,
            "no_defect_precision": 0.9697336561743342,
            "no_defect_recall": 0.9473684210526315,
            "no_defect_f1": 0.9584205803170804,
            "no_defect_tp": 1602,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 89,
            "no_defect_support": 1691,
            "defect_precision": 0.9451632778804683,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9566573121297163,
            "defect_tp": 1534,
            "defect_fp": 89,
            "defect_tn": 1602,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9628885934866038,
            "recall_macro": 0.9625484964966041,
            "f1_macro": 0.9626954718063477,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9595782073813708,
            "no_defect_recall": 0.9686575990538143,
            "no_defect_f1": 0.9640965273690406,
            "no_defect_tp": 1638,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 53,
            "no_defect_support": 1691,
            "defect_precision": 0.9661989795918368,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9612944162436549,
            "defect_tp": 1515,
            "defect_fp": 53,
            "defect_tn": 1638,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.959572563500056,
            "recall_macro": 0.9600111105137716,
            "f1_macro": 0.9596757042340232,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9709969788519638,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9605499103407054,
            "no_defect_tp": 1607,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9481481481481482,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9588014981273408,
            "defect_tp": 1536,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9611637957397803,
            "recall_macro": 0.9616493139556416,
            "f1_macro": 0.961208353832415,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.975669099756691,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9619190404797601,
            "no_defect_tp": 1604,
            "no_defect_fp": 40,
            "no_defect_tn": 1544,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9466584917228694,
            "defect_recall": 0.9747474747474747,
            "defect_f1": 0.96049766718507,
            "defect_tp": 1544,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 40,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9538499022068201,
            "recall_macro": 0.9541213435358911,
            "f1_macro": 0.9532810314600961,
            "precision_micro": 0.9532824427480916,
            "recall_micro": 0.9532824427480916,
            "f1_micro": 0.9532824427480916,
            "accuracy": 0.9532824427480916,
            "hamming_loss": 0.0467175572519084,
            "no_defect_precision": 0.9800249687890137,
            "no_defect_recall": 0.9284447072738025,
            "no_defect_f1": 0.9535378074703917,
            "no_defect_tp": 1570,
            "no_defect_fp": 32,
            "no_defect_tn": 1552,
            "no_defect_fn": 121,
            "no_defect_support": 1691,
            "defect_precision": 0.9276748356246264,
            "defect_recall": 0.9797979797979798,
            "defect_f1": 0.9530242554498004,
            "defect_tp": 1552,
            "defect_fp": 121,
            "defect_tn": 1570,
            "defect_fn": 32,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9596153530579761,
            "recall_macro": 0.9600910046652211,
            "f1_macro": 0.9596797360407758,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9732847601700061,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9604553624925105,
            "no_defect_tp": 1603,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9459459459459459,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.958904109589041,
            "defect_tp": 1540,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629214773967487,
            "recall_macro": 0.9633435179709573,
            "f1_macro": 0.9630345622994606,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9734620024125452,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9638698118841446,
            "no_defect_tp": 1614,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9523809523809523,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9621993127147767,
            "defect_tp": 1540,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638259377389813,
            "recall_macro": 0.9641906199786152,
            "f1_macro": 0.9639474118262565,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9723723723723724,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9648390941597139,
            "no_defect_tp": 1619,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9552795031055901,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.963055729492799,
            "defect_tp": 1538,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629513933208083,
            "recall_macro": 0.963103835516609,
            "f1_macro": 0.9630203225618912,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9667063020214031,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9641268900088942,
            "no_defect_tp": 1626,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9591964846202135,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9619137551148883,
            "defect_tp": 1528,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9616999118980853,
            "recall_macro": 0.9621208387840559,
            "f1_macro": 0.9618125643589468,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9722557297949337,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9626754255001493,
            "no_defect_tp": 1612,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9511440940012369,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9609497032177444,
            "defect_tp": 1538,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.964473968040473,
            "recall_macro": 0.9646421712691672,
            "f1_macro": 0.9645490535091865,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9684711481261155,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9655990510083037,
            "no_defect_tp": 1628,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.9604767879548306,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9634990560100692,
            "defect_tp": 1531,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9647848083880652,
            "recall_macro": 0.9649378542969613,
            "f1_macro": 0.9648540255753512,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9684898929845422,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9659057219092796,
            "no_defect_tp": 1629,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9610797237915882,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9638023292414227,
            "defect_tp": 1531,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 53,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9685797762911235,
            "recall_macro": 0.9685418763278542,
            "f1_macro": 0.9685564029795322,
            "precision_micro": 0.9685592185592186,
            "recall_micro": 0.9685592185592186,
            "f1_micro": 0.9685592185592186,
            "accuracy": 0.9685592185592186,
            "hamming_loss": 0.03144078144078144,
            "no_defect_precision": 0.9668074834037417,
            "no_defect_recall": 0.9709090909090909,
            "no_defect_f1": 0.9688539461747808,
            "no_defect_tp": 1602,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 48,
            "no_defect_support": 1650,
            "defect_precision": 0.9703520691785052,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.9682588597842835,
            "defect_tp": 1571,
            "defect_fp": 48,
            "defect_tn": 1602,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.01_s150_20251207_152505",
    "lr": 0.01,
    "weight_decay": 0.01,
    "seed": 150,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9651590022381853,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.01_s150_20251207_152505",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s150_20251207_152505",
      "timestamp": "2025-12-07T15:26:59.807716",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 5,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.01,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.01,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.01_s150",
          "seed": 150,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.01_s150_20251207_152505"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.965096016326433,
        "recall_macro": 0.9652335373247556,
        "f1_macro": 0.9651590022381853,
        "precision_micro": 0.9651908396946565,
        "recall_micro": 0.9651908396946565,
        "f1_micro": 0.9651908396946565,
        "accuracy": 0.9651908396946565,
        "hamming_loss": 0.03480916030534351,
        "no_defect_precision": 0.9685086155674391,
        "no_defect_recall": 0.9639266706091071,
        "no_defect_f1": 0.966212211025489,
        "no_defect_tp": 1630,
        "no_defect_fp": 53,
        "no_defect_tn": 1531,
        "no_defect_fn": 61,
        "no_defect_support": 1691,
        "defect_precision": 0.9616834170854272,
        "defect_recall": 0.9665404040404041,
        "defect_f1": 0.9641057934508817,
        "defect_tp": 1531,
        "defect_fp": 61,
        "defect_tn": 1630,
        "defect_fn": 53,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9679691935275245,
        "recall_macro": 0.9679313429497931,
        "f1_macro": 0.9679458476975813,
        "precision_micro": 0.967948717948718,
        "recall_micro": 0.967948717948718,
        "f1_micro": 0.967948717948718,
        "accuracy": 0.967948717948718,
        "hamming_loss": 0.03205128205128205,
        "no_defect_precision": 0.9662039831019915,
        "no_defect_recall": 0.9703030303030303,
        "no_defect_f1": 0.9682491684306017,
        "no_defect_tp": 1601,
        "no_defect_fp": 56,
        "no_defect_tn": 1570,
        "no_defect_fn": 49,
        "no_defect_support": 1650,
        "defect_precision": 0.9697344039530574,
        "defect_recall": 0.965559655596556,
        "defect_f1": 0.9676425269645609,
        "defect_tp": 1570,
        "defect_fp": 49,
        "defect_tn": 1601,
        "defect_fn": 56,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.3903066012151072,
          0.22039218000662378,
          0.18201641420440196,
          0.18107400778447236,
          0.18743049641720422,
          0.1844328357273066,
          0.1875201842774906,
          0.18054285938520312,
          0.17649087654309792,
          0.17051202983100544,
          0.16585223945676034,
          0.17445718224265586,
          0.17160628389987986,
          0.1680564644072345,
          0.1633755316856516
        ],
        "val_loss": [
          0.28970599031219113,
          0.15446205279574945,
          0.11833036526177938,
          0.10660833775853881,
          0.10532233606164272,
          0.10678828636614177,
          0.10862455029900257,
          0.09887530883917442,
          0.09962219576566265,
          0.10000427396824726,
          0.09815987632968105,
          0.09898673943602122,
          0.09897072251456288,
          0.09791556025783603,
          0.09832241507963492
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9180676911728363,
            "recall_macro": 0.9181004680154592,
            "f1_macro": 0.9180837362104045,
            "precision_micro": 0.9181679389312977,
            "recall_micro": 0.9181679389312977,
            "f1_micro": 0.9181679389312977,
            "accuracy": 0.9181679389312977,
            "hamming_loss": 0.08183206106870229,
            "no_defect_precision": 0.9212551805802249,
            "no_defect_recall": 0.9201655824955648,
            "no_defect_f1": 0.9207100591715977,
            "no_defect_tp": 1556,
            "no_defect_fp": 133,
            "no_defect_tn": 1451,
            "no_defect_fn": 135,
            "no_defect_support": 1691,
            "defect_precision": 0.9148802017654477,
            "defect_recall": 0.9160353535353535,
            "defect_f1": 0.9154574132492114,
            "defect_tp": 1451,
            "defect_fp": 135,
            "defect_tn": 1556,
            "defect_fn": 133,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9534737871508143,
            "recall_macro": 0.9539176881171263,
            "f1_macro": 0.9535671751828958,
            "precision_micro": 0.953587786259542,
            "recall_micro": 0.953587786259542,
            "f1_micro": 0.953587786259542,
            "accuracy": 0.953587786259542,
            "hamming_loss": 0.046412213740458015,
            "no_defect_precision": 0.9655172413793104,
            "no_defect_recall": 0.9438202247191011,
            "no_defect_f1": 0.9545454545454546,
            "no_defect_tp": 1596,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 95,
            "no_defect_support": 1691,
            "defect_precision": 0.9414303329223181,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9525888958203369,
            "defect_tp": 1527,
            "defect_fp": 95,
            "defect_tn": 1596,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9592747051798776,
            "recall_macro": 0.9594557714937668,
            "f1_macro": 0.9593543882097072,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9636904761904762,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9605458320973005,
            "no_defect_tp": 1619,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.954858934169279,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9581629443221139,
            "defect_tp": 1523,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610818680285469,
            "recall_macro": 0.9613696844255686,
            "f1_macro": 0.9611933552910319,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9677033492822966,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9622360987213797,
            "no_defect_tp": 1618,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9544603867747973,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9601506118606841,
            "defect_tp": 1530,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.965096016326433,
            "recall_macro": 0.9652335373247556,
            "f1_macro": 0.9651590022381853,
            "precision_micro": 0.9651908396946565,
            "recall_micro": 0.9651908396946565,
            "f1_micro": 0.9651908396946565,
            "accuracy": 0.9651908396946565,
            "hamming_loss": 0.03480916030534351,
            "no_defect_precision": 0.9685086155674391,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.966212211025489,
            "no_defect_tp": 1630,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9616834170854272,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9641057934508817,
            "defect_tp": 1531,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9611975087640785,
            "recall_macro": 0.9616892610313663,
            "f1_macro": 0.9612100324840622,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9768292682926829,
            "no_defect_recall": 0.9473684210526315,
            "no_defect_f1": 0.9618733113179225,
            "no_defect_tp": 1602,
            "no_defect_fp": 38,
            "no_defect_tn": 1546,
            "no_defect_fn": 89,
            "no_defect_support": 1691,
            "defect_precision": 0.945565749235474,
            "defect_recall": 0.976010101010101,
            "defect_f1": 0.9605467536502019,
            "defect_tp": 1546,
            "defect_fp": 89,
            "defect_tn": 1602,
            "defect_fn": 38,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598914066707545,
            "recall_macro": 0.9603467406172905,
            "f1_macro": 0.9599827478796057,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9721549636803875,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9608136404427161,
            "no_defect_tp": 1606,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9476278496611213,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9591518553164952,
            "defect_tp": 1538,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9638257050082522,
            "recall_macro": 0.9641706464407529,
            "f1_macro": 0.9639463085945955,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9718056388722256,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9648600357355569,
            "no_defect_tp": 1620,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9558457711442786,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9630325814536341,
            "defect_tp": 1537,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9637401643330497,
            "recall_macro": 0.9635154397314363,
            "f1_macro": 0.9636168896051149,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9618096357226792,
            "no_defect_recall": 0.9680662329982259,
            "no_defect_f1": 0.9649277925139994,
            "no_defect_tp": 1637,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 54,
            "no_defect_support": 1691,
            "defect_precision": 0.9656706929434202,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9623059866962306,
            "defect_tp": 1519,
            "defect_fp": 54,
            "defect_tn": 1637,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962657183346189,
            "recall_macro": 0.9621928928552228,
            "f1_macro": 0.9623852894897034,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9579439252336449,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.963855421686747,
            "no_defect_tp": 1640,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.9673704414587332,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.9609151572926596,
            "defect_tp": 1512,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9639145662498311,
            "recall_macro": 0.963950937524267,
            "f1_macro": 0.9639323913165214,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9656601539372409,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9650887573964497,
            "no_defect_tp": 1631,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9621689785624212,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9627760252365931,
            "defect_tp": 1526,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9633714355424532,
            "recall_macro": 0.9622888405043935,
            "f1_macro": 0.9626708238410437,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9526832083092902,
            "no_defect_recall": 0.9763453577764636,
            "no_defect_f1": 0.9643691588785047,
            "no_defect_tp": 1651,
            "no_defect_fp": 82,
            "no_defect_tn": 1502,
            "no_defect_fn": 40,
            "no_defect_support": 1691,
            "defect_precision": 0.9740596627756161,
            "defect_recall": 0.9482323232323232,
            "defect_f1": 0.9609724888035829,
            "defect_tp": 1502,
            "defect_fp": 40,
            "defect_tn": 1651,
            "defect_fn": 82,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9641852328492664,
            "recall_macro": 0.9643065411656482,
            "f1_macro": 0.964241469816273,
            "precision_micro": 0.9642748091603054,
            "recall_micro": 0.9642748091603054,
            "f1_micro": 0.9642748091603054,
            "accuracy": 0.9642748091603054,
            "hamming_loss": 0.03572519083969466,
            "no_defect_precision": 0.9673396674584323,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9653333333333334,
            "no_defect_tp": 1629,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9610307982401005,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9631496062992126,
            "defect_tp": 1529,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9651908069153505,
            "recall_macro": 0.9651136960975815,
            "f1_macro": 0.9651508068845989,
            "precision_micro": 0.9651908396946565,
            "recall_micro": 0.9651908396946565,
            "f1_micro": 0.9651908396946565,
            "accuracy": 0.9651908396946565,
            "hamming_loss": 0.03480916030534351,
            "no_defect_precision": 0.9651917404129794,
            "no_defect_recall": 0.9674748669426375,
            "no_defect_f1": 0.9663319551092735,
            "no_defect_tp": 1636,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 55,
            "no_defect_support": 1691,
            "defect_precision": 0.9651898734177216,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9639696586599241,
            "defect_tp": 1525,
            "defect_fp": 55,
            "defect_tn": 1636,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9651371495852176,
            "recall_macro": 0.9651736167111684,
            "f1_macro": 0.9651550221193512,
            "precision_micro": 0.9651908396946565,
            "recall_micro": 0.9651908396946565,
            "f1_micro": 0.9651908396946565,
            "accuracy": 0.9651908396946565,
            "hamming_loss": 0.03480916030534351,
            "no_defect_precision": 0.9668442865600947,
            "no_defect_recall": 0.9657007687758723,
            "no_defect_f1": 0.9662721893491124,
            "no_defect_tp": 1633,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 58,
            "no_defect_support": 1691,
            "defect_precision": 0.9634300126103404,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9640378548895899,
            "defect_tp": 1528,
            "defect_fp": 58,
            "defect_tn": 1633,
            "defect_fn": 56,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9679691935275245,
            "recall_macro": 0.9679313429497931,
            "f1_macro": 0.9679458476975813,
            "precision_micro": 0.967948717948718,
            "recall_micro": 0.967948717948718,
            "f1_micro": 0.967948717948718,
            "accuracy": 0.967948717948718,
            "hamming_loss": 0.03205128205128205,
            "no_defect_precision": 0.9662039831019915,
            "no_defect_recall": 0.9703030303030303,
            "no_defect_f1": 0.9682491684306017,
            "no_defect_tp": 1601,
            "no_defect_fp": 56,
            "no_defect_tn": 1570,
            "no_defect_fn": 49,
            "no_defect_support": 1650,
            "defect_precision": 0.9697344039530574,
            "defect_recall": 0.965559655596556,
            "defect_f1": 0.9676425269645609,
            "defect_tp": 1570,
            "defect_fp": 49,
            "defect_tn": 1601,
            "defect_fn": 56,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.1_s10_20251207_165616",
    "lr": 0.01,
    "weight_decay": 0.1,
    "seed": 10,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9630242561439546,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.1_s10_20251207_165616",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s10_20251207_165616",
      "timestamp": "2025-12-07T16:58:16.152023",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 10,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.1_s10",
          "seed": 10,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s10_20251207_165616"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9629252545967721,
        "recall_macro": 0.9631637561301961,
        "f1_macro": 0.9630242561439546,
        "precision_micro": 0.9630534351145038,
        "recall_micro": 0.9630534351145038,
        "f1_micro": 0.9630534351145038,
        "accuracy": 0.9630534351145038,
        "hamming_loss": 0.036946564885496185,
        "no_defect_precision": 0.9683770883054893,
        "no_defect_recall": 0.9597871082199881,
        "no_defect_f1": 0.9640629640629641,
        "no_defect_tp": 1623,
        "no_defect_fp": 53,
        "no_defect_tn": 1531,
        "no_defect_fn": 68,
        "no_defect_support": 1691,
        "defect_precision": 0.957473420888055,
        "defect_recall": 0.9665404040404041,
        "defect_f1": 0.961985548224945,
        "defect_tp": 1531,
        "defect_fp": 68,
        "defect_tn": 1623,
        "defect_fn": 53,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9667683125723435,
        "recall_macro": 0.9667013306496701,
        "f1_macro": 0.9667239185045202,
        "precision_micro": 0.9667277167277167,
        "recall_micro": 0.9667277167277167,
        "f1_micro": 0.9667277167277167,
        "accuracy": 0.9667277167277167,
        "hamming_loss": 0.03327228327228327,
        "no_defect_precision": 0.9638771824202288,
        "no_defect_recall": 0.9703030303030303,
        "no_defect_f1": 0.9670794321957112,
        "no_defect_tp": 1601,
        "no_defect_fp": 60,
        "no_defect_tn": 1566,
        "no_defect_fn": 49,
        "no_defect_support": 1650,
        "defect_precision": 0.9696594427244583,
        "defect_recall": 0.9630996309963099,
        "defect_f1": 0.9663684048133292,
        "defect_tp": 1566,
        "defect_fp": 49,
        "defect_tn": 1601,
        "defect_fn": 60,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.39219450401960554,
          0.22315924359041278,
          0.1926496123357298,
          0.19044666991385956,
          0.18272450913881658,
          0.1816026525080952,
          0.18755380784367917,
          0.18531127440817186,
          0.17974433037900525,
          0.17283023650676138,
          0.1722738725059202,
          0.1716898844331877,
          0.16510940371198135,
          0.1651274800518816,
          0.17099387307795522
        ],
        "val_loss": [
          0.2930451405162995,
          0.1586527992039919,
          0.15309226183364025,
          0.11977530578867747,
          0.12266838493255469,
          0.1242962761137348,
          0.12215807417837474,
          0.12091894304523101,
          0.1199675526899787,
          0.11362305591599299,
          0.11868336352591331,
          0.12000566914391059,
          0.11477095862993827,
          0.11613332336911789,
          0.11536749989654009
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9140400600878931,
            "recall_macro": 0.9142765621919968,
            "f1_macro": 0.9141336269334571,
            "precision_micro": 0.9141984732824427,
            "recall_micro": 0.9141984732824427,
            "f1_micro": 0.9141984732824427,
            "accuracy": 0.9141984732824427,
            "hamming_loss": 0.08580152671755725,
            "no_defect_precision": 0.921146953405018,
            "no_defect_recall": 0.911886457717327,
            "no_defect_f1": 0.9164933135215453,
            "no_defect_tp": 1542,
            "no_defect_fp": 132,
            "no_defect_tn": 1452,
            "no_defect_fn": 149,
            "no_defect_support": 1691,
            "defect_precision": 0.9069331667707683,
            "defect_recall": 0.9166666666666666,
            "defect_f1": 0.911773940345369,
            "defect_tp": 1452,
            "defect_fp": 149,
            "defect_tn": 1542,
            "defect_fn": 132,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9526861397608287,
            "recall_macro": 0.952551274125047,
            "f1_macro": 0.9526143395799481,
            "precision_micro": 0.9526717557251908,
            "recall_micro": 0.9526717557251908,
            "f1_micro": 0.9526717557251908,
            "accuracy": 0.9526717557251908,
            "hamming_loss": 0.04732824427480916,
            "no_defect_precision": 0.9522968197879859,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9542637946296842,
            "no_defect_tp": 1617,
            "no_defect_fp": 81,
            "no_defect_tn": 1503,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9530754597336716,
            "defect_recall": 0.9488636363636364,
            "defect_f1": 0.950964884530212,
            "defect_tp": 1503,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 81,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9474141742445064,
            "recall_macro": 0.9473206338966245,
            "f1_macro": 0.9462594167226075,
            "precision_micro": 0.9462595419847328,
            "recall_micro": 0.9462595419847328,
            "f1_micro": 0.9462595419847328,
            "accuracy": 0.9462595419847328,
            "hamming_loss": 0.053740458015267174,
            "no_defect_precision": 0.9797340088663711,
            "no_defect_recall": 0.914843287995269,
            "no_defect_f1": 0.946177370030581,
            "no_defect_tp": 1547,
            "no_defect_fp": 32,
            "no_defect_tn": 1552,
            "no_defect_fn": 144,
            "no_defect_support": 1691,
            "defect_precision": 0.9150943396226415,
            "defect_recall": 0.9797979797979798,
            "defect_f1": 0.9463414634146341,
            "defect_tp": 1552,
            "defect_fp": 144,
            "defect_tn": 1547,
            "defect_fn": 32,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9590850363710997,
            "recall_macro": 0.9584649346809311,
            "f1_macro": 0.9587095006392148,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.9528521536670547,
            "no_defect_recall": 0.9680662329982259,
            "no_defect_f1": 0.9603989439718392,
            "no_defect_tp": 1637,
            "no_defect_fp": 81,
            "no_defect_tn": 1503,
            "no_defect_fn": 54,
            "no_defect_support": 1691,
            "defect_precision": 0.9653179190751445,
            "defect_recall": 0.9488636363636364,
            "defect_f1": 0.9570200573065902,
            "defect_tp": 1503,
            "defect_fp": 54,
            "defect_tn": 1637,
            "defect_fn": 81,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.959776864357017,
            "recall_macro": 0.959531745605075,
            "f1_macro": 0.9596413711515064,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9577216676453317,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9611078373600471,
            "no_defect_tp": 1631,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9618320610687023,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.9581749049429658,
            "defect_tp": 1512,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9580260563427566,
            "recall_macro": 0.9584128541476264,
            "f1_macro": 0.9581441966591666,
            "precision_micro": 0.9581679389312977,
            "recall_micro": 0.9581679389312977,
            "f1_micro": 0.9581679389312977,
            "accuracy": 0.9581679389312977,
            "hamming_loss": 0.04183206106870229,
            "no_defect_precision": 0.9675090252707581,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9591410677005666,
            "no_defect_tp": 1608,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9485430874147551,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9571473256177666,
            "defect_tp": 1530,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9580313827155519,
            "recall_macro": 0.9582930129204523,
            "f1_macro": 0.9581363234515432,
            "precision_micro": 0.9581679389312977,
            "recall_micro": 0.9581679389312977,
            "f1_micro": 0.9581679389312977,
            "accuracy": 0.9581679389312977,
            "hamming_loss": 0.04183206106870229,
            "no_defect_precision": 0.96415770609319,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9592867756315008,
            "no_defect_tp": 1614,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9519050593379138,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9569858712715855,
            "defect_tp": 1524,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9608299274023477,
            "recall_macro": 0.9609341866327378,
            "f1_macro": 0.9608788229005217,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9637982195845697,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9620853080568721,
            "no_defect_tp": 1624,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9578616352201258,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9596723377441714,
            "defect_tp": 1523,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.959870130645496,
            "recall_macro": 0.9601070581629423,
            "f1_macro": 0.9599684095442813,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9653937947494033,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.961092961092961,
            "no_defect_tp": 1618,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9543464665415885,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9588438579956017,
            "defect_tp": 1526,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629252545967721,
            "recall_macro": 0.9631637561301961,
            "f1_macro": 0.9630242561439546,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9683770883054893,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9640629640629641,
            "no_defect_tp": 1623,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.957473420888055,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.961985548224945,
            "defect_tp": 1531,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610770624321949,
            "recall_macro": 0.9614096315012932,
            "f1_macro": 0.9611958461992454,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9688249400479616,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9621911283119976,
            "no_defect_tp": 1616,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9533291848164281,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9602005640864932,
            "defect_tp": 1532,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9619981170179353,
            "recall_macro": 0.9623965482739877,
            "f1_macro": 0.9621164630041747,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9717037928958459,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9630071599045346,
            "no_defect_tp": 1614,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9522924411400248,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9612257661038149,
            "defect_tp": 1537,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9617829876990275,
            "recall_macro": 0.9618012621782581,
            "f1_macro": 0.9617920349914493,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9633136094674556,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9630286897367643,
            "no_defect_tp": 1628,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.9602523659305994,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9605553802461344,
            "defect_tp": 1522,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9619941173266517,
            "recall_macro": 0.9623166541225382,
            "f1_macro": 0.962111882370503,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.969442780107849,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9630952380952381,
            "no_defect_tp": 1618,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9545454545454546,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.961128526645768,
            "defect_tp": 1533,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9601869100983549,
            "recall_macro": 0.9603827676528741,
            "f1_macro": 0.9602719145997798,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9648600357355569,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9614243323442137,
            "no_defect_tp": 1620,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9555137844611529,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9591194968553459,
            "defect_tp": 1525,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 59,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9667683125723435,
            "recall_macro": 0.9667013306496701,
            "f1_macro": 0.9667239185045202,
            "precision_micro": 0.9667277167277167,
            "recall_micro": 0.9667277167277167,
            "f1_micro": 0.9667277167277167,
            "accuracy": 0.9667277167277167,
            "hamming_loss": 0.03327228327228327,
            "no_defect_precision": 0.9638771824202288,
            "no_defect_recall": 0.9703030303030303,
            "no_defect_f1": 0.9670794321957112,
            "no_defect_tp": 1601,
            "no_defect_fp": 60,
            "no_defect_tn": 1566,
            "no_defect_fn": 49,
            "no_defect_support": 1650,
            "defect_precision": 0.9696594427244583,
            "defect_recall": 0.9630996309963099,
            "defect_f1": 0.9663684048133292,
            "defect_tp": 1566,
            "defect_fp": 49,
            "defect_tn": 1601,
            "defect_fn": 60,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.1_s20_20251207_192605",
    "lr": 0.01,
    "weight_decay": 0.1,
    "seed": 20,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.964539417531697,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.1_s20_20251207_192605",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s20_20251207_192605",
      "timestamp": "2025-12-07T19:28:01.612671",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 4,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.1_s20",
          "seed": 20,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s20_20251207_192605"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9645793659684104,
        "recall_macro": 0.9645023565041306,
        "f1_macro": 0.964539417531697,
        "precision_micro": 0.9645801526717557,
        "recall_micro": 0.9645801526717557,
        "f1_micro": 0.9645801526717557,
        "accuracy": 0.9645801526717557,
        "hamming_loss": 0.035419847328244276,
        "no_defect_precision": 0.9646017699115044,
        "no_defect_recall": 0.9668835008870491,
        "no_defect_f1": 0.9657412876550502,
        "no_defect_tp": 1635,
        "no_defect_fp": 60,
        "no_defect_tn": 1524,
        "no_defect_fn": 56,
        "no_defect_support": 1691,
        "defect_precision": 0.9645569620253165,
        "defect_recall": 0.9621212121212122,
        "defect_f1": 0.9633375474083439,
        "defect_tp": 1524,
        "defect_fp": 56,
        "defect_tn": 1635,
        "defect_fn": 60,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9664252316940802,
        "recall_macro": 0.9664161914346416,
        "f1_macro": 0.9664203513022411,
        "precision_micro": 0.9664224664224664,
        "recall_micro": 0.9664224664224664,
        "f1_micro": 0.9664224664224664,
        "accuracy": 0.9664224664224664,
        "hamming_loss": 0.033577533577533576,
        "no_defect_precision": 0.9661016949152542,
        "no_defect_recall": 0.9672727272727273,
        "no_defect_f1": 0.966686856450636,
        "no_defect_tp": 1596,
        "no_defect_fp": 56,
        "no_defect_tn": 1570,
        "no_defect_fn": 54,
        "no_defect_support": 1650,
        "defect_precision": 0.9667487684729064,
        "defect_recall": 0.965559655596556,
        "defect_f1": 0.9661538461538461,
        "defect_tp": 1570,
        "defect_fp": 54,
        "defect_tn": 1596,
        "defect_fn": 56,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.3933924654163576,
          0.21921685101098096,
          0.1927733235840518,
          0.18487871076646709,
          0.18150621655720547,
          0.1829143237151112,
          0.18068808008562073,
          0.18831099610323687,
          0.17408747346019646,
          0.17690651776526264,
          0.1715554402338411,
          0.1718261555834794,
          0.16975294396468285,
          0.1708443832883775,
          0.17158373451507242
        ],
        "val_loss": [
          0.287839925633027,
          0.15608230634377554,
          0.13073214960212892,
          0.1159245793062907,
          0.12817296715309986,
          0.11896525065486248,
          0.11814366682217671,
          0.12996140100921577,
          0.1287804632089459,
          0.11794906037931259,
          0.11346898722247435,
          0.1202206456890473,
          0.11797406051594478,
          0.11752888438506769,
          0.11854769934255344
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.918525351276055,
            "recall_macro": 0.9177209707960743,
            "f1_macro": 0.9180116235361286,
            "precision_micro": 0.9181679389312977,
            "recall_micro": 0.9181679389312977,
            "f1_micro": 0.9181679389312977,
            "accuracy": 0.9181679389312977,
            "hamming_loss": 0.08183206106870229,
            "no_defect_precision": 0.9119861030689056,
            "no_defect_recall": 0.9314015375517445,
            "no_defect_f1": 0.9215915740198947,
            "no_defect_tp": 1575,
            "no_defect_fp": 152,
            "no_defect_tn": 1432,
            "no_defect_fn": 116,
            "no_defect_support": 1691,
            "defect_precision": 0.9250645994832042,
            "defect_recall": 0.9040404040404041,
            "defect_f1": 0.9144316730523627,
            "defect_tp": 1432,
            "defect_fp": 116,
            "defect_tn": 1575,
            "defect_fn": 152,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9547998710992379,
            "recall_macro": 0.9541855575267757,
            "f1_macro": 0.9544275229277259,
            "precision_micro": 0.9545038167938932,
            "recall_micro": 0.9545038167938932,
            "f1_micro": 0.9545038167938932,
            "accuracy": 0.9545038167938932,
            "hamming_loss": 0.04549618320610687,
            "no_defect_precision": 0.9487776484284052,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.9562921677911411,
            "no_defect_tp": 1630,
            "no_defect_fp": 88,
            "no_defect_tn": 1496,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9608220937700707,
            "defect_recall": 0.9444444444444444,
            "defect_f1": 0.9525628780643107,
            "defect_tp": 1496,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 88,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9559286330643114,
            "recall_macro": 0.956063443422994,
            "f1_macro": 0.9559903186166552,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9595959595959596,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9573206876111441,
            "no_defect_tp": 1615,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9522613065326633,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9546599496221663,
            "defect_tp": 1516,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9645793659684104,
            "recall_macro": 0.9645023565041306,
            "f1_macro": 0.964539417531697,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9646017699115044,
            "no_defect_recall": 0.9668835008870491,
            "no_defect_f1": 0.9657412876550502,
            "no_defect_tp": 1635,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 56,
            "no_defect_support": 1691,
            "defect_precision": 0.9645569620253165,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9633375474083439,
            "defect_tp": 1524,
            "defect_fp": 56,
            "defect_tn": 1635,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9573754632088363,
            "recall_macro": 0.9578453816700416,
            "f1_macro": 0.9572445377449137,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9766441303011678,
            "no_defect_recall": 0.9396806623299823,
            "no_defect_f1": 0.9578059071729957,
            "no_defect_tp": 1589,
            "no_defect_fp": 38,
            "no_defect_tn": 1546,
            "no_defect_fn": 102,
            "no_defect_support": 1691,
            "defect_precision": 0.9381067961165048,
            "defect_recall": 0.976010101010101,
            "defect_f1": 0.9566831683168316,
            "defect_tp": 1546,
            "defect_fp": 102,
            "defect_tn": 1589,
            "defect_fn": 38,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9581857898711648,
            "recall_macro": 0.9570824671911307,
            "f1_macro": 0.9574680291970803,
            "precision_micro": 0.9575572519083969,
            "recall_micro": 0.9575572519083969,
            "f1_micro": 0.9575572519083969,
            "accuracy": 0.9575572519083969,
            "hamming_loss": 0.042442748091603054,
            "no_defect_precision": 0.947520184544406,
            "no_defect_recall": 0.9716144293317563,
            "no_defect_f1": 0.9594160583941606,
            "no_defect_tp": 1643,
            "no_defect_fp": 91,
            "no_defect_tn": 1493,
            "no_defect_fn": 48,
            "no_defect_support": 1691,
            "defect_precision": 0.9688513951979234,
            "defect_recall": 0.9425505050505051,
            "defect_f1": 0.95552,
            "defect_tp": 1493,
            "defect_fp": 48,
            "defect_tn": 1643,
            "defect_fn": 91,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9609203505912167,
            "recall_macro": 0.9598434821305903,
            "f1_macro": 0.9602230090109483,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9503750721292556,
            "no_defect_recall": 0.97397989355411,
            "no_defect_f1": 0.9620327102803738,
            "no_defect_tp": 1647,
            "no_defect_fp": 86,
            "no_defect_tn": 1498,
            "no_defect_fn": 44,
            "no_defect_support": 1691,
            "defect_precision": 0.9714656290531777,
            "defect_recall": 0.9457070707070707,
            "defect_f1": 0.9584133077415227,
            "defect_tp": 1498,
            "defect_fp": 44,
            "defect_tn": 1647,
            "defect_fn": 86,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.956446013823063,
            "recall_macro": 0.9569183855109342,
            "f1_macro": 0.9563279949651655,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9754299754299754,
            "no_defect_recall": 0.9390892962743939,
            "no_defect_f1": 0.9569147333534197,
            "no_defect_tp": 1588,
            "no_defect_fp": 40,
            "no_defect_tn": 1544,
            "no_defect_fn": 103,
            "no_defect_support": 1691,
            "defect_precision": 0.9374620522161505,
            "defect_recall": 0.9747474747474747,
            "defect_f1": 0.9557412565769112,
            "defect_tp": 1544,
            "defect_fp": 103,
            "defect_tn": 1588,
            "defect_fn": 40,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9573002544206616,
            "recall_macro": 0.9577854610564546,
            "f1_macro": 0.9572423368195984,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9748928352725046,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9578820697954272,
            "no_defect_tp": 1592,
            "no_defect_fp": 41,
            "no_defect_tn": 1543,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.9397076735688186,
            "defect_recall": 0.9741161616161617,
            "defect_f1": 0.9566026038437694,
            "defect_tp": 1543,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 41,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626770652448193,
            "recall_macro": 0.9627482318752278,
            "f1_macro": 0.962711208270711,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.965026674570243,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9638839550029603,
            "no_defect_tp": 1628,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.9603274559193955,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9615384615384616,
            "defect_tp": 1525,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9636340013351075,
            "recall_macro": 0.9636153074207481,
            "f1_macro": 0.9636245642484604,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9645390070921985,
            "no_defect_recall": 0.9651094027202839,
            "no_defect_f1": 0.964824120603015,
            "no_defect_tp": 1632,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 59,
            "no_defect_support": 1691,
            "defect_precision": 0.9627289955780164,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.962425007893906,
            "defect_tp": 1524,
            "defect_fp": 59,
            "defect_tn": 1632,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9607722911460692,
            "recall_macro": 0.9610939749356366,
            "f1_macro": 0.9608896850276161,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9682444577591373,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9619047619047619,
            "no_defect_tp": 1616,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9533001245330013,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9598746081504702,
            "defect_tp": 1531,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9601725746268657,
            "recall_macro": 0.9604227147285989,
            "f1_macro": 0.9602746725308061,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9659701492537314,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9613784907902555,
            "no_defect_tp": 1618,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.954375,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9591708542713567,
            "defect_tp": 1527,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620201486443924,
            "recall_macro": 0.9622167864332264,
            "f1_macro": 0.9621055185413284,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9666468135795117,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9632047477744807,
            "no_defect_tp": 1623,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9573934837092731,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9610062893081761,
            "defect_tp": 1528,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610818680285469,
            "recall_macro": 0.9613696844255686,
            "f1_macro": 0.9611933552910319,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9677033492822966,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9622360987213797,
            "no_defect_tp": 1618,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9544603867747973,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9601506118606841,
            "defect_tp": 1530,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 54,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9664252316940802,
            "recall_macro": 0.9664161914346416,
            "f1_macro": 0.9664203513022411,
            "precision_micro": 0.9664224664224664,
            "recall_micro": 0.9664224664224664,
            "f1_micro": 0.9664224664224664,
            "accuracy": 0.9664224664224664,
            "hamming_loss": 0.033577533577533576,
            "no_defect_precision": 0.9661016949152542,
            "no_defect_recall": 0.9672727272727273,
            "no_defect_f1": 0.966686856450636,
            "no_defect_tp": 1596,
            "no_defect_fp": 56,
            "no_defect_tn": 1570,
            "no_defect_fn": 54,
            "no_defect_support": 1650,
            "defect_precision": 0.9667487684729064,
            "defect_recall": 0.965559655596556,
            "defect_f1": 0.9661538461538461,
            "defect_tp": 1570,
            "defect_fp": 54,
            "defect_tn": 1596,
            "defect_fn": 56,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.1_s30_20251207_191814",
    "lr": 0.01,
    "weight_decay": 0.1,
    "seed": 30,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9620873486574757,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.1_s30_20251207_191814",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s30_20251207_191814",
      "timestamp": "2025-12-07T19:20:08.185994",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.1_s30",
          "seed": 30,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s30_20251207_191814"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9622235271090234,
        "recall_macro": 0.961977103978878,
        "f1_macro": 0.9620873486574757,
        "precision_micro": 0.9621374045801526,
        "recall_micro": 0.9621374045801526,
        "f1_micro": 0.9621374045801526,
        "accuracy": 0.9621374045801526,
        "hamming_loss": 0.03786259541984733,
        "no_defect_precision": 0.9600704638872578,
        "no_defect_recall": 0.9668835008870491,
        "no_defect_f1": 0.9634649381261049,
        "no_defect_tp": 1635,
        "no_defect_fp": 68,
        "no_defect_tn": 1516,
        "no_defect_fn": 56,
        "no_defect_support": 1691,
        "defect_precision": 0.9643765903307888,
        "defect_recall": 0.9570707070707071,
        "defect_f1": 0.9607097591888466,
        "defect_tp": 1516,
        "defect_fp": 56,
        "defect_tn": 1635,
        "defect_fn": 68,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9655069654754694,
        "recall_macro": 0.9655026277535503,
        "f1_macro": 0.965504706635602,
        "precision_micro": 0.9655067155067155,
        "recall_micro": 0.9655067155067155,
        "f1_micro": 0.9655067155067155,
        "accuracy": 0.9655067155067155,
        "hamming_loss": 0.034493284493284496,
        "no_defect_precision": 0.9654754694124773,
        "no_defect_recall": 0.9660606060606061,
        "no_defect_f1": 0.9657679491063315,
        "no_defect_tp": 1594,
        "no_defect_fp": 57,
        "no_defect_tn": 1569,
        "no_defect_fn": 56,
        "no_defect_support": 1650,
        "defect_precision": 0.9655384615384616,
        "defect_recall": 0.9649446494464945,
        "defect_f1": 0.9652414641648723,
        "defect_tp": 1569,
        "defect_fp": 56,
        "defect_tn": 1594,
        "defect_fn": 57,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.39374388236879804,
          0.21668761878208137,
          0.1899458784687968,
          0.1883259963041569,
          0.18833658943989287,
          0.18881588186055548,
          0.18247882027381634,
          0.1799640316656444,
          0.18062359755508073,
          0.17622024883909704,
          0.179734855937035,
          0.17210634775989725,
          0.16932403395988951,
          0.1661116222239189,
          0.16851970660948354
        ],
        "val_loss": [
          0.2877977822835629,
          0.16788408231849855,
          0.1319091088640002,
          0.14410093111487535,
          0.12307363662582177,
          0.1265993773077543,
          0.11966665089130402,
          0.11663138056890322,
          0.1246998798675262,
          0.12845708293697009,
          0.12971928894806367,
          0.11656546055410917,
          0.12051319638983561,
          0.11877445876598358,
          0.11834484725617446
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9221928454067189,
            "recall_macro": 0.921904400301059,
            "f1_macro": 0.9220292041418983,
            "precision_micro": 0.9221374045801527,
            "recall_micro": 0.9221374045801527,
            "f1_micro": 0.9221374045801527,
            "accuracy": 0.9221374045801527,
            "hamming_loss": 0.07786259541984733,
            "no_defect_precision": 0.9208675263774913,
            "no_defect_recall": 0.9290360733293909,
            "no_defect_f1": 0.9249337650868413,
            "no_defect_tp": 1571,
            "no_defect_fp": 135,
            "no_defect_tn": 1449,
            "no_defect_fn": 120,
            "no_defect_support": 1691,
            "defect_precision": 0.9235181644359465,
            "defect_recall": 0.9147727272727273,
            "defect_f1": 0.9191246431969553,
            "defect_tp": 1449,
            "defect_fp": 120,
            "defect_tn": 1571,
            "defect_fn": 135,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.945432931644179,
            "recall_macro": 0.9456225098411675,
            "f1_macro": 0.9447320824119683,
            "precision_micro": 0.944732824427481,
            "recall_micro": 0.944732824427481,
            "f1_micro": 0.944732824427481,
            "accuracy": 0.944732824427481,
            "hamming_loss": 0.05526717557251908,
            "no_defect_precision": 0.9730576441102757,
            "no_defect_recall": 0.9183914843287996,
            "no_defect_f1": 0.9449345908122908,
            "no_defect_tp": 1553,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 138,
            "no_defect_support": 1691,
            "defect_precision": 0.9178082191780822,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9445295740116457,
            "defect_tp": 1541,
            "defect_fp": 138,
            "defect_tn": 1553,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9587061887851346,
            "recall_macro": 0.959183982043976,
            "f1_macro": 0.9587638471630786,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.9726609963547995,
            "no_defect_recall": 0.9467770549970431,
            "no_defect_f1": 0.9595445010488463,
            "no_defect_tp": 1601,
            "no_defect_fp": 45,
            "no_defect_tn": 1539,
            "no_defect_fn": 90,
            "no_defect_support": 1691,
            "defect_precision": 0.9447513812154696,
            "defect_recall": 0.9715909090909091,
            "defect_f1": 0.957983193277311,
            "defect_tp": 1539,
            "defect_fp": 90,
            "defect_tn": 1601,
            "defect_fn": 45,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.949099408736254,
            "recall_macro": 0.949290547401872,
            "f1_macro": 0.9483962537437716,
            "precision_micro": 0.9483969465648855,
            "recall_micro": 0.9483969465648855,
            "f1_micro": 0.9483969465648855,
            "accuracy": 0.9483969465648855,
            "hamming_loss": 0.0516030534351145,
            "no_defect_precision": 0.9768170426065163,
            "no_defect_recall": 0.92193968066233,
            "no_defect_f1": 0.9485853361728019,
            "no_defect_tp": 1559,
            "no_defect_fp": 37,
            "no_defect_tn": 1547,
            "no_defect_fn": 132,
            "no_defect_support": 1691,
            "defect_precision": 0.9213817748659917,
            "defect_recall": 0.9766414141414141,
            "defect_f1": 0.9482071713147411,
            "defect_tp": 1547,
            "defect_fp": 132,
            "defect_tn": 1559,
            "defect_fn": 37,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9563939343579977,
            "recall_macro": 0.9552284748729161,
            "f1_macro": 0.9556296128734529,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9452764976958525,
            "no_defect_recall": 0.9704316972205795,
            "no_defect_f1": 0.957688940764517,
            "no_defect_tp": 1641,
            "no_defect_fp": 95,
            "no_defect_tn": 1489,
            "no_defect_fn": 50,
            "no_defect_support": 1691,
            "defect_precision": 0.967511371020143,
            "defect_recall": 0.9400252525252525,
            "defect_f1": 0.9535702849823887,
            "defect_tp": 1489,
            "defect_fp": 50,
            "defect_tn": 1641,
            "defect_fn": 95,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9617143343077966,
            "recall_macro": 0.9621607858597805,
            "f1_macro": 0.9618146160824012,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.973397823458283,
            "no_defect_recall": 0.9520993494973389,
            "no_defect_f1": 0.9626307922272048,
            "no_defect_tp": 1610,
            "no_defect_fp": 44,
            "no_defect_tn": 1540,
            "no_defect_fn": 81,
            "no_defect_support": 1691,
            "defect_precision": 0.9500308451573103,
            "defect_recall": 0.9722222222222222,
            "defect_f1": 0.9609984399375975,
            "defect_tp": 1540,
            "defect_fp": 81,
            "defect_tn": 1610,
            "defect_fn": 44,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9592711977981454,
            "recall_macro": 0.9575140449438202,
            "f1_macro": 0.9580575693105269,
            "precision_micro": 0.9581679389312977,
            "recall_micro": 0.9581679389312977,
            "f1_micro": 0.9581679389312977,
            "accuracy": 0.9581679389312977,
            "hamming_loss": 0.04183206106870229,
            "no_defect_precision": 0.9434931506849316,
            "no_defect_recall": 0.9775280898876404,
            "no_defect_f1": 0.9602091199535289,
            "no_defect_tp": 1653,
            "no_defect_fp": 99,
            "no_defect_tn": 1485,
            "no_defect_fn": 38,
            "no_defect_support": 1691,
            "defect_precision": 0.9750492449113591,
            "defect_recall": 0.9375,
            "defect_f1": 0.9559060186675249,
            "defect_tp": 1485,
            "defect_fp": 38,
            "defect_tn": 1653,
            "defect_fn": 99,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9612100321260699,
            "recall_macro": 0.9606146100269399,
            "f1_macro": 0.9608514656792868,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9551543389633081,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.9624413145539906,
            "no_defect_tp": 1640,
            "no_defect_fp": 77,
            "no_defect_tn": 1507,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.9672657252888318,
            "defect_recall": 0.9513888888888888,
            "defect_f1": 0.9592616168045831,
            "defect_tp": 1507,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 77,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9574390910711661,
            "recall_macro": 0.9578814087056251,
            "f1_macro": 0.95753785308363,
            "precision_micro": 0.9575572519083969,
            "recall_micro": 0.9575572519083969,
            "f1_micro": 0.9575572519083969,
            "accuracy": 0.9575572519083969,
            "hamming_loss": 0.042442748091603054,
            "no_defect_precision": 0.9691656590084643,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9584454409566517,
            "no_defect_tp": 1603,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.945712523133868,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9566302652106085,
            "defect_tp": 1533,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9553701159404724,
            "recall_macro": 0.9558515745867904,
            "f1_macro": 0.9554053741490507,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9701765063907486,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.9562087582483503,
            "no_defect_tp": 1594,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.9405637254901961,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9546019900497512,
            "defect_tp": 1535,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9558353062451423,
            "recall_macro": 0.9563070459174836,
            "f1_macro": 0.955717197691951,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9748157248157249,
            "no_defect_recall": 0.9384979302188055,
            "no_defect_f1": 0.9563121422115095,
            "no_defect_tp": 1587,
            "no_defect_fp": 41,
            "no_defect_tn": 1543,
            "no_defect_fn": 104,
            "no_defect_support": 1691,
            "defect_precision": 0.9368548876745598,
            "defect_recall": 0.9741161616161617,
            "defect_f1": 0.9551222531723924,
            "defect_tp": 1543,
            "defect_fp": 104,
            "defect_tn": 1587,
            "defect_fn": 41,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9622235271090234,
            "recall_macro": 0.961977103978878,
            "f1_macro": 0.9620873486574757,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9600704638872578,
            "no_defect_recall": 0.9668835008870491,
            "no_defect_f1": 0.9634649381261049,
            "no_defect_tp": 1635,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 56,
            "no_defect_support": 1691,
            "defect_precision": 0.9643765903307888,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9607097591888466,
            "defect_tp": 1516,
            "defect_fp": 56,
            "defect_tn": 1635,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598643544917043,
            "recall_macro": 0.9601270317008046,
            "f1_macro": 0.9599697691397968,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9659498207885304,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9610698365527489,
            "no_defect_tp": 1617,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9537788881948782,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9588697017268446,
            "defect_tp": 1527,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610863356758059,
            "recall_macro": 0.9613497108877062,
            "f1_macro": 0.9611920662652991,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9671445639187575,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.962258543833581,
            "no_defect_tp": 1619,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9550281074328545,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9601255886970173,
            "defect_tp": 1529,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610921802260064,
            "recall_macro": 0.9613297373498437,
            "f1_macro": 0.9611907481841506,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9665871121718377,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9622809622809623,
            "no_defect_tp": 1620,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9555972482801751,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.960100534087339,
            "defect_tp": 1528,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 56,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9655069654754694,
            "recall_macro": 0.9655026277535503,
            "f1_macro": 0.965504706635602,
            "precision_micro": 0.9655067155067155,
            "recall_micro": 0.9655067155067155,
            "f1_micro": 0.9655067155067155,
            "accuracy": 0.9655067155067155,
            "hamming_loss": 0.034493284493284496,
            "no_defect_precision": 0.9654754694124773,
            "no_defect_recall": 0.9660606060606061,
            "no_defect_f1": 0.9657679491063315,
            "no_defect_tp": 1594,
            "no_defect_fp": 57,
            "no_defect_tn": 1569,
            "no_defect_fn": 56,
            "no_defect_support": 1650,
            "defect_precision": 0.9655384615384616,
            "defect_recall": 0.9649446494464945,
            "defect_f1": 0.9652414641648723,
            "defect_tp": 1569,
            "defect_fp": 56,
            "defect_tn": 1594,
            "defect_fn": 57,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.1_s40_20251207_202201",
    "lr": 0.01,
    "weight_decay": 0.1,
    "seed": 40,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9648486721921334,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.1_s40_20251207_202201",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s40_20251207_202201",
      "timestamp": "2025-12-07T20:23:55.328082",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 8,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.1_s40",
          "seed": 40,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s40_20251207_202201"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9648395647061019,
        "recall_macro": 0.9648579601455118,
        "f1_macro": 0.9648486721921334,
        "precision_micro": 0.9648854961832061,
        "recall_micro": 0.9648854961832061,
        "f1_micro": 0.9648854961832061,
        "accuracy": 0.9648854961832061,
        "hamming_loss": 0.035114503816793895,
        "no_defect_precision": 0.9662721893491124,
        "no_defect_recall": 0.9657007687758723,
        "no_defect_f1": 0.9659863945578231,
        "no_defect_tp": 1633,
        "no_defect_fp": 57,
        "no_defect_tn": 1527,
        "no_defect_fn": 58,
        "no_defect_support": 1691,
        "defect_precision": 0.9634069400630915,
        "defect_recall": 0.9640151515151515,
        "defect_f1": 0.9637109498264437,
        "defect_tp": 1527,
        "defect_fp": 58,
        "defect_tn": 1633,
        "defect_fn": 57,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9664385399892645,
        "recall_macro": 0.9664072458906408,
        "f1_macro": 0.9664196503752209,
        "precision_micro": 0.9664224664224664,
        "recall_micro": 0.9664224664224664,
        "f1_micro": 0.9664224664224664,
        "accuracy": 0.9664224664224664,
        "hamming_loss": 0.033577533577533576,
        "no_defect_precision": 0.964975845410628,
        "no_defect_recall": 0.9684848484848485,
        "no_defect_f1": 0.9667271627344223,
        "no_defect_tp": 1598,
        "no_defect_fp": 58,
        "no_defect_tn": 1568,
        "no_defect_fn": 52,
        "no_defect_support": 1650,
        "defect_precision": 0.9679012345679012,
        "defect_recall": 0.964329643296433,
        "defect_f1": 0.9661121380160197,
        "defect_tp": 1568,
        "defect_fp": 52,
        "defect_tn": 1598,
        "defect_fn": 58,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.3872275901763509,
          0.22202839842650682,
          0.19368715793143756,
          0.18831965514306742,
          0.1794130687746044,
          0.18449707905991805,
          0.17945386416368406,
          0.17887215864957626,
          0.17870197339162666,
          0.17127523058440894,
          0.17606502793199347,
          0.16595315549787618,
          0.16860844107601933,
          0.17154256076742913,
          0.16952873796037551
        ],
        "val_loss": [
          0.28814302614101994,
          0.16108759449651608,
          0.13632167188020852,
          0.12416180273374686,
          0.11911219021735284,
          0.11808994741967091,
          0.12685716847101083,
          0.11826226000602429,
          0.13018425926566124,
          0.11635991257543747,
          0.11656384220203528,
          0.11947254055681136,
          0.11582508475448076,
          0.11566887473544249,
          0.1170733983700092
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9147164131954737,
            "recall_macro": 0.9136573825182637,
            "f1_macro": 0.9140132497754501,
            "precision_micro": 0.9141984732824427,
            "recall_micro": 0.9141984732824427,
            "f1_micro": 0.9141984732824427,
            "accuracy": 0.9141984732824427,
            "hamming_loss": 0.08580152671755725,
            "no_defect_precision": 0.9061059907834101,
            "no_defect_recall": 0.9302188054405677,
            "no_defect_f1": 0.9180040852057193,
            "no_defect_tp": 1573,
            "no_defect_fp": 163,
            "no_defect_tn": 1421,
            "no_defect_fn": 118,
            "no_defect_support": 1691,
            "defect_precision": 0.9233268356075374,
            "defect_recall": 0.8970959595959596,
            "defect_f1": 0.9100224143451809,
            "defect_tp": 1421,
            "defect_fp": 118,
            "defect_tn": 1573,
            "defect_fn": 163,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9522523036619142,
            "recall_macro": 0.9526950089302249,
            "f1_macro": 0.9523452587403403,
            "precision_micro": 0.9523664122137404,
            "recall_micro": 0.9523664122137404,
            "f1_micro": 0.9523664122137404,
            "accuracy": 0.9523664122137404,
            "hamming_loss": 0.04763358778625954,
            "no_defect_precision": 0.9643073200241984,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.9533492822966507,
            "no_defect_tp": 1594,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.94019728729963,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9513412351840299,
            "defect_tp": 1525,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556837396779129,
            "recall_macro": 0.956167231152447,
            "f1_macro": 0.9557113000700133,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9707673568818515,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.9564956495649565,
            "no_defect_tp": 1594,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.9406001224739743,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9549269505750699,
            "defect_tp": 1536,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9571295363843199,
            "recall_macro": 0.9575657521399685,
            "f1_macro": 0.9572318075209336,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9685800604229607,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9581589958158996,
            "no_defect_tp": 1603,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.945679012345679,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9563046192259675,
            "defect_tp": 1532,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9590371255047399,
            "recall_macro": 0.9580294368881004,
            "f1_macro": 0.9583894493431251,
            "precision_micro": 0.9584732824427481,
            "recall_micro": 0.9584732824427481,
            "f1_micro": 0.9584732824427481,
            "accuracy": 0.9584732824427481,
            "hamming_loss": 0.04152671755725191,
            "no_defect_precision": 0.9491623339110341,
            "no_defect_recall": 0.9716144293317563,
            "no_defect_f1": 0.9602571595558154,
            "no_defect_tp": 1643,
            "no_defect_fp": 88,
            "no_defect_tn": 1496,
            "no_defect_fn": 48,
            "no_defect_support": 1691,
            "defect_precision": 0.9689119170984456,
            "defect_recall": 0.9444444444444444,
            "defect_f1": 0.9565217391304348,
            "defect_tp": 1496,
            "defect_fp": 48,
            "defect_tn": 1643,
            "defect_fn": 88,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610532262113984,
            "recall_macro": 0.9607144777162518,
            "f1_macro": 0.960860822878791,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9578207381370826,
            "no_defect_recall": 0.9668835008870491,
            "no_defect_f1": 0.9623307828134197,
            "no_defect_tp": 1635,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 56,
            "no_defect_support": 1691,
            "defect_precision": 0.9642857142857143,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.9593908629441624,
            "defect_tp": 1512,
            "defect_fp": 56,
            "defect_tn": 1635,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9597667455817263,
            "recall_macro": 0.96025079296812,
            "f1_macro": 0.9596863536768507,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9779276517473943,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9602649006622517,
            "no_defect_tp": 1595,
            "no_defect_fp": 36,
            "no_defect_tn": 1548,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9416058394160584,
            "defect_recall": 0.9772727272727273,
            "defect_f1": 0.9591078066914498,
            "defect_tp": 1548,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 36,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9648395647061019,
            "recall_macro": 0.9648579601455118,
            "f1_macro": 0.9648486721921334,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9662721893491124,
            "no_defect_recall": 0.9657007687758723,
            "no_defect_f1": 0.9659863945578231,
            "no_defect_tp": 1633,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 58,
            "no_defect_support": 1691,
            "defect_precision": 0.9634069400630915,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9637109498264437,
            "defect_tp": 1527,
            "defect_fp": 58,
            "defect_tn": 1633,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9550518003300182,
            "recall_macro": 0.955479917447688,
            "f1_macro": 0.9548039983588825,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9765287214329833,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.9552870090634441,
            "no_defect_tp": 1581,
            "no_defect_fp": 38,
            "no_defect_tn": 1546,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9335748792270532,
            "defect_recall": 0.976010101010101,
            "defect_f1": 0.9543209876543209,
            "defect_tp": 1546,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 38,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.960891803312965,
            "recall_macro": 0.9608542924812884,
            "f1_macro": 0.9608726883897916,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9616066154754873,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9621749408983451,
            "no_defect_tp": 1628,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.9601769911504425,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9595704358812381,
            "defect_tp": 1519,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626265618711183,
            "recall_macro": 0.9617374215245298,
            "f1_macro": 0.9620650795465671,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9536768963520555,
            "no_defect_recall": 0.97397989355411,
            "no_defect_f1": 0.9637214745465185,
            "no_defect_tp": 1647,
            "no_defect_fp": 80,
            "no_defect_tn": 1504,
            "no_defect_fn": 44,
            "no_defect_support": 1691,
            "defect_precision": 0.9715762273901809,
            "defect_recall": 0.9494949494949495,
            "defect_f1": 0.9604086845466155,
            "defect_tp": 1504,
            "defect_fp": 44,
            "defect_tn": 1647,
            "defect_fn": 80,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9613976141969529,
            "recall_macro": 0.9618251557562616,
            "f1_macro": 0.9615075927007986,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9722389861194931,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9623655913978495,
            "no_defect_tp": 1611,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9505562422744128,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9606495940037476,
            "defect_tp": 1538,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.960817904137443,
            "recall_macro": 0.9609541601706002,
            "f1_macro": 0.9608802832148046,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.964349376114082,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9620628334321281,
            "no_defect_tp": 1623,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.957286432160804,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9596977329974811,
            "defect_tp": 1524,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9608433285205132,
            "recall_macro": 0.9609142130948753,
            "f1_macro": 0.9608773332676311,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9632483698873741,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9621077560686797,
            "no_defect_tp": 1625,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9584382871536524,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9596469104665826,
            "defect_tp": 1522,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598599515859916,
            "recall_macro": 0.9601470052386669,
            "f1_macro": 0.9599710987647652,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9665071770334929,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9610466845078799,
            "no_defect_tp": 1616,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9532127261384903,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9588955130216504,
            "defect_tp": 1528,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 56,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9664385399892645,
            "recall_macro": 0.9664072458906408,
            "f1_macro": 0.9664196503752209,
            "precision_micro": 0.9664224664224664,
            "recall_micro": 0.9664224664224664,
            "f1_micro": 0.9664224664224664,
            "accuracy": 0.9664224664224664,
            "hamming_loss": 0.033577533577533576,
            "no_defect_precision": 0.964975845410628,
            "no_defect_recall": 0.9684848484848485,
            "no_defect_f1": 0.9667271627344223,
            "no_defect_tp": 1598,
            "no_defect_fp": 58,
            "no_defect_tn": 1568,
            "no_defect_fn": 52,
            "no_defect_support": 1650,
            "defect_precision": 0.9679012345679012,
            "defect_recall": 0.964329643296433,
            "defect_f1": 0.9661121380160197,
            "defect_tp": 1568,
            "defect_fp": 52,
            "defect_tn": 1598,
            "defect_fn": 58,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.1_s50_20251207_160421",
    "lr": 0.01,
    "weight_decay": 0.1,
    "seed": 50,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9633329029070197,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.1_s50_20251207_160421",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s50_20251207_160421",
      "timestamp": "2025-12-07T16:06:20.083508",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.1_s50",
          "seed": 50,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s50_20251207_160421"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9632184499851508,
        "recall_macro": 0.9635193597715774,
        "f1_macro": 0.9633329029070197,
        "precision_micro": 0.9633587786259542,
        "recall_micro": 0.9633587786259542,
        "f1_micro": 0.9633587786259542,
        "accuracy": 0.9633587786259542,
        "hamming_loss": 0.0366412213740458,
        "no_defect_precision": 0.9700777977259126,
        "no_defect_recall": 0.9586043761088113,
        "no_defect_f1": 0.9643069601427722,
        "no_defect_tp": 1621,
        "no_defect_fp": 50,
        "no_defect_tn": 1534,
        "no_defect_fn": 70,
        "no_defect_support": 1691,
        "defect_precision": 0.956359102244389,
        "defect_recall": 0.9684343434343434,
        "defect_f1": 0.9623588456712673,
        "defect_tp": 1534,
        "defect_fp": 70,
        "defect_tn": 1621,
        "defect_fn": 50,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9658468030537994,
        "recall_macro": 0.9657877669685788,
        "f1_macro": 0.9658082829032095,
        "precision_micro": 0.9658119658119658,
        "recall_micro": 0.9658119658119658,
        "f1_micro": 0.9658119658119658,
        "accuracy": 0.9658119658119658,
        "hamming_loss": 0.03418803418803419,
        "no_defect_precision": 0.9632530120481928,
        "no_defect_recall": 0.9690909090909091,
        "no_defect_f1": 0.9661631419939577,
        "no_defect_tp": 1599,
        "no_defect_fp": 61,
        "no_defect_tn": 1565,
        "no_defect_fn": 51,
        "no_defect_support": 1650,
        "defect_precision": 0.968440594059406,
        "defect_recall": 0.9624846248462484,
        "defect_f1": 0.9654534238124615,
        "defect_tp": 1565,
        "defect_fp": 51,
        "defect_tn": 1599,
        "defect_fn": 61,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.38771188701795234,
          0.21650141371593315,
          0.19381251903133911,
          0.18999646127099273,
          0.18034867923628836,
          0.18582848567032414,
          0.18554066933660326,
          0.1766300935874923,
          0.17930062620210846,
          0.1793448036404085,
          0.1778433713360561,
          0.17083557121549192,
          0.169662659699448,
          0.16712051968257796,
          0.17129827491845545
        ],
        "val_loss": [
          0.2852568050416616,
          0.1570825598274286,
          0.138736696054156,
          0.12871714753027147,
          0.1280652334770331,
          0.12286156559219727,
          0.12640277496897256,
          0.11763007981845966,
          0.12094171302249798,
          0.118536759669391,
          0.13985212440960682,
          0.116900045138139,
          0.11837233115847294,
          0.11686095423423327,
          0.11660805495026019
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9211241495113027,
            "recall_macro": 0.921157165982713,
            "f1_macro": 0.9211403132174789,
            "precision_micro": 0.9212213740458015,
            "recall_micro": 0.9212213740458015,
            "f1_micro": 0.9212213740458015,
            "accuracy": 0.9212213740458015,
            "hamming_loss": 0.07877862595419848,
            "no_defect_precision": 0.9242155121373594,
            "no_defect_recall": 0.9231224127735068,
            "no_defect_f1": 0.9236686390532545,
            "no_defect_tp": 1561,
            "no_defect_fp": 128,
            "no_defect_tn": 1456,
            "no_defect_fn": 130,
            "no_defect_support": 1691,
            "defect_precision": 0.9180327868852459,
            "defect_recall": 0.9191919191919192,
            "defect_f1": 0.9186119873817035,
            "defect_tp": 1456,
            "defect_fp": 130,
            "defect_tn": 1561,
            "defect_fn": 128,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9549887937976673,
            "recall_macro": 0.9551963678774738,
            "f1_macro": 0.9550774956939061,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9600715137067938,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.956366874443455,
            "no_defect_tp": 1611,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.949906073888541,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9537881169443572,
            "defect_tp": 1517,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9580820245135189,
            "recall_macro": 0.958552668912663,
            "f1_macro": 0.958151957617239,
            "precision_micro": 0.9581679389312977,
            "recall_micro": 0.9581679389312977,
            "f1_micro": 0.9581679389312977,
            "accuracy": 0.9581679389312977,
            "hamming_loss": 0.04183206106870229,
            "no_defect_precision": 0.9714805825242718,
            "no_defect_recall": 0.9467770549970431,
            "no_defect_f1": 0.9589697514225816,
            "no_defect_tp": 1601,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 90,
            "no_defect_support": 1691,
            "defect_precision": 0.9446834665027658,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9573341638118966,
            "defect_tp": 1537,
            "defect_fp": 90,
            "defect_tn": 1601,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.956689562785813,
            "recall_macro": 0.9571741214630038,
            "f1_macro": 0.9566315130598783,
            "precision_micro": 0.9566412213740458,
            "recall_micro": 0.9566412213740458,
            "f1_micro": 0.9566412213740458,
            "accuracy": 0.9566412213740458,
            "hamming_loss": 0.0433587786259542,
            "no_defect_precision": 0.9742804654011022,
            "no_defect_recall": 0.9408633944411591,
            "no_defect_f1": 0.957280385078219,
            "no_defect_tp": 1591,
            "no_defect_fp": 42,
            "no_defect_tn": 1542,
            "no_defect_fn": 100,
            "no_defect_support": 1691,
            "defect_precision": 0.9390986601705238,
            "defect_recall": 0.9734848484848485,
            "defect_f1": 0.9559826410415375,
            "defect_tp": 1542,
            "defect_fp": 100,
            "defect_tn": 1591,
            "defect_fn": 42,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9544246610247842,
            "recall_macro": 0.9514167025070337,
            "f1_macro": 0.952193431607693,
            "precision_micro": 0.9523664122137404,
            "recall_micro": 0.9523664122137404,
            "f1_micro": 0.9523664122137404,
            "accuracy": 0.9523664122137404,
            "hamming_loss": 0.04763358778625954,
            "no_defect_precision": 0.9309376754632229,
            "no_defect_recall": 0.9804849201655825,
            "no_defect_f1": 0.9550691244239631,
            "no_defect_tp": 1658,
            "no_defect_fp": 123,
            "no_defect_tn": 1461,
            "no_defect_fn": 33,
            "no_defect_support": 1691,
            "defect_precision": 0.9779116465863453,
            "defect_recall": 0.9223484848484849,
            "defect_f1": 0.949317738791423,
            "defect_tp": 1461,
            "defect_fp": 33,
            "defect_tn": 1658,
            "defect_fn": 123,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9602401775225167,
            "recall_macro": 0.9607223177965343,
            "f1_macro": 0.9602915676170949,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9744680851063829,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9610311750599521,
            "no_defect_tp": 1603,
            "no_defect_fp": 42,
            "no_defect_tn": 1542,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9460122699386503,
            "defect_recall": 0.9734848484848485,
            "defect_f1": 0.9595519601742377,
            "defect_tp": 1542,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 42,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9565759785182837,
            "recall_macro": 0.9570542802358296,
            "f1_macro": 0.9566261738586729,
            "precision_micro": 0.9566412213740458,
            "recall_micro": 0.9566412213740458,
            "f1_micro": 0.9566412213740458,
            "accuracy": 0.9566412213740458,
            "hamming_loss": 0.0433587786259542,
            "no_defect_precision": 0.9708206686930091,
            "no_defect_recall": 0.9444115907746895,
            "no_defect_f1": 0.9574340527577938,
            "no_defect_tp": 1597,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 94,
            "no_defect_support": 1691,
            "defect_precision": 0.9423312883435583,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.955818294959552,
            "defect_tp": 1536,
            "defect_fp": 94,
            "defect_tn": 1597,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9628885934866038,
            "recall_macro": 0.9625484964966041,
            "f1_macro": 0.9626954718063477,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9595782073813708,
            "no_defect_recall": 0.9686575990538143,
            "no_defect_f1": 0.9640965273690406,
            "no_defect_tp": 1638,
            "no_defect_fp": 69,
            "no_defect_tn": 1515,
            "no_defect_fn": 53,
            "no_defect_support": 1691,
            "defect_precision": 0.9661989795918368,
            "defect_recall": 0.9564393939393939,
            "defect_f1": 0.9612944162436549,
            "defect_tp": 1515,
            "defect_fp": 53,
            "defect_tn": 1638,
            "defect_fn": 69,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9589395518751954,
            "recall_macro": 0.9592599561552844,
            "f1_macro": 0.9590563890132856,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9664469742360695,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9601190476190476,
            "no_defect_tp": 1613,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9514321295143213,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9579937304075236,
            "defect_tp": 1528,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.959354451627741,
            "recall_macro": 0.9593359302665926,
            "f1_macro": 0.9593451012188676,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.960401891252955,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9606857818504286,
            "no_defect_tp": 1625,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9583070120025269,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9580044205873066,
            "defect_tp": 1517,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9473641976967427,
            "recall_macro": 0.9474964756972445,
            "f1_macro": 0.9465645666459778,
            "precision_micro": 0.9465648854961832,
            "recall_micro": 0.9465648854961832,
            "f1_micro": 0.9465648854961832,
            "accuracy": 0.9465648854961832,
            "hamming_loss": 0.05343511450381679,
            "no_defect_precision": 0.9761306532663316,
            "no_defect_recall": 0.918982850384388,
            "no_defect_f1": 0.9466950959488273,
            "no_defect_tp": 1554,
            "no_defect_fp": 38,
            "no_defect_tn": 1546,
            "no_defect_fn": 137,
            "no_defect_support": 1691,
            "defect_precision": 0.9185977421271538,
            "defect_recall": 0.976010101010101,
            "defect_f1": 0.9464340373431283,
            "defect_tp": 1546,
            "defect_fp": 137,
            "defect_tn": 1554,
            "defect_fn": 38,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9632184499851508,
            "recall_macro": 0.9635193597715774,
            "f1_macro": 0.9633329029070197,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9700777977259126,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9643069601427722,
            "no_defect_tp": 1621,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.956359102244389,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9623588456712673,
            "defect_tp": 1534,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604661634724578,
            "recall_macro": 0.9607982919078425,
            "f1_macro": 0.9605847571630131,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9682254196642686,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9615957130098244,
            "no_defect_tp": 1615,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9527069072806472,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9595738013162018,
            "defect_tp": 1531,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620402219057258,
            "recall_macro": 0.9621768393575016,
            "f1_macro": 0.962102774364342,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9655377302436126,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9632483698873741,
            "no_defect_tp": 1625,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9585427135678392,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9609571788413098,
            "defect_tp": 1526,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.960530844096461,
            "recall_macro": 0.9606185300670812,
            "f1_macro": 0.9605724417629837,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.963226571767497,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9618004145691442,
            "no_defect_tp": 1624,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9578351164254248,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9593444689568232,
            "defect_tp": 1522,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 62,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9658468030537994,
            "recall_macro": 0.9657877669685788,
            "f1_macro": 0.9658082829032095,
            "precision_micro": 0.9658119658119658,
            "recall_micro": 0.9658119658119658,
            "f1_micro": 0.9658119658119658,
            "accuracy": 0.9658119658119658,
            "hamming_loss": 0.03418803418803419,
            "no_defect_precision": 0.9632530120481928,
            "no_defect_recall": 0.9690909090909091,
            "no_defect_f1": 0.9661631419939577,
            "no_defect_tp": 1599,
            "no_defect_fp": 61,
            "no_defect_tn": 1565,
            "no_defect_fn": 51,
            "no_defect_support": 1650,
            "defect_precision": 0.968440594059406,
            "defect_recall": 0.9624846248462484,
            "defect_f1": 0.9654534238124615,
            "defect_tp": 1565,
            "defect_fp": 51,
            "defect_tn": 1599,
            "defect_fn": 61,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.1_s60_20251207_193649",
    "lr": 0.01,
    "weight_decay": 0.1,
    "seed": 60,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9636315568997111,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.1_s60_20251207_193649",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s60_20251207_193649",
      "timestamp": "2025-12-07T19:38:42.625879",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 11,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.1_s60",
          "seed": 60,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s60_20251207_193649"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9635625316765606,
        "recall_macro": 0.9637151751100598,
        "f1_macro": 0.9636315568997111,
        "precision_micro": 0.9636641221374046,
        "recall_micro": 0.9636641221374046,
        "f1_micro": 0.9636641221374046,
        "accuracy": 0.9636641221374046,
        "hamming_loss": 0.03633587786259542,
        "no_defect_precision": 0.9673008323424495,
        "no_defect_recall": 0.9621525724423418,
        "no_defect_f1": 0.9647198339756893,
        "no_defect_tp": 1627,
        "no_defect_fp": 55,
        "no_defect_tn": 1529,
        "no_defect_fn": 64,
        "no_defect_support": 1691,
        "defect_precision": 0.9598242310106717,
        "defect_recall": 0.9652777777777778,
        "defect_f1": 0.9625432798237331,
        "defect_tp": 1529,
        "defect_fp": 64,
        "defect_tn": 1627,
        "defect_fn": 55,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9661227611702468,
        "recall_macro": 0.9661086883596108,
        "f1_macro": 0.9661149144192763,
        "precision_micro": 0.9661172161172161,
        "recall_micro": 0.9661172161172161,
        "f1_micro": 0.9661172161172161,
        "accuracy": 0.9661172161172161,
        "hamming_loss": 0.03388278388278388,
        "no_defect_precision": 0.9655172413793104,
        "no_defect_recall": 0.9672727272727273,
        "no_defect_f1": 0.9663941871026339,
        "no_defect_tp": 1596,
        "no_defect_fp": 57,
        "no_defect_tn": 1569,
        "no_defect_fn": 54,
        "no_defect_support": 1650,
        "defect_precision": 0.966728280961183,
        "defect_recall": 0.9649446494464945,
        "defect_f1": 0.9658356417359187,
        "defect_tp": 1569,
        "defect_fp": 54,
        "defect_tn": 1596,
        "defect_fn": 57,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.3922615510773958,
          0.22527845671486157,
          0.1890436854509629,
          0.18295492758686074,
          0.18194507363264031,
          0.18169599469112052,
          0.18140195110602358,
          0.176374330212631,
          0.18162085131496566,
          0.17598593914608576,
          0.17886946927054656,
          0.16978966454082953,
          0.1706200290985686,
          0.17087455081391034,
          0.16983206735370548
        ],
        "val_loss": [
          0.28980761479872924,
          0.16476542531297758,
          0.13108100011371648,
          0.12436654504675132,
          0.1378775921005469,
          0.12495075588902602,
          0.11533758896761216,
          0.11726430710405111,
          0.11936579261404964,
          0.11696215303471455,
          0.11488686466159728,
          0.11770535797740404,
          0.11852363977008142,
          0.1178471353621437,
          0.1185844701070052
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9171160166393847,
            "recall_macro": 0.9172533660078013,
            "f1_macro": 0.9171777472253927,
            "precision_micro": 0.9172519083969466,
            "recall_micro": 0.9172519083969466,
            "f1_micro": 0.9172519083969466,
            "accuracy": 0.9172519083969466,
            "hamming_loss": 0.08274809160305344,
            "no_defect_precision": 0.9221165279429251,
            "no_defect_recall": 0.9172087522176227,
            "no_defect_f1": 0.9196560924992588,
            "no_defect_tp": 1551,
            "no_defect_fp": 131,
            "no_defect_tn": 1453,
            "no_defect_fn": 140,
            "no_defect_support": 1691,
            "defect_precision": 0.9121155053358443,
            "defect_recall": 0.9172979797979798,
            "defect_f1": 0.9146994019515265,
            "defect_tp": 1453,
            "defect_fp": 140,
            "defect_tn": 1551,
            "defect_fn": 131,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9520764122079328,
            "recall_macro": 0.9525591142053295,
            "f1_macro": 0.952048979937463,
            "precision_micro": 0.9520610687022901,
            "recall_micro": 0.9520610687022901,
            "f1_micro": 0.9520610687022901,
            "accuracy": 0.9520610687022901,
            "hamming_loss": 0.04793893129770992,
            "no_defect_precision": 0.9688264058679706,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.9528103396453261,
            "no_defect_tp": 1585,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.9353264185478951,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9512876202295998,
            "defect_tp": 1533,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.957420392123501,
            "recall_macro": 0.9576816733270015,
            "f1_macro": 0.957525174888792,
            "precision_micro": 0.9575572519083969,
            "recall_micro": 0.9575572519083969,
            "f1_micro": 0.9575572519083969,
            "accuracy": 0.9575572519083969,
            "hamming_loss": 0.042442748091603054,
            "no_defect_precision": 0.9635603345280764,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9586924219910847,
            "no_defect_tp": 1613,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9512804497189257,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9563579277864992,
            "defect_tp": 1523,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.956529430336994,
            "recall_macro": 0.9566947565543071,
            "f1_macro": 0.9566031517095213,
            "precision_micro": 0.9566412213740458,
            "recall_micro": 0.9566412213740458,
            "f1_micro": 0.9566412213740458,
            "accuracy": 0.9566412213740458,
            "hamming_loss": 0.0433587786259542,
            "no_defect_precision": 0.9607376561570494,
            "no_defect_recall": 0.9550561797752809,
            "no_defect_f1": 0.9578884934756821,
            "no_defect_tp": 1615,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 76,
            "no_defect_support": 1691,
            "defect_precision": 0.9523212045169385,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9553178099433606,
            "defect_tp": 1518,
            "defect_fp": 76,
            "defect_tn": 1615,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.950839552238806,
            "recall_macro": 0.9510846191064997,
            "f1_macro": 0.9502278196675564,
            "precision_micro": 0.9502290076335878,
            "recall_micro": 0.9502290076335878,
            "f1_micro": 0.9502290076335878,
            "accuracy": 0.9502290076335878,
            "hamming_loss": 0.04977099236641221,
            "no_defect_precision": 0.9775,
            "no_defect_recall": 0.924896510940272,
            "no_defect_f1": 0.9504709814646004,
            "no_defect_tp": 1564,
            "no_defect_fp": 36,
            "no_defect_tn": 1548,
            "no_defect_fn": 127,
            "no_defect_support": 1691,
            "defect_precision": 0.924179104477612,
            "defect_recall": 0.9772727272727273,
            "defect_f1": 0.9499846578705125,
            "defect_tp": 1548,
            "defect_fp": 127,
            "defect_tn": 1564,
            "defect_fn": 36,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.953589931634276,
            "recall_macro": 0.9516563849613819,
            "f1_macro": 0.9522331225569612,
            "precision_micro": 0.9523664122137404,
            "recall_micro": 0.9523664122137404,
            "f1_micro": 0.9523664122137404,
            "accuracy": 0.9523664122137404,
            "hamming_loss": 0.04763358778625954,
            "no_defect_precision": 0.9368241320432555,
            "no_defect_recall": 0.9733885274985216,
            "no_defect_f1": 0.9547563805104409,
            "no_defect_tp": 1646,
            "no_defect_fp": 111,
            "no_defect_tn": 1473,
            "no_defect_fn": 45,
            "no_defect_support": 1691,
            "defect_precision": 0.9703557312252964,
            "defect_recall": 0.9299242424242424,
            "defect_f1": 0.9497098646034816,
            "defect_tp": 1473,
            "defect_fp": 45,
            "defect_tn": 1646,
            "defect_fn": 111,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9634729252666381,
            "recall_macro": 0.9631798096279173,
            "f1_macro": 0.9633086932068986,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9607038123167155,
            "no_defect_recall": 0.9686575990538143,
            "no_defect_f1": 0.9646643109540636,
            "no_defect_tp": 1638,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 53,
            "no_defect_support": 1691,
            "defect_precision": 0.9662420382165605,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9619530754597336,
            "defect_tp": 1517,
            "defect_fp": 53,
            "defect_tn": 1638,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9595564943103846,
            "recall_macro": 0.9598313486730103,
            "f1_macro": 0.9596648685203473,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9659294680215182,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9607609988109393,
            "no_defect_tp": 1616,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9531835205992509,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9585687382297552,
            "defect_tp": 1527,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9585015856018801,
            "recall_macro": 0.9565471017089882,
            "f1_macro": 0.9571322894741959,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9413773477518498,
            "no_defect_recall": 0.9781194559432289,
            "no_defect_f1": 0.9593967517401392,
            "no_defect_tp": 1654,
            "no_defect_fp": 103,
            "no_defect_tn": 1481,
            "no_defect_fn": 37,
            "no_defect_support": 1691,
            "defect_precision": 0.9756258234519104,
            "defect_recall": 0.9349747474747475,
            "defect_f1": 0.9548678272082527,
            "defect_tp": 1481,
            "defect_fp": 37,
            "defect_tn": 1654,
            "defect_fn": 103,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9607722911460692,
            "recall_macro": 0.9610939749356366,
            "f1_macro": 0.9608896850276161,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9682444577591373,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9619047619047619,
            "no_defect_tp": 1616,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9533001245330013,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9598746081504702,
            "defect_tp": 1531,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9635625316765606,
            "recall_macro": 0.9637151751100598,
            "f1_macro": 0.9636315568997111,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9673008323424495,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9647198339756893,
            "no_defect_tp": 1627,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.9598242310106717,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9625432798237331,
            "defect_tp": 1529,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 55,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623006323800996,
            "recall_macro": 0.9626123371503323,
            "f1_macro": 0.9624168321091106,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9694610778443113,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9634037488842606,
            "no_defect_tp": 1619,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9551401869158879,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9614299153339605,
            "defect_tp": 1533,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9622988603516689,
            "recall_macro": 0.9626323106881948,
            "f1_macro": 0.9624180242717102,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9700239808153477,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9633819589163441,
            "no_defect_tp": 1618,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.95457373988799,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9614540896270761,
            "defect_tp": 1534,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623301985370951,
            "recall_macro": 0.9625124694610205,
            "f1_macro": 0.9624104492465713,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9666666666666667,
            "no_defect_recall": 0.9603784742755765,
            "no_defect_f1": 0.9635123108869772,
            "no_defect_tp": 1624,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 67,
            "no_defect_support": 1691,
            "defect_precision": 0.9579937304075236,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9613085876061654,
            "defect_tp": 1528,
            "defect_fp": 67,
            "defect_tn": 1624,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9613945895522388,
            "recall_macro": 0.9616453939155003,
            "f1_macro": 0.9614969902990891,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9671641791044776,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9625668449197861,
            "no_defect_tp": 1620,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.955625,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.960427135678392,
            "defect_tp": 1529,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 55,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9661227611702468,
            "recall_macro": 0.9661086883596108,
            "f1_macro": 0.9661149144192763,
            "precision_micro": 0.9661172161172161,
            "recall_micro": 0.9661172161172161,
            "f1_micro": 0.9661172161172161,
            "accuracy": 0.9661172161172161,
            "hamming_loss": 0.03388278388278388,
            "no_defect_precision": 0.9655172413793104,
            "no_defect_recall": 0.9672727272727273,
            "no_defect_f1": 0.9663941871026339,
            "no_defect_tp": 1596,
            "no_defect_fp": 57,
            "no_defect_tn": 1569,
            "no_defect_fn": 54,
            "no_defect_support": 1650,
            "defect_precision": 0.966728280961183,
            "defect_recall": 0.9649446494464945,
            "defect_f1": 0.9658356417359187,
            "defect_tp": 1569,
            "defect_fp": 54,
            "defect_tn": 1596,
            "defect_fn": 57,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.1_s70_20251207_195542",
    "lr": 0.01,
    "weight_decay": 0.1,
    "seed": 70,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9636200413549278,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.1_s70_20251207_195542",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s70_20251207_195542",
      "timestamp": "2025-12-07T19:57:34.090083",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.1_s70",
          "seed": 70,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s70_20251207_195542"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9636935317987592,
        "recall_macro": 0.9635553868071609,
        "f1_macro": 0.9636200413549278,
        "precision_micro": 0.9636641221374046,
        "recall_micro": 0.9636641221374046,
        "f1_micro": 0.9636641221374046,
        "accuracy": 0.9636641221374046,
        "hamming_loss": 0.03633587786259542,
        "no_defect_precision": 0.9628975265017667,
        "no_defect_recall": 0.9668835008870491,
        "no_defect_f1": 0.964886397167306,
        "no_defect_tp": 1635,
        "no_defect_fp": 63,
        "no_defect_tn": 1521,
        "no_defect_fn": 56,
        "no_defect_support": 1691,
        "defect_precision": 0.9644895370957515,
        "defect_recall": 0.9602272727272727,
        "defect_f1": 0.9623536855425499,
        "defect_tp": 1521,
        "defect_fp": 56,
        "defect_tn": 1635,
        "defect_fn": 63,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9651952942719941,
        "recall_macro": 0.9652174885385217,
        "f1_macro": 0.9652006351146859,
        "precision_micro": 0.9652014652014652,
        "recall_micro": 0.9652014652014652,
        "f1_micro": 0.9652014652014652,
        "accuracy": 0.9652014652014652,
        "hamming_loss": 0.0347985347985348,
        "no_defect_precision": 0.9677222898903776,
        "no_defect_recall": 0.963030303030303,
        "no_defect_f1": 0.965370595382746,
        "no_defect_tp": 1589,
        "no_defect_fp": 53,
        "no_defect_tn": 1573,
        "no_defect_fn": 61,
        "no_defect_support": 1650,
        "defect_precision": 0.9626682986536108,
        "defect_recall": 0.9674046740467405,
        "defect_f1": 0.9650306748466257,
        "defect_tp": 1573,
        "defect_fp": 61,
        "defect_tn": 1589,
        "defect_fn": 53,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.39085836982876687,
          0.21672375852468123,
          0.19312169577412028,
          0.18461366733497156,
          0.18294291472584634,
          0.18831612338082063,
          0.17668031993084374,
          0.18035214632811905,
          0.18582328480656676,
          0.17954828008759968,
          0.17053435270569314,
          0.17303783917277427,
          0.17445909649632466,
          0.16436455024710261,
          0.16803504037183697
        ],
        "val_loss": [
          0.2877342632183662,
          0.1580148244706484,
          0.1344082716565866,
          0.12232023319945885,
          0.1362881943440208,
          0.12049640643482025,
          0.12491873329362044,
          0.11532480262506467,
          0.12435500560185084,
          0.12124745246882622,
          0.11927517947669213,
          0.11579502918399297,
          0.11835891294937867,
          0.11860402186329548,
          0.1182663942902134
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9185474168953811,
            "recall_macro": 0.9164144774175821,
            "f1_macro": 0.9169955653967206,
            "precision_micro": 0.9172519083969466,
            "recall_micro": 0.9172519083969466,
            "f1_micro": 0.9172519083969466,
            "accuracy": 0.9172519083969466,
            "hamming_loss": 0.08274809160305344,
            "no_defect_precision": 0.9020385050962627,
            "no_defect_recall": 0.9420461265523359,
            "no_defect_f1": 0.9216083309227654,
            "no_defect_tp": 1593,
            "no_defect_fp": 173,
            "no_defect_tn": 1411,
            "no_defect_fn": 98,
            "no_defect_support": 1691,
            "defect_precision": 0.9350563286944996,
            "defect_recall": 0.8907828282828283,
            "defect_f1": 0.9123827998706757,
            "defect_tp": 1411,
            "defect_fp": 98,
            "defect_tn": 1593,
            "defect_fn": 173,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9510293657730469,
            "recall_macro": 0.9511927002132502,
            "f1_macro": 0.9511021427712917,
            "precision_micro": 0.9511450381679389,
            "recall_micro": 0.9511450381679389,
            "f1_micro": 0.9511450381679389,
            "accuracy": 0.9511450381679389,
            "hamming_loss": 0.04885496183206107,
            "no_defect_precision": 0.9553837001784652,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9525504151838672,
            "no_defect_tp": 1606,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9466750313676286,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9496538703587162,
            "defect_tp": 1509,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954983611001485,
            "recall_macro": 0.9536501920446332,
            "f1_macro": 0.9540929724541014,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9425617461229179,
            "no_defect_recall": 0.9704316972205795,
            "no_defect_f1": 0.9562937062937062,
            "no_defect_tp": 1641,
            "no_defect_fp": 100,
            "no_defect_tn": 1484,
            "no_defect_fn": 50,
            "no_defect_support": 1691,
            "defect_precision": 0.9674054758800521,
            "defect_recall": 0.9368686868686869,
            "defect_f1": 0.9518922386144965,
            "defect_tp": 1484,
            "defect_fp": 50,
            "defect_tn": 1641,
            "defect_fn": 100,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.958052192747096,
            "recall_macro": 0.9576178326732733,
            "f1_macro": 0.957799134525098,
            "precision_micro": 0.9578625954198473,
            "recall_micro": 0.9578625954198473,
            "f1_micro": 0.9578625954198473,
            "accuracy": 0.9578625954198473,
            "hamming_loss": 0.04213740458015267,
            "no_defect_precision": 0.9538281706604325,
            "no_defect_recall": 0.9651094027202839,
            "no_defect_f1": 0.9594356261022927,
            "no_defect_tp": 1632,
            "no_defect_fp": 79,
            "no_defect_tn": 1505,
            "no_defect_fn": 59,
            "no_defect_support": 1691,
            "defect_precision": 0.9622762148337596,
            "defect_recall": 0.9501262626262627,
            "defect_f1": 0.9561626429479034,
            "defect_tp": 1505,
            "defect_fp": 59,
            "defect_tn": 1632,
            "defect_fn": 79,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9492564885968746,
            "recall_macro": 0.9443324432975527,
            "f1_macro": 0.9453723507534577,
            "precision_micro": 0.945648854961832,
            "recall_micro": 0.945648854961832,
            "f1_micro": 0.945648854961832,
            "accuracy": 0.945648854961832,
            "hamming_loss": 0.05435114503816794,
            "no_defect_precision": 0.9163456246560264,
            "no_defect_recall": 0.9846244825547014,
            "no_defect_f1": 0.9492588369441277,
            "no_defect_tp": 1665,
            "no_defect_fp": 152,
            "no_defect_tn": 1432,
            "no_defect_fn": 26,
            "no_defect_support": 1691,
            "defect_precision": 0.9821673525377229,
            "defect_recall": 0.9040404040404041,
            "defect_f1": 0.9414858645627876,
            "defect_tp": 1432,
            "defect_fp": 26,
            "defect_tn": 1665,
            "defect_fn": 152,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9562109154306757,
            "recall_macro": 0.9564190470643753,
            "f1_macro": 0.9562998767634596,
            "precision_micro": 0.9563358778625954,
            "recall_micro": 0.9563358778625954,
            "f1_micro": 0.9563358778625954,
            "accuracy": 0.9563358778625954,
            "hamming_loss": 0.04366412213740458,
            "no_defect_precision": 0.9612634088200238,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9575541703769664,
            "no_defect_tp": 1613,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9511584220413275,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9550455831499528,
            "defect_tp": 1519,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9562164331592928,
            "recall_macro": 0.9557838138929209,
            "f1_macro": 0.9559643142870589,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9520748100526009,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9576719576719577,
            "no_defect_tp": 1629,
            "no_defect_fp": 82,
            "no_defect_tn": 1502,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9603580562659847,
            "defect_recall": 0.9482323232323232,
            "defect_f1": 0.9542566709021602,
            "defect_tp": 1502,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 82,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9618221619790914,
            "recall_macro": 0.9612259496203908,
            "f1_macro": 0.961463161528048,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9557367501456028,
            "no_defect_recall": 0.9704316972205795,
            "no_defect_f1": 0.9630281690140845,
            "no_defect_tp": 1641,
            "no_defect_fp": 76,
            "no_defect_tn": 1508,
            "no_defect_fn": 50,
            "no_defect_support": 1691,
            "defect_precision": 0.9679075738125802,
            "defect_recall": 0.952020202020202,
            "defect_f1": 0.9598981540420115,
            "defect_tp": 1508,
            "defect_fp": 50,
            "defect_tn": 1641,
            "defect_fn": 76,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9592913752913753,
            "recall_macro": 0.9597553745617022,
            "f1_macro": 0.9593728130503955,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9721212121212122,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9601915594133493,
            "no_defect_tp": 1604,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9464615384615385,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9585540666874416,
            "defect_tp": 1538,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9571597307846942,
            "recall_macro": 0.9576256727535557,
            "f1_macro": 0.9572350625851102,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9702850212249848,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.9580838323353293,
            "no_defect_tp": 1600,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9440344403444034,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.956386292834891,
            "defect_tp": 1535,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.958079924791496,
            "recall_macro": 0.9558758415019504,
            "f1_macro": 0.9565113062187569,
            "precision_micro": 0.9566412213740458,
            "recall_micro": 0.9566412213740458,
            "f1_micro": 0.9566412213740458,
            "accuracy": 0.9566412213740458,
            "hamming_loss": 0.0433587786259542,
            "no_defect_precision": 0.9393079977311402,
            "no_defect_recall": 0.9793021880544057,
            "no_defect_f1": 0.9588882455124493,
            "no_defect_tp": 1656,
            "no_defect_fp": 107,
            "no_defect_tn": 1477,
            "no_defect_fn": 35,
            "no_defect_support": 1691,
            "defect_precision": 0.9768518518518519,
            "defect_recall": 0.9324494949494949,
            "defect_f1": 0.9541343669250646,
            "defect_tp": 1477,
            "defect_fp": 35,
            "defect_tn": 1656,
            "defect_fn": 107,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9636935317987592,
            "recall_macro": 0.9635553868071609,
            "f1_macro": 0.9636200413549278,
            "precision_micro": 0.9636641221374046,
            "recall_micro": 0.9636641221374046,
            "f1_micro": 0.9636641221374046,
            "accuracy": 0.9636641221374046,
            "hamming_loss": 0.03633587786259542,
            "no_defect_precision": 0.9628975265017667,
            "no_defect_recall": 0.9668835008870491,
            "no_defect_f1": 0.964886397167306,
            "no_defect_tp": 1635,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 56,
            "no_defect_support": 1691,
            "defect_precision": 0.9644895370957515,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9623536855425499,
            "defect_tp": 1521,
            "defect_fp": 56,
            "defect_tn": 1635,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626232253644427,
            "recall_macro": 0.9628480995645395,
            "f1_macro": 0.9627180279213092,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9677996422182469,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9637767220902613,
            "no_defect_tp": 1623,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9574468085106383,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.961659333752357,
            "defect_tp": 1530,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629093402432446,
            "recall_macro": 0.9632636238195079,
            "f1_macro": 0.9630302584192167,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9711884753901561,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9639559130175752,
            "no_defect_tp": 1618,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9546302050963331,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9621046038208582,
            "defect_tp": 1536,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626039344369932,
            "recall_macro": 0.9629479672538513,
            "f1_macro": 0.9627241495639038,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9706058788242351,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9636688505062537,
            "no_defect_tp": 1618,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9546019900497512,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.9617794486215538,
            "defect_tp": 1535,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 49,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9651952942719941,
            "recall_macro": 0.9652174885385217,
            "f1_macro": 0.9652006351146859,
            "precision_micro": 0.9652014652014652,
            "recall_micro": 0.9652014652014652,
            "f1_micro": 0.9652014652014652,
            "accuracy": 0.9652014652014652,
            "hamming_loss": 0.0347985347985348,
            "no_defect_precision": 0.9677222898903776,
            "no_defect_recall": 0.963030303030303,
            "no_defect_f1": 0.965370595382746,
            "no_defect_tp": 1589,
            "no_defect_fp": 53,
            "no_defect_tn": 1573,
            "no_defect_fn": 61,
            "no_defect_support": 1650,
            "defect_precision": 0.9626682986536108,
            "defect_recall": 0.9674046740467405,
            "defect_f1": 0.9650306748466257,
            "defect_tp": 1573,
            "defect_fp": 61,
            "defect_tn": 1589,
            "defect_fn": 53,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.1_s80_20251207_162424",
    "lr": 0.01,
    "weight_decay": 0.1,
    "seed": 80,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.962398772117937,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.1_s80_20251207_162424",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s80_20251207_162424",
      "timestamp": "2025-12-07T16:26:19.276813",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 10,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.1_s80",
          "seed": 80,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s80_20251207_162424"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.962449364895384,
        "recall_macro": 0.9623526811581218,
        "f1_macro": 0.962398772117937,
        "precision_micro": 0.962442748091603,
        "recall_micro": 0.962442748091603,
        "f1_micro": 0.962442748091603,
        "accuracy": 0.962442748091603,
        "hamming_loss": 0.03755725190839695,
        "no_defect_precision": 0.9622641509433962,
        "no_defect_recall": 0.9651094027202839,
        "no_defect_f1": 0.9636846767050488,
        "no_defect_tp": 1632,
        "no_defect_fp": 64,
        "no_defect_tn": 1520,
        "no_defect_fn": 59,
        "no_defect_support": 1691,
        "defect_precision": 0.9626345788473718,
        "defect_recall": 0.9595959595959596,
        "defect_f1": 0.9611128675308251,
        "defect_tp": 1520,
        "defect_fp": 59,
        "defect_tn": 1632,
        "defect_fn": 64,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9682628668385277,
        "recall_macro": 0.9682433187968243,
        "f1_macro": 0.968251648993905,
        "precision_micro": 0.9682539682539683,
        "recall_micro": 0.9682539682539683,
        "f1_micro": 0.9682539682539683,
        "accuracy": 0.9682539682539683,
        "hamming_loss": 0.031746031746031744,
        "no_defect_precision": 0.9673518742442564,
        "no_defect_recall": 0.9696969696969697,
        "no_defect_f1": 0.9685230024213075,
        "no_defect_tp": 1600,
        "no_defect_fp": 54,
        "no_defect_tn": 1572,
        "no_defect_fn": 50,
        "no_defect_support": 1650,
        "defect_precision": 0.969173859432799,
        "defect_recall": 0.966789667896679,
        "defect_f1": 0.9679802955665024,
        "defect_tp": 1572,
        "defect_fp": 50,
        "defect_tn": 1600,
        "defect_fn": 54,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.38692118327238567,
          0.21352158627126008,
          0.19234493390411514,
          0.19022005939832792,
          0.18887211410445648,
          0.18321555700137526,
          0.1818864264186456,
          0.17970360865403417,
          0.17521732147767455,
          0.17671304211706299,
          0.1723411354123299,
          0.1664157588362195,
          0.17078255238518056,
          0.17005922930572323,
          0.16558868871323734
        ],
        "val_loss": [
          0.28881037722413355,
          0.16144795443576115,
          0.13575430085452703,
          0.1212575939985422,
          0.12309730396820949,
          0.12305723510396022,
          0.13595732108045083,
          0.12668709385280424,
          0.11640665561963733,
          0.11512652741601834,
          0.11848476751206014,
          0.11971952930952494,
          0.11943891465377349,
          0.11667249015030953,
          0.11623724564336814
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9150009734570705,
            "recall_macro": 0.915407213769869,
            "f1_macro": 0.9147976894459353,
            "precision_micro": 0.9148091603053435,
            "recall_micro": 0.9148091603053435,
            "f1_micro": 0.9148091603053435,
            "accuracy": 0.9148091603053435,
            "hamming_loss": 0.08519083969465649,
            "no_defect_precision": 0.9352651048088779,
            "no_defect_recall": 0.8971023063276168,
            "no_defect_f1": 0.9157862964080894,
            "no_defect_tp": 1517,
            "no_defect_fp": 105,
            "no_defect_tn": 1479,
            "no_defect_fn": 174,
            "no_defect_support": 1691,
            "defect_precision": 0.8947368421052632,
            "defect_recall": 0.9337121212121212,
            "defect_f1": 0.9138090824837812,
            "defect_tp": 1479,
            "defect_fp": 174,
            "defect_tn": 1517,
            "defect_fn": 105,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9505393812052334,
            "recall_macro": 0.9510207784527713,
            "f1_macro": 0.9505213928878384,
            "precision_micro": 0.9505343511450381,
            "recall_micro": 0.9505343511450381,
            "f1_micro": 0.9505343511450381,
            "accuracy": 0.9505343511450381,
            "hamming_loss": 0.04946564885496183,
            "no_defect_precision": 0.9670128283445327,
            "no_defect_recall": 0.9361324659964518,
            "no_defect_f1": 0.9513221153846154,
            "no_defect_tp": 1583,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 108,
            "no_defect_support": 1691,
            "defect_precision": 0.9340659340659341,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9497206703910615,
            "defect_tp": 1530,
            "defect_fp": 108,
            "defect_tn": 1583,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9557202452743077,
            "recall_macro": 0.9562071782281717,
            "f1_macro": 0.9557131504734484,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9719169719169719,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9564433763893061,
            "no_defect_tp": 1592,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.9395235186316433,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9549829245575908,
            "defect_tp": 1538,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9595758305830091,
            "recall_macro": 0.9597714280594234,
            "f1_macro": 0.9596607132859303,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9642644431209053,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9608308605341246,
            "no_defect_tp": 1619,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9548872180451128,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9584905660377359,
            "defect_tp": 1524,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9595615671641791,
            "recall_macro": 0.959811375135148,
            "f1_macro": 0.9596635136466647,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9653731343283583,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9607843137254902,
            "no_defect_tp": 1617,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.95375,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9585427135678392,
            "defect_tp": 1526,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9592662195131962,
            "recall_macro": 0.9594757450316291,
            "f1_macro": 0.9593558294373437,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.964243146603099,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.960522410210745,
            "no_defect_tp": 1618,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9542892924232936,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9581892486639422,
            "defect_tp": 1524,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9527878895498535,
            "recall_macro": 0.9531344267631967,
            "f1_macro": 0.9523636363636363,
            "precision_micro": 0.9523664122137404,
            "recall_micro": 0.9523664122137404,
            "f1_micro": 0.9523664122137404,
            "accuracy": 0.9523664122137404,
            "hamming_loss": 0.04763358778625954,
            "no_defect_precision": 0.9770043505282784,
            "no_defect_recall": 0.9296274393849793,
            "no_defect_f1": 0.9527272727272728,
            "no_defect_tp": 1572,
            "no_defect_fp": 37,
            "no_defect_tn": 1547,
            "no_defect_fn": 119,
            "no_defect_support": 1691,
            "defect_precision": 0.9285714285714286,
            "defect_recall": 0.9766414141414141,
            "defect_f1": 0.952,
            "defect_tp": 1547,
            "defect_fp": 119,
            "defect_tn": 1572,
            "defect_fn": 37,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9573239589999716,
            "recall_macro": 0.9578054345943169,
            "f1_macro": 0.9572431023845387,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9754751686082158,
            "no_defect_recall": 0.9408633944411591,
            "no_defect_f1": 0.9578567128236002,
            "no_defect_tp": 1591,
            "no_defect_fp": 40,
            "no_defect_tn": 1544,
            "no_defect_fn": 100,
            "no_defect_support": 1691,
            "defect_precision": 0.9391727493917275,
            "defect_recall": 0.9747474747474747,
            "defect_f1": 0.9566294919454771,
            "defect_tp": 1544,
            "defect_fp": 100,
            "defect_tn": 1591,
            "defect_fn": 40,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.959024232908285,
            "recall_macro": 0.9590602207766608,
            "f1_macro": 0.9590418681052022,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9609236234458259,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9603550295857988,
            "no_defect_tp": 1623,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.957124842370744,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9577287066246056,
            "defect_tp": 1518,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962449364895384,
            "recall_macro": 0.9623526811581218,
            "f1_macro": 0.962398772117937,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9622641509433962,
            "no_defect_recall": 0.9651094027202839,
            "no_defect_f1": 0.9636846767050488,
            "no_defect_tp": 1632,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 59,
            "no_defect_support": 1691,
            "defect_precision": 0.9626345788473718,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9611128675308251,
            "defect_tp": 1520,
            "defect_fp": 59,
            "defect_tn": 1632,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9617532905271786,
            "recall_macro": 0.9618412092539828,
            "f1_macro": 0.9617950017083176,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9644128113879004,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9629848978383181,
            "no_defect_tp": 1626,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9590937696664569,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.960605105578317,
            "defect_tp": 1524,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604658519716152,
            "recall_macro": 0.9608182654457048,
            "f1_macro": 0.9605859779841236,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9687875150060024,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9615728328865059,
            "no_defect_tp": 1614,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9521441889372281,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9595991230817413,
            "defect_tp": 1532,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598585276219167,
            "recall_macro": 0.9602468729279787,
            "f1_macro": 0.9599772975354075,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9693140794223827,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9609305099910528,
            "no_defect_tp": 1611,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9504029758214507,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9590240850797622,
            "defect_tp": 1533,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9607835820895523,
            "recall_macro": 0.9610340543220496,
            "f1_macro": 0.9608858314149475,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9665671641791045,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9619726678550208,
            "no_defect_tp": 1619,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.955,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9597989949748744,
            "defect_tp": 1528,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9601869100983549,
            "recall_macro": 0.9603827676528741,
            "f1_macro": 0.9602719145997798,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9648600357355569,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9614243323442137,
            "no_defect_tp": 1620,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9555137844611529,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9591194968553459,
            "defect_tp": 1525,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 59,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9682628668385277,
            "recall_macro": 0.9682433187968243,
            "f1_macro": 0.968251648993905,
            "precision_micro": 0.9682539682539683,
            "recall_micro": 0.9682539682539683,
            "f1_micro": 0.9682539682539683,
            "accuracy": 0.9682539682539683,
            "hamming_loss": 0.031746031746031744,
            "no_defect_precision": 0.9673518742442564,
            "no_defect_recall": 0.9696969696969697,
            "no_defect_f1": 0.9685230024213075,
            "no_defect_tp": 1600,
            "no_defect_fp": 54,
            "no_defect_tn": 1572,
            "no_defect_fn": 50,
            "no_defect_support": 1650,
            "defect_precision": 0.969173859432799,
            "defect_recall": 0.966789667896679,
            "defect_f1": 0.9679802955665024,
            "defect_tp": 1572,
            "defect_fp": 50,
            "defect_tn": 1600,
            "defect_fn": 54,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.1_s90_20251207_134027",
    "lr": 0.01,
    "weight_decay": 0.1,
    "seed": 90,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9627217846221368,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.1_s90_20251207_134027",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s90_20251207_134027",
      "timestamp": "2025-12-07T13:42:18.166113",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 12,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.1_s90",
          "seed": 90,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s90_20251207_134027"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9626075072641556,
        "recall_macro": 0.9629080201781266,
        "f1_macro": 0.9627217846221368,
        "precision_micro": 0.9627480916030534,
        "recall_micro": 0.9627480916030534,
        "f1_micro": 0.9627480916030534,
        "accuracy": 0.9627480916030534,
        "hamming_loss": 0.037251908396946566,
        "no_defect_precision": 0.9694793536804309,
        "no_defect_recall": 0.9580130100532229,
        "no_defect_f1": 0.9637120761451516,
        "no_defect_tp": 1620,
        "no_defect_fp": 51,
        "no_defect_tn": 1533,
        "no_defect_fn": 71,
        "no_defect_support": 1691,
        "defect_precision": 0.9557356608478803,
        "defect_recall": 0.9678030303030303,
        "defect_f1": 0.9617314930991218,
        "defect_tp": 1533,
        "defect_fp": 71,
        "defect_tn": 1620,
        "defect_fn": 51,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9648901233449734,
        "recall_macro": 0.9649010399194902,
        "f1_macro": 0.9648947723737122,
        "precision_micro": 0.9648962148962149,
        "recall_micro": 0.9648962148962149,
        "f1_micro": 0.9648962148962149,
        "accuracy": 0.9648962148962149,
        "hamming_loss": 0.035103785103785104,
        "no_defect_precision": 0.9659987856709168,
        "no_defect_recall": 0.9642424242424242,
        "no_defect_f1": 0.9651198058841371,
        "no_defect_tp": 1591,
        "no_defect_fp": 56,
        "no_defect_tn": 1570,
        "no_defect_fn": 59,
        "no_defect_support": 1650,
        "defect_precision": 0.9637814610190301,
        "defect_recall": 0.965559655596556,
        "defect_f1": 0.9646697388632872,
        "defect_tp": 1570,
        "defect_fp": 59,
        "defect_tn": 1591,
        "defect_fn": 56,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.39341198007681377,
          0.2207842695226729,
          0.19458833364886718,
          0.18865451812120662,
          0.18523992205264678,
          0.18788916012856752,
          0.18292968057750658,
          0.1752683631452307,
          0.1767648054466088,
          0.17400313376071064,
          0.170435144219189,
          0.17489437715279008,
          0.16774651710583077,
          0.17134776714581326,
          0.17059556344937082
        ],
        "val_loss": [
          0.2885924354195595,
          0.1657421815280731,
          0.1304931978766735,
          0.1300905395585757,
          0.12881611839223367,
          0.12489139847457409,
          0.13027560008833042,
          0.13605387379916814,
          0.11982511270504731,
          0.11959215332395755,
          0.1143402813289028,
          0.11926119273098615,
          0.1157426182897045,
          0.12333152944651934,
          0.11941130416324505
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9215879353451565,
            "recall_macro": 0.9207776687633282,
            "f1_macro": 0.9210708913146313,
            "precision_micro": 0.9212213740458015,
            "recall_micro": 0.9212213740458015,
            "f1_micro": 0.9212213740458015,
            "accuracy": 0.9212213740458015,
            "hamming_loss": 0.07877862595419848,
            "no_defect_precision": 0.9148812970469021,
            "no_defect_recall": 0.9343583678296866,
            "no_defect_f1": 0.9245172615564657,
            "no_defect_tp": 1580,
            "no_defect_fp": 147,
            "no_defect_tn": 1437,
            "no_defect_fn": 111,
            "no_defect_support": 1691,
            "defect_precision": 0.9282945736434108,
            "defect_recall": 0.9071969696969697,
            "defect_f1": 0.9176245210727969,
            "defect_tp": 1437,
            "defect_fp": 111,
            "defect_tn": 1580,
            "defect_fn": 147,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9482499746335291,
            "recall_macro": 0.9486114471145517,
            "f1_macro": 0.9483661365443863,
            "precision_micro": 0.9483969465648855,
            "recall_micro": 0.9483969465648855,
            "f1_micro": 0.9483969465648855,
            "accuracy": 0.9483969465648855,
            "hamming_loss": 0.0516030534351145,
            "no_defect_precision": 0.9573317307692307,
            "no_defect_recall": 0.9420461265523359,
            "no_defect_f1": 0.9496274217585693,
            "no_defect_tp": 1593,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 98,
            "no_defect_support": 1691,
            "defect_precision": 0.9391682184978274,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.9471048513302034,
            "defect_tp": 1513,
            "defect_fp": 98,
            "defect_tn": 1593,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.957768401000511,
            "recall_macro": 0.9568267312390613,
            "f1_macro": 0.9571679464902938,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9485251590514748,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.9590643274853801,
            "no_defect_tp": 1640,
            "no_defect_fp": 89,
            "no_defect_tn": 1495,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.9670116429495472,
            "defect_recall": 0.9438131313131313,
            "defect_f1": 0.9552715654952076,
            "defect_tp": 1495,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 89,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9555832440370478,
            "recall_macro": 0.9558676280845115,
            "f1_macro": 0.9556932009228316,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9623205741626795,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9568837347606304,
            "no_defect_tp": 1609,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9488459139114162,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.954502667085033,
            "defect_tp": 1521,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9543496503496504,
            "recall_macro": 0.9548086572406502,
            "f1_macro": 0.9541912938001168,
            "precision_micro": 0.9541984732824428,
            "recall_micro": 0.9541984732824428,
            "f1_micro": 0.9541984732824428,
            "accuracy": 0.9541984732824428,
            "hamming_loss": 0.04580152671755725,
            "no_defect_precision": 0.9741538461538461,
            "no_defect_recall": 0.9361324659964518,
            "no_defect_f1": 0.9547647768395657,
            "no_defect_tp": 1583,
            "no_defect_fp": 42,
            "no_defect_tn": 1542,
            "no_defect_fn": 108,
            "no_defect_support": 1691,
            "defect_precision": 0.9345454545454546,
            "defect_recall": 0.9734848484848485,
            "defect_f1": 0.9536178107606679,
            "defect_tp": 1542,
            "defect_fp": 108,
            "defect_tn": 1583,
            "defect_fn": 42,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.954760870084643,
            "recall_macro": 0.954760870084643,
            "f1_macro": 0.954760870084643,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9562389118864577,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9562389118864577,
            "no_defect_tp": 1617,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9532828282828283,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9532828282828283,
            "defect_tp": 1510,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9530254129767217,
            "recall_macro": 0.9535060839022992,
            "f1_macro": 0.9529665705015582,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.9706062461726883,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.95367027677497,
            "no_defect_tp": 1585,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.9354445797807551,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9522628642281463,
            "defect_tp": 1536,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9513622126241581,
            "recall_macro": 0.9514801698236057,
            "f1_macro": 0.950534125160271,
            "precision_micro": 0.9505343511450381,
            "recall_micro": 0.9505343511450381,
            "f1_micro": 0.9505343511450381,
            "accuracy": 0.9505343511450381,
            "hamming_loss": 0.04946564885496183,
            "no_defect_precision": 0.9805153991200503,
            "no_defect_recall": 0.9225310467179184,
            "no_defect_f1": 0.9506398537477148,
            "no_defect_tp": 1560,
            "no_defect_fp": 31,
            "no_defect_tn": 1553,
            "no_defect_fn": 131,
            "no_defect_support": 1691,
            "defect_precision": 0.922209026128266,
            "defect_recall": 0.9804292929292929,
            "defect_f1": 0.9504283965728274,
            "defect_tp": 1553,
            "defect_fp": 131,
            "defect_tn": 1560,
            "defect_fn": 31,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9592452206584539,
            "recall_macro": 0.9596155597966657,
            "f1_macro": 0.9593650660378898,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9681490384615384,
            "no_defect_recall": 0.9526907155529273,
            "no_defect_f1": 0.9603576751117735,
            "no_defect_tp": 1611,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 80,
            "no_defect_support": 1691,
            "defect_precision": 0.9503414028553694,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9583724569640063,
            "defect_tp": 1531,
            "defect_fp": 80,
            "defect_tn": 1611,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9577270170507105,
            "recall_macro": 0.9581371446576947,
            "f1_macro": 0.9578404850746269,
            "precision_micro": 0.9578625954198473,
            "recall_micro": 0.9578625954198473,
            "f1_micro": 0.9578625954198473,
            "accuracy": 0.9578625954198473,
            "hamming_loss": 0.04213740458015267,
            "no_defect_precision": 0.9680530440024111,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9588059701492537,
            "no_defect_tp": 1606,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9474009900990099,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.956875,
            "defect_tp": 1531,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9619850801588381,
            "recall_macro": 0.9616215003374968,
            "f1_macro": 0.9617772658693555,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9584309133489461,
            "no_defect_recall": 0.9680662329982259,
            "no_defect_f1": 0.9632244777875846,
            "no_defect_tp": 1637,
            "no_defect_fp": 71,
            "no_defect_tn": 1513,
            "no_defect_fn": 54,
            "no_defect_support": 1691,
            "defect_precision": 0.9655392469687301,
            "defect_recall": 0.9551767676767676,
            "defect_f1": 0.9603300539511266,
            "defect_tp": 1513,
            "defect_fp": 54,
            "defect_tn": 1637,
            "defect_fn": 71,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626075072641556,
            "recall_macro": 0.9629080201781266,
            "f1_macro": 0.9627217846221368,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9694793536804309,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9637120761451516,
            "no_defect_tp": 1620,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9557356608478803,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9617314930991218,
            "defect_tp": 1533,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610001957330202,
            "recall_macro": 0.9607544247919766,
            "f1_macro": 0.9608643599044911,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9588960657662948,
            "no_defect_recall": 0.9657007687758723,
            "no_defect_f1": 0.9622863877430761,
            "no_defect_tp": 1633,
            "no_defect_fp": 70,
            "no_defect_tn": 1514,
            "no_defect_fn": 58,
            "no_defect_support": 1691,
            "defect_precision": 0.9631043256997456,
            "defect_recall": 0.9558080808080808,
            "defect_f1": 0.9594423320659062,
            "defect_tp": 1514,
            "defect_fp": 58,
            "defect_tn": 1633,
            "defect_fn": 70,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598820872063836,
            "recall_macro": 0.9603267670794282,
            "f1_macro": 0.9599817176543564,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.971584038694075,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9608370702541106,
            "no_defect_tp": 1607,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9481801357186922,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9591263650546021,
            "defect_tp": 1537,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9616879613919318,
            "recall_macro": 0.962020971094744,
            "f1_macro": 0.9618069352354779,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9694244604316546,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9627865436141709,
            "no_defect_tp": 1617,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9539514623522091,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9608273268567847,
            "defect_tp": 1533,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 51,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9648901233449734,
            "recall_macro": 0.9649010399194902,
            "f1_macro": 0.9648947723737122,
            "precision_micro": 0.9648962148962149,
            "recall_micro": 0.9648962148962149,
            "f1_micro": 0.9648962148962149,
            "accuracy": 0.9648962148962149,
            "hamming_loss": 0.035103785103785104,
            "no_defect_precision": 0.9659987856709168,
            "no_defect_recall": 0.9642424242424242,
            "no_defect_f1": 0.9651198058841371,
            "no_defect_tp": 1591,
            "no_defect_fp": 56,
            "no_defect_tn": 1570,
            "no_defect_fn": 59,
            "no_defect_support": 1650,
            "defect_precision": 0.9637814610190301,
            "defect_recall": 0.965559655596556,
            "defect_f1": 0.9646697388632872,
            "defect_tp": 1570,
            "defect_fp": 59,
            "defect_tn": 1591,
            "defect_fn": 56,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.1_s100_20251207_195305",
    "lr": 0.01,
    "weight_decay": 0.1,
    "seed": 100,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9623852894897034,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.1_s100_20251207_195305",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s100_20251207_195305",
      "timestamp": "2025-12-07T19:54:56.122148",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 8,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.1_s100",
          "seed": 100,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s100_20251207_195305"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.962657183346189,
        "recall_macro": 0.9621928928552228,
        "f1_macro": 0.9623852894897034,
        "precision_micro": 0.962442748091603,
        "recall_micro": 0.962442748091603,
        "f1_micro": 0.962442748091603,
        "accuracy": 0.962442748091603,
        "hamming_loss": 0.03755725190839695,
        "no_defect_precision": 0.9579439252336449,
        "no_defect_recall": 0.9698403311649911,
        "no_defect_f1": 0.963855421686747,
        "no_defect_tp": 1640,
        "no_defect_fp": 72,
        "no_defect_tn": 1512,
        "no_defect_fn": 51,
        "no_defect_support": 1691,
        "defect_precision": 0.9673704414587332,
        "defect_recall": 0.9545454545454546,
        "defect_f1": 0.9609151572926596,
        "defect_tp": 1512,
        "defect_fp": 51,
        "defect_tn": 1640,
        "defect_fn": 72,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9667280436099334,
        "recall_macro": 0.9667236945096724,
        "f1_macro": 0.966725778967085,
        "precision_micro": 0.9667277167277167,
        "recall_micro": 0.9667277167277167,
        "f1_micro": 0.9667277167277167,
        "accuracy": 0.9667277167277167,
        "hamming_loss": 0.03327228327228327,
        "no_defect_precision": 0.966686856450636,
        "no_defect_recall": 0.9672727272727273,
        "no_defect_f1": 0.9669797031202666,
        "no_defect_tp": 1596,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 54,
        "no_defect_support": 1650,
        "defect_precision": 0.9667692307692307,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.9664718548139034,
        "defect_tp": 1571,
        "defect_fp": 54,
        "defect_tn": 1596,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.3900924674761345,
          0.22282000275710637,
          0.18704672874765915,
          0.1833790177206614,
          0.18653125911327587,
          0.1851155039343874,
          0.1783609338042377,
          0.1825151463432791,
          0.1818844407609816,
          0.17171786248559234,
          0.17592343117527384,
          0.1727265348993086,
          0.17558766899934375,
          0.16694660360094893,
          0.16695547110116632
        ],
        "val_loss": [
          0.2870256287547258,
          0.1624629109238203,
          0.13364591972472575,
          0.12617636593775108,
          0.12922966136382177,
          0.12517808456546986,
          0.12221956281707837,
          0.11777020711451769,
          0.12208511415295877,
          0.12167536166424935,
          0.124901843472169,
          0.11967094328541023,
          0.12204227553537259,
          0.11670936063791697,
          0.11765639942425948
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9194879289065909,
            "recall_macro": 0.9177370242937954,
            "f1_macro": 0.9182477890651317,
            "precision_micro": 0.9184732824427481,
            "recall_micro": 0.9184732824427481,
            "f1_micro": 0.9184732824427481,
            "accuracy": 0.9184732824427481,
            "hamming_loss": 0.08152671755725191,
            "no_defect_precision": 0.9054669703872438,
            "no_defect_recall": 0.9402720283855707,
            "no_defect_f1": 0.9225413402959095,
            "no_defect_tp": 1590,
            "no_defect_fp": 166,
            "no_defect_tn": 1418,
            "no_defect_fn": 101,
            "no_defect_support": 1691,
            "defect_precision": 0.9335088874259381,
            "defect_recall": 0.8952020202020202,
            "defect_f1": 0.9139542378343538,
            "defect_tp": 1418,
            "defect_fp": 101,
            "defect_tn": 1590,
            "defect_fn": 166,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9492058853387555,
            "recall_macro": 0.9493387078950355,
            "f1_macro": 0.9492666172941997,
            "precision_micro": 0.9493129770992367,
            "recall_micro": 0.9493129770992367,
            "f1_micro": 0.9493129770992367,
            "accuracy": 0.9493129770992367,
            "hamming_loss": 0.05068702290076336,
            "no_defect_precision": 0.9530600118835413,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.950800237107291,
            "no_defect_tp": 1604,
            "no_defect_fp": 79,
            "no_defect_tn": 1505,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9453517587939698,
            "defect_recall": 0.9501262626262627,
            "defect_f1": 0.9477329974811083,
            "defect_tp": 1505,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 79,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9546791041936931,
            "recall_macro": 0.9551004202283031,
            "f1_macro": 0.9547866961882396,
            "precision_micro": 0.9548091603053435,
            "recall_micro": 0.9548091603053435,
            "f1_micro": 0.9548091603053435,
            "accuracy": 0.9548091603053435,
            "hamming_loss": 0.04519083969465649,
            "no_defect_precision": 0.9656004828002414,
            "no_defect_recall": 0.9461856889414547,
            "no_defect_f1": 0.955794504181601,
            "no_defect_tp": 1600,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 91,
            "no_defect_support": 1691,
            "defect_precision": 0.9437577255871447,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9537788881948782,
            "defect_tp": 1527,
            "defect_fp": 91,
            "defect_tn": 1600,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9550926475628908,
            "recall_macro": 0.9550365795745748,
            "f1_macro": 0.9550638095304766,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9557260920897285,
            "no_defect_recall": 0.9574216439976345,
            "no_defect_f1": 0.9565731166912851,
            "no_defect_tp": 1619,
            "no_defect_fp": 75,
            "no_defect_tn": 1509,
            "no_defect_fn": 72,
            "no_defect_support": 1691,
            "defect_precision": 0.9544592030360531,
            "defect_recall": 0.9526515151515151,
            "defect_f1": 0.9535545023696682,
            "defect_tp": 1509,
            "defect_fp": 72,
            "defect_tn": 1619,
            "defect_fn": 75,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9526140427036389,
            "recall_macro": 0.9530905596473308,
            "f1_macro": 0.9526558649135775,
            "precision_micro": 0.9526717557251908,
            "recall_micro": 0.9526717557251908,
            "f1_micro": 0.9526717557251908,
            "accuracy": 0.9526717557251908,
            "hamming_loss": 0.04732824427480916,
            "no_defect_precision": 0.9671532846715328,
            "no_defect_recall": 0.9402720283855707,
            "no_defect_f1": 0.9535232383808095,
            "no_defect_tp": 1590,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 101,
            "no_defect_support": 1691,
            "defect_precision": 0.9380748007357449,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9517884914463453,
            "defect_tp": 1530,
            "defect_fp": 101,
            "defect_tn": 1590,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556698336848786,
            "recall_macro": 0.9556878662437504,
            "f1_macro": 0.9556787605900813,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9573964497041421,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9571132800946466,
            "no_defect_tp": 1618,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9539432176656152,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.954244241085516,
            "defect_tp": 1512,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.956511425103673,
            "recall_macro": 0.9569344390086555,
            "f1_macro": 0.956619667964392,
            "precision_micro": 0.9566412213740458,
            "recall_micro": 0.9566412213740458,
            "f1_micro": 0.9566412213740458,
            "accuracy": 0.9566412213740458,
            "hamming_loss": 0.0433587786259542,
            "no_defect_precision": 0.9674109837054918,
            "no_defect_recall": 0.94795978710822,
            "no_defect_f1": 0.9575866188769414,
            "no_defect_tp": 1603,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 88,
            "no_defect_support": 1691,
            "defect_precision": 0.9456118665018541,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9556527170518426,
            "defect_tp": 1530,
            "defect_fp": 88,
            "defect_tn": 1603,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962657183346189,
            "recall_macro": 0.9621928928552228,
            "f1_macro": 0.9623852894897034,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9579439252336449,
            "no_defect_recall": 0.9698403311649911,
            "no_defect_f1": 0.963855421686747,
            "no_defect_tp": 1640,
            "no_defect_fp": 72,
            "no_defect_tn": 1512,
            "no_defect_fn": 51,
            "no_defect_support": 1691,
            "defect_precision": 0.9673704414587332,
            "defect_recall": 0.9545454545454546,
            "defect_f1": 0.9609151572926596,
            "defect_tp": 1512,
            "defect_fp": 51,
            "defect_tn": 1640,
            "defect_fn": 72,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.959919620881102,
            "recall_macro": 0.9600071904736305,
            "f1_macro": 0.9599611617903168,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9626334519572953,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9612081729345573,
            "no_defect_tp": 1623,
            "no_defect_fp": 63,
            "no_defect_tn": 1521,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9572057898049088,
            "defect_recall": 0.9602272727272727,
            "defect_f1": 0.9587141506460762,
            "defect_tp": 1521,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 63,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598552645127209,
            "recall_macro": 0.9601869523143918,
            "f1_macro": 0.9599736681267808,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9676258992805755,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.961000297707651,
            "no_defect_tp": 1614,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.9520846297448662,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9589470385459103,
            "defect_tp": 1530,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9574310796012329,
            "recall_macro": 0.9578614351677628,
            "f1_macro": 0.957536728199894,
            "precision_micro": 0.9575572519083969,
            "recall_micro": 0.9575572519083969,
            "f1_micro": 0.9575572519083969,
            "accuracy": 0.9575572519083969,
            "hamming_loss": 0.042442748091603054,
            "no_defect_precision": 0.9685990338164251,
            "no_defect_recall": 0.9485511531638084,
            "no_defect_f1": 0.9584702718852703,
            "no_defect_tp": 1604,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 87,
            "no_defect_support": 1691,
            "defect_precision": 0.9462631253860407,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9566031845145176,
            "defect_tp": 1532,
            "defect_fp": 87,
            "defect_tn": 1604,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598549799037079,
            "recall_macro": 0.9602069258522541,
            "f1_macro": 0.9599749078753503,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.968187274909964,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9609770628537384,
            "no_defect_tp": 1613,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9515226848974518,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9589727528969622,
            "defect_tp": 1531,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604849045006012,
            "recall_macro": 0.9609181331350167,
            "f1_macro": 0.9605916398401894,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9716183574879227,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9614580221093516,
            "no_defect_tp": 1609,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9493514515132798,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9597252575710271,
            "defect_tp": 1537,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9617674484929388,
            "recall_macro": 0.9618212357161204,
            "f1_macro": 0.961793532670531,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9638625592417062,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9630068067475585,
            "no_defect_tp": 1627,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.9596723377441714,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9605802585935036,
            "defect_tp": 1523,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 61,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610994019627086,
            "recall_macro": 0.9613097638119814,
            "f1_macro": 0.9611894010416739,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.966030989272944,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9623033541110122,
            "no_defect_tp": 1621,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9561678146524734,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9600754479723358,
            "defect_tp": 1527,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 57,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9667280436099334,
            "recall_macro": 0.9667236945096724,
            "f1_macro": 0.966725778967085,
            "precision_micro": 0.9667277167277167,
            "recall_micro": 0.9667277167277167,
            "f1_micro": 0.9667277167277167,
            "accuracy": 0.9667277167277167,
            "hamming_loss": 0.03327228327228327,
            "no_defect_precision": 0.966686856450636,
            "no_defect_recall": 0.9672727272727273,
            "no_defect_f1": 0.9669797031202666,
            "no_defect_tp": 1596,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 54,
            "no_defect_support": 1650,
            "defect_precision": 0.9667692307692307,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.9664718548139034,
            "defect_tp": 1571,
            "defect_fp": 54,
            "defect_tn": 1596,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.1_s110_20251207_195827",
    "lr": 0.01,
    "weight_decay": 0.1,
    "seed": 110,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9648413873978277,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.1_s110_20251207_195827",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s110_20251207_195827",
      "timestamp": "2025-12-07T20:00:18.277898",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 13,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.1_s110",
          "seed": 110,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s110_20251207_195827"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9649393090569561,
        "recall_macro": 0.9647580924562,
        "f1_macro": 0.9648413873978277,
        "precision_micro": 0.9648854961832061,
        "recall_micro": 0.9648854961832061,
        "f1_micro": 0.9648854961832061,
        "accuracy": 0.9648854961832061,
        "hamming_loss": 0.035114503816793895,
        "no_defect_precision": 0.9635294117647059,
        "no_defect_recall": 0.9686575990538143,
        "no_defect_f1": 0.9660867000884695,
        "no_defect_tp": 1638,
        "no_defect_fp": 62,
        "no_defect_tn": 1522,
        "no_defect_fn": 53,
        "no_defect_support": 1691,
        "defect_precision": 0.9663492063492064,
        "defect_recall": 0.9608585858585859,
        "defect_f1": 0.9635960747071858,
        "defect_tp": 1522,
        "defect_fp": 53,
        "defect_tn": 1638,
        "defect_fn": 62,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9673321995122557,
        "recall_macro": 0.9673431734317344,
        "f1_macro": 0.9673368751651061,
        "precision_micro": 0.9673382173382173,
        "recall_micro": 0.9673382173382173,
        "f1_micro": 0.9673382173382173,
        "accuracy": 0.9673382173382173,
        "hamming_loss": 0.032661782661782664,
        "no_defect_precision": 0.9684274438372799,
        "no_defect_recall": 0.9666666666666667,
        "no_defect_f1": 0.967546254170458,
        "no_defect_tp": 1595,
        "no_defect_fp": 52,
        "no_defect_tn": 1574,
        "no_defect_fn": 55,
        "no_defect_support": 1650,
        "defect_precision": 0.9662369551872314,
        "defect_recall": 0.968019680196802,
        "defect_f1": 0.9671274961597542,
        "defect_tp": 1574,
        "defect_fp": 55,
        "defect_tn": 1595,
        "defect_fn": 52,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.39517950612630803,
          0.2203912866539536,
          0.19138519593736616,
          0.1874632725967523,
          0.1823493199555445,
          0.18142107637232815,
          0.1864021562320418,
          0.17816301165577259,
          0.17405835091755978,
          0.17784979057237194,
          0.17138672997263185,
          0.16989898560062114,
          0.1670999643100605,
          0.1728253071215861,
          0.1738732499557559
        ],
        "val_loss": [
          0.28959219043071455,
          0.15962633834435389,
          0.1314175924142966,
          0.12051266625237006,
          0.1301473452924536,
          0.1268691960722208,
          0.11898353115583842,
          0.12926589683271372,
          0.11921783407720235,
          0.12457755387115937,
          0.11789514511250533,
          0.12046172720595048,
          0.11384025316398877,
          0.11648667904619987,
          0.11673724235823521
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9179573972758706,
            "recall_macro": 0.9166341863340681,
            "f1_macro": 0.917053932116981,
            "precision_micro": 0.9172519083969466,
            "recall_micro": 0.9172519083969466,
            "f1_micro": 0.9172519083969466,
            "accuracy": 0.9172519083969466,
            "hamming_loss": 0.08274809160305344,
            "no_defect_precision": 0.9071100917431193,
            "no_defect_recall": 0.9355410999408634,
            "no_defect_f1": 0.9211062590975255,
            "no_defect_tp": 1582,
            "no_defect_fp": 162,
            "no_defect_tn": 1422,
            "no_defect_fn": 109,
            "no_defect_support": 1691,
            "defect_precision": 0.9288047028086218,
            "defect_recall": 0.8977272727272727,
            "defect_f1": 0.9130016051364366,
            "defect_tp": 1422,
            "defect_fp": 109,
            "defect_tn": 1582,
            "defect_fn": 162,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9507286262057619,
            "recall_macro": 0.9508770436475936,
            "f1_macro": 0.9507956358054916,
            "precision_micro": 0.9508396946564885,
            "recall_micro": 0.9508396946564885,
            "f1_micro": 0.9508396946564885,
            "accuracy": 0.9508396946564885,
            "hamming_loss": 0.04916030534351145,
            "no_defect_precision": 0.9548156956004756,
            "no_defect_recall": 0.9497338852749853,
            "no_defect_f1": 0.9522680106729914,
            "no_defect_tp": 1606,
            "no_defect_fp": 76,
            "no_defect_tn": 1508,
            "no_defect_fn": 85,
            "no_defect_support": 1691,
            "defect_precision": 0.9466415568110483,
            "defect_recall": 0.952020202020202,
            "defect_f1": 0.9493232609379918,
            "defect_tp": 1508,
            "defect_fp": 85,
            "defect_tn": 1606,
            "defect_fn": 76,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9539423154660845,
            "recall_macro": 0.952783116499113,
            "f1_macro": 0.9531815915147468,
            "precision_micro": 0.9532824427480916,
            "recall_micro": 0.9532824427480916,
            "f1_micro": 0.9532824427480916,
            "accuracy": 0.9532824427480916,
            "hamming_loss": 0.0467175572519084,
            "no_defect_precision": 0.9429723502304147,
            "no_defect_recall": 0.9680662329982259,
            "no_defect_f1": 0.9553545374963525,
            "no_defect_tp": 1637,
            "no_defect_fp": 99,
            "no_defect_tn": 1485,
            "no_defect_fn": 54,
            "no_defect_support": 1691,
            "defect_precision": 0.9649122807017544,
            "defect_recall": 0.9375,
            "defect_f1": 0.9510086455331412,
            "defect_tp": 1485,
            "defect_fp": 54,
            "defect_tn": 1637,
            "defect_fn": 99,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9590095917962072,
            "recall_macro": 0.9590801943145231,
            "f1_macro": 0.9590434582645514,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9614700652045051,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9603315571343991,
            "no_defect_tp": 1622,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9565491183879093,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9577553593947037,
            "defect_tp": 1519,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.95806993006993,
            "recall_macro": 0.9585326953748006,
            "f1_macro": 0.9581509427661968,
            "precision_micro": 0.9581679389312977,
            "recall_micro": 0.9581679389312977,
            "f1_micro": 0.9581679389312977,
            "accuracy": 0.9581679389312977,
            "hamming_loss": 0.04183206106870229,
            "no_defect_precision": 0.9709090909090909,
            "no_defect_recall": 0.9473684210526315,
            "no_defect_f1": 0.9589943130799162,
            "no_defect_tp": 1602,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 89,
            "no_defect_support": 1691,
            "defect_precision": 0.9452307692307692,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9573075724524774,
            "defect_tp": 1536,
            "defect_fp": 89,
            "defect_tn": 1602,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9559652786842449,
            "recall_macro": 0.9564429406423789,
            "f1_macro": 0.9560152748989359,
            "precision_micro": 0.956030534351145,
            "recall_micro": 0.956030534351145,
            "f1_micro": 0.956030534351145,
            "accuracy": 0.956030534351145,
            "hamming_loss": 0.04396946564885496,
            "no_defect_precision": 0.9702127659574468,
            "no_defect_recall": 0.9438202247191011,
            "no_defect_f1": 0.9568345323741008,
            "no_defect_tp": 1596,
            "no_defect_fp": 49,
            "no_defect_tn": 1535,
            "no_defect_fn": 95,
            "no_defect_support": 1691,
            "defect_precision": 0.941717791411043,
            "defect_recall": 0.9690656565656566,
            "defect_f1": 0.955196017423771,
            "defect_tp": 1535,
            "defect_fp": 95,
            "defect_tn": 1596,
            "defect_fn": 49,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.960614962598731,
            "recall_macro": 0.9605186623777695,
            "f1_macro": 0.9605645658797874,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9604952830188679,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9619131975199291,
            "no_defect_tp": 1629,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9607346421785941,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9592159342396459,
            "defect_tp": 1517,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9554248778439371,
            "recall_macro": 0.9559114952003775,
            "f1_macro": 0.9554081688989161,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9718998167379352,
            "no_defect_recall": 0.9408633944411591,
            "no_defect_f1": 0.9561298076923077,
            "no_defect_tp": 1591,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 100,
            "no_defect_support": 1691,
            "defect_precision": 0.938949938949939,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9546865301055245,
            "defect_tp": 1538,
            "defect_fp": 100,
            "defect_tn": 1591,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.960891803312965,
            "recall_macro": 0.9608542924812884,
            "f1_macro": 0.9608726883897916,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9616066154754873,
            "no_defect_recall": 0.9627439384979303,
            "no_defect_f1": 0.9621749408983451,
            "no_defect_tp": 1628,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 63,
            "no_defect_support": 1691,
            "defect_precision": 0.9601769911504425,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9595704358812381,
            "defect_tp": 1519,
            "defect_fp": 63,
            "defect_tn": 1628,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9589704628508642,
            "recall_macro": 0.9594197444581833,
            "f1_macro": 0.9590657991743949,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9709618874773139,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9599282296650717,
            "no_defect_tp": 1605,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9469790382244143,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.958203368683718,
            "defect_tp": 1536,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623142298065169,
            "recall_macro": 0.9625524165367454,
            "f1_macro": 0.9624130868240199,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9677804295942721,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9634689634689635,
            "no_defect_tp": 1622,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9568480300187617,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9613572101790764,
            "defect_tp": 1530,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9616999118980853,
            "recall_macro": 0.9621208387840559,
            "f1_macro": 0.9618125643589468,
            "precision_micro": 0.9618320610687023,
            "recall_micro": 0.9618320610687023,
            "f1_micro": 0.9618320610687023,
            "accuracy": 0.9618320610687023,
            "hamming_loss": 0.03816793893129771,
            "no_defect_precision": 0.9722557297949337,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9626754255001493,
            "no_defect_tp": 1612,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9511440940012369,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9609497032177444,
            "defect_tp": 1538,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9649393090569561,
            "recall_macro": 0.9647580924562,
            "f1_macro": 0.9648413873978277,
            "precision_micro": 0.9648854961832061,
            "recall_micro": 0.9648854961832061,
            "f1_micro": 0.9648854961832061,
            "accuracy": 0.9648854961832061,
            "hamming_loss": 0.035114503816793895,
            "no_defect_precision": 0.9635294117647059,
            "no_defect_recall": 0.9686575990538143,
            "no_defect_f1": 0.9660867000884695,
            "no_defect_tp": 1638,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 53,
            "no_defect_support": 1691,
            "defect_precision": 0.9663492063492064,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9635960747071858,
            "defect_tp": 1522,
            "defect_fp": 53,
            "defect_tn": 1638,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629093402432446,
            "recall_macro": 0.9632636238195079,
            "f1_macro": 0.9630302584192167,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9711884753901561,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9639559130175752,
            "no_defect_tp": 1618,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9546302050963331,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9621046038208582,
            "defect_tp": 1536,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629093402432446,
            "recall_macro": 0.9632636238195079,
            "f1_macro": 0.9630302584192167,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9711884753901561,
            "no_defect_recall": 0.9568302779420461,
            "no_defect_f1": 0.9639559130175752,
            "no_defect_tp": 1618,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 73,
            "no_defect_support": 1691,
            "defect_precision": 0.9546302050963331,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9621046038208582,
            "defect_tp": 1536,
            "defect_fp": 73,
            "defect_tn": 1618,
            "defect_fn": 48,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9673321995122557,
            "recall_macro": 0.9673431734317344,
            "f1_macro": 0.9673368751651061,
            "precision_micro": 0.9673382173382173,
            "recall_micro": 0.9673382173382173,
            "f1_micro": 0.9673382173382173,
            "accuracy": 0.9673382173382173,
            "hamming_loss": 0.032661782661782664,
            "no_defect_precision": 0.9684274438372799,
            "no_defect_recall": 0.9666666666666667,
            "no_defect_f1": 0.967546254170458,
            "no_defect_tp": 1595,
            "no_defect_fp": 52,
            "no_defect_tn": 1574,
            "no_defect_fn": 55,
            "no_defect_support": 1650,
            "defect_precision": 0.9662369551872314,
            "defect_recall": 0.968019680196802,
            "defect_f1": 0.9671274961597542,
            "defect_tp": 1574,
            "defect_fp": 55,
            "defect_tn": 1595,
            "defect_fn": 52,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.1_s120_20251207_135841",
    "lr": 0.01,
    "weight_decay": 0.1,
    "seed": 120,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9639265196881205,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.1_s120_20251207_135841",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s120_20251207_135841",
      "timestamp": "2025-12-07T14:00:37.074750",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 14,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.1_s120",
          "seed": 120,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s120_20251207_135841"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9639884893418864,
        "recall_macro": 0.9638710433728175,
        "f1_macro": 0.9639265196881205,
        "precision_micro": 0.963969465648855,
        "recall_micro": 0.963969465648855,
        "f1_micro": 0.963969465648855,
        "accuracy": 0.963969465648855,
        "hamming_loss": 0.03603053435114504,
        "no_defect_precision": 0.9634649381261049,
        "no_defect_recall": 0.9668835008870491,
        "no_defect_f1": 0.9651711924439197,
        "no_defect_tp": 1635,
        "no_defect_fp": 62,
        "no_defect_tn": 1522,
        "no_defect_fn": 56,
        "no_defect_support": 1691,
        "defect_precision": 0.9645120405576679,
        "defect_recall": 0.9608585858585859,
        "defect_f1": 0.9626818469323213,
        "defect_tp": 1522,
        "defect_fp": 56,
        "defect_tn": 1635,
        "defect_fn": 62,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9661576915692922,
        "recall_macro": 0.9660907972716091,
        "f1_macro": 0.9661133482018509,
        "precision_micro": 0.9661172161172161,
        "recall_micro": 0.9661172161172161,
        "f1_micro": 0.9661172161172161,
        "accuracy": 0.9661172161172161,
        "hamming_loss": 0.03388278388278388,
        "no_defect_precision": 0.963275135460566,
        "no_defect_recall": 0.9696969696969697,
        "no_defect_f1": 0.9664753850800363,
        "no_defect_tp": 1600,
        "no_defect_fp": 61,
        "no_defect_tn": 1565,
        "no_defect_fn": 50,
        "no_defect_support": 1650,
        "defect_precision": 0.9690402476780186,
        "defect_recall": 0.9624846248462484,
        "defect_f1": 0.9657513113236655,
        "defect_tp": 1565,
        "defect_fp": 50,
        "defect_tn": 1600,
        "defect_fn": 61,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.3902457550355081,
          0.2192044671172876,
          0.199125237762928,
          0.19015764847210762,
          0.1943737791079607,
          0.18377976660386788,
          0.1856488979822921,
          0.17707778864138796,
          0.1756722471953436,
          0.17601009785630214,
          0.1719836193023865,
          0.16910810771721677,
          0.17199092548512016,
          0.17121762819744055,
          0.1684090757438578
        ],
        "val_loss": [
          0.2893534852908208,
          0.15332590473385957,
          0.1389500910702806,
          0.1294008827266785,
          0.12075137619215709,
          0.12766747276943463,
          0.11754360400999968,
          0.11483646707179454,
          0.13781121473472852,
          0.12177776301709506,
          0.12090901443018363,
          0.11822159237299974,
          0.11725323439504091,
          0.11572139645711733,
          0.11615719667707498
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9238309822361547,
            "recall_macro": 0.9239980750736221,
            "f1_macro": 0.9239040801820834,
            "precision_micro": 0.923969465648855,
            "recall_micro": 0.923969465648855,
            "f1_micro": 0.923969465648855,
            "accuracy": 0.923969465648855,
            "hamming_loss": 0.07603053435114504,
            "no_defect_precision": 0.9291666666666667,
            "no_defect_recall": 0.9231224127735068,
            "no_defect_f1": 0.9261346781370513,
            "no_defect_tp": 1561,
            "no_defect_fp": 119,
            "no_defect_tn": 1465,
            "no_defect_fn": 130,
            "no_defect_support": 1691,
            "defect_precision": 0.9184952978056427,
            "defect_recall": 0.9248737373737373,
            "defect_f1": 0.9216734822271154,
            "defect_tp": 1465,
            "defect_fp": 130,
            "defect_tn": 1561,
            "defect_fn": 119,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9533987844787284,
            "recall_macro": 0.9525873011606305,
            "f1_macro": 0.9528897758063335,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.9455072463768116,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9549180327868853,
            "no_defect_tp": 1631,
            "no_defect_fp": 94,
            "no_defect_tn": 1490,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9612903225806452,
            "defect_recall": 0.9406565656565656,
            "defect_f1": 0.9508615188257817,
            "defect_tp": 1490,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 94,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.951533903390339,
            "recall_macro": 0.9494867360775108,
            "f1_macro": 0.9500848508445672,
            "precision_micro": 0.9502290076335878,
            "recall_micro": 0.9502290076335878,
            "f1_micro": 0.9502290076335878,
            "accuracy": 0.9502290076335878,
            "hamming_loss": 0.04977099236641221,
            "no_defect_precision": 0.9340909090909091,
            "no_defect_recall": 0.9722057953873448,
            "no_defect_f1": 0.9527673138220806,
            "no_defect_tp": 1644,
            "no_defect_fp": 116,
            "no_defect_tn": 1468,
            "no_defect_fn": 47,
            "no_defect_support": 1691,
            "defect_precision": 0.968976897689769,
            "defect_recall": 0.9267676767676768,
            "defect_f1": 0.9474023878670539,
            "defect_tp": 1468,
            "defect_fp": 47,
            "defect_tn": 1644,
            "defect_fn": 116,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9568740783505524,
            "recall_macro": 0.9573499632636238,
            "f1_macro": 0.9569311292592154,
            "precision_micro": 0.9569465648854962,
            "recall_micro": 0.9569465648854962,
            "f1_micro": 0.9569465648854962,
            "accuracy": 0.9569465648854962,
            "hamming_loss": 0.04305343511450382,
            "no_defect_precision": 0.9708383961117861,
            "no_defect_recall": 0.9450029568302779,
            "no_defect_f1": 0.9577464788732394,
            "no_defect_tp": 1598,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 93,
            "no_defect_support": 1691,
            "defect_precision": 0.9429097605893186,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9561157796451915,
            "defect_tp": 1536,
            "defect_fp": 93,
            "defect_tn": 1598,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9612698412698413,
            "recall_macro": 0.9610900548954955,
            "f1_macro": 0.9611726626045575,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.96,
            "no_defect_recall": 0.9651094027202839,
            "no_defect_f1": 0.9625479209672663,
            "no_defect_tp": 1632,
            "no_defect_fp": 68,
            "no_defect_tn": 1516,
            "no_defect_fn": 59,
            "no_defect_support": 1691,
            "defect_precision": 0.9625396825396826,
            "defect_recall": 0.9570707070707071,
            "defect_f1": 0.9597974042418487,
            "defect_tp": 1516,
            "defect_fp": 59,
            "defect_tn": 1632,
            "defect_fn": 68,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9550419679159702,
            "recall_macro": 0.9555159444832715,
            "f1_macro": 0.9550984113553522,
            "precision_micro": 0.9551145038167939,
            "recall_micro": 0.9551145038167939,
            "f1_micro": 0.9551145038167939,
            "accuracy": 0.9551145038167939,
            "hamming_loss": 0.04488549618320611,
            "no_defect_precision": 0.9690157958687727,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9559484566976326,
            "no_defect_tp": 1595,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9410681399631676,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.954248366013072,
            "defect_tp": 1533,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9586459981514264,
            "recall_macro": 0.9590641408168019,
            "f1_macro": 0.9587575695076627,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.9692400482509047,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9596894595401613,
            "no_defect_tp": 1607,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.948051948051948,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9578256794751641,
            "defect_tp": 1533,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9607614379719895,
            "recall_macro": 0.9603988211505953,
            "f1_macro": 0.960554138377175,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9572599531615925,
            "no_defect_recall": 0.9668835008870491,
            "no_defect_f1": 0.9620476610767873,
            "no_defect_tp": 1635,
            "no_defect_fp": 73,
            "no_defect_tn": 1511,
            "no_defect_fn": 56,
            "no_defect_support": 1691,
            "defect_precision": 0.9642629227823867,
            "defect_recall": 0.9539141414141414,
            "defect_f1": 0.9590606156775627,
            "defect_tp": 1511,
            "defect_fp": 56,
            "defect_tn": 1635,
            "defect_fn": 73,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9510362452664765,
            "recall_macro": 0.9513403550585691,
            "f1_macro": 0.9505323172077981,
            "precision_micro": 0.9505343511450381,
            "recall_micro": 0.9505343511450381,
            "f1_micro": 0.9505343511450381,
            "accuracy": 0.9505343511450381,
            "hamming_loss": 0.04946564885496183,
            "no_defect_precision": 0.9763239875389408,
            "no_defect_recall": 0.9266706091070372,
            "no_defect_f1": 0.9508495145631068,
            "no_defect_tp": 1567,
            "no_defect_fp": 38,
            "no_defect_tn": 1546,
            "no_defect_fn": 124,
            "no_defect_support": 1691,
            "defect_precision": 0.925748502994012,
            "defect_recall": 0.976010101010101,
            "defect_f1": 0.9502151198524893,
            "defect_tp": 1546,
            "defect_fp": 124,
            "defect_tn": 1567,
            "defect_fn": 38,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9592567809007582,
            "recall_macro": 0.9596754804102527,
            "f1_macro": 0.9593685684779194,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9698431845597105,
            "no_defect_recall": 0.9509166173861621,
            "no_defect_f1": 0.9602866527321589,
            "no_defect_tp": 1608,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 83,
            "no_defect_support": 1691,
            "defect_precision": 0.9486703772418058,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9584504842236801,
            "defect_tp": 1534,
            "defect_fp": 83,
            "defect_tn": 1608,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610770624321949,
            "recall_macro": 0.9614096315012932,
            "f1_macro": 0.9611958461992454,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9688249400479616,
            "no_defect_recall": 0.9556475458308693,
            "no_defect_f1": 0.9621911283119976,
            "no_defect_tp": 1616,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 75,
            "no_defect_support": 1691,
            "defect_precision": 0.9533291848164281,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9602005640864932,
            "defect_tp": 1532,
            "defect_fp": 75,
            "defect_tn": 1616,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9607746791011699,
            "recall_macro": 0.9610740013977743,
            "f1_macro": 0.9608884297674877,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9676840215439856,
            "no_defect_recall": 0.9562389118864577,
            "no_defect_f1": 0.9619274241522903,
            "no_defect_tp": 1617,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 74,
            "no_defect_support": 1691,
            "defect_precision": 0.9538653366583542,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9598494353826851,
            "defect_tp": 1530,
            "defect_fp": 74,
            "defect_tn": 1617,
            "defect_fn": 54,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9610994019627086,
            "recall_macro": 0.9613097638119814,
            "f1_macro": 0.9611894010416739,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.966030989272944,
            "no_defect_recall": 0.9586043761088113,
            "no_defect_f1": 0.9623033541110122,
            "no_defect_tp": 1621,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 70,
            "no_defect_support": 1691,
            "defect_precision": 0.9561678146524734,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.9600754479723358,
            "defect_tp": 1527,
            "defect_fp": 70,
            "defect_tn": 1621,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9639884893418864,
            "recall_macro": 0.9638710433728175,
            "f1_macro": 0.9639265196881205,
            "precision_micro": 0.963969465648855,
            "recall_micro": 0.963969465648855,
            "f1_micro": 0.963969465648855,
            "accuracy": 0.963969465648855,
            "hamming_loss": 0.03603053435114504,
            "no_defect_precision": 0.9634649381261049,
            "no_defect_recall": 0.9668835008870491,
            "no_defect_f1": 0.9651711924439197,
            "no_defect_tp": 1635,
            "no_defect_fp": 62,
            "no_defect_tn": 1522,
            "no_defect_fn": 56,
            "no_defect_support": 1691,
            "defect_precision": 0.9645120405576679,
            "defect_recall": 0.9608585858585859,
            "defect_f1": 0.9626818469323213,
            "defect_tp": 1522,
            "defect_fp": 56,
            "defect_tn": 1635,
            "defect_fn": 62,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9623943031004424,
            "recall_macro": 0.9624126017717088,
            "f1_macro": 0.9624033624315862,
            "precision_micro": 0.962442748091603,
            "recall_micro": 0.962442748091603,
            "f1_micro": 0.962442748091603,
            "accuracy": 0.962442748091603,
            "hamming_loss": 0.03755725190839695,
            "no_defect_precision": 0.9639053254437869,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.963620230700976,
            "no_defect_tp": 1629,
            "no_defect_fp": 61,
            "no_defect_tn": 1523,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9608832807570978,
            "defect_recall": 0.961489898989899,
            "defect_f1": 0.9611864941621963,
            "defect_tp": 1523,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 61,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9661576915692922,
            "recall_macro": 0.9660907972716091,
            "f1_macro": 0.9661133482018509,
            "precision_micro": 0.9661172161172161,
            "recall_micro": 0.9661172161172161,
            "f1_micro": 0.9661172161172161,
            "accuracy": 0.9661172161172161,
            "hamming_loss": 0.03388278388278388,
            "no_defect_precision": 0.963275135460566,
            "no_defect_recall": 0.9696969696969697,
            "no_defect_f1": 0.9664753850800363,
            "no_defect_tp": 1600,
            "no_defect_fp": 61,
            "no_defect_tn": 1565,
            "no_defect_fn": 50,
            "no_defect_support": 1650,
            "defect_precision": 0.9690402476780186,
            "defect_recall": 0.9624846248462484,
            "defect_f1": 0.9657513113236655,
            "defect_tp": 1565,
            "defect_fp": 50,
            "defect_tn": 1600,
            "defect_fn": 61,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.1_s130_20251207_184144",
    "lr": 0.01,
    "weight_decay": 0.1,
    "seed": 130,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9633279211690275,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.1_s130_20251207_184144",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s130_20251207_184144",
      "timestamp": "2025-12-07T18:43:39.363566",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 15,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.1_s130",
          "seed": 130,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s130_20251207_184144"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9632423076750841,
        "recall_macro": 0.9634394656201279,
        "f1_macro": 0.9633279211690275,
        "precision_micro": 0.9633587786259542,
        "recall_micro": 0.9633587786259542,
        "f1_micro": 0.9633587786259542,
        "accuracy": 0.9633587786259542,
        "hamming_loss": 0.0366412213740458,
        "no_defect_precision": 0.9678379988088148,
        "no_defect_recall": 0.960969840331165,
        "no_defect_f1": 0.9643916913946587,
        "no_defect_tp": 1625,
        "no_defect_fp": 54,
        "no_defect_tn": 1530,
        "no_defect_fn": 66,
        "no_defect_support": 1691,
        "defect_precision": 0.9586466165413534,
        "defect_recall": 0.9659090909090909,
        "defect_f1": 0.9622641509433962,
        "defect_tp": 1530,
        "defect_fp": 66,
        "defect_tn": 1625,
        "defect_fn": 54,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9679611071454531,
        "recall_macro": 0.9679358157217937,
        "f1_macro": 0.9679462061337196,
        "precision_micro": 0.967948717948718,
        "recall_micro": 0.967948717948718,
        "f1_micro": 0.967948717948718,
        "accuracy": 0.967948717948718,
        "hamming_loss": 0.03205128205128205,
        "no_defect_precision": 0.9667673716012085,
        "no_defect_recall": 0.9696969696969697,
        "no_defect_f1": 0.9682299546142209,
        "no_defect_tp": 1600,
        "no_defect_fp": 55,
        "no_defect_tn": 1571,
        "no_defect_fn": 50,
        "no_defect_support": 1650,
        "defect_precision": 0.9691548426896978,
        "defect_recall": 0.9661746617466175,
        "defect_f1": 0.9676624576532183,
        "defect_tp": 1571,
        "defect_fp": 50,
        "defect_tn": 1600,
        "defect_fn": 55,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.3875353896218863,
          0.22110877033307463,
          0.19253631152804926,
          0.1865142782425282,
          0.1841259845006416,
          0.18362073974379933,
          0.17838426200852234,
          0.17897218269408996,
          0.1830876915711738,
          0.17566053957432884,
          0.17323318064586887,
          0.17462308424287262,
          0.17471186246208567,
          0.17440929778200812,
          0.16966714392022608
        ],
        "val_loss": [
          0.289829144684168,
          0.16973505240793413,
          0.12760732007714418,
          0.14130100321311218,
          0.12715511890844658,
          0.15984388025334248,
          0.12218473206918973,
          0.12669843399467376,
          0.1377744937602144,
          0.12316275660235149,
          0.1166756429637854,
          0.11671115429355548,
          0.1163600875208011,
          0.11650073205908903,
          0.11733046926271457
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9149019176196662,
            "recall_macro": 0.912330915601909,
            "f1_macro": 0.9129802319828568,
            "precision_micro": 0.9132824427480916,
            "recall_micro": 0.9132824427480916,
            "f1_micro": 0.9132824427480916,
            "accuracy": 0.9132824427480916,
            "hamming_loss": 0.0867175572519084,
            "no_defect_precision": 0.8958919527293191,
            "no_defect_recall": 0.9414547604967475,
            "no_defect_f1": 0.9181084198385236,
            "no_defect_tp": 1592,
            "no_defect_fp": 185,
            "no_defect_tn": 1399,
            "no_defect_fn": 99,
            "no_defect_support": 1691,
            "defect_precision": 0.9339118825100133,
            "defect_recall": 0.8832070707070707,
            "defect_f1": 0.9078520441271901,
            "defect_tp": 1399,
            "defect_fp": 99,
            "defect_tn": 1592,
            "defect_fn": 185,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.94134676878325,
            "recall_macro": 0.9415988686390815,
            "f1_macro": 0.9407617626151759,
            "precision_micro": 0.9407633587786259,
            "recall_micro": 0.9407633587786259,
            "f1_micro": 0.9407633587786259,
            "accuracy": 0.9407633587786259,
            "hamming_loss": 0.059236641221374044,
            "no_defect_precision": 0.9675202998126171,
            "no_defect_recall": 0.9160260201064458,
            "no_defect_f1": 0.9410692588092345,
            "no_defect_tp": 1549,
            "no_defect_fp": 52,
            "no_defect_tn": 1532,
            "no_defect_fn": 142,
            "no_defect_support": 1691,
            "defect_precision": 0.9151732377538829,
            "defect_recall": 0.9671717171717171,
            "defect_f1": 0.9404542664211173,
            "defect_tp": 1532,
            "defect_fp": 142,
            "defect_tn": 1549,
            "defect_fn": 52,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604883411462046,
            "recall_macro": 0.9606984242185306,
            "f1_macro": 0.9605782105068972,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.965435041716329,
            "no_defect_recall": 0.9580130100532229,
            "no_defect_f1": 0.9617097061442564,
            "no_defect_tp": 1620,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 71,
            "no_defect_support": 1691,
            "defect_precision": 0.9555416405760802,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9594467148695379,
            "defect_tp": 1526,
            "defect_fp": 71,
            "defect_tn": 1620,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9488369117221331,
            "recall_macro": 0.9491707061746979,
            "f1_macro": 0.9483941751688034,
            "precision_micro": 0.9483969465648855,
            "recall_micro": 0.9483969465648855,
            "f1_micro": 0.9483969465648855,
            "accuracy": 0.9483969465648855,
            "hamming_loss": 0.0516030534351145,
            "no_defect_precision": 0.9732587064676617,
            "no_defect_recall": 0.9254878769958604,
            "no_defect_f1": 0.9487723552591695,
            "no_defect_tp": 1565,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 126,
            "no_defect_support": 1691,
            "defect_precision": 0.9244151169766047,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9480159950784374,
            "defect_tp": 1541,
            "defect_fp": 126,
            "defect_tn": 1565,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9552838477789913,
            "recall_macro": 0.9556917862838915,
            "f1_macro": 0.9553964552238805,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9656419529837251,
            "no_defect_recall": 0.9473684210526315,
            "no_defect_f1": 0.9564179104477611,
            "no_defect_tp": 1602,
            "no_defect_fp": 57,
            "no_defect_tn": 1527,
            "no_defect_fn": 89,
            "no_defect_support": 1691,
            "defect_precision": 0.9449257425742574,
            "defect_recall": 0.9640151515151515,
            "defect_f1": 0.954375,
            "defect_tp": 1527,
            "defect_fp": 89,
            "defect_tn": 1602,
            "defect_fn": 57,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9394950552281004,
            "recall_macro": 0.9382743012621783,
            "f1_macro": 0.9367803127408012,
            "precision_micro": 0.936793893129771,
            "recall_micro": 0.936793893129771,
            "f1_micro": 0.936793893129771,
            "accuracy": 0.936793893129771,
            "hamming_loss": 0.06320610687022901,
            "no_defect_precision": 0.9830729166666666,
            "no_defect_recall": 0.892962743938498,
            "no_defect_f1": 0.9358537341183762,
            "no_defect_tp": 1510,
            "no_defect_fp": 26,
            "no_defect_tn": 1558,
            "no_defect_fn": 181,
            "no_defect_support": 1691,
            "defect_precision": 0.8959171937895342,
            "defect_recall": 0.9835858585858586,
            "defect_f1": 0.937706891363226,
            "defect_tp": 1558,
            "defect_fp": 181,
            "defect_tn": 1510,
            "defect_fn": 26,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.958954519650313,
            "recall_macro": 0.9593797973824585,
            "f1_macro": 0.9590636303325953,
            "precision_micro": 0.9590839694656489,
            "recall_micro": 0.9590839694656489,
            "f1_micro": 0.9590839694656489,
            "accuracy": 0.9590839694656489,
            "hamming_loss": 0.040916030534351146,
            "no_defect_precision": 0.9698249849124925,
            "no_defect_recall": 0.9503252513305737,
            "no_defect_f1": 0.9599761051373955,
            "no_defect_tp": 1607,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 84,
            "no_defect_support": 1691,
            "defect_precision": 0.9480840543881335,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9581511555277952,
            "defect_tp": 1534,
            "defect_fp": 84,
            "defect_tn": 1607,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.957256939083451,
            "recall_macro": 0.9577455139807298,
            "f1_macro": 0.9572407099030702,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9737324373854612,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.9579326923076923,
            "no_defect_tp": 1594,
            "no_defect_fp": 43,
            "no_defect_tn": 1541,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.9407814407814408,
            "defect_recall": 0.9728535353535354,
            "defect_f1": 0.9565487274984482,
            "defect_tp": 1541,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 43,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9509168114047652,
            "recall_macro": 0.9512804344449821,
            "f1_macro": 0.9505309888319663,
            "precision_micro": 0.9505343511450381,
            "recall_micro": 0.9505343511450381,
            "f1_micro": 0.9505343511450381,
            "accuracy": 0.9505343511450381,
            "hamming_loss": 0.04946564885496183,
            "no_defect_precision": 0.9745499689633768,
            "no_defect_recall": 0.9284447072738025,
            "no_defect_f1": 0.9509388249545729,
            "no_defect_tp": 1570,
            "no_defect_fp": 41,
            "no_defect_tn": 1543,
            "no_defect_fn": 121,
            "no_defect_support": 1691,
            "defect_precision": 0.9272836538461539,
            "defect_recall": 0.9741161616161617,
            "defect_f1": 0.9501231527093597,
            "defect_tp": 1543,
            "defect_fp": 121,
            "defect_tn": 1570,
            "defect_fn": 41,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9595499225934009,
            "recall_macro": 0.9599112428244598,
            "f1_macro": 0.9596699861107276,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9681681681681682,
            "no_defect_recall": 0.9532820816085157,
            "no_defect_f1": 0.9606674612634089,
            "no_defect_tp": 1612,
            "no_defect_fp": 53,
            "no_defect_tn": 1531,
            "no_defect_fn": 79,
            "no_defect_support": 1691,
            "defect_precision": 0.9509316770186336,
            "defect_recall": 0.9665404040404041,
            "defect_f1": 0.9586725109580463,
            "defect_tp": 1531,
            "defect_fp": 79,
            "defect_tn": 1612,
            "defect_fn": 53,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9615425118359171,
            "recall_macro": 0.9614256849990144,
            "f1_macro": 0.9614808600059592,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9611078373600471,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9628099173553719,
            "no_defect_tp": 1631,
            "no_defect_fp": 66,
            "no_defect_tn": 1518,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9619771863117871,
            "defect_recall": 0.9583333333333334,
            "defect_f1": 0.9601518026565465,
            "defect_tp": 1518,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 66,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9598296480279283,
            "recall_macro": 0.9594917985293503,
            "f1_macro": 0.9596377235937532,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9566490919742238,
            "no_defect_recall": 0.9657007687758723,
            "no_defect_f1": 0.9611536197763391,
            "no_defect_tp": 1633,
            "no_defect_fp": 74,
            "no_defect_tn": 1510,
            "no_defect_fn": 58,
            "no_defect_support": 1691,
            "defect_precision": 0.9630102040816326,
            "defect_recall": 0.9532828282828283,
            "defect_f1": 0.9581218274111675,
            "defect_tp": 1510,
            "defect_fp": 58,
            "defect_tn": 1633,
            "defect_fn": 74,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.961247444679219,
            "recall_macro": 0.9611100284333578,
            "f1_macro": 0.9611743298493769,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9605418138987044,
            "no_defect_recall": 0.9645180366646955,
            "no_defect_f1": 0.9625258188256123,
            "no_defect_tp": 1631,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 60,
            "no_defect_support": 1691,
            "defect_precision": 0.9619530754597336,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9598228408731414,
            "defect_tp": 1517,
            "defect_fp": 60,
            "defect_tn": 1631,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626635313438964,
            "recall_macro": 0.96276820541309,
            "f1_macro": 0.9627126280770597,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9655786350148368,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9638625592417062,
            "no_defect_tp": 1627,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.959748427672956,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9615626969124134,
            "defect_tp": 1526,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9632423076750841,
            "recall_macro": 0.9634394656201279,
            "f1_macro": 0.9633279211690275,
            "precision_micro": 0.9633587786259542,
            "recall_micro": 0.9633587786259542,
            "f1_micro": 0.9633587786259542,
            "accuracy": 0.9633587786259542,
            "hamming_loss": 0.0366412213740458,
            "no_defect_precision": 0.9678379988088148,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9643916913946587,
            "no_defect_tp": 1625,
            "no_defect_fp": 54,
            "no_defect_tn": 1530,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9586466165413534,
            "defect_recall": 0.9659090909090909,
            "defect_f1": 0.9622641509433962,
            "defect_tp": 1530,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 54,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9679611071454531,
            "recall_macro": 0.9679358157217937,
            "f1_macro": 0.9679462061337196,
            "precision_micro": 0.967948717948718,
            "recall_micro": 0.967948717948718,
            "f1_micro": 0.967948717948718,
            "accuracy": 0.967948717948718,
            "hamming_loss": 0.03205128205128205,
            "no_defect_precision": 0.9667673716012085,
            "no_defect_recall": 0.9696969696969697,
            "no_defect_f1": 0.9682299546142209,
            "no_defect_tp": 1600,
            "no_defect_fp": 55,
            "no_defect_tn": 1571,
            "no_defect_fn": 50,
            "no_defect_support": 1650,
            "defect_precision": 0.9691548426896978,
            "defect_recall": 0.9661746617466175,
            "defect_f1": 0.9676624576532183,
            "defect_tp": 1571,
            "defect_fp": 50,
            "defect_tn": 1600,
            "defect_fn": 55,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.1_s140_20251207_133543",
    "lr": 0.01,
    "weight_decay": 0.1,
    "seed": 140,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9630216614539442,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.1_s140_20251207_133543",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s140_20251207_133543",
      "timestamp": "2025-12-07T13:37:36.236804",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 15,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.1_s140",
          "seed": 140,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s140_20251207_133543"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9629412972085386,
        "recall_macro": 0.9631238090544714,
        "f1_macro": 0.9630216614539442,
        "precision_micro": 0.9630534351145038,
        "recall_micro": 0.9630534351145038,
        "f1_micro": 0.9630534351145038,
        "accuracy": 0.9630534351145038,
        "hamming_loss": 0.036946564885496185,
        "no_defect_precision": 0.9672619047619048,
        "no_defect_recall": 0.960969840331165,
        "no_defect_f1": 0.9641056066449125,
        "no_defect_tp": 1625,
        "no_defect_fp": 55,
        "no_defect_tn": 1529,
        "no_defect_fn": 66,
        "no_defect_support": 1691,
        "defect_precision": 0.9586206896551724,
        "defect_recall": 0.9652777777777778,
        "defect_f1": 0.9619377162629758,
        "defect_tp": 1529,
        "defect_fp": 66,
        "defect_tn": 1625,
        "defect_fn": 55,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9685892769075409,
        "recall_macro": 0.9685374035558538,
        "f1_macro": 0.9685560279214958,
        "precision_micro": 0.9685592185592186,
        "recall_micro": 0.9685592185592186,
        "f1_micro": 0.9685592185592186,
        "accuracy": 0.9685592185592186,
        "hamming_loss": 0.03144078144078144,
        "no_defect_precision": 0.9662447257383966,
        "no_defect_recall": 0.9715151515151516,
        "no_defect_f1": 0.9688727712299788,
        "no_defect_tp": 1603,
        "no_defect_fp": 56,
        "no_defect_tn": 1570,
        "no_defect_fn": 47,
        "no_defect_support": 1650,
        "defect_precision": 0.9709338280766853,
        "defect_recall": 0.965559655596556,
        "defect_f1": 0.9682392846130127,
        "defect_tp": 1570,
        "defect_fp": 47,
        "defect_tn": 1603,
        "defect_fn": 56,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.38849994671145244,
          0.22235329601929277,
          0.19110710267367223,
          0.1845329529820127,
          0.18062990539118834,
          0.18689411027536232,
          0.17941969246545098,
          0.17909012279749914,
          0.17846084124248895,
          0.17423128874419125,
          0.16635944585171702,
          0.17159076240770987,
          0.16817665516270255,
          0.16841881164197642,
          0.16681161519747897
        ],
        "val_loss": [
          0.2902364343977891,
          0.16048793208140594,
          0.1282852701842785,
          0.12459458539692256,
          0.11819076029440531,
          0.12017361382738902,
          0.1176353210153488,
          0.1366690699584209,
          0.12121750622128065,
          0.12443408448822223,
          0.11553913670090529,
          0.11178714072761628,
          0.11801688824422084,
          0.11289573962298724,
          0.11293992958962917
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9186667071282888,
            "recall_macro": 0.9172055788517941,
            "f1_macro": 0.9176561066272452,
            "precision_micro": 0.9178625954198474,
            "recall_micro": 0.9178625954198474,
            "f1_micro": 0.9178625954198474,
            "accuracy": 0.9178625954198474,
            "hamming_loss": 0.08213740458015267,
            "no_defect_precision": 0.9067505720823799,
            "no_defect_recall": 0.9373151981076286,
            "no_defect_f1": 0.9217795870892701,
            "no_defect_tp": 1585,
            "no_defect_fp": 163,
            "no_defect_tn": 1421,
            "no_defect_fn": 106,
            "no_defect_support": 1691,
            "defect_precision": 0.9305828421741977,
            "defect_recall": 0.8970959595959596,
            "defect_f1": 0.9135326261652202,
            "defect_tp": 1421,
            "defect_fp": 106,
            "defect_tn": 1585,
            "defect_fn": 163,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.94708844986469,
            "recall_macro": 0.9444562045648681,
            "f1_macro": 0.9451589289514735,
            "precision_micro": 0.9453435114503816,
            "recall_micro": 0.9453435114503816,
            "f1_micro": 0.9453435114503816,
            "accuracy": 0.9453435114503816,
            "hamming_loss": 0.05465648854961832,
            "no_defect_precision": 0.9261555806087937,
            "no_defect_recall": 0.9716144293317563,
            "no_defect_f1": 0.9483405483405484,
            "no_defect_tp": 1643,
            "no_defect_fp": 131,
            "no_defect_tn": 1453,
            "no_defect_fn": 48,
            "no_defect_support": 1691,
            "defect_precision": 0.9680213191205863,
            "defect_recall": 0.9172979797979798,
            "defect_f1": 0.9419773095623987,
            "defect_tp": 1453,
            "defect_fp": 48,
            "defect_tn": 1643,
            "defect_fn": 131,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9580270769221585,
            "recall_macro": 0.9583129864583146,
            "f1_macro": 0.9581377139753651,
            "precision_micro": 0.9581679389312977,
            "recall_micro": 0.9581679389312977,
            "f1_micro": 0.9581679389312977,
            "accuracy": 0.9581679389312977,
            "hamming_loss": 0.04183206106870229,
            "no_defect_precision": 0.9647129186602871,
            "no_defect_recall": 0.9538734476641041,
            "no_defect_f1": 0.9592625631876301,
            "no_defect_tp": 1613,
            "no_defect_fp": 59,
            "no_defect_tn": 1525,
            "no_defect_fn": 78,
            "no_defect_support": 1691,
            "defect_precision": 0.9513412351840299,
            "defect_recall": 0.9627525252525253,
            "defect_f1": 0.9570128647631001,
            "defect_tp": 1525,
            "defect_fp": 78,
            "defect_tn": 1613,
            "defect_fn": 59,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556837396779129,
            "recall_macro": 0.956167231152447,
            "f1_macro": 0.9557113000700133,
            "precision_micro": 0.9557251908396946,
            "recall_micro": 0.9557251908396946,
            "f1_micro": 0.9557251908396946,
            "accuracy": 0.9557251908396946,
            "hamming_loss": 0.044274809160305344,
            "no_defect_precision": 0.9707673568818515,
            "no_defect_recall": 0.9426374926079243,
            "no_defect_f1": 0.9564956495649565,
            "no_defect_tp": 1594,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 97,
            "no_defect_support": 1691,
            "defect_precision": 0.9406001224739743,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9549269505750699,
            "defect_tp": 1536,
            "defect_fp": 97,
            "defect_tn": 1594,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9607084038867715,
            "recall_macro": 0.9599433498199021,
            "f1_macro": 0.9602337090372177,
            "precision_micro": 0.9603053435114504,
            "recall_micro": 0.9603053435114504,
            "f1_micro": 0.9603053435114504,
            "accuracy": 0.9603053435114504,
            "hamming_loss": 0.03969465648854962,
            "no_defect_precision": 0.9529889727219966,
            "no_defect_recall": 0.9710230632761679,
            "no_defect_f1": 0.9619214997070885,
            "no_defect_tp": 1642,
            "no_defect_fp": 81,
            "no_defect_tn": 1503,
            "no_defect_fn": 49,
            "no_defect_support": 1691,
            "defect_precision": 0.9684278350515464,
            "defect_recall": 0.9488636363636364,
            "defect_f1": 0.9585459183673469,
            "defect_tp": 1503,
            "defect_fp": 49,
            "defect_tn": 1642,
            "defect_fn": 81,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9572021976776103,
            "recall_macro": 0.9576855933671427,
            "f1_macro": 0.9572380300059391,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.9720024345709068,
            "no_defect_recall": 0.9444115907746895,
            "no_defect_f1": 0.9580083983203359,
            "no_defect_tp": 1597,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 94,
            "no_defect_support": 1691,
            "defect_precision": 0.9424019607843137,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9564676616915423,
            "defect_tp": 1538,
            "defect_fp": 94,
            "defect_tn": 1597,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9608367682138175,
            "recall_macro": 0.9613136838521227,
            "f1_macro": 0.9609015622213584,
            "precision_micro": 0.9609160305343512,
            "recall_micro": 0.9609160305343512,
            "f1_micro": 0.9609160305343512,
            "accuracy": 0.9609160305343512,
            "hamming_loss": 0.039083969465648856,
            "no_defect_precision": 0.9744990892531876,
            "no_defect_recall": 0.9491425192193969,
            "no_defect_f1": 0.9616536848412223,
            "no_defect_tp": 1605,
            "no_defect_fp": 42,
            "no_defect_tn": 1542,
            "no_defect_fn": 86,
            "no_defect_support": 1691,
            "defect_precision": 0.9471744471744472,
            "defect_recall": 0.9734848484848485,
            "defect_f1": 0.9601494396014943,
            "defect_tp": 1542,
            "defect_fp": 86,
            "defect_tn": 1605,
            "defect_fn": 42,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9490065298507462,
            "recall_macro": 0.9492506003261474,
            "f1_macro": 0.9483957148700431,
            "precision_micro": 0.9483969465648855,
            "recall_micro": 0.9483969465648855,
            "f1_micro": 0.9483969465648855,
            "accuracy": 0.9483969465648855,
            "hamming_loss": 0.0516030534351145,
            "no_defect_precision": 0.975625,
            "no_defect_recall": 0.9231224127735068,
            "no_defect_f1": 0.9486478274080826,
            "no_defect_tp": 1561,
            "no_defect_fp": 39,
            "no_defect_tn": 1545,
            "no_defect_fn": 130,
            "no_defect_support": 1691,
            "defect_precision": 0.9223880597014925,
            "defect_recall": 0.9753787878787878,
            "defect_f1": 0.9481436023320037,
            "defect_tp": 1545,
            "defect_fp": 130,
            "defect_tn": 1561,
            "defect_fn": 39,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9571725227462933,
            "recall_macro": 0.957645646291418,
            "f1_macro": 0.9572360836796108,
            "precision_micro": 0.9572519083969465,
            "recall_micro": 0.9572519083969465,
            "f1_micro": 0.9572519083969465,
            "accuracy": 0.9572519083969465,
            "hamming_loss": 0.042748091603053436,
            "no_defect_precision": 0.970856102003643,
            "no_defect_recall": 0.9455943228858663,
            "no_defect_f1": 0.9580587177950869,
            "no_defect_tp": 1599,
            "no_defect_fp": 48,
            "no_defect_tn": 1536,
            "no_defect_fn": 92,
            "no_defect_support": 1691,
            "defect_precision": 0.9434889434889435,
            "defect_recall": 0.9696969696969697,
            "defect_f1": 0.9564134495641345,
            "defect_tp": 1536,
            "defect_fp": 92,
            "defect_tn": 1599,
            "defect_fn": 48,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9599585811218527,
            "recall_macro": 0.9604466083066023,
            "f1_macro": 0.959987450408081,
            "precision_micro": 0.96,
            "recall_micro": 0.96,
            "f1_micro": 0.96,
            "accuracy": 0.96,
            "hamming_loss": 0.04,
            "no_defect_precision": 0.9750304506699148,
            "no_defect_recall": 0.9467770549970431,
            "no_defect_f1": 0.9606960696069607,
            "no_defect_tp": 1601,
            "no_defect_fp": 41,
            "no_defect_tn": 1543,
            "no_defect_fn": 90,
            "no_defect_support": 1691,
            "defect_precision": 0.9448867115737906,
            "defect_recall": 0.9741161616161617,
            "defect_f1": 0.9592788312092011,
            "defect_tp": 1543,
            "defect_fp": 90,
            "defect_tn": 1601,
            "defect_fn": 41,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.961077761662608,
            "recall_macro": 0.961449578577018,
            "f1_macro": 0.9611982209534737,
            "precision_micro": 0.9612213740458015,
            "recall_micro": 0.9612213740458015,
            "f1_micro": 0.9612213740458015,
            "accuracy": 0.9612213740458015,
            "hamming_loss": 0.038778625954198474,
            "no_defect_precision": 0.9699519230769231,
            "no_defect_recall": 0.9544648137196925,
            "no_defect_f1": 0.9621460506706409,
            "no_defect_tp": 1614,
            "no_defect_fp": 50,
            "no_defect_tn": 1534,
            "no_defect_fn": 77,
            "no_defect_support": 1691,
            "defect_precision": 0.952203600248293,
            "defect_recall": 0.9684343434343434,
            "defect_f1": 0.9602503912363067,
            "defect_tp": 1534,
            "defect_fp": 77,
            "defect_tn": 1614,
            "defect_fn": 50,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626635313438964,
            "recall_macro": 0.96276820541309,
            "f1_macro": 0.9627126280770597,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9655786350148368,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9638625592417062,
            "no_defect_tp": 1627,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.959748427672956,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9615626969124134,
            "defect_tp": 1526,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9604849045006012,
            "recall_macro": 0.9609181331350167,
            "f1_macro": 0.9605916398401894,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9716183574879227,
            "no_defect_recall": 0.9515079834417505,
            "no_defect_f1": 0.9614580221093516,
            "no_defect_tp": 1609,
            "no_defect_fp": 47,
            "no_defect_tn": 1537,
            "no_defect_fn": 82,
            "no_defect_support": 1691,
            "defect_precision": 0.9493514515132798,
            "defect_recall": 0.9703282828282829,
            "defect_f1": 0.9597252575710271,
            "defect_tp": 1537,
            "defect_fp": 82,
            "defect_tn": 1609,
            "defect_fn": 47,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9626406131858241,
            "recall_macro": 0.9628081524888148,
            "f1_macro": 0.9627153838631098,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.966686496133254,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9638196915776986,
            "no_defect_tp": 1625,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.958594730238394,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.961611076148521,
            "defect_tp": 1528,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9629412972085386,
            "recall_macro": 0.9631238090544714,
            "f1_macro": 0.9630216614539442,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9672619047619048,
            "no_defect_recall": 0.960969840331165,
            "no_defect_f1": 0.9641056066449125,
            "no_defect_tp": 1625,
            "no_defect_fp": 55,
            "no_defect_tn": 1529,
            "no_defect_fn": 66,
            "no_defect_support": 1691,
            "defect_precision": 0.9586206896551724,
            "defect_recall": 0.9652777777777778,
            "defect_f1": 0.9619377162629758,
            "defect_tp": 1529,
            "defect_fp": 66,
            "defect_tn": 1625,
            "defect_fn": 55,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9685892769075409,
            "recall_macro": 0.9685374035558538,
            "f1_macro": 0.9685560279214958,
            "precision_micro": 0.9685592185592186,
            "recall_micro": 0.9685592185592186,
            "f1_micro": 0.9685592185592186,
            "accuracy": 0.9685592185592186,
            "hamming_loss": 0.03144078144078144,
            "no_defect_precision": 0.9662447257383966,
            "no_defect_recall": 0.9715151515151516,
            "no_defect_f1": 0.9688727712299788,
            "no_defect_tp": 1603,
            "no_defect_fp": 56,
            "no_defect_tn": 1570,
            "no_defect_fn": 47,
            "no_defect_support": 1650,
            "defect_precision": 0.9709338280766853,
            "defect_recall": 0.965559655596556,
            "defect_f1": 0.9682392846130127,
            "defect_tp": 1570,
            "defect_fp": 47,
            "defect_tn": 1603,
            "defect_fn": 56,
            "defect_support": 1626
          }
        ]
      }
    }
  },
  {
    "phase": "grid",
    "experiment_dir": "code/experiments/results/experiment_grid_lr0.01_wd0.1_s150_20251207_200104",
    "lr": 0.01,
    "weight_decay": 0.1,
    "seed": 150,
    "metric_key_used": "best_val_metrics.f1_macro",
    "metric_value": 0.9645515675317365,
    "raw_results": {
      "experiment_name": "experiment_grid_lr0.01_wd0.1_s150_20251207_200104",
      "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s150_20251207_200104",
      "timestamp": "2025-12-07T20:02:56.438747",
      "model": "ConvNextTiny",
      "loss": "CrossEntropyLossWrapper",
      "loss_params": {
        "weight": null,
        "reduction": "mean"
      },
      "best_epoch": 8,
      "split_info": {
        "train": {
          "total_samples": 15284,
          "class_counts": {
            "no_defect": 7734,
            "defect": 7550
          }
        },
        "val": {
          "total_samples": 3275,
          "class_counts": {
            "no_defect": 1691,
            "defect": 1584
          }
        },
        "test": {
          "total_samples": 3276,
          "class_counts": {
            "no_defect": 1650,
            "defect": 1626
          }
        },
        "total": {
          "total_samples": 21835,
          "class_counts": {
            "no_defect": 11075,
            "defect": 10760
          }
        }
      },
      "config": {
        "model": {
          "name": "convnext_tiny",
          "num_classes": 2,
          "pretrained": true,
          "cbam_stages": [
            3,
            4
          ]
        },
        "loss": {
          "type": "cross_entropy",
          "weight": null,
          "reduction": "mean"
        },
        "data": {
          "img_dir": "data/images",
          "ann_dir": "data/annotations",
          "splits_dir": "data/splits",
          "batch_size": 64,
          "num_workers": 8,
          "pin_memory": false,
          "image_size": [
            150,
            150
          ],
          "num_classes": 2,
          "class_names": [
            "no_defect",
            "defect"
          ],
          "split_strategy": "stratified_70_15_15",
          "use_saved_splits": true
        },
        "augmentation": {
          "horizontal_flip": 0.5,
          "vertical_flip": 0.3,
          "rotation": 10,
          "brightness_contrast": {
            "brightness": 0.2,
            "contrast": 0.2
          },
          "defect_blackout": {
            "enabled": false
          }
        },
        "training": {
          "num_epochs": 15,
          "learning_rate": 0.01,
          "weight_decay": 0.1,
          "warmup_epochs": 2,
          "log_interval": 5,
          "threshold": 0.5,
          "save_checkpoints": false,
          "freeze_backbone": true,
          "freeze_early_stages": null
        },
        "optimizer": {
          "type": "adamw",
          "lr": 0.01,
          "weight_decay": 0.1,
          "betas": [
            0.9,
            0.999
          ]
        },
        "scheduler": {
          "type": "cosine",
          "warmup_epochs": 3
        },
        "experiment": {
          "name": "grid_lr0.01_wd0.1_s150",
          "seed": 150,
          "save_dir": "code/experiments/results",
          "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.01_wd0.1_s150_20251207_200104"
        }
      },
      "device": "cuda",
      "num_model_parameters": 28590666,
      "num_trainable_parameters": 772074,
      "best_val_metrics": {
        "precision_macro": 0.9644563530889462,
        "recall_macro": 0.9646821183448918,
        "f1_macro": 0.9645515675317365,
        "precision_micro": 0.9645801526717557,
        "recall_micro": 0.9645801526717557,
        "f1_micro": 0.9645801526717557,
        "accuracy": 0.9645801526717557,
        "hamming_loss": 0.035419847328244276,
        "no_defect_precision": 0.9695885509838998,
        "no_defect_recall": 0.9615612063867534,
        "no_defect_f1": 0.9655581947743468,
        "no_defect_tp": 1626,
        "no_defect_fp": 51,
        "no_defect_tn": 1533,
        "no_defect_fn": 65,
        "no_defect_support": 1691,
        "defect_precision": 0.9593241551939925,
        "defect_recall": 0.9678030303030303,
        "defect_f1": 0.9635449402891263,
        "defect_tp": 1533,
        "defect_fp": 65,
        "defect_tn": 1626,
        "defect_fn": 51,
        "defect_support": 1584
      },
      "test_metrics": {
        "precision_macro": 0.9673789335753947,
        "recall_macro": 0.9673118640277312,
        "f1_macro": 0.9673344888071895,
        "precision_micro": 0.9673382173382173,
        "recall_micro": 0.9673382173382173,
        "f1_micro": 0.9673382173382173,
        "accuracy": 0.9673382173382173,
        "hamming_loss": 0.032661782661782664,
        "no_defect_precision": 0.9644792293798916,
        "no_defect_recall": 0.9709090909090909,
        "no_defect_f1": 0.9676834793113863,
        "no_defect_tp": 1602,
        "no_defect_fp": 59,
        "no_defect_tn": 1567,
        "no_defect_fn": 48,
        "no_defect_support": 1650,
        "defect_precision": 0.9702786377708978,
        "defect_recall": 0.9637146371463715,
        "defect_f1": 0.9669854983029929,
        "defect_tp": 1567,
        "defect_fp": 48,
        "defect_tn": 1602,
        "defect_fn": 59,
        "defect_support": 1626
      },
      "training_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_loss": [
          0.39092020896189383,
          0.22284829173876153,
          0.18561785783478404,
          0.18369177753830554,
          0.18806055094657084,
          0.18591575477287858,
          0.18753797447145235,
          0.18259861610175177,
          0.1781220564844718,
          0.17244456468391617,
          0.16884540258341754,
          0.176166764893043,
          0.1732802593683099,
          0.17026036343377504,
          0.1664535423826473
        ],
        "val_loss": [
          0.29115694818588406,
          0.1606543350678224,
          0.12854059914556834,
          0.1175719339113969,
          0.12143151311633679,
          0.1295276444691878,
          0.13036270210376152,
          0.11376826386325635,
          0.11753406038937661,
          0.11657332098827912,
          0.11519841119073905,
          0.11576220994958511,
          0.11623138311104132,
          0.11541293776379181,
          0.1158032865048601
        ]
      },
      "metrics_history": {
        "epoch": [
          1,
          2,
          3,
          4,
          5,
          6,
          7,
          8,
          9,
          10,
          11,
          12,
          13,
          14,
          15
        ],
        "train_metrics": [
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null,
          null
        ],
        "val_metrics": [
          {
            "precision_macro": 0.9177682787971553,
            "recall_macro": 0.9177848114498026,
            "f1_macro": 0.9177764593015989,
            "precision_micro": 0.9178625954198474,
            "recall_micro": 0.9178625954198474,
            "f1_micro": 0.9178625954198474,
            "accuracy": 0.9178625954198474,
            "hamming_loss": 0.08213740458015267,
            "no_defect_precision": 0.9207100591715977,
            "no_defect_recall": 0.9201655824955648,
            "no_defect_f1": 0.9204377403135167,
            "no_defect_tp": 1556,
            "no_defect_fp": 134,
            "no_defect_tn": 1450,
            "no_defect_fn": 135,
            "no_defect_support": 1691,
            "defect_precision": 0.9148264984227129,
            "defect_recall": 0.9154040404040404,
            "defect_f1": 0.9151151782896813,
            "defect_tp": 1450,
            "defect_fp": 135,
            "defect_tn": 1556,
            "defect_fn": 134,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9528630454063642,
            "recall_macro": 0.9533063485236755,
            "f1_macro": 0.952956216961618,
            "precision_micro": 0.9529770992366412,
            "recall_micro": 0.9529770992366412,
            "f1_micro": 0.9529770992366412,
            "accuracy": 0.9529770992366412,
            "hamming_loss": 0.04702290076335878,
            "no_defect_precision": 0.9649122807017544,
            "no_defect_recall": 0.9432288586635127,
            "no_defect_f1": 0.9539473684210527,
            "no_defect_tp": 1595,
            "no_defect_fp": 58,
            "no_defect_tn": 1526,
            "no_defect_fn": 96,
            "no_defect_support": 1691,
            "defect_precision": 0.9408138101109741,
            "defect_recall": 0.9633838383838383,
            "defect_f1": 0.9519650655021834,
            "defect_tp": 1526,
            "defect_fp": 96,
            "defect_tn": 1595,
            "defect_fn": 58,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9593083976657433,
            "recall_macro": 0.9593958508801796,
            "f1_macro": 0.9593498818176498,
            "precision_micro": 0.9593893129770993,
            "recall_micro": 0.9593893129770993,
            "f1_micro": 0.9593893129770993,
            "accuracy": 0.9593893129770993,
            "hamming_loss": 0.040610687022900764,
            "no_defect_precision": 0.9620403321470937,
            "no_defect_recall": 0.9591957421643997,
            "no_defect_f1": 0.9606159312999704,
            "no_defect_tp": 1622,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 69,
            "no_defect_support": 1691,
            "defect_precision": 0.9565764631843927,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9580838323353293,
            "defect_tp": 1520,
            "defect_fp": 69,
            "defect_tn": 1622,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.960614962598731,
            "recall_macro": 0.9605186623777695,
            "f1_macro": 0.9605645658797874,
            "precision_micro": 0.9606106870229008,
            "recall_micro": 0.9606106870229008,
            "f1_micro": 0.9606106870229008,
            "accuracy": 0.9606106870229008,
            "hamming_loss": 0.03938931297709924,
            "no_defect_precision": 0.9604952830188679,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9619131975199291,
            "no_defect_tp": 1629,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9607346421785941,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9592159342396459,
            "defect_tp": 1517,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.962787344302262,
            "recall_macro": 0.9626283906480536,
            "f1_macro": 0.9627021022366603,
            "precision_micro": 0.9627480916030534,
            "recall_micro": 0.9627480916030534,
            "f1_micro": 0.9627480916030534,
            "accuracy": 0.9627480916030534,
            "hamming_loss": 0.037251908396946566,
            "no_defect_precision": 0.9617422012948793,
            "no_defect_recall": 0.9662921348314607,
            "no_defect_f1": 0.9640117994100295,
            "no_defect_tp": 1634,
            "no_defect_fp": 65,
            "no_defect_tn": 1519,
            "no_defect_fn": 57,
            "no_defect_support": 1691,
            "defect_precision": 0.9638324873096447,
            "defect_recall": 0.9589646464646465,
            "defect_f1": 0.9613924050632912,
            "defect_tp": 1519,
            "defect_fp": 57,
            "defect_tn": 1634,
            "defect_fn": 65,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9556957775982418,
            "recall_macro": 0.9561112305790012,
            "f1_macro": 0.9554153205322822,
            "precision_micro": 0.9554198473282443,
            "recall_micro": 0.9554198473282443,
            "f1_micro": 0.9554198473282443,
            "accuracy": 0.9554198473282443,
            "hamming_loss": 0.044580152671755725,
            "no_defect_precision": 0.9777365491651205,
            "no_defect_recall": 0.934949733885275,
            "no_defect_f1": 0.9558645707376058,
            "no_defect_tp": 1581,
            "no_defect_fp": 36,
            "no_defect_tn": 1548,
            "no_defect_fn": 110,
            "no_defect_support": 1691,
            "defect_precision": 0.9336550060313631,
            "defect_recall": 0.9772727272727273,
            "defect_f1": 0.9549660703269587,
            "defect_tp": 1548,
            "defect_fp": 110,
            "defect_tn": 1581,
            "defect_fn": 36,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9539531195923288,
            "recall_macro": 0.9544330800614065,
            "f1_macro": 0.9538832233036761,
            "precision_micro": 0.9538931297709924,
            "recall_micro": 0.9538931297709924,
            "f1_micro": 0.9538931297709924,
            "accuracy": 0.9538931297709924,
            "hamming_loss": 0.046106870229007633,
            "no_defect_precision": 0.9718137254901961,
            "no_defect_recall": 0.937906564163217,
            "no_defect_f1": 0.9545591333132711,
            "no_defect_tp": 1586,
            "no_defect_fp": 46,
            "no_defect_tn": 1538,
            "no_defect_fn": 105,
            "no_defect_support": 1691,
            "defect_precision": 0.9360925136944613,
            "defect_recall": 0.9709595959595959,
            "defect_f1": 0.9532073132940811,
            "defect_tp": 1538,
            "defect_fp": 105,
            "defect_tn": 1586,
            "defect_fn": 46,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9644563530889462,
            "recall_macro": 0.9646821183448918,
            "f1_macro": 0.9645515675317365,
            "precision_micro": 0.9645801526717557,
            "recall_micro": 0.9645801526717557,
            "f1_micro": 0.9645801526717557,
            "accuracy": 0.9645801526717557,
            "hamming_loss": 0.035419847328244276,
            "no_defect_precision": 0.9695885509838998,
            "no_defect_recall": 0.9615612063867534,
            "no_defect_f1": 0.9655581947743468,
            "no_defect_tp": 1626,
            "no_defect_fp": 51,
            "no_defect_tn": 1533,
            "no_defect_fn": 65,
            "no_defect_support": 1691,
            "defect_precision": 0.9593241551939925,
            "defect_recall": 0.9678030303030303,
            "defect_f1": 0.9635449402891263,
            "defect_tp": 1533,
            "defect_fp": 65,
            "defect_tn": 1626,
            "defect_fn": 51,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9587264106919531,
            "recall_macro": 0.9587445642110042,
            "f1_macro": 0.9587353977907653,
            "precision_micro": 0.9587786259541985,
            "recall_micro": 0.9587786259541985,
            "f1_micro": 0.9587786259541985,
            "accuracy": 0.9587786259541985,
            "hamming_loss": 0.04122137404580153,
            "no_defect_precision": 0.9603550295857988,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9600709849157054,
            "no_defect_tp": 1623,
            "no_defect_fp": 67,
            "no_defect_tn": 1517,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9570977917981073,
            "defect_recall": 0.9577020202020202,
            "defect_f1": 0.9573998106658251,
            "defect_tp": 1517,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 67,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9600211457908062,
            "recall_macro": 0.9593719573021762,
            "f1_macro": 0.9596260530100678,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.9534613147178592,
            "no_defect_recall": 0.9692489651094027,
            "no_defect_f1": 0.9612903225806452,
            "no_defect_tp": 1639,
            "no_defect_fp": 80,
            "no_defect_tn": 1504,
            "no_defect_fn": 52,
            "no_defect_support": 1691,
            "defect_precision": 0.9665809768637532,
            "defect_recall": 0.9494949494949495,
            "defect_f1": 0.9579617834394905,
            "defect_tp": 1504,
            "defect_fp": 52,
            "defect_tn": 1639,
            "defect_fn": 80,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9615031926658666,
            "recall_macro": 0.9614656320747391,
            "f1_macro": 0.9614840526337012,
            "precision_micro": 0.9615267175572519,
            "recall_micro": 0.9615267175572519,
            "f1_micro": 0.9615267175572519,
            "accuracy": 0.9615267175572519,
            "hamming_loss": 0.03847328244274809,
            "no_defect_precision": 0.9621972829297105,
            "no_defect_recall": 0.9633353045535187,
            "no_defect_f1": 0.9627659574468085,
            "no_defect_tp": 1629,
            "no_defect_fp": 64,
            "no_defect_tn": 1520,
            "no_defect_fn": 62,
            "no_defect_support": 1691,
            "defect_precision": 0.9608091024020228,
            "defect_recall": 0.9595959595959596,
            "defect_f1": 0.9602021478205938,
            "defect_tp": 1520,
            "defect_fp": 62,
            "defect_tn": 1629,
            "defect_fn": 64,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.960401923110036,
            "recall_macro": 0.9591921954614149,
            "f1_macro": 0.9596064964489597,
            "precision_micro": 0.9596946564885496,
            "recall_micro": 0.9596946564885496,
            "f1_micro": 0.9596946564885496,
            "accuracy": 0.9596946564885496,
            "hamming_loss": 0.04030534351145038,
            "no_defect_precision": 0.948762233736327,
            "no_defect_recall": 0.9745712596096984,
            "no_defect_f1": 0.9614935822637106,
            "no_defect_tp": 1648,
            "no_defect_fp": 89,
            "no_defect_tn": 1495,
            "no_defect_fn": 43,
            "no_defect_support": 1691,
            "defect_precision": 0.9720416124837451,
            "defect_recall": 0.9438131313131313,
            "defect_f1": 0.9577194106342088,
            "defect_tp": 1495,
            "defect_fp": 43,
            "defect_tn": 1648,
            "defect_fn": 89,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620201486443924,
            "recall_macro": 0.9622167864332264,
            "f1_macro": 0.9621055185413284,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.9666468135795117,
            "no_defect_recall": 0.9597871082199881,
            "no_defect_f1": 0.9632047477744807,
            "no_defect_tp": 1623,
            "no_defect_fp": 56,
            "no_defect_tn": 1528,
            "no_defect_fn": 68,
            "no_defect_support": 1691,
            "defect_precision": 0.9573934837092731,
            "defect_recall": 0.9646464646464646,
            "defect_f1": 0.9610062893081761,
            "defect_tp": 1528,
            "defect_fp": 68,
            "defect_tn": 1623,
            "defect_fn": 56,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9630056185018573,
            "recall_macro": 0.9630239413651596,
            "f1_macro": 0.9630146898717229,
            "precision_micro": 0.9630534351145038,
            "recall_micro": 0.9630534351145038,
            "f1_micro": 0.9630534351145038,
            "accuracy": 0.9630534351145038,
            "hamming_loss": 0.036946564885496185,
            "no_defect_precision": 0.9644970414201184,
            "no_defect_recall": 0.9639266706091071,
            "no_defect_f1": 0.9642117716651878,
            "no_defect_tp": 1630,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 61,
            "no_defect_support": 1691,
            "defect_precision": 0.9615141955835962,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9618176080782581,
            "defect_tp": 1524,
            "defect_fp": 61,
            "defect_tn": 1630,
            "defect_fn": 60,
            "defect_support": 1584
          },
          {
            "precision_macro": 0.9620658196700506,
            "recall_macro": 0.962136892281777,
            "f1_macro": 0.9620999166030177,
            "precision_micro": 0.9621374045801526,
            "recall_micro": 0.9621374045801526,
            "f1_micro": 0.9621374045801526,
            "accuracy": 0.9621374045801526,
            "hamming_loss": 0.03786259541984733,
            "no_defect_precision": 0.96443390634262,
            "no_defect_recall": 0.9621525724423418,
            "no_defect_f1": 0.9632918886915335,
            "no_defect_tp": 1627,
            "no_defect_fp": 60,
            "no_defect_tn": 1524,
            "no_defect_fn": 64,
            "no_defect_support": 1691,
            "defect_precision": 0.9596977329974811,
            "defect_recall": 0.9621212121212122,
            "defect_f1": 0.9609079445145019,
            "defect_tp": 1524,
            "defect_fp": 64,
            "defect_tn": 1627,
            "defect_fn": 60,
            "defect_support": 1584
          }
        ],
        "test_metrics": [
          {
            "precision_macro": 0.9673789335753947,
            "recall_macro": 0.9673118640277312,
            "f1_macro": 0.9673344888071895,
            "precision_micro": 0.9673382173382173,
            "recall_micro": 0.9673382173382173,
            "f1_micro": 0.9673382173382173,
            "accuracy": 0.9673382173382173,
            "hamming_loss": 0.032661782661782664,
            "no_defect_precision": 0.9644792293798916,
            "no_defect_recall": 0.9709090909090909,
            "no_defect_f1": 0.9676834793113863,
            "no_defect_tp": 1602,
            "no_defect_fp": 59,
            "no_defect_tn": 1567,
            "no_defect_fn": 48,
            "no_defect_support": 1650,
            "defect_precision": 0.9702786377708978,
            "defect_recall": 0.9637146371463715,
            "defect_f1": 0.9669854983029929,
            "defect_tp": 1567,
            "defect_fp": 48,
            "defect_tn": 1602,
            "defect_fn": 59,
            "defect_support": 1626
          }
        ]
      }
    }
  }
]