{
  "experiment_name": "experiment_grid_lr0.001_wd0.1_s90_20251207_160140",
  "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s90_20251207_160140",
  "timestamp": "2025-12-07T16:03:31.733893",
  "model": "ConvNextTiny",
  "loss": "CrossEntropyLossWrapper",
  "loss_params": {
    "weight": null,
    "reduction": "mean"
  },
  "best_epoch": 14,
  "split_info": {
    "train": {
      "total_samples": 15284,
      "class_counts": {
        "no_defect": 7734,
        "defect": 7550
      }
    },
    "val": {
      "total_samples": 3275,
      "class_counts": {
        "no_defect": 1691,
        "defect": 1584
      }
    },
    "test": {
      "total_samples": 3276,
      "class_counts": {
        "no_defect": 1650,
        "defect": 1626
      }
    },
    "total": {
      "total_samples": 21835,
      "class_counts": {
        "no_defect": 11075,
        "defect": 10760
      }
    }
  },
  "config": {
    "model": {
      "name": "convnext_tiny",
      "num_classes": 2,
      "pretrained": true,
      "cbam_stages": [
        3,
        4
      ]
    },
    "loss": {
      "type": "cross_entropy",
      "weight": null,
      "reduction": "mean"
    },
    "data": {
      "img_dir": "data/images",
      "ann_dir": "data/annotations",
      "splits_dir": "data/splits",
      "batch_size": 64,
      "num_workers": 8,
      "pin_memory": false,
      "image_size": [
        150,
        150
      ],
      "num_classes": 2,
      "class_names": [
        "no_defect",
        "defect"
      ],
      "split_strategy": "stratified_70_15_15",
      "use_saved_splits": true
    },
    "augmentation": {
      "horizontal_flip": 0.5,
      "vertical_flip": 0.3,
      "rotation": 10,
      "brightness_contrast": {
        "brightness": 0.2,
        "contrast": 0.2
      },
      "defect_blackout": {
        "enabled": false
      }
    },
    "training": {
      "num_epochs": 15,
      "learning_rate": 0.001,
      "weight_decay": 0.1,
      "warmup_epochs": 2,
      "log_interval": 5,
      "threshold": 0.5,
      "save_checkpoints": false,
      "freeze_backbone": true,
      "freeze_early_stages": null
    },
    "optimizer": {
      "type": "adamw",
      "lr": 0.001,
      "weight_decay": 0.1,
      "betas": [
        0.9,
        0.999
      ]
    },
    "scheduler": {
      "type": "cosine",
      "warmup_epochs": 3
    },
    "experiment": {
      "name": "grid_lr0.001_wd0.1_s90",
      "seed": 90,
      "save_dir": "code/experiments/results",
      "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s90_20251207_160140"
    }
  },
  "device": "cuda",
  "num_model_parameters": 28590666,
  "num_trainable_parameters": 772074,
  "best_val_metrics": {
    "precision_macro": 0.9555789717945619,
    "recall_macro": 0.9559075751602364,
    "f1_macro": 0.9556960448731542,
    "precision_micro": 0.9557251908396946,
    "recall_micro": 0.9557251908396946,
    "f1_micro": 0.9557251908396946,
    "accuracy": 0.9557251908396946,
    "hamming_loss": 0.044274809160305344,
    "no_defect_precision": 0.9634292565947242,
    "no_defect_recall": 0.9503252513305737,
    "no_defect_f1": 0.9568323905924382,
    "no_defect_tp": 1607,
    "no_defect_fp": 61,
    "no_defect_tn": 1523,
    "no_defect_fn": 84,
    "no_defect_support": 1691,
    "defect_precision": 0.9477286869943995,
    "defect_recall": 0.961489898989899,
    "defect_f1": 0.9545596991538703,
    "defect_tp": 1523,
    "defect_fp": 84,
    "defect_tn": 1607,
    "defect_fn": 61,
    "defect_support": 1584
  },
  "test_metrics": {
    "precision_macro": 0.9593944453865922,
    "recall_macro": 0.959410712288941,
    "f1_macro": 0.9594003437442782,
    "precision_micro": 0.9594017094017094,
    "recall_micro": 0.9594017094017094,
    "f1_micro": 0.9594017094017094,
    "accuracy": 0.9594017094017094,
    "hamming_loss": 0.0405982905982906,
    "no_defect_precision": 0.9610942249240122,
    "no_defect_recall": 0.9581818181818181,
    "no_defect_f1": 0.9596358118361153,
    "no_defect_tp": 1581,
    "no_defect_fp": 64,
    "no_defect_tn": 1562,
    "no_defect_fn": 69,
    "no_defect_support": 1650,
    "defect_precision": 0.9576946658491723,
    "defect_recall": 0.9606396063960639,
    "defect_f1": 0.9591648756524409,
    "defect_tp": 1562,
    "defect_fp": 69,
    "defect_tn": 1581,
    "defect_fn": 64,
    "defect_support": 1626
  },
  "training_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15
    ],
    "train_loss": [
      0.6188642123254273,
      0.41264333061593345,
      0.2922121429792508,
      0.24425279052935883,
      0.22238026559352875,
      0.21047096802350368,
      0.19997282809418115,
      0.19033713479795217,
      0.19101389301122482,
      0.18671689107702366,
      0.18381961893337043,
      0.18676329921603702,
      0.18190335815920491,
      0.18696711838993568,
      0.1844253219258835
    ],
    "val_loss": [
      0.5766448699511014,
      0.3503749674329391,
      0.2540998811332079,
      0.21736965643671843,
      0.19325936041199243,
      0.1836970169097185,
      0.17300633470026347,
      0.16316148008291537,
      0.15900609742563504,
      0.15559413169439024,
      0.15185893756838945,
      0.1517854330058281,
      0.1493594292551279,
      0.15077556297183037,
      0.15052203504511943
    ]
  },
  "metrics_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15
    ],
    "train_metrics": [
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null
    ],
    "val_metrics": [
      {
        "precision_macro": 0.8665139440237644,
        "recall_macro": 0.8555166538238685,
        "f1_macro": 0.856449838485743,
        "precision_micro": 0.8580152671755725,
        "recall_micro": 0.8580152671755725,
        "f1_micro": 0.8580152671755725,
        "accuracy": 0.8580152671755725,
        "hamming_loss": 0.14198473282442747,
        "no_defect_precision": 0.818276220145379,
        "no_defect_recall": 0.9319929036073329,
        "no_defect_f1": 0.8714404202377661,
        "no_defect_tp": 1576,
        "no_defect_fp": 350,
        "no_defect_tn": 1234,
        "no_defect_fn": 115,
        "no_defect_support": 1691,
        "defect_precision": 0.9147516679021498,
        "defect_recall": 0.7790404040404041,
        "defect_f1": 0.8414592567337198,
        "defect_tp": 1234,
        "defect_fp": 115,
        "defect_tn": 1576,
        "defect_fn": 350,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9010291771090637,
        "recall_macro": 0.8985857615181979,
        "f1_macro": 0.8991955194806956,
        "precision_micro": 0.8995419847328244,
        "recall_micro": 0.8995419847328244,
        "f1_micro": 0.8995419847328244,
        "accuracy": 0.8995419847328244,
        "hamming_loss": 0.10045801526717557,
        "no_defect_precision": 0.8834459459459459,
        "no_defect_recall": 0.9278533412182141,
        "no_defect_f1": 0.9051052783386213,
        "no_defect_tp": 1569,
        "no_defect_fp": 207,
        "no_defect_tn": 1377,
        "no_defect_fn": 122,
        "no_defect_support": 1691,
        "defect_precision": 0.9186124082721815,
        "defect_recall": 0.8693181818181818,
        "defect_f1": 0.89328576062277,
        "defect_tp": 1377,
        "defect_fp": 122,
        "defect_tn": 1569,
        "defect_fn": 207,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9294806792069323,
        "recall_macro": 0.9278740614303891,
        "f1_macro": 0.9283633471605581,
        "precision_micro": 0.9285496183206107,
        "recall_micro": 0.9285496183206107,
        "f1_micro": 0.9285496183206107,
        "accuracy": 0.9285496183206107,
        "hamming_loss": 0.07145038167938932,
        "no_defect_precision": 0.9160479725870931,
        "no_defect_recall": 0.9485511531638084,
        "no_defect_f1": 0.9320162696106915,
        "no_defect_tp": 1604,
        "no_defect_fp": 147,
        "no_defect_tn": 1437,
        "no_defect_fn": 87,
        "no_defect_support": 1691,
        "defect_precision": 0.9429133858267716,
        "defect_recall": 0.9071969696969697,
        "defect_f1": 0.9247104247104247,
        "defect_tp": 1437,
        "defect_fp": 87,
        "defect_tn": 1604,
        "defect_fn": 147,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9397756332480913,
        "recall_macro": 0.9397930368140304,
        "f1_macro": 0.9397842471465242,
        "precision_micro": 0.9398473282442749,
        "recall_micro": 0.9398473282442749,
        "f1_micro": 0.9398473282442749,
        "accuracy": 0.9398473282442749,
        "hamming_loss": 0.06015267175572519,
        "no_defect_precision": 0.9420118343195266,
        "no_defect_recall": 0.9414547604967475,
        "no_defect_f1": 0.9417332150251405,
        "no_defect_tp": 1592,
        "no_defect_fp": 98,
        "no_defect_tn": 1486,
        "no_defect_fn": 99,
        "no_defect_support": 1691,
        "defect_precision": 0.9375394321766561,
        "defect_recall": 0.9381313131313131,
        "defect_f1": 0.9378352792679079,
        "defect_tp": 1486,
        "defect_fp": 99,
        "defect_tn": 1592,
        "defect_fn": 98,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9463202192209825,
        "recall_macro": 0.946082274549158,
        "f1_macro": 0.9461884948686753,
        "precision_micro": 0.9462595419847328,
        "recall_micro": 0.9462595419847328,
        "f1_micro": 0.9462595419847328,
        "accuracy": 0.9462595419847328,
        "hamming_loss": 0.053740458015267174,
        "no_defect_precision": 0.9448032883147387,
        "no_defect_recall": 0.9515079834417505,
        "no_defect_f1": 0.9481437831467295,
        "no_defect_tp": 1609,
        "no_defect_fp": 94,
        "no_defect_tn": 1490,
        "no_defect_fn": 82,
        "no_defect_support": 1691,
        "defect_precision": 0.9478371501272265,
        "defect_recall": 0.9406565656565656,
        "defect_f1": 0.944233206590621,
        "defect_tp": 1490,
        "defect_fp": 82,
        "defect_tn": 1609,
        "defect_fn": 94,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9492475805098178,
        "recall_macro": 0.9497182051144204,
        "f1_macro": 0.9492953863418288,
        "precision_micro": 0.9493129770992367,
        "recall_micro": 0.9493129770992367,
        "f1_micro": 0.9493129770992367,
        "accuracy": 0.9493129770992367,
        "hamming_loss": 0.05068702290076336,
        "no_defect_precision": 0.9635258358662614,
        "no_defect_recall": 0.9373151981076286,
        "no_defect_f1": 0.9502398081534772,
        "no_defect_tp": 1585,
        "no_defect_fp": 60,
        "no_defect_tn": 1524,
        "no_defect_fn": 106,
        "no_defect_support": 1691,
        "defect_precision": 0.9349693251533743,
        "defect_recall": 0.9621212121212122,
        "defect_f1": 0.9483509645301804,
        "defect_tp": 1524,
        "defect_fp": 106,
        "defect_tn": 1585,
        "defect_fn": 60,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9501018998427491,
        "recall_macro": 0.9505253600463535,
        "f1_macro": 0.9502049402631851,
        "precision_micro": 0.9502290076335878,
        "recall_micro": 0.9502290076335878,
        "f1_micro": 0.9502290076335878,
        "accuracy": 0.9502290076335878,
        "hamming_loss": 0.04977099236641221,
        "no_defect_precision": 0.961352657004831,
        "no_defect_recall": 0.9414547604967475,
        "no_defect_f1": 0.9512996713474754,
        "no_defect_tp": 1592,
        "no_defect_fp": 64,
        "no_defect_tn": 1520,
        "no_defect_fn": 99,
        "no_defect_support": 1691,
        "defect_precision": 0.938851142680667,
        "defect_recall": 0.9595959595959596,
        "defect_f1": 0.9491102091788948,
        "defect_tp": 1520,
        "defect_fp": 99,
        "defect_tn": 1592,
        "defect_fn": 64,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9528843103223037,
        "recall_macro": 0.9529867719178777,
        "f1_macro": 0.9529323338021902,
        "precision_micro": 0.9529770992366412,
        "recall_micro": 0.9529770992366412,
        "f1_micro": 0.9529770992366412,
        "accuracy": 0.9529770992366412,
        "hamming_loss": 0.04702290076335878,
        "no_defect_precision": 0.9560830860534124,
        "no_defect_recall": 0.9526907155529273,
        "no_defect_f1": 0.9543838862559242,
        "no_defect_tp": 1611,
        "no_defect_fp": 74,
        "no_defect_tn": 1510,
        "no_defect_fn": 80,
        "no_defect_support": 1691,
        "defect_precision": 0.949685534591195,
        "defect_recall": 0.9532828282828283,
        "defect_f1": 0.9514807813484563,
        "defect_tp": 1510,
        "defect_fp": 80,
        "defect_tn": 1611,
        "defect_fn": 74,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9540577267059331,
        "recall_macro": 0.9543292923319535,
        "f1_macro": 0.9541646233185764,
        "precision_micro": 0.9541984732824428,
        "recall_micro": 0.9541984732824428,
        "f1_micro": 0.9541984732824428,
        "accuracy": 0.9541984732824428,
        "hamming_loss": 0.04580152671755725,
        "no_defect_precision": 0.9605499103407054,
        "no_defect_recall": 0.9503252513305737,
        "no_defect_f1": 0.955410225921522,
        "no_defect_tp": 1607,
        "no_defect_fp": 66,
        "no_defect_tn": 1518,
        "no_defect_fn": 84,
        "no_defect_support": 1691,
        "defect_precision": 0.947565543071161,
        "defect_recall": 0.9583333333333334,
        "defect_f1": 0.9529190207156308,
        "defect_tp": 1518,
        "defect_fp": 84,
        "defect_tn": 1607,
        "defect_fn": 66,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9540577267059331,
        "recall_macro": 0.9543292923319535,
        "f1_macro": 0.9541646233185764,
        "precision_micro": 0.9541984732824428,
        "recall_micro": 0.9541984732824428,
        "f1_micro": 0.9541984732824428,
        "accuracy": 0.9541984732824428,
        "hamming_loss": 0.04580152671755725,
        "no_defect_precision": 0.9605499103407054,
        "no_defect_recall": 0.9503252513305737,
        "no_defect_f1": 0.955410225921522,
        "no_defect_tp": 1607,
        "no_defect_fp": 66,
        "no_defect_tn": 1518,
        "no_defect_fn": 84,
        "no_defect_support": 1691,
        "defect_precision": 0.947565543071161,
        "defect_recall": 0.9583333333333334,
        "defect_f1": 0.9529190207156308,
        "defect_tp": 1518,
        "defect_fp": 84,
        "defect_tn": 1607,
        "defect_fn": 66,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.95531747418017,
        "recall_macro": 0.9554521038295432,
        "f1_macro": 0.9553790730418865,
        "precision_micro": 0.9554198473282443,
        "recall_micro": 0.9554198473282443,
        "f1_micro": 0.9554198473282443,
        "accuracy": 0.9554198473282443,
        "hamming_loss": 0.044580152671755725,
        "no_defect_precision": 0.9590017825311943,
        "no_defect_recall": 0.9544648137196925,
        "no_defect_f1": 0.9567279193835211,
        "no_defect_tp": 1614,
        "no_defect_fp": 69,
        "no_defect_tn": 1515,
        "no_defect_fn": 77,
        "no_defect_support": 1691,
        "defect_precision": 0.9516331658291457,
        "defect_recall": 0.9564393939393939,
        "defect_f1": 0.9540302267002518,
        "defect_tp": 1515,
        "defect_fp": 77,
        "defect_tn": 1614,
        "defect_fn": 69,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9543613275944924,
        "recall_macro": 0.9546449488976101,
        "f1_macro": 0.9544709443965649,
        "precision_micro": 0.9545038167938932,
        "recall_micro": 0.9545038167938932,
        "f1_micro": 0.9545038167938932,
        "accuracy": 0.9545038167938932,
        "hamming_loss": 0.04549618320610687,
        "no_defect_precision": 0.9611244019138756,
        "no_defect_recall": 0.9503252513305737,
        "no_defect_f1": 0.9556943205471305,
        "no_defect_tp": 1607,
        "no_defect_fp": 65,
        "no_defect_tn": 1519,
        "no_defect_fn": 84,
        "no_defect_support": 1691,
        "defect_precision": 0.9475982532751092,
        "defect_recall": 0.9589646464646465,
        "defect_f1": 0.9532475682459993,
        "defect_tp": 1519,
        "defect_fp": 84,
        "defect_tn": 1607,
        "defect_fn": 65,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9552982739755882,
        "recall_macro": 0.955492050905268,
        "f1_macro": 0.9553823040889835,
        "precision_micro": 0.9554198473282443,
        "recall_micro": 0.9554198473282443,
        "f1_micro": 0.9554198473282443,
        "accuracy": 0.9554198473282443,
        "hamming_loss": 0.044580152671755725,
        "no_defect_precision": 0.9600952948183442,
        "no_defect_recall": 0.9532820816085157,
        "no_defect_f1": 0.9566765578635015,
        "no_defect_tp": 1612,
        "no_defect_fp": 67,
        "no_defect_tn": 1517,
        "no_defect_fn": 79,
        "no_defect_support": 1691,
        "defect_precision": 0.9505012531328321,
        "defect_recall": 0.9577020202020202,
        "defect_f1": 0.9540880503144654,
        "defect_tp": 1517,
        "defect_fp": 79,
        "defect_tn": 1612,
        "defect_fn": 67,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9555789717945619,
        "recall_macro": 0.9559075751602364,
        "f1_macro": 0.9556960448731542,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.9634292565947242,
        "no_defect_recall": 0.9503252513305737,
        "no_defect_f1": 0.9568323905924382,
        "no_defect_tp": 1607,
        "no_defect_fp": 61,
        "no_defect_tn": 1523,
        "no_defect_fn": 84,
        "no_defect_support": 1691,
        "defect_precision": 0.9477286869943995,
        "defect_recall": 0.961489898989899,
        "defect_f1": 0.9545596991538703,
        "defect_tp": 1523,
        "defect_fp": 84,
        "defect_tn": 1607,
        "defect_fn": 61,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9555789717945619,
        "recall_macro": 0.9559075751602364,
        "f1_macro": 0.9556960448731542,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.9634292565947242,
        "no_defect_recall": 0.9503252513305737,
        "no_defect_f1": 0.9568323905924382,
        "no_defect_tp": 1607,
        "no_defect_fp": 61,
        "no_defect_tn": 1523,
        "no_defect_fn": 84,
        "no_defect_support": 1691,
        "defect_precision": 0.9477286869943995,
        "defect_recall": 0.961489898989899,
        "defect_f1": 0.9545596991538703,
        "defect_tp": 1523,
        "defect_fp": 84,
        "defect_tn": 1607,
        "defect_fn": 61,
        "defect_support": 1584
      }
    ],
    "test_metrics": [
      {
        "precision_macro": 0.9593944453865922,
        "recall_macro": 0.959410712288941,
        "f1_macro": 0.9594003437442782,
        "precision_micro": 0.9594017094017094,
        "recall_micro": 0.9594017094017094,
        "f1_micro": 0.9594017094017094,
        "accuracy": 0.9594017094017094,
        "hamming_loss": 0.0405982905982906,
        "no_defect_precision": 0.9610942249240122,
        "no_defect_recall": 0.9581818181818181,
        "no_defect_f1": 0.9596358118361153,
        "no_defect_tp": 1581,
        "no_defect_fp": 64,
        "no_defect_tn": 1562,
        "no_defect_fn": 69,
        "no_defect_support": 1650,
        "defect_precision": 0.9576946658491723,
        "defect_recall": 0.9606396063960639,
        "defect_f1": 0.9591648756524409,
        "defect_tp": 1562,
        "defect_fp": 69,
        "defect_tn": 1581,
        "defect_fn": 64,
        "defect_support": 1626
      }
    ]
  }
}