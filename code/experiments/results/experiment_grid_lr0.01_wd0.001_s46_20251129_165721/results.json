{
  "experiment_name": "experiment_grid_lr0.01_wd0.001_s46_20251129_165721",
  "experiment_dir": "/Users/ema/projects/DL4SE-project-UPM/code/experiments/results/experiment_grid_lr0.01_wd0.001_s46_20251129_165721",
  "timestamp": "2025-11-29T17:26:30.171121",
  "model": "ConvNextTiny",
  "loss": "CrossEntropyLossWrapper",
  "loss_params": {
    "weight": null,
    "reduction": "mean"
  },
  "best_epoch": 9,
  "split_info": {
    "train": {
      "total_samples": 15283,
      "class_counts": {
        "no_defect": 7752,
        "defect": 7531
      }
    },
    "val": {
      "total_samples": 3275,
      "class_counts": {
        "no_defect": 1661,
        "defect": 1614
      }
    },
    "test": {
      "total_samples": 3277,
      "class_counts": {
        "no_defect": 1662,
        "defect": 1615
      }
    },
    "total": {
      "total_samples": 21835,
      "class_counts": {
        "no_defect": 11075,
        "defect": 10760
      }
    }
  },
  "config": {
    "model": {
      "name": "convnext_tiny",
      "num_classes": 2,
      "pretrained": true,
      "cbam_stages": [
        3,
        4
      ]
    },
    "loss": {
      "type": "cross_entropy",
      "weight": null,
      "reduction": "mean"
    },
    "data": {
      "img_dir": "data/images",
      "ann_dir": "data/annotations",
      "splits_dir": "data/splits",
      "batch_size": 64,
      "num_workers": 0,
      "pin_memory": false,
      "image_size": [
        150,
        150
      ],
      "num_classes": 2,
      "class_names": [
        "no_defect",
        "defect"
      ],
      "split_strategy": "stratified_70_15_15",
      "use_saved_splits": true
    },
    "augmentation": {
      "horizontal_flip": 0.5,
      "vertical_flip": 0.3,
      "rotation": 10,
      "brightness_contrast": {
        "brightness": 0.2,
        "contrast": 0.2
      },
      "defect_blackout": {
        "enabled": false
      }
    },
    "training": {
      "num_epochs": 50,
      "learning_rate": 0.01,
      "weight_decay": 0.001,
      "warmup_epochs": 2,
      "early_stopping_patience": 5,
      "early_stopping_metric": "f1_macro",
      "log_interval": 5,
      "threshold": 0.5,
      "save_checkpoints": false,
      "freeze_backbone": true,
      "freeze_early_stages": null
    },
    "optimizer": {
      "type": "adamw",
      "lr": 0.01,
      "weight_decay": 0.001,
      "betas": [
        0.9,
        0.999
      ]
    },
    "scheduler": {
      "type": "cosine",
      "warmup_epochs": 3
    },
    "experiment": {
      "name": "grid_lr0.01_wd0.001_s46",
      "seed": 46,
      "save_dir": "code/experiments/results",
      "output_dir": "/Users/ema/projects/DL4SE-project-UPM/code/experiments/results/experiment_grid_lr0.01_wd0.001_s46_20251129_165721"
    }
  },
  "device": "mps",
  "num_model_parameters": 28590666,
  "num_trainable_parameters": 772074,
  "best_val_metrics": {
    "precision_macro": 0.9616199813258637,
    "recall_macro": 0.9610424513979501,
    "f1_macro": 0.9611946152671305,
    "precision_micro": 0.9612213740458015,
    "recall_micro": 0.9612213740458015,
    "f1_micro": 0.9612213740458015,
    "accuracy": 0.9612213740458015,
    "hamming_loss": 0.038778625954198474,
    "no_defect_precision": 0.9511764705882353,
    "no_defect_recall": 0.9735099337748344,
    "no_defect_f1": 0.9622136268967569,
    "no_defect_tp": 1617,
    "no_defect_fp": 83,
    "no_defect_tn": 1531,
    "no_defect_fn": 44,
    "no_defect_support": 1661,
    "defect_precision": 0.9720634920634921,
    "defect_recall": 0.9485749690210656,
    "defect_f1": 0.9601756036375039,
    "defect_tp": 1531,
    "defect_fp": 44,
    "defect_tn": 1617,
    "defect_fn": 83,
    "defect_support": 1614
  },
  "test_metrics": {
    "precision_macro": 0.9596564685073101,
    "recall_macro": 0.9585282754561069,
    "f1_macro": 0.9587589895278904,
    "precision_micro": 0.9588037839487336,
    "recall_micro": 0.9588037839487336,
    "f1_micro": 0.9588037839487336,
    "accuracy": 0.9588037839487336,
    "hamming_loss": 0.0411962160512664,
    "no_defect_precision": 0.943122460824144,
    "no_defect_recall": 0.9777376654632972,
    "no_defect_f1": 0.9601181683899557,
    "no_defect_tp": 1625,
    "no_defect_fp": 98,
    "no_defect_tn": 1517,
    "no_defect_fn": 37,
    "no_defect_support": 1662,
    "defect_precision": 0.9761904761904762,
    "defect_recall": 0.9393188854489164,
    "defect_f1": 0.9573998106658251,
    "defect_tp": 1517,
    "defect_fp": 37,
    "defect_tn": 1625,
    "defect_fn": 98,
    "defect_support": 1615
  },
  "training_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14
    ],
    "train_loss": [
      0.39153845620704,
      0.2155403367645072,
      0.19439656798684946,
      0.18616392214053845,
      0.18114800606250264,
      0.1789746375824617,
      0.18359332565981973,
      0.18295399967783665,
      0.18437792211147533,
      0.17820953102353726,
      0.18325131032693834,
      0.1731392650175294,
      0.18213139451011454,
      0.18962285923284466
    ],
    "val_loss": [
      0.2907984609214159,
      0.1634531610000592,
      0.13355273452515787,
      0.12195488832031305,
      0.12752555081477532,
      0.1148405485571577,
      0.12395702753789149,
      0.11256853885088976,
      0.10598869507129376,
      0.11248281476302789,
      0.11119470043251148,
      0.12370403784398849,
      0.11739159085286352,
      0.10876810608001855
    ]
  },
  "metrics_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14
    ],
    "train_metrics": [
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null
    ],
    "val_metrics": [
      {
        "precision_macro": 0.9210517967008605,
        "recall_macro": 0.9207989319821221,
        "f1_macro": 0.9208798845227352,
        "precision_micro": 0.9209160305343511,
        "recall_micro": 0.9209160305343511,
        "f1_micro": 0.9209160305343511,
        "accuracy": 0.9209160305343511,
        "hamming_loss": 0.07908396946564886,
        "no_defect_precision": 0.916270783847981,
        "no_defect_recall": 0.9289584587597832,
        "no_defect_f1": 0.9225710014947683,
        "no_defect_tp": 1543,
        "no_defect_fp": 141,
        "no_defect_tn": 1473,
        "no_defect_fn": 118,
        "no_defect_support": 1661,
        "defect_precision": 0.9258328095537398,
        "defect_recall": 0.912639405204461,
        "defect_f1": 0.919188767550702,
        "defect_tp": 1473,
        "defect_fp": 118,
        "defect_tn": 1543,
        "defect_fn": 141,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9481724941724943,
        "recall_macro": 0.9482386955798413,
        "f1_macro": 0.9480910174477581,
        "precision_micro": 0.9480916030534351,
        "recall_micro": 0.9480916030534351,
        "f1_micro": 0.9480916030534351,
        "accuracy": 0.9480916030534351,
        "hamming_loss": 0.051908396946564885,
        "no_defect_precision": 0.9587692307692308,
        "no_defect_recall": 0.937989163154726,
        "no_defect_f1": 0.9482653682288497,
        "no_defect_tp": 1558,
        "no_defect_fp": 67,
        "no_defect_tn": 1547,
        "no_defect_fn": 103,
        "no_defect_support": 1661,
        "defect_precision": 0.9375757575757576,
        "defect_recall": 0.9584882280049566,
        "defect_f1": 0.9479166666666666,
        "defect_tp": 1547,
        "defect_fp": 103,
        "defect_tn": 1558,
        "defect_fn": 67,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9532893961521651,
        "recall_macro": 0.9533823923272211,
        "f1_macro": 0.9532803344963017,
        "precision_micro": 0.9532824427480916,
        "recall_micro": 0.9532824427480916,
        "f1_micro": 0.9532824427480916,
        "accuracy": 0.9532824427480916,
        "hamming_loss": 0.0467175572519084,
        "no_defect_precision": 0.960880195599022,
        "no_defect_recall": 0.946417820590006,
        "no_defect_f1": 0.9535941765241128,
        "no_defect_tp": 1572,
        "no_defect_fp": 64,
        "no_defect_tn": 1550,
        "no_defect_fn": 89,
        "no_defect_support": 1661,
        "defect_precision": 0.9456985967053081,
        "defect_recall": 0.9603469640644362,
        "defect_f1": 0.9529664924684906,
        "defect_tp": 1550,
        "defect_fp": 89,
        "defect_tn": 1572,
        "defect_fn": 64,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9549610425866708,
        "recall_macro": 0.9547034265946598,
        "f1_macro": 0.9547890916254511,
        "precision_micro": 0.9548091603053435,
        "recall_micro": 0.9548091603053435,
        "f1_micro": 0.9548091603053435,
        "accuracy": 0.9548091603053435,
        "hamming_loss": 0.04519083969465649,
        "no_defect_precision": 0.9494949494949495,
        "no_defect_recall": 0.9620710415412402,
        "no_defect_f1": 0.9557416267942583,
        "no_defect_tp": 1598,
        "no_defect_fp": 85,
        "no_defect_tn": 1529,
        "no_defect_fn": 63,
        "no_defect_support": 1661,
        "defect_precision": 0.960427135678392,
        "defect_recall": 0.9473358116480793,
        "defect_f1": 0.9538365564566438,
        "defect_tp": 1529,
        "defect_fp": 63,
        "defect_tn": 1598,
        "defect_fn": 85,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9521621925193755,
        "recall_macro": 0.9504833161373204,
        "f1_macro": 0.9507668200253806,
        "precision_micro": 0.9508396946564885,
        "recall_micro": 0.9508396946564885,
        "f1_micro": 0.9508396946564885,
        "accuracy": 0.9508396946564885,
        "hamming_loss": 0.04916030534351145,
        "no_defect_precision": 0.9310344827586207,
        "no_defect_recall": 0.975316074653823,
        "no_defect_f1": 0.9526609820640988,
        "no_defect_tp": 1620,
        "no_defect_fp": 120,
        "no_defect_tn": 1494,
        "no_defect_fn": 41,
        "no_defect_support": 1661,
        "defect_precision": 0.9732899022801303,
        "defect_recall": 0.9256505576208178,
        "defect_f1": 0.9488726579866624,
        "defect_tp": 1494,
        "defect_fp": 41,
        "defect_tn": 1620,
        "defect_fn": 120,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9554394275693955,
        "recall_macro": 0.9549518548940001,
        "f1_macro": 0.955086347005164,
        "precision_micro": 0.9551145038167939,
        "recall_micro": 0.9551145038167939,
        "f1_micro": 0.9551145038167939,
        "accuracy": 0.9551145038167939,
        "hamming_loss": 0.04488549618320611,
        "no_defect_precision": 0.9463443396226415,
        "no_defect_recall": 0.9662853702588802,
        "no_defect_f1": 0.9562109025915997,
        "no_defect_tp": 1605,
        "no_defect_fp": 91,
        "no_defect_tn": 1523,
        "no_defect_fn": 56,
        "no_defect_support": 1661,
        "defect_precision": 0.9645345155161494,
        "defect_recall": 0.9436183395291202,
        "defect_f1": 0.9539617914187285,
        "defect_tp": 1523,
        "defect_fp": 56,
        "defect_tn": 1605,
        "defect_fn": 91,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9498936033688785,
        "recall_macro": 0.9498402374765653,
        "f1_macro": 0.9496181515066445,
        "precision_micro": 0.9496183206106871,
        "recall_micro": 0.9496183206106871,
        "f1_micro": 0.9496183206106871,
        "accuracy": 0.9496183206106871,
        "hamming_loss": 0.050381679389312976,
        "no_defect_precision": 0.9651741293532339,
        "no_defect_recall": 0.9343768813967489,
        "no_defect_f1": 0.9495258488834506,
        "no_defect_tp": 1552,
        "no_defect_fp": 56,
        "no_defect_tn": 1558,
        "no_defect_fn": 109,
        "no_defect_support": 1661,
        "defect_precision": 0.9346130773845231,
        "defect_recall": 0.9653035935563816,
        "defect_f1": 0.9497104541298385,
        "defect_tp": 1558,
        "defect_fp": 109,
        "defect_tn": 1552,
        "defect_fn": 56,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9595690830640491,
        "recall_macro": 0.9588826918586391,
        "f1_macro": 0.9590523547625233,
        "precision_micro": 0.9590839694656489,
        "recall_micro": 0.9590839694656489,
        "f1_micro": 0.9590839694656489,
        "accuracy": 0.9590839694656489,
        "hamming_loss": 0.040916030534351146,
        "no_defect_precision": 0.9478005865102639,
        "no_defect_recall": 0.9729078868151716,
        "no_defect_f1": 0.960190136660725,
        "no_defect_tp": 1616,
        "no_defect_fp": 89,
        "no_defect_tn": 1525,
        "no_defect_fn": 45,
        "no_defect_support": 1661,
        "defect_precision": 0.9713375796178344,
        "defect_recall": 0.9448574969021065,
        "defect_f1": 0.9579145728643216,
        "defect_tp": 1525,
        "defect_fp": 45,
        "defect_tn": 1616,
        "defect_fn": 89,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9616199813258637,
        "recall_macro": 0.9610424513979501,
        "f1_macro": 0.9611946152671305,
        "precision_micro": 0.9612213740458015,
        "recall_micro": 0.9612213740458015,
        "f1_micro": 0.9612213740458015,
        "accuracy": 0.9612213740458015,
        "hamming_loss": 0.038778625954198474,
        "no_defect_precision": 0.9511764705882353,
        "no_defect_recall": 0.9735099337748344,
        "no_defect_f1": 0.9622136268967569,
        "no_defect_tp": 1617,
        "no_defect_fp": 83,
        "no_defect_tn": 1531,
        "no_defect_fn": 44,
        "no_defect_support": 1661,
        "defect_precision": 0.9720634920634921,
        "defect_recall": 0.9485749690210656,
        "defect_f1": 0.9601756036375039,
        "defect_tp": 1531,
        "defect_fp": 44,
        "defect_tn": 1617,
        "defect_fn": 83,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9603311670271368,
        "recall_macro": 0.9598383574786243,
        "f1_macro": 0.9599749078753503,
        "precision_micro": 0.96,
        "recall_micro": 0.96,
        "f1_micro": 0.96,
        "accuracy": 0.96,
        "hamming_loss": 0.04,
        "no_defect_precision": 0.9510613207547169,
        "no_defect_recall": 0.971101745936183,
        "no_defect_f1": 0.9609770628537384,
        "no_defect_tp": 1613,
        "no_defect_fp": 83,
        "no_defect_tn": 1531,
        "no_defect_fn": 48,
        "no_defect_support": 1661,
        "defect_precision": 0.9696010132995567,
        "defect_recall": 0.9485749690210656,
        "defect_f1": 0.9589727528969622,
        "defect_tp": 1531,
        "defect_fp": 48,
        "defect_tn": 1613,
        "defect_fn": 83,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9600098950748666,
        "recall_macro": 0.9595373339987929,
        "f1_macro": 0.9596699861107276,
        "precision_micro": 0.9596946564885496,
        "recall_micro": 0.9596946564885496,
        "f1_micro": 0.9596946564885496,
        "accuracy": 0.9596946564885496,
        "hamming_loss": 0.04030534351145038,
        "no_defect_precision": 0.9510324483775812,
        "no_defect_recall": 0.9704996989765202,
        "no_defect_f1": 0.9606674612634089,
        "no_defect_tp": 1612,
        "no_defect_fp": 83,
        "no_defect_tn": 1531,
        "no_defect_fn": 49,
        "no_defect_support": 1661,
        "defect_precision": 0.9689873417721518,
        "defect_recall": 0.9485749690210656,
        "defect_f1": 0.9586725109580463,
        "defect_tp": 1531,
        "defect_fp": 49,
        "defect_tn": 1612,
        "defect_fn": 83,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9566024968237308,
        "recall_macro": 0.9563282819579134,
        "f1_macro": 0.9560283656202239,
        "precision_micro": 0.956030534351145,
        "recall_micro": 0.956030534351145,
        "f1_micro": 0.956030534351145,
        "accuracy": 0.956030534351145,
        "hamming_loss": 0.04396946564885496,
        "no_defect_precision": 0.9767441860465116,
        "no_defect_recall": 0.9355809753160746,
        "no_defect_f1": 0.955719557195572,
        "no_defect_tp": 1554,
        "no_defect_fp": 37,
        "no_defect_tn": 1577,
        "no_defect_fn": 107,
        "no_defect_support": 1661,
        "defect_precision": 0.9364608076009501,
        "defect_recall": 0.9770755885997522,
        "defect_f1": 0.9563371740448757,
        "defect_tp": 1577,
        "defect_fp": 107,
        "defect_tn": 1554,
        "defect_fn": 37,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9566428917323966,
        "recall_macro": 0.9565679443938386,
        "f1_macro": 0.9563356173164275,
        "precision_micro": 0.9563358778625954,
        "recall_micro": 0.9563358778625954,
        "f1_micro": 0.9563358778625954,
        "accuracy": 0.9563358778625954,
        "hamming_loss": 0.04366412213740458,
        "no_defect_precision": 0.9726027397260274,
        "no_defect_recall": 0.9403973509933775,
        "no_defect_f1": 0.9562289562289562,
        "no_defect_tp": 1562,
        "no_defect_fp": 44,
        "no_defect_tn": 1570,
        "no_defect_fn": 99,
        "no_defect_support": 1661,
        "defect_precision": 0.9406830437387658,
        "defect_recall": 0.9727385377942999,
        "defect_f1": 0.9564422784038988,
        "defect_tp": 1570,
        "defect_fp": 99,
        "defect_tn": 1562,
        "defect_fn": 44,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.959019970339525,
        "recall_macro": 0.9578919627849931,
        "f1_macro": 0.9581223974961268,
        "precision_micro": 0.9581679389312977,
        "recall_micro": 0.9581679389312977,
        "f1_micro": 0.9581679389312977,
        "accuracy": 0.9581679389312977,
        "hamming_loss": 0.04183206106870229,
        "no_defect_precision": 0.9425087108013938,
        "no_defect_recall": 0.9771222155328115,
        "no_defect_f1": 0.9595033993496896,
        "no_defect_tp": 1623,
        "no_defect_fp": 99,
        "no_defect_tn": 1515,
        "no_defect_fn": 38,
        "no_defect_support": 1661,
        "defect_precision": 0.9755312298776562,
        "defect_recall": 0.9386617100371747,
        "defect_f1": 0.9567413956425639,
        "defect_tp": 1515,
        "defect_fp": 38,
        "defect_tn": 1623,
        "defect_fn": 99,
        "defect_support": 1614
      }
    ],
    "test_metrics": [
      {
        "precision_macro": 0.9596564685073101,
        "recall_macro": 0.9585282754561069,
        "f1_macro": 0.9587589895278904,
        "precision_micro": 0.9588037839487336,
        "recall_micro": 0.9588037839487336,
        "f1_micro": 0.9588037839487336,
        "accuracy": 0.9588037839487336,
        "hamming_loss": 0.0411962160512664,
        "no_defect_precision": 0.943122460824144,
        "no_defect_recall": 0.9777376654632972,
        "no_defect_f1": 0.9601181683899557,
        "no_defect_tp": 1625,
        "no_defect_fp": 98,
        "no_defect_tn": 1517,
        "no_defect_fn": 37,
        "no_defect_support": 1662,
        "defect_precision": 0.9761904761904762,
        "defect_recall": 0.9393188854489164,
        "defect_f1": 0.9573998106658251,
        "defect_tp": 1517,
        "defect_fp": 37,
        "defect_tn": 1625,
        "defect_fn": 98,
        "defect_support": 1615
      }
    ]
  }
}