{
  "experiment_name": "experiment_grid_lr0.001_wd0.1_s140_20251207_193401",
  "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s140_20251207_193401",
  "timestamp": "2025-12-07T19:35:54.625193",
  "model": "ConvNextTiny",
  "loss": "CrossEntropyLossWrapper",
  "loss_params": {
    "weight": null,
    "reduction": "mean"
  },
  "best_epoch": 15,
  "split_info": {
    "train": {
      "total_samples": 15284,
      "class_counts": {
        "no_defect": 7734,
        "defect": 7550
      }
    },
    "val": {
      "total_samples": 3275,
      "class_counts": {
        "no_defect": 1691,
        "defect": 1584
      }
    },
    "test": {
      "total_samples": 3276,
      "class_counts": {
        "no_defect": 1650,
        "defect": 1626
      }
    },
    "total": {
      "total_samples": 21835,
      "class_counts": {
        "no_defect": 11075,
        "defect": 10760
      }
    }
  },
  "config": {
    "model": {
      "name": "convnext_tiny",
      "num_classes": 2,
      "pretrained": true,
      "cbam_stages": [
        3,
        4
      ]
    },
    "loss": {
      "type": "cross_entropy",
      "weight": null,
      "reduction": "mean"
    },
    "data": {
      "img_dir": "data/images",
      "ann_dir": "data/annotations",
      "splits_dir": "data/splits",
      "batch_size": 64,
      "num_workers": 8,
      "pin_memory": false,
      "image_size": [
        150,
        150
      ],
      "num_classes": 2,
      "class_names": [
        "no_defect",
        "defect"
      ],
      "split_strategy": "stratified_70_15_15",
      "use_saved_splits": true
    },
    "augmentation": {
      "horizontal_flip": 0.5,
      "vertical_flip": 0.3,
      "rotation": 10,
      "brightness_contrast": {
        "brightness": 0.2,
        "contrast": 0.2
      },
      "defect_blackout": {
        "enabled": false
      }
    },
    "training": {
      "num_epochs": 15,
      "learning_rate": 0.001,
      "weight_decay": 0.1,
      "warmup_epochs": 2,
      "log_interval": 5,
      "threshold": 0.5,
      "save_checkpoints": false,
      "freeze_backbone": true,
      "freeze_early_stages": null
    },
    "optimizer": {
      "type": "adamw",
      "lr": 0.001,
      "weight_decay": 0.1,
      "betas": [
        0.9,
        0.999
      ]
    },
    "scheduler": {
      "type": "cosine",
      "warmup_epochs": 3
    },
    "experiment": {
      "name": "grid_lr0.001_wd0.1_s140",
      "seed": 140,
      "save_dir": "code/experiments/results",
      "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.001_wd0.1_s140_20251207_193401"
    }
  },
  "device": "cuda",
  "num_model_parameters": 28590666,
  "num_trainable_parameters": 772074,
  "best_val_metrics": {
    "precision_macro": 0.9564950815806987,
    "recall_macro": 0.9568345713193437,
    "f1_macro": 0.9566133544104454,
    "precision_micro": 0.9566412213740458,
    "recall_micro": 0.9566412213740458,
    "f1_micro": 0.9566412213740458,
    "accuracy": 0.9566412213740458,
    "hamming_loss": 0.0433587786259542,
    "no_defect_precision": 0.9646070785842832,
    "no_defect_recall": 0.9509166173861621,
    "no_defect_f1": 0.957712924359738,
    "no_defect_tp": 1608,
    "no_defect_fp": 59,
    "no_defect_tn": 1525,
    "no_defect_fn": 83,
    "no_defect_support": 1691,
    "defect_precision": 0.9483830845771144,
    "defect_recall": 0.9627525252525253,
    "defect_f1": 0.9555137844611529,
    "defect_tp": 1525,
    "defect_fp": 83,
    "defect_tn": 1608,
    "defect_fn": 59,
    "defect_support": 1584
  },
  "test_metrics": {
    "precision_macro": 0.9603122540015744,
    "recall_macro": 0.960319803198032,
    "f1_macro": 0.9603156706323663,
    "precision_micro": 0.9603174603174603,
    "recall_micro": 0.9603174603174603,
    "f1_micro": 0.9603174603174603,
    "accuracy": 0.9603174603174603,
    "hamming_loss": 0.03968253968253968,
    "no_defect_precision": 0.9611650485436893,
    "no_defect_recall": 0.96,
    "no_defect_f1": 0.960582171012735,
    "no_defect_tp": 1584,
    "no_defect_fp": 64,
    "no_defect_tn": 1562,
    "no_defect_fn": 66,
    "no_defect_support": 1650,
    "defect_precision": 0.9594594594594594,
    "defect_recall": 0.9606396063960639,
    "defect_f1": 0.9600491702519975,
    "defect_tp": 1562,
    "defect_fp": 66,
    "defect_tn": 1584,
    "defect_fn": 64,
    "defect_support": 1626
  },
  "training_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15
    ],
    "train_loss": [
      0.6105358921084942,
      0.41099706204865266,
      0.28981988923818996,
      0.2404936238437517,
      0.21866530538478157,
      0.20981871679612282,
      0.19997669260746265,
      0.1941396707832564,
      0.1905593550043126,
      0.18694627855487447,
      0.18100487537463839,
      0.18623654662814598,
      0.18204851937967365,
      0.18322869963850436,
      0.18335363175330302
    ],
    "val_loss": [
      0.5681899992319254,
      0.3474001597899657,
      0.25149191027650464,
      0.21434184192464903,
      0.19349520137676826,
      0.18172546877310827,
      0.1706921370843282,
      0.165185236873535,
      0.16241783720369524,
      0.1548961392388894,
      0.15221215827533832,
      0.14976209230147874,
      0.1507467024314862,
      0.14972235935811812,
      0.14942818192335275
    ]
  },
  "metrics_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15
    ],
    "train_metrics": [
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null
    ],
    "val_metrics": [
      {
        "precision_macro": 0.8605387517035121,
        "recall_macro": 0.8472696360410731,
        "f1_macro": 0.8481167095374518,
        "precision_micro": 0.8500763358778626,
        "recall_micro": 0.8500763358778626,
        "f1_micro": 0.8500763358778626,
        "accuracy": 0.8500763358778626,
        "hamming_loss": 0.1499236641221374,
        "no_defect_precision": 0.8067484662576687,
        "no_defect_recall": 0.9331756357185098,
        "no_defect_f1": 0.8653687962709076,
        "no_defect_tp": 1578,
        "no_defect_fp": 378,
        "no_defect_tn": 1206,
        "no_defect_fn": 113,
        "no_defect_support": 1691,
        "defect_precision": 0.9143290371493555,
        "defect_recall": 0.7613636363636364,
        "defect_f1": 0.8308646228039959,
        "defect_tp": 1206,
        "defect_fp": 113,
        "defect_tn": 1578,
        "defect_fn": 378,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9082013343433342,
        "recall_macro": 0.9055862065360882,
        "f1_macro": 0.9062324563045024,
        "precision_micro": 0.9065648854961832,
        "recall_micro": 0.9065648854961832,
        "f1_micro": 0.9065648854961832,
        "accuracy": 0.9065648854961832,
        "hamming_loss": 0.0934351145038168,
        "no_defect_precision": 0.8892636312535133,
        "no_defect_recall": 0.9355410999408634,
        "no_defect_f1": 0.9118155619596542,
        "no_defect_tp": 1582,
        "no_defect_fp": 197,
        "no_defect_tn": 1387,
        "no_defect_fn": 109,
        "no_defect_support": 1691,
        "defect_precision": 0.9271390374331551,
        "defect_recall": 0.8756313131313131,
        "defect_f1": 0.9006493506493507,
        "defect_tp": 1387,
        "defect_fp": 109,
        "defect_tn": 1582,
        "defect_fn": 197,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9319276495683027,
        "recall_macro": 0.9312103889277159,
        "f1_macro": 0.9314796217256675,
        "precision_micro": 0.9316030534351145,
        "recall_micro": 0.9316030534351145,
        "f1_micro": 0.9316030534351145,
        "accuracy": 0.9316030534351145,
        "hamming_loss": 0.0683969465648855,
        "no_defect_precision": 0.9257109692396982,
        "no_defect_recall": 0.9432288586635127,
        "no_defect_f1": 0.9343878148799063,
        "no_defect_tp": 1595,
        "no_defect_fp": 128,
        "no_defect_tn": 1456,
        "no_defect_fn": 96,
        "no_defect_support": 1691,
        "defect_precision": 0.9381443298969072,
        "defect_recall": 0.9191919191919192,
        "defect_f1": 0.9285714285714286,
        "defect_tp": 1456,
        "defect_fp": 96,
        "defect_tn": 1595,
        "defect_fn": 128,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9418826866730119,
        "recall_macro": 0.9419826592357639,
        "f1_macro": 0.9419295027429619,
        "precision_micro": 0.9419847328244275,
        "recall_micro": 0.9419847328244275,
        "f1_micro": 0.9419847328244275,
        "accuracy": 0.9419847328244275,
        "hamming_loss": 0.05801526717557252,
        "no_defect_precision": 0.94540059347181,
        "no_defect_recall": 0.9420461265523359,
        "no_defect_f1": 0.9437203791469194,
        "no_defect_tp": 1593,
        "no_defect_fp": 92,
        "no_defect_tn": 1492,
        "no_defect_fn": 98,
        "no_defect_support": 1691,
        "defect_precision": 0.9383647798742139,
        "defect_recall": 0.9419191919191919,
        "defect_f1": 0.9401386263390044,
        "defect_tp": 1492,
        "defect_fp": 98,
        "defect_tn": 1593,
        "defect_fn": 92,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9467431607607464,
        "recall_macro": 0.9469332965969571,
        "f1_macro": 0.9468254856950898,
        "precision_micro": 0.9468702290076336,
        "recall_micro": 0.9468702290076336,
        "f1_micro": 0.9468702290076336,
        "accuracy": 0.9468702290076336,
        "hamming_loss": 0.05312977099236641,
        "no_defect_precision": 0.9517569982132221,
        "no_defect_recall": 0.9450029568302779,
        "no_defect_f1": 0.9483679525222551,
        "no_defect_tp": 1598,
        "no_defect_fp": 81,
        "no_defect_tn": 1503,
        "no_defect_fn": 93,
        "no_defect_support": 1691,
        "defect_precision": 0.9417293233082706,
        "defect_recall": 0.9488636363636364,
        "defect_f1": 0.9452830188679245,
        "defect_tp": 1503,
        "defect_fp": 93,
        "defect_tn": 1598,
        "defect_fn": 81,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9476588399232544,
        "recall_macro": 0.9480800016725505,
        "f1_macro": 0.9477610109509488,
        "precision_micro": 0.9477862595419847,
        "recall_micro": 0.9477862595419847,
        "f1_micro": 0.9477862595419847,
        "accuracy": 0.9477862595419847,
        "hamming_loss": 0.052213740458015266,
        "no_defect_precision": 0.9589371980676329,
        "no_defect_recall": 0.9390892962743939,
        "no_defect_f1": 0.9489094711682103,
        "no_defect_tp": 1588,
        "no_defect_fp": 68,
        "no_defect_tn": 1516,
        "no_defect_fn": 103,
        "no_defect_support": 1691,
        "defect_precision": 0.9363804817788759,
        "defect_recall": 0.9570707070707071,
        "defect_f1": 0.9466125507336872,
        "defect_tp": 1516,
        "defect_fp": 103,
        "defect_tn": 1588,
        "defect_fn": 68,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9507003245178858,
        "recall_macro": 0.9510967525640797,
        "f1_macro": 0.9508132064173664,
        "precision_micro": 0.9508396946564885,
        "recall_micro": 0.9508396946564885,
        "f1_micro": 0.9508396946564885,
        "accuracy": 0.9508396946564885,
        "hamming_loss": 0.04916030534351145,
        "no_defect_precision": 0.9608433734939759,
        "no_defect_recall": 0.9432288586635127,
        "no_defect_f1": 0.951954640405849,
        "no_defect_tp": 1595,
        "no_defect_fp": 65,
        "no_defect_tn": 1519,
        "no_defect_fn": 96,
        "no_defect_support": 1691,
        "defect_precision": 0.9405572755417957,
        "defect_recall": 0.9589646464646465,
        "defect_f1": 0.949671772428884,
        "defect_tp": 1519,
        "defect_fp": 96,
        "defect_tn": 1595,
        "defect_fn": 65,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9528542389317818,
        "recall_macro": 0.9532863749858131,
        "f1_macro": 0.9529549882730269,
        "precision_micro": 0.9529770992366412,
        "recall_micro": 0.9529770992366412,
        "f1_micro": 0.9529770992366412,
        "accuracy": 0.9529770992366412,
        "hamming_loss": 0.04702290076335878,
        "no_defect_precision": 0.9643504531722055,
        "no_defect_recall": 0.9438202247191011,
        "no_defect_f1": 0.9539748953974896,
        "no_defect_tp": 1596,
        "no_defect_fp": 59,
        "no_defect_tn": 1525,
        "no_defect_fn": 95,
        "no_defect_support": 1691,
        "defect_precision": 0.941358024691358,
        "defect_recall": 0.9627525252525253,
        "defect_f1": 0.9519350811485643,
        "defect_tp": 1525,
        "defect_fp": 95,
        "defect_tn": 1596,
        "defect_fn": 59,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9508158051764004,
        "recall_macro": 0.9512964879427033,
        "f1_macro": 0.950825316771134,
        "precision_micro": 0.9508396946564885,
        "recall_micro": 0.9508396946564885,
        "f1_micro": 0.9508396946564885,
        "accuracy": 0.9508396946564885,
        "hamming_loss": 0.04916030534351145,
        "no_defect_precision": 0.9664634146341463,
        "no_defect_recall": 0.9373151981076286,
        "no_defect_f1": 0.9516661663164215,
        "no_defect_tp": 1585,
        "no_defect_fp": 55,
        "no_defect_tn": 1529,
        "no_defect_fn": 106,
        "no_defect_support": 1691,
        "defect_precision": 0.9351681957186544,
        "defect_recall": 0.9652777777777778,
        "defect_f1": 0.9499844672258465,
        "defect_tp": 1529,
        "defect_fp": 106,
        "defect_tn": 1585,
        "defect_fn": 55,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9537503693732147,
        "recall_macro": 0.9540336093041593,
        "f1_macro": 0.9538598161334316,
        "precision_micro": 0.9538931297709924,
        "recall_micro": 0.9538931297709924,
        "f1_micro": 0.9538931297709924,
        "accuracy": 0.9538931297709924,
        "hamming_loss": 0.046106870229007633,
        "no_defect_precision": 0.9605263157894737,
        "no_defect_recall": 0.9497338852749853,
        "no_defect_f1": 0.9550996134403806,
        "no_defect_tp": 1606,
        "no_defect_fp": 66,
        "no_defect_tn": 1518,
        "no_defect_fn": 85,
        "no_defect_support": 1691,
        "defect_precision": 0.9469744229569557,
        "defect_recall": 0.9583333333333334,
        "defect_f1": 0.9526200188264826,
        "defect_tp": 1518,
        "defect_fp": 85,
        "defect_tn": 1606,
        "defect_fn": 66,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9549680033604493,
        "recall_macro": 0.9553162091046479,
        "f1_macro": 0.955086347005164,
        "precision_micro": 0.9551145038167939,
        "recall_micro": 0.9551145038167939,
        "f1_micro": 0.9551145038167939,
        "accuracy": 0.9551145038167939,
        "hamming_loss": 0.04488549618320611,
        "no_defect_precision": 0.9633853541416567,
        "no_defect_recall": 0.9491425192193969,
        "no_defect_f1": 0.9562109025915997,
        "no_defect_tp": 1605,
        "no_defect_fp": 61,
        "no_defect_tn": 1523,
        "no_defect_fn": 86,
        "no_defect_support": 1691,
        "defect_precision": 0.9465506525792418,
        "defect_recall": 0.961489898989899,
        "defect_f1": 0.9539617914187285,
        "defect_tp": 1523,
        "defect_fp": 86,
        "defect_tn": 1605,
        "defect_fn": 61,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9552907144664282,
        "recall_macro": 0.9555120244431303,
        "f1_macro": 0.9553838694795995,
        "precision_micro": 0.9554198473282443,
        "recall_micro": 0.9554198473282443,
        "f1_micro": 0.9554198473282443,
        "accuracy": 0.9554198473282443,
        "hamming_loss": 0.044580152671755725,
        "no_defect_precision": 0.960644007155635,
        "no_defect_recall": 0.9526907155529273,
        "no_defect_f1": 0.9566508313539193,
        "no_defect_tp": 1611,
        "no_defect_fp": 66,
        "no_defect_tn": 1518,
        "no_defect_fn": 80,
        "no_defect_support": 1691,
        "defect_precision": 0.9499374217772215,
        "defect_recall": 0.9583333333333334,
        "defect_f1": 0.9541169076052797,
        "defect_tp": 1518,
        "defect_fp": 80,
        "defect_tn": 1611,
        "defect_fn": 66,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9549759409153642,
        "recall_macro": 0.9553761297182349,
        "f1_macro": 0.9550903189028129,
        "precision_micro": 0.9551145038167939,
        "recall_micro": 0.9551145038167939,
        "f1_micro": 0.9551145038167939,
        "accuracy": 0.9551145038167939,
        "hamming_loss": 0.04488549618320611,
        "no_defect_precision": 0.9650602409638555,
        "no_defect_recall": 0.9473684210526315,
        "no_defect_f1": 0.9561324977618622,
        "no_defect_tp": 1602,
        "no_defect_fp": 58,
        "no_defect_tn": 1526,
        "no_defect_fn": 89,
        "no_defect_support": 1691,
        "defect_precision": 0.944891640866873,
        "defect_recall": 0.9633838383838383,
        "defect_f1": 0.9540481400437637,
        "defect_tp": 1526,
        "defect_fp": 89,
        "defect_tn": 1602,
        "defect_fn": 58,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9555801386501457,
        "recall_macro": 0.955947522235961,
        "f1_macro": 0.9556987562067221,
        "precision_micro": 0.9557251908396946,
        "recall_micro": 0.9557251908396946,
        "f1_micro": 0.9557251908396946,
        "accuracy": 0.9557251908396946,
        "hamming_loss": 0.044274809160305344,
        "no_defect_precision": 0.9645432692307693,
        "no_defect_recall": 0.9491425192193969,
        "no_defect_f1": 0.9567809239940388,
        "no_defect_tp": 1605,
        "no_defect_fp": 59,
        "no_defect_tn": 1525,
        "no_defect_fn": 86,
        "no_defect_support": 1691,
        "defect_precision": 0.946617008069522,
        "defect_recall": 0.9627525252525253,
        "defect_f1": 0.9546165884194053,
        "defect_tp": 1525,
        "defect_fp": 86,
        "defect_tn": 1605,
        "defect_fn": 59,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9564950815806987,
        "recall_macro": 0.9568345713193437,
        "f1_macro": 0.9566133544104454,
        "precision_micro": 0.9566412213740458,
        "recall_micro": 0.9566412213740458,
        "f1_micro": 0.9566412213740458,
        "accuracy": 0.9566412213740458,
        "hamming_loss": 0.0433587786259542,
        "no_defect_precision": 0.9646070785842832,
        "no_defect_recall": 0.9509166173861621,
        "no_defect_f1": 0.957712924359738,
        "no_defect_tp": 1608,
        "no_defect_fp": 59,
        "no_defect_tn": 1525,
        "no_defect_fn": 83,
        "no_defect_support": 1691,
        "defect_precision": 0.9483830845771144,
        "defect_recall": 0.9627525252525253,
        "defect_f1": 0.9555137844611529,
        "defect_tp": 1525,
        "defect_fp": 83,
        "defect_tn": 1608,
        "defect_fn": 59,
        "defect_support": 1584
      }
    ],
    "test_metrics": [
      {
        "precision_macro": 0.9603122540015744,
        "recall_macro": 0.960319803198032,
        "f1_macro": 0.9603156706323663,
        "precision_micro": 0.9603174603174603,
        "recall_micro": 0.9603174603174603,
        "f1_micro": 0.9603174603174603,
        "accuracy": 0.9603174603174603,
        "hamming_loss": 0.03968253968253968,
        "no_defect_precision": 0.9611650485436893,
        "no_defect_recall": 0.96,
        "no_defect_f1": 0.960582171012735,
        "no_defect_tp": 1584,
        "no_defect_fp": 64,
        "no_defect_tn": 1562,
        "no_defect_fn": 66,
        "no_defect_support": 1650,
        "defect_precision": 0.9594594594594594,
        "defect_recall": 0.9606396063960639,
        "defect_f1": 0.9600491702519975,
        "defect_tp": 1562,
        "defect_fp": 66,
        "defect_tn": 1584,
        "defect_fn": 64,
        "defect_support": 1626
      }
    ]
  }
}