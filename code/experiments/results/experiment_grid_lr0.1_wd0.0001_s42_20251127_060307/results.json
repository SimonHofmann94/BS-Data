{
  "experiment_name": "experiment_grid_lr0.1_wd0.0001_s42_20251127_060307",
  "experiment_dir": "/Users/ema/projects/DL4SE-project-UPM/code/experiments/results/experiment_grid_lr0.1_wd0.0001_s42_20251127_060307",
  "timestamp": "2025-11-27T06:23:12.544687",
  "model": "ConvNextTiny",
  "loss": "CrossEntropyLossWrapper",
  "loss_params": {
    "weight": null,
    "reduction": "mean"
  },
  "best_epoch": 5,
  "split_info": {
    "train": {
      "total_samples": 15283,
      "class_counts": {
        "no_defect": 7752,
        "defect": 7531
      }
    },
    "val": {
      "total_samples": 3275,
      "class_counts": {
        "no_defect": 1661,
        "defect": 1614
      }
    },
    "test": {
      "total_samples": 3277,
      "class_counts": {
        "no_defect": 1662,
        "defect": 1615
      }
    },
    "total": {
      "total_samples": 21835,
      "class_counts": {
        "no_defect": 11075,
        "defect": 10760
      }
    }
  },
  "config": {
    "model": {
      "name": "convnext_tiny",
      "num_classes": 2,
      "pretrained": true,
      "cbam_stages": [
        3,
        4
      ]
    },
    "loss": {
      "type": "cross_entropy",
      "weight": null,
      "reduction": "mean"
    },
    "data": {
      "img_dir": "data/images",
      "ann_dir": "data/annotations",
      "splits_dir": "data/splits",
      "batch_size": 64,
      "num_workers": 0,
      "pin_memory": false,
      "image_size": [
        150,
        150
      ],
      "num_classes": 2,
      "class_names": [
        "no_defect",
        "defect"
      ],
      "split_strategy": "stratified_70_15_15",
      "use_saved_splits": true
    },
    "augmentation": {
      "horizontal_flip": 0.5,
      "vertical_flip": 0.3,
      "rotation": 10,
      "brightness_contrast": {
        "brightness": 0.2,
        "contrast": 0.2
      },
      "defect_blackout": {
        "enabled": false
      }
    },
    "training": {
      "num_epochs": 50,
      "learning_rate": 0.1,
      "weight_decay": 0.0001,
      "warmup_epochs": 2,
      "early_stopping_patience": 5,
      "early_stopping_metric": "f1_macro",
      "log_interval": 5,
      "threshold": 0.5,
      "freeze_backbone": true,
      "freeze_early_stages": null
    },
    "optimizer": {
      "type": "adamw",
      "lr": 0.1,
      "weight_decay": 0.0001,
      "betas": [
        0.9,
        0.999
      ]
    },
    "scheduler": {
      "type": "cosine",
      "warmup_epochs": 3
    },
    "experiment": {
      "name": "grid_lr0.1_wd0.0001_s42",
      "seed": 42,
      "save_dir": "code/experiments/results",
      "output_dir": "/Users/ema/projects/DL4SE-project-UPM/code/experiments/results/experiment_grid_lr0.1_wd0.0001_s42_20251127_060307"
    }
  },
  "device": "mps",
  "num_model_parameters": 28590666,
  "num_trainable_parameters": 772074,
  "best_val_metrics": {
    "precision_macro": 0.9561298390718171,
    "recall_macro": 0.9561880281432708,
    "f1_macro": 0.9560302022909049,
    "precision_micro": 0.956030534351145,
    "recall_micro": 0.956030534351145,
    "f1_micro": 0.956030534351145,
    "accuracy": 0.956030534351145,
    "hamming_loss": 0.04396946564885496,
    "no_defect_precision": 0.9673444239063462,
    "no_defect_recall": 0.9452137266706803,
    "no_defect_f1": 0.9561510353227771,
    "no_defect_tp": 1570,
    "no_defect_fp": 53,
    "no_defect_tn": 1561,
    "no_defect_fn": 91,
    "no_defect_support": 1661,
    "defect_precision": 0.9449152542372882,
    "defect_recall": 0.9671623296158612,
    "defect_f1": 0.9559093692590325,
    "defect_tp": 1561,
    "defect_fp": 91,
    "defect_tn": 1570,
    "defect_fn": 53,
    "defect_support": 1614
  },
  "test_metrics": {
    "precision_macro": 0.935322962714267,
    "recall_macro": 0.9347585623647141,
    "f1_macro": 0.934381434739212,
    "precision_micro": 0.934391211473909,
    "recall_micro": 0.934391211473909,
    "f1_micro": 0.934391211473909,
    "accuracy": 0.934391211473909,
    "hamming_loss": 0.06560878852609094,
    "no_defect_precision": 0.9593650793650793,
    "no_defect_recall": 0.9091456077015644,
    "no_defect_f1": 0.9335804757491505,
    "no_defect_tp": 1511,
    "no_defect_fp": 64,
    "no_defect_tn": 1551,
    "no_defect_fn": 151,
    "no_defect_support": 1662,
    "defect_precision": 0.9112808460634547,
    "defect_recall": 0.9603715170278638,
    "defect_f1": 0.9351823937292735,
    "defect_tp": 1551,
    "defect_fp": 151,
    "defect_tn": 1511,
    "defect_fn": 64,
    "defect_support": 1615
  },
  "training_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10
    ],
    "train_loss": [
      0.2295902494543766,
      0.2967920777656793,
      0.5672403394739498,
      0.5730658100847794,
      0.5214820640185014,
      0.6016266593499163,
      0.5968607585978496,
      0.5755331236323552,
      0.5770207913631425,
      0.5649295887640954
    ],
    "val_loss": [
      0.13892152117421994,
      0.17044855861996228,
      0.21101224654389975,
      0.23137496634780502,
      0.21289922535652295,
      0.4892020594830123,
      0.2473224527292097,
      0.23516911352411485,
      0.22776138799571738,
      0.29251452112713683
    ]
  },
  "metrics_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10
    ],
    "train_metrics": [
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null
    ],
    "val_metrics": [
      {
        "precision_macro": 0.9523839635058062,
        "recall_macro": 0.952330302209669,
        "f1_macro": 0.9523539338919926,
        "precision_micro": 0.9523664122137404,
        "recall_micro": 0.9523664122137404,
        "f1_micro": 0.9523664122137404,
        "accuracy": 0.9523664122137404,
        "hamming_loss": 0.04763358778625954,
        "no_defect_precision": 0.9514097180563887,
        "no_defect_recall": 0.954846478025286,
        "no_defect_f1": 0.953125,
        "no_defect_tp": 1586,
        "no_defect_fp": 81,
        "no_defect_tn": 1533,
        "no_defect_fn": 75,
        "no_defect_support": 1661,
        "defect_precision": 0.9533582089552238,
        "defect_recall": 0.949814126394052,
        "defect_f1": 0.9515828677839852,
        "defect_tp": 1533,
        "defect_fp": 75,
        "defect_tn": 1586,
        "defect_fn": 81,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9484129265280953,
        "recall_macro": 0.9480954576414828,
        "f1_macro": 0.9477829684784516,
        "precision_micro": 0.9477862595419847,
        "recall_micro": 0.9477862595419847,
        "f1_micro": 0.9477862595419847,
        "accuracy": 0.9477862595419847,
        "hamming_loss": 0.052213740458015266,
        "no_defect_precision": 0.9691435768261965,
        "no_defect_recall": 0.9265502709211318,
        "no_defect_f1": 0.9473684210526315,
        "no_defect_tp": 1539,
        "no_defect_fp": 49,
        "no_defect_tn": 1565,
        "no_defect_fn": 122,
        "no_defect_support": 1661,
        "defect_precision": 0.9276822762299941,
        "defect_recall": 0.969640644361834,
        "defect_f1": 0.9481975159042715,
        "defect_tp": 1565,
        "defect_fp": 122,
        "defect_tn": 1539,
        "defect_fn": 49,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9475096668860463,
        "recall_macro": 0.9474145179110836,
        "f1_macro": 0.9471750800077385,
        "precision_micro": 0.947175572519084,
        "recall_micro": 0.947175572519084,
        "f1_micro": 0.947175572519084,
        "accuracy": 0.947175572519084,
        "hamming_loss": 0.05282442748091603,
        "no_defect_precision": 0.9638403990024937,
        "no_defect_recall": 0.9307645996387718,
        "no_defect_f1": 0.9470137825421133,
        "no_defect_tp": 1546,
        "no_defect_fp": 58,
        "no_defect_tn": 1556,
        "no_defect_fn": 115,
        "no_defect_support": 1661,
        "defect_precision": 0.931178934769599,
        "defect_recall": 0.9640644361833953,
        "defect_f1": 0.9473363774733637,
        "defect_tp": 1556,
        "defect_fp": 115,
        "defect_tn": 1546,
        "defect_fn": 58,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.945815837112517,
        "recall_macro": 0.9455324683850743,
        "f1_macro": 0.9456232981337584,
        "precision_micro": 0.945648854961832,
        "recall_micro": 0.945648854961832,
        "f1_micro": 0.945648854961832,
        "accuracy": 0.945648854961832,
        "hamming_loss": 0.05435114503816794,
        "no_defect_precision": 0.9400593471810089,
        "no_defect_recall": 0.9536423841059603,
        "no_defect_f1": 0.9468021518230724,
        "no_defect_tp": 1584,
        "no_defect_fp": 101,
        "no_defect_tn": 1513,
        "no_defect_fn": 77,
        "no_defect_support": 1661,
        "defect_precision": 0.9515723270440252,
        "defect_recall": 0.9374225526641884,
        "defect_f1": 0.9444444444444444,
        "defect_tp": 1513,
        "defect_fp": 77,
        "defect_tn": 1584,
        "defect_fn": 101,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9561298390718171,
        "recall_macro": 0.9561880281432708,
        "f1_macro": 0.9560302022909049,
        "precision_micro": 0.956030534351145,
        "recall_micro": 0.956030534351145,
        "f1_micro": 0.956030534351145,
        "accuracy": 0.956030534351145,
        "hamming_loss": 0.04396946564885496,
        "no_defect_precision": 0.9673444239063462,
        "no_defect_recall": 0.9452137266706803,
        "no_defect_f1": 0.9561510353227771,
        "no_defect_tp": 1570,
        "no_defect_fp": 53,
        "no_defect_tn": 1561,
        "no_defect_fn": 91,
        "no_defect_support": 1661,
        "defect_precision": 0.9449152542372882,
        "defect_recall": 0.9671623296158612,
        "defect_f1": 0.9559093692590325,
        "defect_tp": 1561,
        "defect_fp": 91,
        "defect_tn": 1570,
        "defect_fn": 53,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9161533134067216,
        "recall_macro": 0.9088279331884541,
        "f1_macro": 0.9074581758299338,
        "precision_micro": 0.9077862595419848,
        "recall_micro": 0.9077862595419848,
        "f1_micro": 0.9077862595419848,
        "accuracy": 0.9077862595419848,
        "hamming_loss": 0.09221374045801527,
        "no_defect_precision": 0.9788583509513742,
        "no_defect_recall": 0.8362432269717038,
        "no_defect_f1": 0.9019480519480519,
        "no_defect_tp": 1389,
        "no_defect_fp": 30,
        "no_defect_tn": 1584,
        "no_defect_fn": 272,
        "no_defect_support": 1661,
        "defect_precision": 0.853448275862069,
        "defect_recall": 0.9814126394052045,
        "defect_f1": 0.9129682997118156,
        "defect_tp": 1584,
        "defect_fp": 272,
        "defect_tn": 1389,
        "defect_fn": 30,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9479510954909145,
        "recall_macro": 0.946906097833004,
        "f1_macro": 0.9471201764281658,
        "precision_micro": 0.947175572519084,
        "recall_micro": 0.947175572519084,
        "f1_micro": 0.947175572519084,
        "accuracy": 0.947175572519084,
        "hamming_loss": 0.05282442748091603,
        "no_defect_precision": 0.9325581395348838,
        "no_defect_recall": 0.9656833232992174,
        "no_defect_f1": 0.9488317065956817,
        "no_defect_tp": 1604,
        "no_defect_fp": 116,
        "no_defect_tn": 1498,
        "no_defect_fn": 57,
        "no_defect_support": 1661,
        "defect_precision": 0.9633440514469453,
        "defect_recall": 0.9281288723667905,
        "defect_f1": 0.94540864626065,
        "defect_tp": 1498,
        "defect_fp": 57,
        "defect_tn": 1604,
        "defect_fn": 116,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.954780685653914,
        "recall_macro": 0.9547267400611894,
        "f1_macro": 0.9545036640878184,
        "precision_micro": 0.9545038167938932,
        "recall_micro": 0.9545038167938932,
        "f1_micro": 0.9545038167938932,
        "accuracy": 0.9545038167938932,
        "hamming_loss": 0.04549618320610687,
        "no_defect_precision": 0.9701492537313433,
        "no_defect_recall": 0.9391932570740518,
        "no_defect_f1": 0.954420312022025,
        "no_defect_tp": 1560,
        "no_defect_fp": 48,
        "no_defect_tn": 1566,
        "no_defect_fn": 101,
        "no_defect_support": 1661,
        "defect_precision": 0.9394121175764847,
        "defect_recall": 0.9702602230483272,
        "defect_f1": 0.9545870161536117,
        "defect_tp": 1566,
        "defect_fp": 101,
        "defect_tn": 1560,
        "defect_fn": 48,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9473626700136137,
        "recall_macro": 0.9459329004861884,
        "f1_macro": 0.9461884948686753,
        "precision_micro": 0.9462595419847328,
        "recall_micro": 0.9462595419847328,
        "f1_micro": 0.9462595419847328,
        "accuracy": 0.9462595419847328,
        "hamming_loss": 0.053740458015267174,
        "no_defect_precision": 0.9284477784189267,
        "no_defect_recall": 0.9686935580975317,
        "no_defect_f1": 0.9481437831467295,
        "no_defect_tp": 1609,
        "no_defect_fp": 124,
        "no_defect_tn": 1490,
        "no_defect_fn": 52,
        "no_defect_support": 1661,
        "defect_precision": 0.9662775616083009,
        "defect_recall": 0.9231722428748451,
        "defect_f1": 0.944233206590621,
        "defect_tp": 1490,
        "defect_fp": 52,
        "defect_tn": 1609,
        "defect_fn": 124,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9341071045473199,
        "recall_macro": 0.9332488826321761,
        "f1_macro": 0.9328068298476817,
        "precision_micro": 0.932824427480916,
        "recall_micro": 0.932824427480916,
        "f1_micro": 0.932824427480916,
        "accuracy": 0.932824427480916,
        "hamming_loss": 0.06717557251908397,
        "no_defect_precision": 0.9615631005765535,
        "no_defect_recall": 0.9036724864539434,
        "no_defect_f1": 0.9317194289261328,
        "no_defect_tp": 1501,
        "no_defect_fp": 60,
        "no_defect_tn": 1554,
        "no_defect_fn": 160,
        "no_defect_support": 1661,
        "defect_precision": 0.9066511085180864,
        "defect_recall": 0.9628252788104089,
        "defect_f1": 0.9338942307692307,
        "defect_tp": 1554,
        "defect_fp": 160,
        "defect_tn": 1501,
        "defect_fn": 60,
        "defect_support": 1614
      }
    ],
    "test_metrics": [
      {
        "precision_macro": 0.935322962714267,
        "recall_macro": 0.9347585623647141,
        "f1_macro": 0.934381434739212,
        "precision_micro": 0.934391211473909,
        "recall_micro": 0.934391211473909,
        "f1_micro": 0.934391211473909,
        "accuracy": 0.934391211473909,
        "hamming_loss": 0.06560878852609094,
        "no_defect_precision": 0.9593650793650793,
        "no_defect_recall": 0.9091456077015644,
        "no_defect_f1": 0.9335804757491505,
        "no_defect_tp": 1511,
        "no_defect_fp": 64,
        "no_defect_tn": 1551,
        "no_defect_fn": 151,
        "no_defect_support": 1662,
        "defect_precision": 0.9112808460634547,
        "defect_recall": 0.9603715170278638,
        "defect_f1": 0.9351823937292735,
        "defect_tp": 1551,
        "defect_fp": 151,
        "defect_tn": 1511,
        "defect_fn": 64,
        "defect_support": 1615
      }
    ]
  }
}