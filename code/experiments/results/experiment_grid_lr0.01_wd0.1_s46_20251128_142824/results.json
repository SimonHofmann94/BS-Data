{
  "experiment_name": "experiment_grid_lr0.01_wd0.1_s46_20251128_142824",
  "experiment_dir": "/Users/ema/projects/DL4SE-project-UPM/code/experiments/results/experiment_grid_lr0.01_wd0.1_s46_20251128_142824",
  "timestamp": "2025-11-28T14:56:02.336193",
  "model": "ConvNextTiny",
  "loss": "CrossEntropyLossWrapper",
  "loss_params": {
    "weight": null,
    "reduction": "mean"
  },
  "best_epoch": 8,
  "split_info": {
    "train": {
      "total_samples": 15283,
      "class_counts": {
        "no_defect": 7752,
        "defect": 7531
      }
    },
    "val": {
      "total_samples": 3275,
      "class_counts": {
        "no_defect": 1661,
        "defect": 1614
      }
    },
    "test": {
      "total_samples": 3277,
      "class_counts": {
        "no_defect": 1662,
        "defect": 1615
      }
    },
    "total": {
      "total_samples": 21835,
      "class_counts": {
        "no_defect": 11075,
        "defect": 10760
      }
    }
  },
  "config": {
    "model": {
      "name": "convnext_tiny",
      "num_classes": 2,
      "pretrained": true,
      "cbam_stages": [
        3,
        4
      ]
    },
    "loss": {
      "type": "cross_entropy",
      "weight": null,
      "reduction": "mean"
    },
    "data": {
      "img_dir": "data/images",
      "ann_dir": "data/annotations",
      "splits_dir": "data/splits",
      "batch_size": 64,
      "num_workers": 0,
      "pin_memory": false,
      "image_size": [
        150,
        150
      ],
      "num_classes": 2,
      "class_names": [
        "no_defect",
        "defect"
      ],
      "split_strategy": "stratified_70_15_15",
      "use_saved_splits": true
    },
    "augmentation": {
      "horizontal_flip": 0.5,
      "vertical_flip": 0.3,
      "rotation": 10,
      "brightness_contrast": {
        "brightness": 0.2,
        "contrast": 0.2
      },
      "defect_blackout": {
        "enabled": false
      }
    },
    "training": {
      "num_epochs": 50,
      "learning_rate": 0.01,
      "weight_decay": 0.1,
      "warmup_epochs": 2,
      "early_stopping_patience": 5,
      "early_stopping_metric": "f1_macro",
      "log_interval": 5,
      "threshold": 0.5,
      "freeze_backbone": true,
      "freeze_early_stages": null
    },
    "optimizer": {
      "type": "adamw",
      "lr": 0.01,
      "weight_decay": 0.1,
      "betas": [
        0.9,
        0.999
      ]
    },
    "scheduler": {
      "type": "cosine",
      "warmup_epochs": 3
    },
    "experiment": {
      "name": "grid_lr0.01_wd0.1_s46",
      "seed": 46,
      "save_dir": "code/experiments/results",
      "output_dir": "/Users/ema/projects/DL4SE-project-UPM/code/experiments/results/experiment_grid_lr0.01_wd0.1_s46_20251128_142824"
    }
  },
  "device": "mps",
  "num_model_parameters": 28590666,
  "num_trainable_parameters": 772074,
  "best_val_metrics": {
    "precision_macro": 0.9575609615981473,
    "recall_macro": 0.9575353600009548,
    "f1_macro": 0.957547356764003,
    "precision_micro": 0.9575572519083969,
    "recall_micro": 0.9575572519083969,
    "f1_micro": 0.9575572519083969,
    "accuracy": 0.9575572519083969,
    "hamming_loss": 0.042442748091603054,
    "no_defect_precision": 0.9573317307692307,
    "no_defect_recall": 0.9590608067429259,
    "no_defect_f1": 0.9581954887218045,
    "no_defect_tp": 1593,
    "no_defect_fp": 71,
    "no_defect_tn": 1543,
    "no_defect_fn": 68,
    "no_defect_support": 1661,
    "defect_precision": 0.957790192427064,
    "defect_recall": 0.9560099132589839,
    "defect_f1": 0.9568992248062016,
    "defect_tp": 1543,
    "defect_fp": 68,
    "defect_tn": 1593,
    "defect_fn": 71,
    "defect_support": 1614
  },
  "test_metrics": {
    "precision_macro": 0.9487087906141092,
    "recall_macro": 0.9479224180646988,
    "f1_macro": 0.947501231333469,
    "precision_micro": 0.9475129691791272,
    "recall_micro": 0.9475129691791272,
    "f1_micro": 0.9475129691791272,
    "accuracy": 0.9475129691791272,
    "hamming_loss": 0.05248703082087275,
    "no_defect_precision": 0.9757343550446999,
    "no_defect_recall": 0.9193742478941035,
    "no_defect_f1": 0.9467162329615861,
    "no_defect_tp": 1528,
    "no_defect_fp": 38,
    "no_defect_tn": 1577,
    "no_defect_fn": 134,
    "no_defect_support": 1662,
    "defect_precision": 0.9216832261835184,
    "defect_recall": 0.9764705882352941,
    "defect_f1": 0.9482862297053518,
    "defect_tp": 1577,
    "defect_fp": 134,
    "defect_tn": 1528,
    "defect_fn": 38,
    "defect_support": 1615
  },
  "training_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13
    ],
    "train_loss": [
      0.39226348218059937,
      0.21827730324477831,
      0.19768963666889958,
      0.18878882529533558,
      0.1823716881883693,
      0.18063597371762766,
      0.18414626710085688,
      0.18265349135800385,
      0.18513734902111056,
      0.17850833878731628,
      0.18234755292098392,
      0.17388097477383194,
      0.1818018099410015
    ],
    "val_loss": [
      0.2924526806634206,
      0.16950346328891241,
      0.145162139302836,
      0.13453180622309446,
      0.1439708640369085,
      0.12978573945852426,
      0.141794537122433,
      0.12642307909062275,
      0.12496349817285171,
      0.13154130557981822,
      0.1290062703192234,
      0.13482174520882276,
      0.14621465581540877
    ]
  },
  "metrics_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13
    ],
    "train_metrics": [
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null
    ],
    "val_metrics": [
      {
        "precision_macro": 0.9210517967008605,
        "recall_macro": 0.9207989319821221,
        "f1_macro": 0.9208798845227352,
        "precision_micro": 0.9209160305343511,
        "recall_micro": 0.9209160305343511,
        "f1_micro": 0.9209160305343511,
        "accuracy": 0.9209160305343511,
        "hamming_loss": 0.07908396946564886,
        "no_defect_precision": 0.916270783847981,
        "no_defect_recall": 0.9289584587597832,
        "no_defect_f1": 0.9225710014947683,
        "no_defect_tp": 1543,
        "no_defect_fp": 141,
        "no_defect_tn": 1473,
        "no_defect_fn": 118,
        "no_defect_support": 1661,
        "defect_precision": 0.9258328095537398,
        "defect_recall": 0.912639405204461,
        "defect_f1": 0.919188767550702,
        "defect_tp": 1473,
        "defect_fp": 118,
        "defect_tn": 1543,
        "defect_fn": 141,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9481271472280526,
        "recall_macro": 0.9482123979895958,
        "f1_macro": 0.9480902043535047,
        "precision_micro": 0.9480916030534351,
        "recall_micro": 0.9480916030534351,
        "f1_micro": 0.9480916030534351,
        "accuracy": 0.9480916030534351,
        "hamming_loss": 0.051908396946564885,
        "no_defect_precision": 0.9570815450643777,
        "no_defect_recall": 0.9397953040337146,
        "no_defect_f1": 0.948359659781288,
        "no_defect_tp": 1561,
        "no_defect_fp": 70,
        "no_defect_tn": 1544,
        "no_defect_fn": 100,
        "no_defect_support": 1661,
        "defect_precision": 0.9391727493917275,
        "defect_recall": 0.9566294919454771,
        "defect_f1": 0.9478207489257213,
        "defect_tp": 1544,
        "defect_fp": 100,
        "defect_tn": 1561,
        "defect_fn": 70,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9518203137587197,
        "recall_macro": 0.9518948066548942,
        "f1_macro": 0.9517549650103454,
        "precision_micro": 0.9517557251908397,
        "recall_micro": 0.9517557251908397,
        "f1_micro": 0.9517557251908397,
        "accuracy": 0.9517557251908397,
        "hamming_loss": 0.048244274809160305,
        "no_defect_precision": 0.9618930547019053,
        "no_defect_recall": 0.9422034918723661,
        "no_defect_f1": 0.9519464720194647,
        "no_defect_tp": 1565,
        "no_defect_fp": 62,
        "no_defect_tn": 1552,
        "no_defect_fn": 96,
        "no_defect_support": 1661,
        "defect_precision": 0.941747572815534,
        "defect_recall": 0.9615861214374225,
        "defect_f1": 0.9515634580012262,
        "defect_tp": 1552,
        "defect_fp": 96,
        "defect_tn": 1565,
        "defect_fn": 62,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9533643491382591,
        "recall_macro": 0.9532070750589179,
        "f1_macro": 0.953265693451489,
        "precision_micro": 0.9532824427480916,
        "recall_micro": 0.9532824427480916,
        "f1_micro": 0.9532824427480916,
        "accuracy": 0.9532824427480916,
        "hamming_loss": 0.0467175572519084,
        "no_defect_precision": 0.9498806682577565,
        "no_defect_recall": 0.9584587597832631,
        "no_defect_f1": 0.9541504345220257,
        "no_defect_tp": 1592,
        "no_defect_fp": 84,
        "no_defect_tn": 1530,
        "no_defect_fn": 69,
        "no_defect_support": 1661,
        "defect_precision": 0.9568480300187617,
        "defect_recall": 0.9479553903345725,
        "defect_f1": 0.9523809523809523,
        "defect_tp": 1530,
        "defect_fp": 69,
        "defect_tn": 1592,
        "defect_fn": 84,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9475805544347127,
        "recall_macro": 0.9452081314387132,
        "f1_macro": 0.9455421033948022,
        "precision_micro": 0.945648854961832,
        "recall_micro": 0.945648854961832,
        "f1_micro": 0.945648854961832,
        "accuracy": 0.945648854961832,
        "hamming_loss": 0.05435114503816794,
        "no_defect_precision": 0.9215463331438317,
        "no_defect_recall": 0.9759181216134859,
        "no_defect_f1": 0.947953216374269,
        "no_defect_tp": 1621,
        "no_defect_fp": 138,
        "no_defect_tn": 1476,
        "no_defect_fn": 40,
        "no_defect_support": 1661,
        "defect_precision": 0.9736147757255936,
        "defect_recall": 0.9144981412639405,
        "defect_f1": 0.9431309904153354,
        "defect_tp": 1476,
        "defect_fp": 40,
        "defect_tn": 1621,
        "defect_fn": 138,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9524135224177349,
        "recall_macro": 0.951889024915195,
        "f1_macro": 0.9520295106557601,
        "precision_micro": 0.9520610687022901,
        "recall_micro": 0.9520610687022901,
        "f1_micro": 0.9520610687022901,
        "accuracy": 0.9520610687022901,
        "hamming_loss": 0.04793893129770992,
        "no_defect_precision": 0.9428739693757362,
        "no_defect_recall": 0.9638771824202288,
        "no_defect_f1": 0.9532598987793987,
        "no_defect_tp": 1601,
        "no_defect_fp": 97,
        "no_defect_tn": 1517,
        "no_defect_fn": 60,
        "no_defect_support": 1661,
        "defect_precision": 0.9619530754597336,
        "defect_recall": 0.9399008674101611,
        "defect_f1": 0.9507991225321216,
        "defect_tp": 1517,
        "defect_fp": 60,
        "defect_tn": 1601,
        "defect_fn": 97,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9491192660687393,
        "recall_macro": 0.9489634646273165,
        "f1_macro": 0.9487012139407388,
        "precision_micro": 0.9487022900763359,
        "recall_micro": 0.9487022900763359,
        "f1_micro": 0.9487022900763359,
        "accuracy": 0.9487022900763359,
        "hamming_loss": 0.05129770992366412,
        "no_defect_precision": 0.9668542839274546,
        "no_defect_recall": 0.9307645996387718,
        "no_defect_f1": 0.9484662576687116,
        "no_defect_tp": 1546,
        "no_defect_fp": 53,
        "no_defect_tn": 1561,
        "no_defect_fn": 115,
        "no_defect_support": 1661,
        "defect_precision": 0.9313842482100239,
        "defect_recall": 0.9671623296158612,
        "defect_f1": 0.948936170212766,
        "defect_tp": 1561,
        "defect_fp": 115,
        "defect_tn": 1546,
        "defect_fn": 53,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9575609615981473,
        "recall_macro": 0.9575353600009548,
        "f1_macro": 0.957547356764003,
        "precision_micro": 0.9575572519083969,
        "recall_micro": 0.9575572519083969,
        "f1_micro": 0.9575572519083969,
        "accuracy": 0.9575572519083969,
        "hamming_loss": 0.042442748091603054,
        "no_defect_precision": 0.9573317307692307,
        "no_defect_recall": 0.9590608067429259,
        "no_defect_f1": 0.9581954887218045,
        "no_defect_tp": 1593,
        "no_defect_fp": 71,
        "no_defect_tn": 1543,
        "no_defect_fn": 68,
        "no_defect_support": 1661,
        "defect_precision": 0.957790192427064,
        "defect_recall": 0.9560099132589839,
        "defect_f1": 0.9568992248062016,
        "defect_tp": 1543,
        "defect_fp": 68,
        "defect_tn": 1593,
        "defect_fn": 71,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9568351344222805,
        "recall_macro": 0.9561296512230804,
        "f1_macro": 0.9563013936246736,
        "precision_micro": 0.9563358778625954,
        "recall_micro": 0.9563358778625954,
        "f1_micro": 0.9563358778625954,
        "accuracy": 0.9563358778625954,
        "hamming_loss": 0.04366412213740458,
        "no_defect_precision": 0.9449003516998827,
        "no_defect_recall": 0.9704996989765202,
        "no_defect_f1": 0.9575289575289575,
        "no_defect_tp": 1612,
        "no_defect_fp": 94,
        "no_defect_tn": 1520,
        "no_defect_fn": 49,
        "no_defect_support": 1661,
        "defect_precision": 0.9687699171446782,
        "defect_recall": 0.9417596034696406,
        "defect_f1": 0.9550738297203896,
        "defect_tp": 1520,
        "defect_fp": 49,
        "defect_tn": 1612,
        "defect_fn": 94,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9535091124069184,
        "recall_macro": 0.952394647377291,
        "f1_macro": 0.952620230743793,
        "precision_micro": 0.9526717557251908,
        "recall_micro": 0.9526717557251908,
        "f1_micro": 0.9526717557251908,
        "accuracy": 0.9526717557251908,
        "hamming_loss": 0.04732824427480916,
        "no_defect_precision": 0.9372822299651568,
        "no_defect_recall": 0.9717037928958459,
        "no_defect_f1": 0.9541826780963641,
        "no_defect_tp": 1614,
        "no_defect_fp": 108,
        "no_defect_tn": 1506,
        "no_defect_fn": 47,
        "no_defect_support": 1661,
        "defect_precision": 0.96973599484868,
        "defect_recall": 0.9330855018587361,
        "defect_f1": 0.9510577833912219,
        "defect_tp": 1506,
        "defect_fp": 47,
        "defect_tn": 1614,
        "defect_fn": 108,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9558987242467827,
        "recall_macro": 0.955217814920171,
        "f1_macro": 0.9553854014576746,
        "precision_micro": 0.9554198473282443,
        "recall_micro": 0.9554198473282443,
        "f1_micro": 0.9554198473282443,
        "accuracy": 0.9554198473282443,
        "hamming_loss": 0.044580152671755725,
        "no_defect_precision": 0.9442815249266863,
        "no_defect_recall": 0.9692956050571945,
        "no_defect_f1": 0.9566250742721331,
        "no_defect_tp": 1610,
        "no_defect_fp": 95,
        "no_defect_tn": 1519,
        "no_defect_fn": 51,
        "no_defect_support": 1661,
        "defect_precision": 0.967515923566879,
        "defect_recall": 0.9411400247831475,
        "defect_f1": 0.9541457286432161,
        "defect_tp": 1519,
        "defect_fp": 51,
        "defect_tn": 1610,
        "defect_fn": 95,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.955071898243449,
        "recall_macro": 0.9550277635410209,
        "f1_macro": 0.9548090549712837,
        "precision_micro": 0.9548091603053435,
        "recall_micro": 0.9548091603053435,
        "f1_micro": 0.9548091603053435,
        "accuracy": 0.9548091603053435,
        "hamming_loss": 0.04519083969465649,
        "no_defect_precision": 0.9701678060907396,
        "no_defect_recall": 0.9397953040337146,
        "no_defect_f1": 0.9547400611620795,
        "no_defect_tp": 1561,
        "no_defect_fp": 48,
        "no_defect_tn": 1566,
        "no_defect_fn": 100,
        "no_defect_support": 1661,
        "defect_precision": 0.9399759903961584,
        "defect_recall": 0.9702602230483272,
        "defect_f1": 0.9548780487804878,
        "defect_tp": 1566,
        "defect_fp": 100,
        "defect_tn": 1561,
        "defect_fn": 48,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9502715885405566,
        "recall_macro": 0.9491650794858654,
        "f1_macro": 0.9486844873820919,
        "precision_micro": 0.9487022900763359,
        "recall_micro": 0.9487022900763359,
        "f1_micro": 0.9487022900763359,
        "accuracy": 0.9487022900763359,
        "hamming_loss": 0.05129770992366412,
        "no_defect_precision": 0.9806825499034127,
        "no_defect_recall": 0.9169175195665262,
        "no_defect_f1": 0.9477286869943995,
        "no_defect_tp": 1523,
        "no_defect_fp": 30,
        "no_defect_tn": 1584,
        "no_defect_fn": 138,
        "no_defect_support": 1661,
        "defect_precision": 0.9198606271777003,
        "defect_recall": 0.9814126394052045,
        "defect_f1": 0.9496402877697842,
        "defect_tp": 1584,
        "defect_fp": 138,
        "defect_tn": 1523,
        "defect_fn": 30,
        "defect_support": 1614
      }
    ],
    "test_metrics": [
      {
        "precision_macro": 0.9487087906141092,
        "recall_macro": 0.9479224180646988,
        "f1_macro": 0.947501231333469,
        "precision_micro": 0.9475129691791272,
        "recall_micro": 0.9475129691791272,
        "f1_micro": 0.9475129691791272,
        "accuracy": 0.9475129691791272,
        "hamming_loss": 0.05248703082087275,
        "no_defect_precision": 0.9757343550446999,
        "no_defect_recall": 0.9193742478941035,
        "no_defect_f1": 0.9467162329615861,
        "no_defect_tp": 1528,
        "no_defect_fp": 38,
        "no_defect_tn": 1577,
        "no_defect_fn": 134,
        "no_defect_support": 1662,
        "defect_precision": 0.9216832261835184,
        "defect_recall": 0.9764705882352941,
        "defect_f1": 0.9482862297053518,
        "defect_tp": 1577,
        "defect_fp": 134,
        "defect_tn": 1528,
        "defect_fn": 38,
        "defect_support": 1615
      }
    ]
  }
}