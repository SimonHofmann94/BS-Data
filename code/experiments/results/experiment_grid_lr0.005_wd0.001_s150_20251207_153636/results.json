{
  "experiment_name": "experiment_grid_lr0.005_wd0.001_s150_20251207_153636",
  "experiment_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s150_20251207_153636",
  "timestamp": "2025-12-07T15:38:37.574922",
  "model": "ConvNextTiny",
  "loss": "CrossEntropyLossWrapper",
  "loss_params": {
    "weight": null,
    "reduction": "mean"
  },
  "best_epoch": 9,
  "split_info": {
    "train": {
      "total_samples": 15284,
      "class_counts": {
        "no_defect": 7734,
        "defect": 7550
      }
    },
    "val": {
      "total_samples": 3275,
      "class_counts": {
        "no_defect": 1691,
        "defect": 1584
      }
    },
    "test": {
      "total_samples": 3276,
      "class_counts": {
        "no_defect": 1650,
        "defect": 1626
      }
    },
    "total": {
      "total_samples": 21835,
      "class_counts": {
        "no_defect": 11075,
        "defect": 10760
      }
    }
  },
  "config": {
    "model": {
      "name": "convnext_tiny",
      "num_classes": 2,
      "pretrained": true,
      "cbam_stages": [
        3,
        4
      ]
    },
    "loss": {
      "type": "cross_entropy",
      "weight": null,
      "reduction": "mean"
    },
    "data": {
      "img_dir": "data/images",
      "ann_dir": "data/annotations",
      "splits_dir": "data/splits",
      "batch_size": 64,
      "num_workers": 8,
      "pin_memory": false,
      "image_size": [
        150,
        150
      ],
      "num_classes": 2,
      "class_names": [
        "no_defect",
        "defect"
      ],
      "split_strategy": "stratified_70_15_15",
      "use_saved_splits": true
    },
    "augmentation": {
      "horizontal_flip": 0.5,
      "vertical_flip": 0.3,
      "rotation": 10,
      "brightness_contrast": {
        "brightness": 0.2,
        "contrast": 0.2
      },
      "defect_blackout": {
        "enabled": false
      }
    },
    "training": {
      "num_epochs": 15,
      "learning_rate": 0.005,
      "weight_decay": 0.001,
      "warmup_epochs": 2,
      "log_interval": 5,
      "threshold": 0.5,
      "save_checkpoints": false,
      "freeze_backbone": true,
      "freeze_early_stages": null
    },
    "optimizer": {
      "type": "adamw",
      "lr": 0.005,
      "weight_decay": 0.001,
      "betas": [
        0.9,
        0.999
      ]
    },
    "scheduler": {
      "type": "cosine",
      "warmup_epochs": 3
    },
    "experiment": {
      "name": "grid_lr0.005_wd0.001_s150",
      "seed": 150,
      "save_dir": "code/experiments/results",
      "output_dir": "/workspace/BS-Data/code/experiments/results/experiment_grid_lr0.005_wd0.001_s150_20251207_153636"
    }
  },
  "device": "cuda",
  "num_model_parameters": 28590666,
  "num_trainable_parameters": 772074,
  "best_val_metrics": {
    "precision_macro": 0.9660390566078635,
    "recall_macro": 0.9655452738502709,
    "f1_macro": 0.9657483847207167,
    "precision_micro": 0.9658015267175573,
    "recall_micro": 0.9658015267175573,
    "f1_micro": 0.9658015267175573,
    "accuracy": 0.9658015267175573,
    "hamming_loss": 0.03419847328244275,
    "no_defect_precision": 0.960887332165791,
    "no_defect_recall": 0.9733885274985216,
    "no_defect_f1": 0.9670975323149236,
    "no_defect_tp": 1646,
    "no_defect_fp": 67,
    "no_defect_tn": 1517,
    "no_defect_fn": 45,
    "no_defect_support": 1691,
    "defect_precision": 0.971190781049936,
    "defect_recall": 0.9577020202020202,
    "defect_f1": 0.9643992371265099,
    "defect_tp": 1517,
    "defect_fp": 45,
    "defect_tn": 1646,
    "defect_fn": 67,
    "defect_support": 1584
  },
  "test_metrics": {
    "precision_macro": 0.967049114331723,
    "recall_macro": 0.9670177792687018,
    "f1_macro": 0.9670302021865806,
    "precision_micro": 0.967032967032967,
    "recall_micro": 0.967032967032967,
    "f1_micro": 0.967032967032967,
    "accuracy": 0.967032967032967,
    "hamming_loss": 0.03296703296703297,
    "no_defect_precision": 0.9655797101449275,
    "no_defect_recall": 0.9690909090909091,
    "no_defect_f1": 0.9673321234119783,
    "no_defect_tp": 1599,
    "no_defect_fp": 57,
    "no_defect_tn": 1569,
    "no_defect_fn": 51,
    "no_defect_support": 1650,
    "defect_precision": 0.9685185185185186,
    "defect_recall": 0.9649446494464945,
    "defect_f1": 0.966728280961183,
    "defect_tp": 1569,
    "defect_fp": 51,
    "defect_tn": 1599,
    "defect_fn": 57,
    "defect_support": 1626
  },
  "training_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15
    ],
    "train_loss": [
      0.4647563987696021,
      0.25958226259532835,
      0.19360855966806412,
      0.17938146571858657,
      0.1804091473067156,
      0.1759346454369224,
      0.17929972717577444,
      0.17379298831129672,
      0.17035960184729748,
      0.16641328700479105,
      0.1626537986349112,
      0.1713966186700007,
      0.17032006757029927,
      0.16715906577566678,
      0.16331470754605457
    ],
    "val_loss": [
      0.3705547262842839,
      0.19354715656775695,
      0.14057511592713687,
      0.13715493478454077,
      0.12070842689046493,
      0.1071691053847854,
      0.1119765923716701,
      0.10624738546231619,
      0.10296213562385394,
      0.10333151355958901,
      0.10330592955534275,
      0.10082900832192256,
      0.10244392689604026,
      0.10108690261124419,
      0.10150529426307632
    ]
  },
  "metrics_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11,
      12,
      13,
      14,
      15
    ],
    "train_metrics": [
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null
    ],
    "val_metrics": [
      {
        "precision_macro": 0.8938062556255626,
        "recall_macro": 0.8920208142931383,
        "f1_macro": 0.8925140039659085,
        "precision_micro": 0.8928244274809161,
        "recall_micro": 0.8928244274809161,
        "f1_micro": 0.8928244274809161,
        "accuracy": 0.8928244274809161,
        "hamming_loss": 0.10717557251908397,
        "no_defect_precision": 0.8806818181818182,
        "no_defect_recall": 0.9166173861620343,
        "no_defect_f1": 0.8982903506230078,
        "no_defect_tp": 1550,
        "no_defect_fp": 210,
        "no_defect_tn": 1374,
        "no_defect_fn": 141,
        "no_defect_support": 1691,
        "defect_precision": 0.906930693069307,
        "defect_recall": 0.8674242424242424,
        "defect_f1": 0.8867376573088093,
        "defect_tp": 1374,
        "defect_fp": 141,
        "defect_tn": 1550,
        "defect_fn": 210,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9437729014317152,
        "recall_macro": 0.9437367838646668,
        "f1_macro": 0.9437544895603256,
        "precision_micro": 0.9438167938931298,
        "recall_micro": 0.9438167938931298,
        "f1_micro": 0.9438167938931298,
        "accuracy": 0.9438167938931298,
        "hamming_loss": 0.05618320610687023,
        "no_defect_precision": 0.9450679267572357,
        "no_defect_recall": 0.9461856889414547,
        "no_defect_f1": 0.9456264775413712,
        "no_defect_tp": 1600,
        "no_defect_fp": 93,
        "no_defect_tn": 1491,
        "no_defect_fn": 91,
        "no_defect_support": 1691,
        "defect_precision": 0.9424778761061947,
        "defect_recall": 0.9412878787878788,
        "defect_f1": 0.9418825015792799,
        "defect_tp": 1491,
        "defect_fp": 91,
        "defect_tn": 1600,
        "defect_fn": 93,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9546159955826435,
        "recall_macro": 0.9543053987539498,
        "f1_macro": 0.9544405937927171,
        "precision_micro": 0.9545038167938932,
        "recall_micro": 0.9545038167938932,
        "f1_micro": 0.9545038167938932,
        "accuracy": 0.9545038167938932,
        "hamming_loss": 0.04549618320610687,
        "no_defect_precision": 0.9519343493552169,
        "no_defect_recall": 0.9603784742755765,
        "no_defect_f1": 0.95613776861937,
        "no_defect_tp": 1624,
        "no_defect_fp": 82,
        "no_defect_tn": 1502,
        "no_defect_fn": 67,
        "no_defect_support": 1691,
        "defect_precision": 0.9572976418100702,
        "defect_recall": 0.9482323232323232,
        "defect_f1": 0.9527434189660641,
        "defect_tp": 1502,
        "defect_fp": 67,
        "defect_tn": 1624,
        "defect_fn": 82,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9536468443976251,
        "recall_macro": 0.9540214758465793,
        "f1_macro": 0.9532790276331369,
        "precision_micro": 0.9532824427480916,
        "recall_micro": 0.9532824427480916,
        "f1_micro": 0.9532824427480916,
        "accuracy": 0.9532824427480916,
        "hamming_loss": 0.0467175572519084,
        "no_defect_precision": 0.9770471464019851,
        "no_defect_recall": 0.9314015375517445,
        "no_defect_f1": 0.9536784741144414,
        "no_defect_tp": 1575,
        "no_defect_fp": 37,
        "no_defect_tn": 1547,
        "no_defect_fn": 116,
        "no_defect_support": 1691,
        "defect_precision": 0.9302465423932652,
        "defect_recall": 0.9766414141414141,
        "defect_f1": 0.9528795811518325,
        "defect_tp": 1547,
        "defect_fp": 116,
        "defect_tn": 1575,
        "defect_fn": 37,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9586605891387749,
        "recall_macro": 0.9591040878925268,
        "f1_macro": 0.9587597853689933,
        "precision_micro": 0.9587786259541985,
        "recall_micro": 0.9587786259541985,
        "f1_micro": 0.9587786259541985,
        "accuracy": 0.9587786259541985,
        "hamming_loss": 0.04122137404580153,
        "no_defect_precision": 0.9703748488512697,
        "no_defect_recall": 0.9491425192193969,
        "no_defect_f1": 0.9596412556053812,
        "no_defect_tp": 1605,
        "no_defect_fp": 49,
        "no_defect_tn": 1535,
        "no_defect_fn": 86,
        "no_defect_support": 1691,
        "defect_precision": 0.9469463294262801,
        "defect_recall": 0.9690656565656566,
        "defect_f1": 0.9578783151326054,
        "defect_tp": 1535,
        "defect_fp": 86,
        "defect_tn": 1605,
        "defect_fn": 49,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9645258579175243,
        "recall_macro": 0.9645622771177177,
        "f1_macro": 0.9645437067179363,
        "precision_micro": 0.9645801526717557,
        "recall_micro": 0.9645801526717557,
        "f1_micro": 0.9645801526717557,
        "accuracy": 0.9645801526717557,
        "hamming_loss": 0.035419847328244276,
        "no_defect_precision": 0.9662522202486679,
        "no_defect_recall": 0.9651094027202839,
        "no_defect_f1": 0.9656804733727811,
        "no_defect_tp": 1632,
        "no_defect_fp": 57,
        "no_defect_tn": 1527,
        "no_defect_fn": 59,
        "no_defect_support": 1691,
        "defect_precision": 0.9627994955863808,
        "defect_recall": 0.9640151515151515,
        "defect_f1": 0.9634069400630915,
        "defect_tp": 1527,
        "defect_fp": 59,
        "defect_tn": 1632,
        "defect_fn": 57,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9616947666828304,
        "recall_macro": 0.9621008652461935,
        "f1_macro": 0.9618114956656572,
        "precision_micro": 0.9618320610687023,
        "recall_micro": 0.9618320610687023,
        "f1_micro": 0.9618320610687023,
        "accuracy": 0.9618320610687023,
        "hamming_loss": 0.03816793893129771,
        "no_defect_precision": 0.9716867469879518,
        "no_defect_recall": 0.9538734476641041,
        "no_defect_f1": 0.9626977021784542,
        "no_defect_tp": 1613,
        "no_defect_fp": 47,
        "no_defect_tn": 1537,
        "no_defect_fn": 78,
        "no_defect_support": 1691,
        "defect_precision": 0.951702786377709,
        "defect_recall": 0.9703282828282829,
        "defect_f1": 0.9609252891528602,
        "defect_tp": 1537,
        "defect_fp": 78,
        "defect_tn": 1613,
        "defect_fn": 47,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9629126464205169,
        "recall_macro": 0.9633035708952327,
        "f1_macro": 0.9630324656624757,
        "precision_micro": 0.9630534351145038,
        "recall_micro": 0.9630534351145038,
        "f1_micro": 0.9630534351145038,
        "accuracy": 0.9630534351145038,
        "hamming_loss": 0.036946564885496185,
        "no_defect_precision": 0.9723225030084236,
        "no_defect_recall": 0.9556475458308693,
        "no_defect_f1": 0.9639129138085297,
        "no_defect_tp": 1616,
        "no_defect_fp": 46,
        "no_defect_tn": 1538,
        "no_defect_fn": 75,
        "no_defect_support": 1691,
        "defect_precision": 0.95350278983261,
        "defect_recall": 0.9709595959595959,
        "defect_f1": 0.9621520175164217,
        "defect_tp": 1538,
        "defect_fp": 75,
        "defect_tn": 1616,
        "defect_fn": 46,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9660390566078635,
        "recall_macro": 0.9655452738502709,
        "f1_macro": 0.9657483847207167,
        "precision_micro": 0.9658015267175573,
        "recall_micro": 0.9658015267175573,
        "f1_micro": 0.9658015267175573,
        "accuracy": 0.9658015267175573,
        "hamming_loss": 0.03419847328244275,
        "no_defect_precision": 0.960887332165791,
        "no_defect_recall": 0.9733885274985216,
        "no_defect_f1": 0.9670975323149236,
        "no_defect_tp": 1646,
        "no_defect_fp": 67,
        "no_defect_tn": 1517,
        "no_defect_fn": 45,
        "no_defect_support": 1691,
        "defect_precision": 0.971190781049936,
        "defect_recall": 0.9577020202020202,
        "defect_f1": 0.9643992371265099,
        "defect_tp": 1517,
        "defect_fp": 45,
        "defect_tn": 1646,
        "defect_fn": 67,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9645423035798553,
        "recall_macro": 0.9645423035798553,
        "f1_macro": 0.9645423035798553,
        "precision_micro": 0.9645801526717557,
        "recall_micro": 0.9645801526717557,
        "f1_micro": 0.9645801526717557,
        "accuracy": 0.9645801526717557,
        "hamming_loss": 0.035419847328244276,
        "no_defect_precision": 0.9657007687758723,
        "no_defect_recall": 0.9657007687758723,
        "no_defect_f1": 0.9657007687758723,
        "no_defect_tp": 1633,
        "no_defect_fp": 58,
        "no_defect_tn": 1526,
        "no_defect_fn": 58,
        "no_defect_support": 1691,
        "defect_precision": 0.9633838383838383,
        "defect_recall": 0.9633838383838383,
        "defect_f1": 0.9633838383838383,
        "defect_tp": 1526,
        "defect_fp": 58,
        "defect_tn": 1633,
        "defect_fn": 58,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9626113652017465,
        "recall_macro": 0.9628880466402643,
        "f1_macro": 0.9627205602991089,
        "precision_micro": 0.9627480916030534,
        "recall_micro": 0.9627480916030534,
        "f1_micro": 0.9627480916030534,
        "accuracy": 0.9627480916030534,
        "hamming_loss": 0.037251908396946566,
        "no_defect_precision": 0.9689181111775254,
        "no_defect_recall": 0.9586043761088113,
        "no_defect_f1": 0.9637336504161712,
        "no_defect_tp": 1621,
        "no_defect_fp": 52,
        "no_defect_tn": 1532,
        "no_defect_fn": 70,
        "no_defect_support": 1691,
        "defect_precision": 0.9563046192259675,
        "defect_recall": 0.9671717171717171,
        "defect_f1": 0.9617074701820465,
        "defect_tp": 1532,
        "defect_fp": 70,
        "defect_tn": 1621,
        "defect_fn": 52,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9638205434391107,
        "recall_macro": 0.9634555191178491,
        "f1_macro": 0.9636119571076265,
        "precision_micro": 0.9636641221374046,
        "recall_micro": 0.9636641221374046,
        "f1_micro": 0.9636641221374046,
        "accuracy": 0.9636641221374046,
        "hamming_loss": 0.03633587786259542,
        "no_defect_precision": 0.9601873536299765,
        "no_defect_recall": 0.9698403311649911,
        "no_defect_f1": 0.9649897028537805,
        "no_defect_tp": 1640,
        "no_defect_fp": 68,
        "no_defect_tn": 1516,
        "no_defect_fn": 51,
        "no_defect_support": 1691,
        "defect_precision": 0.967453733248245,
        "defect_recall": 0.9570707070707071,
        "defect_f1": 0.9622342113614726,
        "defect_tp": 1516,
        "defect_fp": 51,
        "defect_tn": 1640,
        "defect_fn": 68,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9629412972085386,
        "recall_macro": 0.9631238090544714,
        "f1_macro": 0.9630216614539442,
        "precision_micro": 0.9630534351145038,
        "recall_micro": 0.9630534351145038,
        "f1_micro": 0.9630534351145038,
        "accuracy": 0.9630534351145038,
        "hamming_loss": 0.036946564885496185,
        "no_defect_precision": 0.9672619047619048,
        "no_defect_recall": 0.960969840331165,
        "no_defect_f1": 0.9641056066449125,
        "no_defect_tp": 1625,
        "no_defect_fp": 55,
        "no_defect_tn": 1529,
        "no_defect_fn": 66,
        "no_defect_support": 1691,
        "defect_precision": 0.9586206896551724,
        "defect_recall": 0.9652777777777778,
        "defect_f1": 0.9619377162629758,
        "defect_tp": 1529,
        "defect_fp": 66,
        "defect_tn": 1625,
        "defect_fn": 55,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9636012536694768,
        "recall_macro": 0.9636552544964727,
        "f1_macro": 0.9636274431023455,
        "precision_micro": 0.9636641221374046,
        "recall_micro": 0.9636641221374046,
        "f1_micro": 0.9636641221374046,
        "accuracy": 0.9636641221374046,
        "hamming_loss": 0.03633587786259542,
        "no_defect_precision": 0.9656398104265402,
        "no_defect_recall": 0.9639266706091071,
        "no_defect_f1": 0.9647824800236756,
        "no_defect_tp": 1630,
        "no_defect_fp": 58,
        "no_defect_tn": 1526,
        "no_defect_fn": 61,
        "no_defect_support": 1691,
        "defect_precision": 0.9615626969124134,
        "defect_recall": 0.9633838383838383,
        "defect_f1": 0.9624724061810155,
        "defect_tp": 1526,
        "defect_fp": 61,
        "defect_tn": 1630,
        "defect_fn": 58,
        "defect_support": 1584
      },
      {
        "precision_macro": 0.9635869601732552,
        "recall_macro": 0.963675228034335,
        "f1_macro": 0.9636288416263183,
        "precision_micro": 0.9636641221374046,
        "recall_micro": 0.9636641221374046,
        "f1_micro": 0.9636641221374046,
        "accuracy": 0.9636641221374046,
        "hamming_loss": 0.03633587786259542,
        "no_defect_precision": 0.9661921708185054,
        "no_defect_recall": 0.9633353045535187,
        "no_defect_f1": 0.9647616227420788,
        "no_defect_tp": 1629,
        "no_defect_fp": 57,
        "no_defect_tn": 1527,
        "no_defect_fn": 62,
        "no_defect_support": 1691,
        "defect_precision": 0.9609817495280051,
        "defect_recall": 0.9640151515151515,
        "defect_f1": 0.9624960605105578,
        "defect_tp": 1527,
        "defect_fp": 62,
        "defect_tn": 1629,
        "defect_fn": 57,
        "defect_support": 1584
      }
    ],
    "test_metrics": [
      {
        "precision_macro": 0.967049114331723,
        "recall_macro": 0.9670177792687018,
        "f1_macro": 0.9670302021865806,
        "precision_micro": 0.967032967032967,
        "recall_micro": 0.967032967032967,
        "f1_micro": 0.967032967032967,
        "accuracy": 0.967032967032967,
        "hamming_loss": 0.03296703296703297,
        "no_defect_precision": 0.9655797101449275,
        "no_defect_recall": 0.9690909090909091,
        "no_defect_f1": 0.9673321234119783,
        "no_defect_tp": 1599,
        "no_defect_fp": 57,
        "no_defect_tn": 1569,
        "no_defect_fn": 51,
        "no_defect_support": 1650,
        "defect_precision": 0.9685185185185186,
        "defect_recall": 0.9649446494464945,
        "defect_f1": 0.966728280961183,
        "defect_tp": 1569,
        "defect_fp": 51,
        "defect_tn": 1599,
        "defect_fn": 57,
        "defect_support": 1626
      }
    ]
  }
}