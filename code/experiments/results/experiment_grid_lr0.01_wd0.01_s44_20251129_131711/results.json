{
  "experiment_name": "experiment_grid_lr0.01_wd0.01_s44_20251129_131711",
  "experiment_dir": "/Users/ema/projects/DL4SE-project-UPM/code/experiments/results/experiment_grid_lr0.01_wd0.01_s44_20251129_131711",
  "timestamp": "2025-11-29T13:41:16.328712",
  "model": "ConvNextTiny",
  "loss": "CrossEntropyLossWrapper",
  "loss_params": {
    "weight": null,
    "reduction": "mean"
  },
  "best_epoch": 6,
  "split_info": {
    "train": {
      "total_samples": 15283,
      "class_counts": {
        "no_defect": 7752,
        "defect": 7531
      }
    },
    "val": {
      "total_samples": 3275,
      "class_counts": {
        "no_defect": 1661,
        "defect": 1614
      }
    },
    "test": {
      "total_samples": 3277,
      "class_counts": {
        "no_defect": 1662,
        "defect": 1615
      }
    },
    "total": {
      "total_samples": 21835,
      "class_counts": {
        "no_defect": 11075,
        "defect": 10760
      }
    }
  },
  "config": {
    "model": {
      "name": "convnext_tiny",
      "num_classes": 2,
      "pretrained": true,
      "cbam_stages": [
        3,
        4
      ]
    },
    "loss": {
      "type": "cross_entropy",
      "weight": null,
      "reduction": "mean"
    },
    "data": {
      "img_dir": "data/images",
      "ann_dir": "data/annotations",
      "splits_dir": "data/splits",
      "batch_size": 64,
      "num_workers": 0,
      "pin_memory": false,
      "image_size": [
        150,
        150
      ],
      "num_classes": 2,
      "class_names": [
        "no_defect",
        "defect"
      ],
      "split_strategy": "stratified_70_15_15",
      "use_saved_splits": true
    },
    "augmentation": {
      "horizontal_flip": 0.5,
      "vertical_flip": 0.3,
      "rotation": 10,
      "brightness_contrast": {
        "brightness": 0.2,
        "contrast": 0.2
      },
      "defect_blackout": {
        "enabled": false
      }
    },
    "training": {
      "num_epochs": 50,
      "learning_rate": 0.01,
      "weight_decay": 0.01,
      "warmup_epochs": 2,
      "early_stopping_patience": 5,
      "early_stopping_metric": "f1_macro",
      "log_interval": 5,
      "threshold": 0.5,
      "save_checkpoints": false,
      "freeze_backbone": true,
      "freeze_early_stages": null
    },
    "optimizer": {
      "type": "adamw",
      "lr": 0.01,
      "weight_decay": 0.01,
      "betas": [
        0.9,
        0.999
      ]
    },
    "scheduler": {
      "type": "cosine",
      "warmup_epochs": 3
    },
    "experiment": {
      "name": "grid_lr0.01_wd0.01_s44",
      "seed": 44,
      "save_dir": "code/experiments/results",
      "output_dir": "/Users/ema/projects/DL4SE-project-UPM/code/experiments/results/experiment_grid_lr0.01_wd0.01_s44_20251129_131711"
    }
  },
  "device": "mps",
  "num_model_parameters": 28590666,
  "num_trainable_parameters": 772074,
  "best_val_metrics": {
    "precision_macro": 0.9621113289146076,
    "recall_macro": 0.962190966013069,
    "f1_macro": 0.9621335599041301,
    "precision_micro": 0.9621374045801526,
    "recall_micro": 0.9621374045801526,
    "f1_micro": 0.9621374045801526,
    "accuracy": 0.9621374045801526,
    "hamming_loss": 0.03786259541984733,
    "no_defect_precision": 0.9666059502125076,
    "no_defect_recall": 0.9584587597832631,
    "no_defect_f1": 0.9625151148730351,
    "no_defect_tp": 1592,
    "no_defect_fp": 55,
    "no_defect_tn": 1559,
    "no_defect_fn": 69,
    "no_defect_support": 1661,
    "defect_precision": 0.9576167076167076,
    "defect_recall": 0.9659231722428748,
    "defect_f1": 0.9617520049352252,
    "defect_tp": 1559,
    "defect_fp": 69,
    "defect_tn": 1592,
    "defect_fn": 55,
    "defect_support": 1614
  },
  "test_metrics": {
    "precision_macro": 0.9587858785766814,
    "recall_macro": 0.95880844072381,
    "f1_macro": 0.9587963556715678,
    "precision_micro": 0.9588037839487336,
    "recall_micro": 0.9588037839487336,
    "f1_micro": 0.9588037839487336,
    "accuracy": 0.9588037839487336,
    "hamming_loss": 0.0411962160512664,
    "no_defect_precision": 0.9602169981916817,
    "no_defect_recall": 0.9584837545126353,
    "no_defect_f1": 0.959349593495935,
    "no_defect_tp": 1593,
    "no_defect_fp": 66,
    "no_defect_tn": 1549,
    "no_defect_fn": 69,
    "no_defect_support": 1662,
    "defect_precision": 0.9573547589616811,
    "defect_recall": 0.9591331269349845,
    "defect_f1": 0.9582431178472007,
    "defect_tp": 1549,
    "defect_fp": 69,
    "defect_tn": 1593,
    "defect_fn": 66,
    "defect_support": 1615
  },
  "training_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11
    ],
    "train_loss": [
      0.3807875222242028,
      0.21644264051230883,
      0.18524247431293692,
      0.1833087169725027,
      0.1782716458437333,
      0.18060869273094451,
      0.18291440345814539,
      0.1847497652592644,
      0.1803717596386267,
      0.17932701665736642,
      0.1776218675700441
    ],
    "val_loss": [
      0.29243471731360143,
      0.15611169687830484,
      0.13275589779592478,
      0.12419070016879302,
      0.11849162749086435,
      0.10819333175627086,
      0.11026828549802303,
      0.1134987361729145,
      0.1177783151372121,
      0.11270906611417349,
      0.11709848891657132
    ]
  },
  "metrics_history": {
    "epoch": [
      1,
      2,
      3,
      4,
      5,
      6,
      7,
      8,
      9,
      10,
      11
    ],
    "train_metrics": [
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null,
      null
    ],
    "val_metrics": [
      {
        "precision_macro": 0.9169975095664511,
        "recall_macro": 0.9139690188275826,
        "f1_macro": 0.9142862484109773,
        "precision_micro": 0.9145038167938931,
        "recall_micro": 0.9145038167938931,
        "f1_micro": 0.9145038167938931,
        "accuracy": 0.9145038167938931,
        "hamming_loss": 0.08549618320610687,
        "no_defect_precision": 0.8881394041596402,
        "no_defect_recall": 0.9512341962673089,
        "no_defect_f1": 0.9186046511627907,
        "no_defect_tp": 1580,
        "no_defect_fp": 199,
        "no_defect_tn": 1415,
        "no_defect_fn": 81,
        "no_defect_support": 1661,
        "defect_precision": 0.945855614973262,
        "defect_recall": 0.8767038413878563,
        "defect_f1": 0.909967845659164,
        "defect_tp": 1415,
        "defect_fp": 81,
        "defect_tn": 1580,
        "defect_fn": 199,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9462095781331108,
        "recall_macro": 0.9450561276369396,
        "f1_macro": 0.9452817816731656,
        "precision_micro": 0.9453435114503816,
        "recall_micro": 0.9453435114503816,
        "f1_micro": 0.9453435114503816,
        "accuracy": 0.9453435114503816,
        "hamming_loss": 0.05465648854961832,
        "no_defect_precision": 0.929814385150812,
        "no_defect_recall": 0.9650812763395545,
        "no_defect_f1": 0.9471196454948302,
        "no_defect_tp": 1603,
        "no_defect_fp": 121,
        "no_defect_tn": 1493,
        "no_defect_fn": 58,
        "no_defect_support": 1661,
        "defect_precision": 0.9626047711154094,
        "defect_recall": 0.9250309789343246,
        "defect_f1": 0.9434439178515008,
        "defect_tp": 1493,
        "defect_fp": 58,
        "defect_tn": 1603,
        "defect_fn": 121,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9563783168926101,
        "recall_macro": 0.9564627540328567,
        "f1_macro": 0.9563348356592674,
        "precision_micro": 0.9563358778625954,
        "recall_micro": 0.9563358778625954,
        "f1_micro": 0.9563358778625954,
        "accuracy": 0.9563358778625954,
        "hamming_loss": 0.04366412213740458,
        "no_defect_precision": 0.9656441717791411,
        "no_defect_recall": 0.9476219145093318,
        "no_defect_f1": 0.9565481616529931,
        "no_defect_tp": 1574,
        "no_defect_fp": 56,
        "no_defect_tn": 1558,
        "no_defect_fn": 87,
        "no_defect_support": 1661,
        "defect_precision": 0.947112462006079,
        "defect_recall": 0.9653035935563816,
        "defect_f1": 0.9561215096655415,
        "defect_tp": 1558,
        "defect_fp": 87,
        "defect_tn": 1574,
        "defect_fn": 56,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9521601886134834,
        "recall_macro": 0.9519766835493466,
        "f1_macro": 0.9520427543496828,
        "precision_micro": 0.9520610687022901,
        "recall_micro": 0.9520610687022901,
        "f1_micro": 0.9520610687022901,
        "accuracy": 0.9520610687022901,
        "hamming_loss": 0.04793893129770992,
        "no_defect_precision": 0.9481525625744934,
        "no_defect_recall": 0.9578567128236002,
        "no_defect_f1": 0.9529799341120095,
        "no_defect_tp": 1591,
        "no_defect_fp": 87,
        "no_defect_tn": 1527,
        "no_defect_fn": 70,
        "no_defect_support": 1661,
        "defect_precision": 0.9561678146524734,
        "defect_recall": 0.9460966542750929,
        "defect_f1": 0.951105574587356,
        "defect_tp": 1527,
        "defect_fp": 70,
        "defect_tn": 1591,
        "defect_fn": 87,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9589519587130504,
        "recall_macro": 0.958967366369075,
        "f1_macro": 0.9587786105811495,
        "precision_micro": 0.9587786259541985,
        "recall_micro": 0.9587786259541985,
        "f1_micro": 0.9587786259541985,
        "accuracy": 0.9587786259541985,
        "hamming_loss": 0.04122137404580153,
        "no_defect_precision": 0.9721534653465347,
        "no_defect_recall": 0.9458157736303432,
        "no_defect_f1": 0.9588037839487336,
        "no_defect_tp": 1571,
        "no_defect_fp": 45,
        "no_defect_tn": 1569,
        "no_defect_fn": 90,
        "no_defect_support": 1661,
        "defect_precision": 0.945750452079566,
        "defect_recall": 0.9721189591078067,
        "defect_f1": 0.9587534372135655,
        "defect_tp": 1569,
        "defect_fp": 90,
        "defect_tn": 1571,
        "defect_fn": 45,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9621113289146076,
        "recall_macro": 0.962190966013069,
        "f1_macro": 0.9621335599041301,
        "precision_micro": 0.9621374045801526,
        "recall_micro": 0.9621374045801526,
        "f1_micro": 0.9621374045801526,
        "accuracy": 0.9621374045801526,
        "hamming_loss": 0.03786259541984733,
        "no_defect_precision": 0.9666059502125076,
        "no_defect_recall": 0.9584587597832631,
        "no_defect_f1": 0.9625151148730351,
        "no_defect_tp": 1592,
        "no_defect_fp": 55,
        "no_defect_tn": 1559,
        "no_defect_fn": 69,
        "no_defect_support": 1661,
        "defect_precision": 0.9576167076167076,
        "defect_recall": 0.9659231722428748,
        "defect_f1": 0.9617520049352252,
        "defect_tp": 1559,
        "defect_fp": 69,
        "defect_tn": 1592,
        "defect_fn": 55,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9616618909249961,
        "recall_macro": 0.9614311335119331,
        "f1_macro": 0.9615106085773,
        "precision_micro": 0.9615267175572519,
        "recall_micro": 0.9615267175572519,
        "f1_micro": 0.9615267175572519,
        "accuracy": 0.9615267175572519,
        "hamming_loss": 0.03847328244274809,
        "no_defect_precision": 0.9565734681737061,
        "no_defect_recall": 0.9680915111378687,
        "no_defect_f1": 0.9622980251346499,
        "no_defect_tp": 1608,
        "no_defect_fp": 73,
        "no_defect_tn": 1541,
        "no_defect_fn": 53,
        "no_defect_support": 1661,
        "defect_precision": 0.966750313676286,
        "defect_recall": 0.9547707558859975,
        "defect_f1": 0.9607231920199502,
        "defect_tp": 1541,
        "defect_fp": 53,
        "defect_tn": 1608,
        "defect_fn": 73,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9577339036554159,
        "recall_macro": 0.957050253389405,
        "f1_macro": 0.957218878110099,
        "precision_micro": 0.9572519083969465,
        "recall_micro": 0.9572519083969465,
        "f1_micro": 0.9572519083969465,
        "accuracy": 0.9572519083969465,
        "hamming_loss": 0.042748091603053436,
        "no_defect_precision": 0.9460410557184751,
        "no_defect_recall": 0.971101745936183,
        "no_defect_f1": 0.958407605466429,
        "no_defect_tp": 1613,
        "no_defect_fp": 92,
        "no_defect_tn": 1522,
        "no_defect_fn": 48,
        "no_defect_support": 1661,
        "defect_precision": 0.9694267515923567,
        "defect_recall": 0.942998760842627,
        "defect_f1": 0.9560301507537688,
        "defect_tp": 1522,
        "defect_fp": 48,
        "defect_tn": 1613,
        "defect_fn": 92,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9548527320239198,
        "recall_macro": 0.9547560217751507,
        "f1_macro": 0.9547954669748571,
        "precision_micro": 0.9548091603053435,
        "recall_micro": 0.9548091603053435,
        "f1_micro": 0.9548091603053435,
        "accuracy": 0.9548091603053435,
        "hamming_loss": 0.04519083969465649,
        "no_defect_precision": 0.952722920406942,
        "no_defect_recall": 0.9584587597832631,
        "no_defect_f1": 0.9555822328931572,
        "no_defect_tp": 1592,
        "no_defect_fp": 79,
        "no_defect_tn": 1535,
        "no_defect_fn": 69,
        "no_defect_support": 1661,
        "defect_precision": 0.9569825436408977,
        "defect_recall": 0.9510532837670385,
        "defect_f1": 0.9540087010565569,
        "defect_tp": 1535,
        "defect_fp": 69,
        "defect_tn": 1592,
        "defect_fn": 79,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9581631419804342,
        "recall_macro": 0.9581549386874482,
        "f1_macro": 0.9581589509443948,
        "precision_micro": 0.9581679389312977,
        "recall_micro": 0.9581679389312977,
        "f1_micro": 0.9581679389312977,
        "accuracy": 0.9581679389312977,
        "hamming_loss": 0.04183206106870229,
        "no_defect_precision": 0.9584837545126353,
        "no_defect_recall": 0.9590608067429259,
        "no_defect_f1": 0.9587721938007824,
        "no_defect_tp": 1593,
        "no_defect_fp": 69,
        "no_defect_tn": 1545,
        "no_defect_fn": 68,
        "no_defect_support": 1661,
        "defect_precision": 0.9578425294482331,
        "defect_recall": 0.9572490706319703,
        "defect_f1": 0.9575457080880074,
        "defect_tp": 1545,
        "defect_fp": 68,
        "defect_tn": 1593,
        "defect_fn": 69,
        "defect_support": 1614
      },
      {
        "precision_macro": 0.9560327678837147,
        "recall_macro": 0.9561266670993647,
        "f1_macro": 0.9560283656202239,
        "precision_micro": 0.956030534351145,
        "recall_micro": 0.956030534351145,
        "f1_micro": 0.956030534351145,
        "accuracy": 0.956030534351145,
        "hamming_loss": 0.04396946564885496,
        "no_defect_precision": 0.9633475870494808,
        "no_defect_recall": 0.9494280553883203,
        "no_defect_f1": 0.9563371740448757,
        "no_defect_tp": 1577,
        "no_defect_fp": 60,
        "no_defect_tn": 1554,
        "no_defect_fn": 84,
        "no_defect_support": 1661,
        "defect_precision": 0.9487179487179487,
        "defect_recall": 0.9628252788104089,
        "defect_f1": 0.955719557195572,
        "defect_tp": 1554,
        "defect_fp": 84,
        "defect_tn": 1577,
        "defect_fn": 60,
        "defect_support": 1614
      }
    ],
    "test_metrics": [
      {
        "precision_macro": 0.9587858785766814,
        "recall_macro": 0.95880844072381,
        "f1_macro": 0.9587963556715678,
        "precision_micro": 0.9588037839487336,
        "recall_micro": 0.9588037839487336,
        "f1_micro": 0.9588037839487336,
        "accuracy": 0.9588037839487336,
        "hamming_loss": 0.0411962160512664,
        "no_defect_precision": 0.9602169981916817,
        "no_defect_recall": 0.9584837545126353,
        "no_defect_f1": 0.959349593495935,
        "no_defect_tp": 1593,
        "no_defect_fp": 66,
        "no_defect_tn": 1549,
        "no_defect_fn": 69,
        "no_defect_support": 1662,
        "defect_precision": 0.9573547589616811,
        "defect_recall": 0.9591331269349845,
        "defect_f1": 0.9582431178472007,
        "defect_tp": 1549,
        "defect_fp": 69,
        "defect_tn": 1593,
        "defect_fn": 66,
        "defect_support": 1615
      }
    ]
  }
}